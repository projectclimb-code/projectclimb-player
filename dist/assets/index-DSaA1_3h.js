(function(){const W=document.createElement("link").relList;if(W&&W.supports&&W.supports("modulepreload"))return;for(const z of document.querySelectorAll('link[rel="modulepreload"]'))et(z);new MutationObserver(z=>{for(const c of z)if(c.type==="childList")for(const O of c.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&et(O)}).observe(document,{childList:!0,subtree:!0});function J(z){const c={};return z.integrity&&(c.integrity=z.integrity),z.referrerPolicy&&(c.referrerPolicy=z.referrerPolicy),z.crossOrigin==="use-credentials"?c.credentials="include":z.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function et(z){if(z.ep)return;z.ep=!0;const c=J(z);fetch(z.href,c)}})();var _r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Aa(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function qa(b){if(Object.prototype.hasOwnProperty.call(b,"__esModule"))return b;var W=b.default;if(typeof W=="function"){var J=function et(){var z=!1;try{z=this instanceof et}catch{}return z?Reflect.construct(W,arguments,this.constructor):W.apply(this,arguments)};J.prototype=W.prototype}else J={};return Object.defineProperty(J,"__esModule",{value:!0}),Object.keys(b).forEach(function(et){var z=Object.getOwnPropertyDescriptor(b,et);Object.defineProperty(J,et,z.get?z:{enumerable:!0,get:function(){return b[et]}})}),J}var Pn={exports:{}},xr={},Yn={},Xn={},ps;function Oe(){return ps||(ps=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b._registerNode=b.Konva=b.glob=void 0;const W=Math.PI/180;function J(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}b.glob=typeof _r<"u"?_r:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},b.Konva={_global:b.glob,version:"9.3.22",isBrowser:J(),isUnminified:/param/.test((function(z){}).toString()),dblClickWindow:400,getAngle(z){return b.Konva.angleDeg?z*W:z},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return b.Konva.DD.isDragging},isTransforming(){var z;return(z=b.Konva.Transformer)===null||z===void 0?void 0:z.isTransforming()},isDragReady(){return!!b.Konva.DD.node},releaseCanvasOnDestroy:!0,document:b.glob.document,_injectGlobal(z){b.glob.Konva=z}};const et=z=>{b.Konva[z.prototype.getClassName()]=z};b._registerNode=et,b.Konva._injectGlobal(b.Konva)})(Xn)),Xn}var Zn={},gs;function ii(){return gs||(gs=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Util=b.Transform=void 0;const W=Oe();class J{constructor(L=[1,0,0,1,0,0]){this.dirty=!1,this.m=L&&L.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new J(this.m)}copyInto(L){L.m[0]=this.m[0],L.m[1]=this.m[1],L.m[2]=this.m[2],L.m[3]=this.m[3],L.m[4]=this.m[4],L.m[5]=this.m[5]}point(L){const K=this.m;return{x:K[0]*L.x+K[2]*L.y+K[4],y:K[1]*L.x+K[3]*L.y+K[5]}}translate(L,K){return this.m[4]+=this.m[0]*L+this.m[2]*K,this.m[5]+=this.m[1]*L+this.m[3]*K,this}scale(L,K){return this.m[0]*=L,this.m[1]*=L,this.m[2]*=K,this.m[3]*=K,this}rotate(L){const K=Math.cos(L),f=Math.sin(L),wt=this.m[0]*K+this.m[2]*f,it=this.m[1]*K+this.m[3]*f,rt=this.m[0]*-f+this.m[2]*K,st=this.m[1]*-f+this.m[3]*K;return this.m[0]=wt,this.m[1]=it,this.m[2]=rt,this.m[3]=st,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(L,K){const f=this.m[0]+this.m[2]*K,wt=this.m[1]+this.m[3]*K,it=this.m[2]+this.m[0]*L,rt=this.m[3]+this.m[1]*L;return this.m[0]=f,this.m[1]=wt,this.m[2]=it,this.m[3]=rt,this}multiply(L){const K=this.m[0]*L.m[0]+this.m[2]*L.m[1],f=this.m[1]*L.m[0]+this.m[3]*L.m[1],wt=this.m[0]*L.m[2]+this.m[2]*L.m[3],it=this.m[1]*L.m[2]+this.m[3]*L.m[3],rt=this.m[0]*L.m[4]+this.m[2]*L.m[5]+this.m[4],st=this.m[1]*L.m[4]+this.m[3]*L.m[5]+this.m[5];return this.m[0]=K,this.m[1]=f,this.m[2]=wt,this.m[3]=it,this.m[4]=rt,this.m[5]=st,this}invert(){const L=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),K=this.m[3]*L,f=-this.m[1]*L,wt=-this.m[2]*L,it=this.m[0]*L,rt=L*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),st=L*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=K,this.m[1]=f,this.m[2]=wt,this.m[3]=it,this.m[4]=rt,this.m[5]=st,this}getMatrix(){return this.m}decompose(){const L=this.m[0],K=this.m[1],f=this.m[2],wt=this.m[3],it=this.m[4],rt=this.m[5],st=L*wt-K*f,gt={x:it,y:rt,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(L!=0||K!=0){const St=Math.sqrt(L*L+K*K);gt.rotation=K>0?Math.acos(L/St):-Math.acos(L/St),gt.scaleX=St,gt.scaleY=st/St,gt.skewX=(L*f+K*wt)/st,gt.skewY=0}else if(f!=0||wt!=0){const St=Math.sqrt(f*f+wt*wt);gt.rotation=Math.PI/2-(wt>0?Math.acos(-f/St):-Math.acos(f/St)),gt.scaleX=st/St,gt.scaleY=St,gt.skewX=0,gt.skewY=(L*f+K*wt)/st}return gt.rotation=b.Util._getRotation(gt.rotation),gt}}b.Transform=J;const et="[object Array]",z="[object Number]",c="[object String]",O="[object Boolean]",x=Math.PI/180,D=180/Math.PI,N="#",B="",Z="0",G="Konva warning: ",d="Konva error: ",y="rgb(",S={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},R=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let H=[];const P=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(g){setTimeout(g,60)};b.Util={_isElement(g){return!!(g&&g.nodeType==1)},_isFunction(g){return!!(g&&g.constructor&&g.call&&g.apply)},_isPlainObject(g){return!!g&&g.constructor===Object},_isArray(g){return Object.prototype.toString.call(g)===et},_isNumber(g){return Object.prototype.toString.call(g)===z&&!isNaN(g)&&isFinite(g)},_isString(g){return Object.prototype.toString.call(g)===c},_isBoolean(g){return Object.prototype.toString.call(g)===O},isObject(g){return g instanceof Object},isValidSelector(g){if(typeof g!="string")return!1;const L=g[0];return L==="#"||L==="."||L===L.toUpperCase()},_sign(g){return g===0||g>0?1:-1},requestAnimFrame(g){H.push(g),H.length===1&&P(function(){const L=H;H=[],L.forEach(function(K){K()})})},createCanvasElement(){const g=document.createElement("canvas");try{g.style=g.style||{}}catch{}return g},createImageElement(){return document.createElement("img")},_isInDocument(g){for(;g=g.parentNode;)if(g==document)return!0;return!1},_urlToImage(g,L){const K=b.Util.createImageElement();K.onload=function(){L(K)},K.src=g},_rgbToHex(g,L,K){return((1<<24)+(g<<16)+(L<<8)+K).toString(16).slice(1)},_hexToRgb(g){g=g.replace(N,B);const L=parseInt(g,16);return{r:L>>16&255,g:L>>8&255,b:L&255}},getRandomColor(){let g=(Math.random()*16777215<<0).toString(16);for(;g.length<6;)g=Z+g;return N+g},getRGB(g){let L;return g in S?(L=S[g],{r:L[0],g:L[1],b:L[2]}):g[0]===N?this._hexToRgb(g.substring(1)):g.substr(0,4)===y?(L=R.exec(g.replace(/ /g,"")),{r:parseInt(L[1],10),g:parseInt(L[2],10),b:parseInt(L[3],10)}):{r:0,g:0,b:0}},colorToRGBA(g){return g=g||"black",b.Util._namedColorToRBA(g)||b.Util._hex3ColorToRGBA(g)||b.Util._hex4ColorToRGBA(g)||b.Util._hex6ColorToRGBA(g)||b.Util._hex8ColorToRGBA(g)||b.Util._rgbColorToRGBA(g)||b.Util._rgbaColorToRGBA(g)||b.Util._hslColorToRGBA(g)},_namedColorToRBA(g){const L=S[g.toLowerCase()];return L?{r:L[0],g:L[1],b:L[2],a:1}:null},_rgbColorToRGBA(g){if(g.indexOf("rgb(")===0){g=g.match(/rgb\(([^)]+)\)/)[1];const L=g.split(/ *, */).map(Number);return{r:L[0],g:L[1],b:L[2],a:1}}},_rgbaColorToRGBA(g){if(g.indexOf("rgba(")===0){g=g.match(/rgba\(([^)]+)\)/)[1];const L=g.split(/ *, */).map((K,f)=>K.slice(-1)==="%"?f===3?parseInt(K)/100:parseInt(K)/100*255:Number(K));return{r:L[0],g:L[1],b:L[2],a:L[3]}}},_hex8ColorToRGBA(g){if(g[0]==="#"&&g.length===9)return{r:parseInt(g.slice(1,3),16),g:parseInt(g.slice(3,5),16),b:parseInt(g.slice(5,7),16),a:parseInt(g.slice(7,9),16)/255}},_hex6ColorToRGBA(g){if(g[0]==="#"&&g.length===7)return{r:parseInt(g.slice(1,3),16),g:parseInt(g.slice(3,5),16),b:parseInt(g.slice(5,7),16),a:1}},_hex4ColorToRGBA(g){if(g[0]==="#"&&g.length===5)return{r:parseInt(g[1]+g[1],16),g:parseInt(g[2]+g[2],16),b:parseInt(g[3]+g[3],16),a:parseInt(g[4]+g[4],16)/255}},_hex3ColorToRGBA(g){if(g[0]==="#"&&g.length===4)return{r:parseInt(g[1]+g[1],16),g:parseInt(g[2]+g[2],16),b:parseInt(g[3]+g[3],16),a:1}},_hslColorToRGBA(g){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(g)){const[L,...K]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(g),f=Number(K[0])/360,wt=Number(K[1])/100,it=Number(K[2])/100;let rt,st,gt;if(wt===0)return gt=it*255,{r:Math.round(gt),g:Math.round(gt),b:Math.round(gt),a:1};it<.5?rt=it*(1+wt):rt=it+wt-it*wt;const St=2*it-rt,It=[0,0,0];for(let Pt=0;Pt<3;Pt++)st=f+1/3*-(Pt-1),st<0&&st++,st>1&&st--,6*st<1?gt=St+(rt-St)*6*st:2*st<1?gt=rt:3*st<2?gt=St+(rt-St)*(2/3-st)*6:gt=St,It[Pt]=gt*255;return{r:Math.round(It[0]),g:Math.round(It[1]),b:Math.round(It[2]),a:1}}},haveIntersection(g,L){return!(L.x>g.x+g.width||L.x+L.width<g.x||L.y>g.y+g.height||L.y+L.height<g.y)},cloneObject(g){const L={};for(const K in g)this._isPlainObject(g[K])?L[K]=this.cloneObject(g[K]):this._isArray(g[K])?L[K]=this.cloneArray(g[K]):L[K]=g[K];return L},cloneArray(g){return g.slice(0)},degToRad(g){return g*x},radToDeg(g){return g*D},_degToRad(g){return b.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),b.Util.degToRad(g)},_radToDeg(g){return b.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),b.Util.radToDeg(g)},_getRotation(g){return W.Konva.angleDeg?b.Util.radToDeg(g):g},_capitalize(g){return g.charAt(0).toUpperCase()+g.slice(1)},throw(g){throw new Error(d+g)},error(g){console.error(d+g)},warn(g){W.Konva.showWarnings&&console.warn(G+g)},each(g,L){for(const K in g)L(K,g[K])},_inRange(g,L,K){return L<=g&&g<K},_getProjectionToSegment(g,L,K,f,wt,it){let rt,st,gt;const St=(g-K)*(g-K)+(L-f)*(L-f);if(St==0)rt=g,st=L,gt=(wt-K)*(wt-K)+(it-f)*(it-f);else{const It=((wt-g)*(K-g)+(it-L)*(f-L))/St;It<0?(rt=g,st=L,gt=(g-wt)*(g-wt)+(L-it)*(L-it)):It>1?(rt=K,st=f,gt=(K-wt)*(K-wt)+(f-it)*(f-it)):(rt=g+It*(K-g),st=L+It*(f-L),gt=(rt-wt)*(rt-wt)+(st-it)*(st-it))}return[rt,st,gt]},_getProjectionToLine(g,L,K){const f=b.Util.cloneObject(g);let wt=Number.MAX_VALUE;return L.forEach(function(it,rt){if(!K&&rt===L.length-1)return;const st=L[(rt+1)%L.length],gt=b.Util._getProjectionToSegment(it.x,it.y,st.x,st.y,g.x,g.y),St=gt[0],It=gt[1],Pt=gt[2];Pt<wt&&(f.x=St,f.y=It,wt=Pt)}),f},_prepareArrayForTween(g,L,K){const f=[],wt=[];if(g.length>L.length){const rt=L;L=g,g=rt}for(let rt=0;rt<g.length;rt+=2)f.push({x:g[rt],y:g[rt+1]});for(let rt=0;rt<L.length;rt+=2)wt.push({x:L[rt],y:L[rt+1]});const it=[];return wt.forEach(function(rt){const st=b.Util._getProjectionToLine(rt,f,K);it.push(st.x),it.push(st.y)}),it},_prepareToStringify(g){let L;g.visitedByCircularReferenceRemoval=!0;for(const K in g)if(g.hasOwnProperty(K)&&g[K]&&typeof g[K]=="object"){if(L=Object.getOwnPropertyDescriptor(g,K),g[K].visitedByCircularReferenceRemoval||b.Util._isElement(g[K]))if(L.configurable)delete g[K];else return null;else if(b.Util._prepareToStringify(g[K])===null)if(L.configurable)delete g[K];else return null}return delete g.visitedByCircularReferenceRemoval,g},_assign(g,L){for(const K in L)g[K]=L[K];return g},_getFirstPointerId(g){return g.touches?g.changedTouches[0].identifier:g.pointerId||999},releaseCanvas(...g){W.Konva.releaseCanvasOnDestroy&&g.forEach(L=>{L.width=0,L.height=0})},drawRoundedRectPath(g,L,K,f){let wt=0,it=0,rt=0,st=0;typeof f=="number"?wt=it=rt=st=Math.min(f,L/2,K/2):(wt=Math.min(f[0]||0,L/2,K/2),it=Math.min(f[1]||0,L/2,K/2),st=Math.min(f[2]||0,L/2,K/2),rt=Math.min(f[3]||0,L/2,K/2)),g.moveTo(wt,0),g.lineTo(L-it,0),g.arc(L-it,it,it,Math.PI*3/2,0,!1),g.lineTo(L,K-st),g.arc(L-st,K-st,st,0,Math.PI/2,!1),g.lineTo(rt,K),g.arc(rt,K-rt,rt,Math.PI/2,Math.PI,!1),g.lineTo(0,wt),g.arc(wt,wt,wt,Math.PI,Math.PI*3/2,!1)}}})(Zn)),Zn}var wr={},Ki={},Yi={},_s;function Ea(){if(_s)return Yi;_s=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HitContext=Yi.SceneContext=Yi.Context=void 0;const b=ii(),W=Oe();function J(H){const P=[],g=H.length,L=b.Util;for(let K=0;K<g;K++){let f=H[K];L._isNumber(f)?f=Math.round(f*1e3)/1e3:L._isString(f)||(f=f+""),P.push(f)}return P}const et=",",z="(",c=")",O="([",x="])",D=";",N="()",B="=",Z=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],G=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],d=100;let y=class{constructor(P){this.canvas=P,W.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(P){P.fillEnabled()&&this._fill(P)}_fill(P){}strokeShape(P){P.hasStroke()&&this._stroke(P)}_stroke(P){}fillStrokeShape(P){P.attrs.fillAfterStrokeEnabled?(this.strokeShape(P),this.fillShape(P)):(this.fillShape(P),this.strokeShape(P))}getTrace(P,g){let L=this.traceArr,K=L.length,f="",wt,it,rt,st;for(wt=0;wt<K;wt++)it=L[wt],rt=it.method,rt?(st=it.args,f+=rt,P?f+=N:b.Util._isArray(st[0])?f+=O+st.join(et)+x:(g&&(st=st.map(gt=>typeof gt=="number"?Math.floor(gt):gt)),f+=z+st.join(et)+c)):(f+=it.property,P||(f+=B+it.val)),f+=D;return f}clearTrace(){this.traceArr=[]}_trace(P){let g=this.traceArr,L;g.push(P),L=g.length,L>=d&&g.shift()}reset(){const P=this.getCanvas().getPixelRatio();this.setTransform(1*P,0,0,1*P,0,0)}getCanvas(){return this.canvas}clear(P){const g=this.getCanvas();P?this.clearRect(P.x||0,P.y||0,P.width||0,P.height||0):this.clearRect(0,0,g.getWidth()/g.pixelRatio,g.getHeight()/g.pixelRatio)}_applyLineCap(P){const g=P.attrs.lineCap;g&&this.setAttr("lineCap",g)}_applyOpacity(P){const g=P.getAbsoluteOpacity();g!==1&&this.setAttr("globalAlpha",g)}_applyLineJoin(P){const g=P.attrs.lineJoin;g&&this.setAttr("lineJoin",g)}setAttr(P,g){this._context[P]=g}arc(P,g,L,K,f,wt){this._context.arc(P,g,L,K,f,wt)}arcTo(P,g,L,K,f){this._context.arcTo(P,g,L,K,f)}beginPath(){this._context.beginPath()}bezierCurveTo(P,g,L,K,f,wt){this._context.bezierCurveTo(P,g,L,K,f,wt)}clearRect(P,g,L,K){this._context.clearRect(P,g,L,K)}clip(...P){this._context.clip.apply(this._context,P)}closePath(){this._context.closePath()}createImageData(P,g){const L=arguments;if(L.length===2)return this._context.createImageData(P,g);if(L.length===1)return this._context.createImageData(P)}createLinearGradient(P,g,L,K){return this._context.createLinearGradient(P,g,L,K)}createPattern(P,g){return this._context.createPattern(P,g)}createRadialGradient(P,g,L,K,f,wt){return this._context.createRadialGradient(P,g,L,K,f,wt)}drawImage(P,g,L,K,f,wt,it,rt,st){const gt=arguments,St=this._context;gt.length===3?St.drawImage(P,g,L):gt.length===5?St.drawImage(P,g,L,K,f):gt.length===9&&St.drawImage(P,g,L,K,f,wt,it,rt,st)}ellipse(P,g,L,K,f,wt,it,rt){this._context.ellipse(P,g,L,K,f,wt,it,rt)}isPointInPath(P,g,L,K){return L?this._context.isPointInPath(L,P,g,K):this._context.isPointInPath(P,g,K)}fill(...P){this._context.fill.apply(this._context,P)}fillRect(P,g,L,K){this._context.fillRect(P,g,L,K)}strokeRect(P,g,L,K){this._context.strokeRect(P,g,L,K)}fillText(P,g,L,K){K?this._context.fillText(P,g,L,K):this._context.fillText(P,g,L)}measureText(P){return this._context.measureText(P)}getImageData(P,g,L,K){return this._context.getImageData(P,g,L,K)}lineTo(P,g){this._context.lineTo(P,g)}moveTo(P,g){this._context.moveTo(P,g)}rect(P,g,L,K){this._context.rect(P,g,L,K)}roundRect(P,g,L,K,f){this._context.roundRect(P,g,L,K,f)}putImageData(P,g,L){this._context.putImageData(P,g,L)}quadraticCurveTo(P,g,L,K){this._context.quadraticCurveTo(P,g,L,K)}restore(){this._context.restore()}rotate(P){this._context.rotate(P)}save(){this._context.save()}scale(P,g){this._context.scale(P,g)}setLineDash(P){this._context.setLineDash?this._context.setLineDash(P):"mozDash"in this._context?this._context.mozDash=P:"webkitLineDash"in this._context&&(this._context.webkitLineDash=P)}getLineDash(){return this._context.getLineDash()}setTransform(P,g,L,K,f,wt){this._context.setTransform(P,g,L,K,f,wt)}stroke(P){P?this._context.stroke(P):this._context.stroke()}strokeText(P,g,L,K){this._context.strokeText(P,g,L,K)}transform(P,g,L,K,f,wt){this._context.transform(P,g,L,K,f,wt)}translate(P,g){this._context.translate(P,g)}_enableTrace(){let P=this,g=Z.length,L=this.setAttr,K,f;const wt=function(it){let rt=P[it],st;P[it]=function(){return f=J(Array.prototype.slice.call(arguments,0)),st=rt.apply(P,arguments),P._trace({method:it,args:f}),st}};for(K=0;K<g;K++)wt(Z[K]);P.setAttr=function(){L.apply(P,arguments);const it=arguments[0];let rt=arguments[1];(it==="shadowOffsetX"||it==="shadowOffsetY"||it==="shadowBlur")&&(rt=rt/this.canvas.getPixelRatio()),P._trace({property:it,val:rt})}}_applyGlobalCompositeOperation(P){const g=P.attrs.globalCompositeOperation;!g||g==="source-over"||this.setAttr("globalCompositeOperation",g)}};Yi.Context=y,G.forEach(function(H){Object.defineProperty(y.prototype,H,{get(){return this._context[H]},set(P){this._context[H]=P}})});class S extends y{constructor(P,{willReadFrequently:g=!1}={}){super(P),this._context=P._canvas.getContext("2d",{willReadFrequently:g})}_fillColor(P){const g=P.fill();this.setAttr("fillStyle",g),P._fillFunc(this)}_fillPattern(P){this.setAttr("fillStyle",P._getFillPattern()),P._fillFunc(this)}_fillLinearGradient(P){const g=P._getLinearGradient();g&&(this.setAttr("fillStyle",g),P._fillFunc(this))}_fillRadialGradient(P){const g=P._getRadialGradient();g&&(this.setAttr("fillStyle",g),P._fillFunc(this))}_fill(P){const g=P.fill(),L=P.getFillPriority();if(g&&L==="color"){this._fillColor(P);return}const K=P.getFillPatternImage();if(K&&L==="pattern"){this._fillPattern(P);return}const f=P.getFillLinearGradientColorStops();if(f&&L==="linear-gradient"){this._fillLinearGradient(P);return}const wt=P.getFillRadialGradientColorStops();if(wt&&L==="radial-gradient"){this._fillRadialGradient(P);return}g?this._fillColor(P):K?this._fillPattern(P):f?this._fillLinearGradient(P):wt&&this._fillRadialGradient(P)}_strokeLinearGradient(P){const g=P.getStrokeLinearGradientStartPoint(),L=P.getStrokeLinearGradientEndPoint(),K=P.getStrokeLinearGradientColorStops(),f=this.createLinearGradient(g.x,g.y,L.x,L.y);if(K){for(let wt=0;wt<K.length;wt+=2)f.addColorStop(K[wt],K[wt+1]);this.setAttr("strokeStyle",f)}}_stroke(P){const g=P.dash(),L=P.getStrokeScaleEnabled();if(P.hasStroke()){if(!L){this.save();const f=this.getCanvas().getPixelRatio();this.setTransform(f,0,0,f,0,0)}this._applyLineCap(P),g&&P.dashEnabled()&&(this.setLineDash(g),this.setAttr("lineDashOffset",P.dashOffset())),this.setAttr("lineWidth",P.strokeWidth()),P.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),P.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(P):this.setAttr("strokeStyle",P.stroke()),P._strokeFunc(this),L||this.restore()}}_applyShadow(P){var g,L,K;const f=(g=P.getShadowRGBA())!==null&&g!==void 0?g:"black",wt=(L=P.getShadowBlur())!==null&&L!==void 0?L:5,it=(K=P.getShadowOffset())!==null&&K!==void 0?K:{x:0,y:0},rt=P.getAbsoluteScale(),st=this.canvas.getPixelRatio(),gt=rt.x*st,St=rt.y*st;this.setAttr("shadowColor",f),this.setAttr("shadowBlur",wt*Math.min(Math.abs(gt),Math.abs(St))),this.setAttr("shadowOffsetX",it.x*gt),this.setAttr("shadowOffsetY",it.y*St)}}Yi.SceneContext=S;class R extends y{constructor(P){super(P),this._context=P._canvas.getContext("2d",{willReadFrequently:!0})}_fill(P){this.save(),this.setAttr("fillStyle",P.colorKey),P._fillFuncHit(this),this.restore()}strokeShape(P){P.hasHitStroke()&&this._stroke(P)}_stroke(P){if(P.hasHitStroke()){const g=P.getStrokeScaleEnabled();if(!g){this.save();const f=this.getCanvas().getPixelRatio();this.setTransform(f,0,0,f,0,0)}this._applyLineCap(P);const L=P.hitStrokeWidth(),K=L==="auto"?P.strokeWidth():L;this.setAttr("lineWidth",K),this.setAttr("strokeStyle",P.colorKey),P._strokeFuncHit(this),g||this.restore()}}}return Yi.HitContext=R,Yi}var vs;function Rn(){if(vs)return Ki;vs=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.HitCanvas=Ki.SceneCanvas=Ki.Canvas=void 0;const b=ii(),W=Ea(),J=Oe();let et;function z(){if(et)return et;const D=b.Util.createCanvasElement(),N=D.getContext("2d");return et=(function(){const B=J.Konva._global.devicePixelRatio||1,Z=N.webkitBackingStorePixelRatio||N.mozBackingStorePixelRatio||N.msBackingStorePixelRatio||N.oBackingStorePixelRatio||N.backingStorePixelRatio||1;return B/Z})(),b.Util.releaseCanvas(D),et}let c=class{constructor(N){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const Z=(N||{}).pixelRatio||J.Konva.pixelRatio||z();this.pixelRatio=Z,this._canvas=b.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(N){const B=this.pixelRatio;this.pixelRatio=N,this.setSize(this.getWidth()/B,this.getHeight()/B)}setWidth(N){this.width=this._canvas.width=N*this.pixelRatio,this._canvas.style.width=N+"px";const B=this.pixelRatio;this.getContext()._context.scale(B,B)}setHeight(N){this.height=this._canvas.height=N*this.pixelRatio,this._canvas.style.height=N+"px";const B=this.pixelRatio;this.getContext()._context.scale(B,B)}getWidth(){return this.width}getHeight(){return this.height}setSize(N,B){this.setWidth(N||0),this.setHeight(B||0)}toDataURL(N,B){try{return this._canvas.toDataURL(N,B)}catch{try{return this._canvas.toDataURL()}catch(G){return b.Util.error("Unable to get data URL. "+G.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ki.Canvas=c;class O extends c{constructor(N={width:0,height:0,willReadFrequently:!1}){super(N),this.context=new W.SceneContext(this,{willReadFrequently:N.willReadFrequently}),this.setSize(N.width,N.height)}}Ki.SceneCanvas=O;class x extends c{constructor(N={width:0,height:0}){super(N),this.hitCanvas=!0,this.context=new W.HitContext(this),this.setSize(N.width,N.height)}}return Ki.HitCanvas=x,Ki}var Qn={},ms;function hs(){return ms||(ms=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.DD=void 0;const W=Oe(),J=ii();b.DD={get isDragging(){let et=!1;return b.DD._dragElements.forEach(z=>{z.dragStatus==="dragging"&&(et=!0)}),et},justDragged:!1,get node(){let et;return b.DD._dragElements.forEach(z=>{et=z.node}),et},_dragElements:new Map,_drag(et){const z=[];b.DD._dragElements.forEach((c,O)=>{const{node:x}=c,D=x.getStage();D.setPointersPositions(et),c.pointerId===void 0&&(c.pointerId=J.Util._getFirstPointerId(et));const N=D._changedPointerPositions.find(B=>B.id===c.pointerId);if(N){if(c.dragStatus!=="dragging"){const B=x.dragDistance();if(Math.max(Math.abs(N.x-c.startPointerPos.x),Math.abs(N.y-c.startPointerPos.y))<B||(x.startDrag({evt:et}),!x.isDragging()))return}x._setDragPosition(et,c),z.push(x)}}),z.forEach(c=>{c.fire("dragmove",{type:"dragmove",target:c,evt:et},!0)})},_endDragBefore(et){const z=[];b.DD._dragElements.forEach(c=>{const{node:O}=c,x=O.getStage();if(et&&x.setPointersPositions(et),!x._changedPointerPositions.find(B=>B.id===c.pointerId))return;(c.dragStatus==="dragging"||c.dragStatus==="stopped")&&(b.DD.justDragged=!0,W.Konva._mouseListenClick=!1,W.Konva._touchListenClick=!1,W.Konva._pointerListenClick=!1,c.dragStatus="stopped");const N=c.node.getLayer()||c.node instanceof W.Konva.Stage&&c.node;N&&z.indexOf(N)===-1&&z.push(N)}),z.forEach(c=>{c.draw()})},_endDragAfter(et){b.DD._dragElements.forEach((z,c)=>{z.dragStatus==="stopped"&&z.node.fire("dragend",{type:"dragend",target:z.node,evt:et},!0),z.dragStatus!=="dragging"&&b.DD._dragElements.delete(c)})}},W.Konva.isBrowser&&(window.addEventListener("mouseup",b.DD._endDragBefore,!0),window.addEventListener("touchend",b.DD._endDragBefore,!0),window.addEventListener("touchcancel",b.DD._endDragBefore,!0),window.addEventListener("mousemove",b.DD._drag),window.addEventListener("touchmove",b.DD._drag),window.addEventListener("mouseup",b.DD._endDragAfter,!1),window.addEventListener("touchend",b.DD._endDragAfter,!1),window.addEventListener("touchcancel",b.DD._endDragAfter,!1))})(Qn)),Qn}var Jn={},ki={},ys;function De(){if(ys)return ki;ys=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.RGBComponent=et,ki.alphaComponent=z,ki.getNumberValidator=c,ki.getNumberOrArrayOfNumbersValidator=O,ki.getNumberOrAutoValidator=x,ki.getStringValidator=D,ki.getStringOrGradientValidator=N,ki.getFunctionValidator=B,ki.getNumberArrayValidator=Z,ki.getBooleanValidator=G,ki.getComponentValidator=d;const b=Oe(),W=ii();function J(y){return W.Util._isString(y)?'"'+y+'"':Object.prototype.toString.call(y)==="[object Number]"||W.Util._isBoolean(y)?y:Object.prototype.toString.call(y)}function et(y){return y>255?255:y<0?0:Math.round(y)}function z(y){return y>1?1:y<1e-4?1e-4:y}function c(){if(b.Konva.isUnminified)return function(y,S){return W.Util._isNumber(y)||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a number.'),y}}function O(y){if(b.Konva.isUnminified)return function(S,R){let H=W.Util._isNumber(S),P=W.Util._isArray(S)&&S.length==y;return!H&&!P&&W.Util.warn(J(S)+' is a not valid value for "'+R+'" attribute. The value should be a number or Array<number>('+y+")"),S}}function x(){if(b.Konva.isUnminified)return function(y,S){return W.Util._isNumber(y)||y==="auto"||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a number or "auto".'),y}}function D(){if(b.Konva.isUnminified)return function(y,S){return W.Util._isString(y)||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a string.'),y}}function N(){if(b.Konva.isUnminified)return function(y,S){const R=W.Util._isString(y),H=Object.prototype.toString.call(y)==="[object CanvasGradient]"||y&&y.addColorStop;return R||H||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a string or a native gradient.'),y}}function B(){if(b.Konva.isUnminified)return function(y,S){return W.Util._isFunction(y)||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a function.'),y}}function Z(){if(b.Konva.isUnminified)return function(y,S){const R=Int8Array?Object.getPrototypeOf(Int8Array):null;return R&&y instanceof R||(W.Util._isArray(y)?y.forEach(function(H){W.Util._isNumber(H)||W.Util.warn('"'+S+'" attribute has non numeric element '+H+". Make sure that all elements are numbers.")}):W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a array of numbers.')),y}}function G(){if(b.Konva.isUnminified)return function(y,S){return y===!0||y===!1||W.Util.warn(J(y)+' is a not valid value for "'+S+'" attribute. The value should be a boolean.'),y}}function d(y){if(b.Konva.isUnminified)return function(S,R){return S==null||W.Util.isObject(S)||W.Util.warn(J(S)+' is a not valid value for "'+R+'" attribute. The value should be an object with properties '+y),S}}return ki}var bs;function Ne(){return bs||(bs=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Factory=void 0;const W=ii(),J=De(),et="get",z="set";b.Factory={addGetterSetter(c,O,x,D,N){b.Factory.addGetter(c,O,x),b.Factory.addSetter(c,O,D,N),b.Factory.addOverloadedGetterSetter(c,O)},addGetter(c,O,x){const D=et+W.Util._capitalize(O);c.prototype[D]=c.prototype[D]||function(){const N=this.attrs[O];return N===void 0?x:N}},addSetter(c,O,x,D){const N=z+W.Util._capitalize(O);c.prototype[N]||b.Factory.overWriteSetter(c,O,x,D)},overWriteSetter(c,O,x,D){const N=z+W.Util._capitalize(O);c.prototype[N]=function(B){return x&&B!==void 0&&B!==null&&(B=x.call(this,B,O)),this._setAttr(O,B),D&&D.call(this),this}},addComponentsGetterSetter(c,O,x,D,N){const B=x.length,Z=W.Util._capitalize,G=et+Z(O),d=z+Z(O);c.prototype[G]=function(){const S={};for(let R=0;R<B;R++){const H=x[R];S[H]=this.getAttr(O+Z(H))}return S};const y=(0,J.getComponentValidator)(x);c.prototype[d]=function(S){const R=this.attrs[O];D&&(S=D.call(this,S,O)),y&&y.call(this,S,O);for(const H in S)S.hasOwnProperty(H)&&this._setAttr(O+Z(H),S[H]);return S||x.forEach(H=>{this._setAttr(O+Z(H),void 0)}),this._fireChangeEvent(O,R,S),N&&N.call(this),this},b.Factory.addOverloadedGetterSetter(c,O)},addOverloadedGetterSetter(c,O){const x=W.Util._capitalize(O),D=z+x,N=et+x;c.prototype[O]=function(){return arguments.length?(this[D](arguments[0]),this):this[N]()}},addDeprecatedGetterSetter(c,O,x,D){W.Util.error("Adding deprecated "+O);const N=et+W.Util._capitalize(O),B=O+" property is deprecated and will be removed soon. Look at Konva change log for more information.";c.prototype[N]=function(){W.Util.error(B);const Z=this.attrs[O];return Z===void 0?x:Z},b.Factory.addSetter(c,O,D,function(){W.Util.error(B)}),b.Factory.addOverloadedGetterSetter(c,O)},backCompat(c,O){W.Util.each(O,function(x,D){const N=c.prototype[D],B=et+W.Util._capitalize(x),Z=z+W.Util._capitalize(x);function G(){N.apply(this,arguments),W.Util.error('"'+x+'" method is deprecated and will be removed soon. Use ""'+D+'" instead.')}c.prototype[x]=G,c.prototype[B]=G,c.prototype[Z]=G})},afterSetFilter(){this._filterUpToDate=!1}}})(Jn)),Jn}var xs;function si(){if(xs)return wr;xs=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.Node=void 0;const b=Rn(),W=hs(),J=Ne(),et=Oe(),z=ii(),c=De(),O="absoluteOpacity",x="allEventListeners",D="absoluteTransform",N="absoluteScale",B="canvas",Z="Change",G="children",d="konva",y="listening",S="mouseenter",R="mouseleave",H="pointerenter",P="pointerleave",g="touchenter",L="touchleave",K="set",f="Shape",wt=" ",it="stage",rt="transform",st="Stage",gt="visible",St=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(wt);let It=1,Pt=class as{constructor(Q){this._id=It++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(Q),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(Q){(Q===rt||Q===D)&&this._cache.get(Q)?this._cache.get(Q).dirty=!0:Q?this._cache.delete(Q):this._cache.clear()}_getCache(Q,at){let ct=this._cache.get(Q);return(ct===void 0||(Q===rt||Q===D)&&ct.dirty===!0)&&(ct=at.call(this),this._cache.set(Q,ct)),ct}_calculate(Q,at,ct){if(!this._attachedDepsListeners.get(Q)){const dt=at.map(Ct=>Ct+"Change.konva").join(wt);this.on(dt,()=>{this._clearCache(Q)}),this._attachedDepsListeners.set(Q,!0)}return this._getCache(Q,ct)}_getCanvasCache(){return this._cache.get(B)}_clearSelfAndDescendantCache(Q){this._clearCache(Q),Q===D&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(B)){const{scene:Q,filter:at,hit:ct,buffer:dt}=this._cache.get(B);z.Util.releaseCanvas(Q,at,ct,dt),this._cache.delete(B)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(Q){const at=Q||{};let ct={};(at.x===void 0||at.y===void 0||at.width===void 0||at.height===void 0)&&(ct=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let dt=Math.ceil(at.width||ct.width),Ct=Math.ceil(at.height||ct.height),Ut=at.pixelRatio,Ot=at.x===void 0?Math.floor(ct.x):at.x,Kt=at.y===void 0?Math.floor(ct.y):at.y,Xt=at.offset||0,Vt=at.drawBorder||!1,mt=at.hitCanvasPixelRatio||1;if(!dt||!Ct){z.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const Dt=Math.abs(Math.round(ct.x)-Ot)>.5?1:0,Wt=Math.abs(Math.round(ct.y)-Kt)>.5?1:0;dt+=Xt*2+Dt,Ct+=Xt*2+Wt,Ot-=Xt,Kt-=Xt;const Qt=new b.SceneCanvas({pixelRatio:Ut,width:dt,height:Ct}),re=new b.SceneCanvas({pixelRatio:Ut,width:0,height:0,willReadFrequently:!0}),be=new b.HitCanvas({pixelRatio:mt,width:dt,height:Ct}),ce=Qt.getContext(),we=be.getContext(),ge=new b.SceneCanvas({width:Qt.width/Qt.pixelRatio+Math.abs(Ot),height:Qt.height/Qt.pixelRatio+Math.abs(Kt),pixelRatio:Qt.pixelRatio}),Ze=ge.getContext();return be.isCache=!0,Qt.isCache=!0,this._cache.delete(B),this._filterUpToDate=!1,at.imageSmoothingEnabled===!1&&(Qt.getContext()._context.imageSmoothingEnabled=!1,re.getContext()._context.imageSmoothingEnabled=!1),ce.save(),we.save(),Ze.save(),ce.translate(-Ot,-Kt),we.translate(-Ot,-Kt),Ze.translate(-Ot,-Kt),ge.x=Ot,ge.y=Kt,this._isUnderCache=!0,this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(N),this.drawScene(Qt,this,ge),this.drawHit(be,this),this._isUnderCache=!1,ce.restore(),we.restore(),Vt&&(ce.save(),ce.beginPath(),ce.rect(0,0,dt,Ct),ce.closePath(),ce.setAttr("strokeStyle","red"),ce.setAttr("lineWidth",5),ce.stroke(),ce.restore()),this._cache.set(B,{scene:Qt,filter:re,hit:be,buffer:ge,x:Ot,y:Kt}),this._requestDraw(),this}isCached(){return this._cache.has(B)}getClientRect(Q){throw new Error('abstract "getClientRect" method call')}_transformedRect(Q,at){const ct=[{x:Q.x,y:Q.y},{x:Q.x+Q.width,y:Q.y},{x:Q.x+Q.width,y:Q.y+Q.height},{x:Q.x,y:Q.y+Q.height}];let dt=1/0,Ct=1/0,Ut=-1/0,Ot=-1/0;const Kt=this.getAbsoluteTransform(at);return ct.forEach(function(Xt){const Vt=Kt.point(Xt);dt===void 0&&(dt=Ut=Vt.x,Ct=Ot=Vt.y),dt=Math.min(dt,Vt.x),Ct=Math.min(Ct,Vt.y),Ut=Math.max(Ut,Vt.x),Ot=Math.max(Ot,Vt.y)}),{x:dt,y:Ct,width:Ut-dt,height:Ot-Ct}}_drawCachedSceneCanvas(Q){Q.save(),Q._applyOpacity(this),Q._applyGlobalCompositeOperation(this);const at=this._getCanvasCache();Q.translate(at.x,at.y);const ct=this._getCachedSceneCanvas(),dt=ct.pixelRatio;Q.drawImage(ct._canvas,0,0,ct.width/dt,ct.height/dt),Q.restore()}_drawCachedHitCanvas(Q){const at=this._getCanvasCache(),ct=at.hit;Q.save(),Q.translate(at.x,at.y),Q.drawImage(ct._canvas,0,0,ct.width/ct.pixelRatio,ct.height/ct.pixelRatio),Q.restore()}_getCachedSceneCanvas(){let Q=this.filters(),at=this._getCanvasCache(),ct=at.scene,dt=at.filter,Ct=dt.getContext(),Ut,Ot,Kt,Xt;if(Q){if(!this._filterUpToDate){const Vt=ct.pixelRatio;dt.setSize(ct.width/ct.pixelRatio,ct.height/ct.pixelRatio);try{for(Ut=Q.length,Ct.clear(),Ct.drawImage(ct._canvas,0,0,ct.getWidth()/Vt,ct.getHeight()/Vt),Ot=Ct.getImageData(0,0,dt.getWidth(),dt.getHeight()),Kt=0;Kt<Ut;Kt++){if(Xt=Q[Kt],typeof Xt!="function"){z.Util.error("Filter should be type of function, but got "+typeof Xt+" instead. Please check correct filters");continue}Xt.call(this,Ot),Ct.putImageData(Ot,0,0)}}catch(mt){z.Util.error("Unable to apply filter. "+mt.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return dt}return ct}on(Q,at){if(this._cache&&this._cache.delete(x),arguments.length===3)return this._delegate.apply(this,arguments);const ct=Q.split(wt);for(let dt=0;dt<ct.length;dt++){const Ut=ct[dt].split("."),Ot=Ut[0],Kt=Ut[1]||"";this.eventListeners[Ot]||(this.eventListeners[Ot]=[]),this.eventListeners[Ot].push({name:Kt,handler:at})}return this}off(Q,at){let ct=(Q||"").split(wt),dt=ct.length,Ct,Ut,Ot,Kt,Xt,Vt;if(this._cache&&this._cache.delete(x),!Q)for(Ut in this.eventListeners)this._off(Ut);for(Ct=0;Ct<dt;Ct++)if(Ot=ct[Ct],Kt=Ot.split("."),Xt=Kt[0],Vt=Kt[1],Xt)this.eventListeners[Xt]&&this._off(Xt,Vt,at);else for(Ut in this.eventListeners)this._off(Ut,Vt,at);return this}dispatchEvent(Q){const at={target:this,type:Q.type,evt:Q};return this.fire(Q.type,at),this}addEventListener(Q,at){return this.on(Q,function(ct){at.call(this,ct.evt)}),this}removeEventListener(Q){return this.off(Q),this}_delegate(Q,at,ct){const dt=this;this.on(Q,function(Ct){const Ut=Ct.target.findAncestors(at,!0,dt);for(let Ot=0;Ot<Ut.length;Ot++)Ct=z.Util.cloneObject(Ct),Ct.currentTarget=Ut[Ot],ct.call(Ut[Ot],Ct)})}remove(){return this.isDragging()&&this.stopDrag(),W.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(D),this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(N),this._clearSelfAndDescendantCache(it),this._clearSelfAndDescendantCache(gt),this._clearSelfAndDescendantCache(y)}_remove(){this._clearCaches();const Q=this.getParent();Q&&Q.children&&(Q.children.splice(this.index,1),Q._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(Q){const at="get"+z.Util._capitalize(Q);return z.Util._isFunction(this[at])?this[at]():this.attrs[Q]}getAncestors(){let Q=this.getParent(),at=[];for(;Q;)at.push(Q),Q=Q.getParent();return at}getAttrs(){return this.attrs||{}}setAttrs(Q){return this._batchTransformChanges(()=>{let at,ct;if(!Q)return this;for(at in Q)at!==G&&(ct=K+z.Util._capitalize(at),z.Util._isFunction(this[ct])?this[ct](Q[at]):this._setAttr(at,Q[at]))}),this}isListening(){return this._getCache(y,this._isListening)}_isListening(Q){if(!this.listening())return!1;const ct=this.getParent();return ct&&ct!==Q&&this!==Q?ct._isListening(Q):!0}isVisible(){return this._getCache(gt,this._isVisible)}_isVisible(Q){if(!this.visible())return!1;const ct=this.getParent();return ct&&ct!==Q&&this!==Q?ct._isVisible(Q):!0}shouldDrawHit(Q,at=!1){if(Q)return this._isVisible(Q)&&this._isListening(Q);const ct=this.getLayer();let dt=!1;W.DD._dragElements.forEach(Ut=>{Ut.dragStatus==="dragging"&&(Ut.node.nodeType==="Stage"||Ut.node.getLayer()===ct)&&(dt=!0)});const Ct=!at&&!et.Konva.hitOnDragEnabled&&(dt||et.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!Ct}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let Q=this.getDepth(),at=this,ct=0,dt,Ct,Ut,Ot;function Kt(Vt){for(dt=[],Ct=Vt.length,Ut=0;Ut<Ct;Ut++)Ot=Vt[Ut],ct++,Ot.nodeType!==f&&(dt=dt.concat(Ot.getChildren().slice())),Ot._id===at._id&&(Ut=Ct);dt.length>0&&dt[0].getDepth()<=Q&&Kt(dt)}const Xt=this.getStage();return at.nodeType!==st&&Xt&&Kt(Xt.getChildren()),ct}getDepth(){let Q=0,at=this.parent;for(;at;)Q++,at=at.parent;return Q}_batchTransformChanges(Q){this._batchingTransformChange=!0,Q(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(rt),this._clearSelfAndDescendantCache(D)),this._needClearTransformCache=!1}setPosition(Q){return this._batchTransformChanges(()=>{this.x(Q.x),this.y(Q.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const Q=this.getStage();if(!Q)return null;const at=Q.getPointerPosition();if(!at)return null;const ct=this.getAbsoluteTransform().copy();return ct.invert(),ct.point(at)}getAbsolutePosition(Q){let at=!1,ct=this.parent;for(;ct;){if(ct.isCached()){at=!0;break}ct=ct.parent}at&&!Q&&(Q=!0);const dt=this.getAbsoluteTransform(Q).getMatrix(),Ct=new z.Transform,Ut=this.offset();return Ct.m=dt.slice(),Ct.translate(Ut.x,Ut.y),Ct.getTranslation()}setAbsolutePosition(Q){const{x:at,y:ct,...dt}=this._clearTransform();this.attrs.x=at,this.attrs.y=ct,this._clearCache(rt);const Ct=this._getAbsoluteTransform().copy();return Ct.invert(),Ct.translate(Q.x,Q.y),Q={x:this.attrs.x+Ct.getTranslation().x,y:this.attrs.y+Ct.getTranslation().y},this._setTransform(dt),this.setPosition({x:Q.x,y:Q.y}),this._clearCache(rt),this._clearSelfAndDescendantCache(D),this}_setTransform(Q){let at;for(at in Q)this.attrs[at]=Q[at]}_clearTransform(){const Q={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,Q}move(Q){let at=Q.x,ct=Q.y,dt=this.x(),Ct=this.y();return at!==void 0&&(dt+=at),ct!==void 0&&(Ct+=ct),this.setPosition({x:dt,y:Ct}),this}_eachAncestorReverse(Q,at){let ct=[],dt=this.getParent(),Ct,Ut;if(!(at&&at._id===this._id)){for(ct.unshift(this);dt&&(!at||dt._id!==at._id);)ct.unshift(dt),dt=dt.parent;for(Ct=ct.length,Ut=0;Ut<Ct;Ut++)Q(ct[Ut])}}rotate(Q){return this.rotation(this.rotation()+Q),this}moveToTop(){if(!this.parent)return z.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const Q=this.index,at=this.parent.getChildren().length;return Q<at-1?(this.parent.children.splice(Q,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return z.Util.warn("Node has no parent. moveUp function is ignored."),!1;const Q=this.index,at=this.parent.getChildren().length;return Q<at-1?(this.parent.children.splice(Q,1),this.parent.children.splice(Q+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return z.Util.warn("Node has no parent. moveDown function is ignored."),!1;const Q=this.index;return Q>0?(this.parent.children.splice(Q,1),this.parent.children.splice(Q-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return z.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const Q=this.index;return Q>0?(this.parent.children.splice(Q,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(Q){if(!this.parent)return z.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(Q<0||Q>=this.parent.children.length)&&z.Util.warn("Unexpected value "+Q+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const at=this.index;return this.parent.children.splice(at,1),this.parent.children.splice(Q,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(O,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let Q=this.opacity();const at=this.getParent();return at&&!at._isUnderCache&&(Q*=at.getAbsoluteOpacity()),Q}moveTo(Q){return this.getParent()!==Q&&(this._remove(),Q.add(this)),this}toObject(){let Q=this.getAttrs(),at,ct,dt,Ct,Ut;const Ot={attrs:{},className:this.getClassName()};for(at in Q)ct=Q[at],Ut=z.Util.isObject(ct)&&!z.Util._isPlainObject(ct)&&!z.Util._isArray(ct),!Ut&&(dt=typeof this[at]=="function"&&this[at],delete Q[at],Ct=dt?dt.call(this):null,Q[at]=ct,Ct!==ct&&(Ot.attrs[at]=ct));return z.Util._prepareToStringify(Ot)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(Q,at,ct){const dt=[];at&&this._isMatch(Q)&&dt.push(this);let Ct=this.parent;for(;Ct;){if(Ct===ct)return dt;Ct._isMatch(Q)&&dt.push(Ct),Ct=Ct.parent}return dt}isAncestorOf(Q){return!1}findAncestor(Q,at,ct){return this.findAncestors(Q,at,ct)[0]}_isMatch(Q){if(!Q)return!1;if(typeof Q=="function")return Q(this);let at=Q.replace(/ /g,"").split(","),ct=at.length,dt,Ct;for(dt=0;dt<ct;dt++)if(Ct=at[dt],z.Util.isValidSelector(Ct)||(z.Util.warn('Selector "'+Ct+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),z.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),z.Util.warn("Konva is awesome, right?")),Ct.charAt(0)==="#"){if(this.id()===Ct.slice(1))return!0}else if(Ct.charAt(0)==="."){if(this.hasName(Ct.slice(1)))return!0}else if(this.className===Ct||this.nodeType===Ct)return!0;return!1}getLayer(){const Q=this.getParent();return Q?Q.getLayer():null}getStage(){return this._getCache(it,this._getStage)}_getStage(){const Q=this.getParent();return Q?Q.getStage():null}fire(Q,at={},ct){return at.target=at.target||this,ct?this._fireAndBubble(Q,at):this._fire(Q,at),this}getAbsoluteTransform(Q){return Q?this._getAbsoluteTransform(Q):this._getCache(D,this._getAbsoluteTransform)}_getAbsoluteTransform(Q){let at;if(Q)return at=new z.Transform,this._eachAncestorReverse(function(ct){const dt=ct.transformsEnabled();dt==="all"?at.multiply(ct.getTransform()):dt==="position"&&at.translate(ct.x()-ct.offsetX(),ct.y()-ct.offsetY())},Q),at;{at=this._cache.get(D)||new z.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(at):at.reset();const ct=this.transformsEnabled();if(ct==="all")at.multiply(this.getTransform());else if(ct==="position"){const dt=this.attrs.x||0,Ct=this.attrs.y||0,Ut=this.attrs.offsetX||0,Ot=this.attrs.offsetY||0;at.translate(dt-Ut,Ct-Ot)}return at.dirty=!1,at}}getAbsoluteScale(Q){let at=this;for(;at;)at._isUnderCache&&(Q=at),at=at.getParent();const dt=this.getAbsoluteTransform(Q).decompose();return{x:dt.scaleX,y:dt.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(rt,this._getTransform)}_getTransform(){var Q,at;const ct=this._cache.get(rt)||new z.Transform;ct.reset();const dt=this.x(),Ct=this.y(),Ut=et.Konva.getAngle(this.rotation()),Ot=(Q=this.attrs.scaleX)!==null&&Q!==void 0?Q:1,Kt=(at=this.attrs.scaleY)!==null&&at!==void 0?at:1,Xt=this.attrs.skewX||0,Vt=this.attrs.skewY||0,mt=this.attrs.offsetX||0,Dt=this.attrs.offsetY||0;return(dt!==0||Ct!==0)&&ct.translate(dt,Ct),Ut!==0&&ct.rotate(Ut),(Xt!==0||Vt!==0)&&ct.skew(Xt,Vt),(Ot!==1||Kt!==1)&&ct.scale(Ot,Kt),(mt!==0||Dt!==0)&&ct.translate(-1*mt,-1*Dt),ct.dirty=!1,ct}clone(Q){let at=z.Util.cloneObject(this.attrs),ct,dt,Ct,Ut,Ot;for(ct in Q)at[ct]=Q[ct];const Kt=new this.constructor(at);for(ct in this.eventListeners)for(dt=this.eventListeners[ct],Ct=dt.length,Ut=0;Ut<Ct;Ut++)Ot=dt[Ut],Ot.name.indexOf(d)<0&&(Kt.eventListeners[ct]||(Kt.eventListeners[ct]=[]),Kt.eventListeners[ct].push(Ot));return Kt}_toKonvaCanvas(Q){Q=Q||{};const at=this.getClientRect(),ct=this.getStage(),dt=Q.x!==void 0?Q.x:Math.floor(at.x),Ct=Q.y!==void 0?Q.y:Math.floor(at.y),Ut=Q.pixelRatio||1,Ot=new b.SceneCanvas({width:Q.width||Math.ceil(at.width)||(ct?ct.width():0),height:Q.height||Math.ceil(at.height)||(ct?ct.height():0),pixelRatio:Ut}),Kt=Ot.getContext(),Xt=new b.SceneCanvas({width:Ot.width/Ot.pixelRatio+Math.abs(dt),height:Ot.height/Ot.pixelRatio+Math.abs(Ct),pixelRatio:Ot.pixelRatio});return Q.imageSmoothingEnabled===!1&&(Kt._context.imageSmoothingEnabled=!1),Kt.save(),(dt||Ct)&&Kt.translate(-1*dt,-1*Ct),this.drawScene(Ot,void 0,Xt),Kt.restore(),Ot}toCanvas(Q){return this._toKonvaCanvas(Q)._canvas}toDataURL(Q){Q=Q||{};const at=Q.mimeType||null,ct=Q.quality||null,dt=this._toKonvaCanvas(Q).toDataURL(at,ct);return Q.callback&&Q.callback(dt),dt}toImage(Q){return new Promise((at,ct)=>{try{const dt=Q?.callback;dt&&delete Q.callback,z.Util._urlToImage(this.toDataURL(Q),function(Ct){at(Ct),dt?.(Ct)})}catch(dt){ct(dt)}})}toBlob(Q){return new Promise((at,ct)=>{try{const dt=Q?.callback;dt&&delete Q.callback,this.toCanvas(Q).toBlob(Ct=>{at(Ct),dt?.(Ct)},Q?.mimeType,Q?.quality)}catch(dt){ct(dt)}})}setSize(Q){return this.width(Q.width),this.height(Q.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():et.Konva.dragDistance}_off(Q,at,ct){let dt=this.eventListeners[Q],Ct,Ut,Ot;for(Ct=0;Ct<dt.length;Ct++)if(Ut=dt[Ct].name,Ot=dt[Ct].handler,(Ut!=="konva"||at==="konva")&&(!at||Ut===at)&&(!ct||ct===Ot)){if(dt.splice(Ct,1),dt.length===0){delete this.eventListeners[Q];break}Ct--}}_fireChangeEvent(Q,at,ct){this._fire(Q+Z,{oldVal:at,newVal:ct})}addName(Q){if(!this.hasName(Q)){const at=this.name(),ct=at?at+" "+Q:Q;this.name(ct)}return this}hasName(Q){if(!Q)return!1;const at=this.name();return at?(at||"").split(/\s/g).indexOf(Q)!==-1:!1}removeName(Q){const at=(this.name()||"").split(/\s/g),ct=at.indexOf(Q);return ct!==-1&&(at.splice(ct,1),this.name(at.join(" "))),this}setAttr(Q,at){const ct=this[K+z.Util._capitalize(Q)];return z.Util._isFunction(ct)?ct.call(this,at):this._setAttr(Q,at),this}_requestDraw(){if(et.Konva.autoDrawEnabled){const Q=this.getLayer()||this.getStage();Q?.batchDraw()}}_setAttr(Q,at){const ct=this.attrs[Q];ct===at&&!z.Util.isObject(at)||(at==null?delete this.attrs[Q]:this.attrs[Q]=at,this._shouldFireChangeEvents&&this._fireChangeEvent(Q,ct,at),this._requestDraw())}_setComponentAttr(Q,at,ct){let dt;ct!==void 0&&(dt=this.attrs[Q],dt||(this.attrs[Q]=this.getAttr(Q)),this.attrs[Q][at]=ct,this._fireChangeEvent(Q,dt,ct))}_fireAndBubble(Q,at,ct){at&&this.nodeType===f&&(at.target=this);const dt=[S,R,H,P,g,L];if(!(dt.indexOf(Q)!==-1&&(ct&&(this===ct||this.isAncestorOf&&this.isAncestorOf(ct))||this.nodeType==="Stage"&&!ct))){this._fire(Q,at);const Ut=dt.indexOf(Q)!==-1&&ct&&ct.isAncestorOf&&ct.isAncestorOf(this)&&!ct.isAncestorOf(this.parent);(at&&!at.cancelBubble||!at)&&this.parent&&this.parent.isListening()&&!Ut&&(ct&&ct.parent?this._fireAndBubble.call(this.parent,Q,at,ct):this._fireAndBubble.call(this.parent,Q,at))}}_getProtoListeners(Q){var at,ct,dt;const Ct=(at=this._cache.get(x))!==null&&at!==void 0?at:{};let Ut=Ct?.[Q];if(Ut===void 0){Ut=[];let Ot=Object.getPrototypeOf(this);for(;Ot;){const Kt=(dt=(ct=Ot.eventListeners)===null||ct===void 0?void 0:ct[Q])!==null&&dt!==void 0?dt:[];Ut.push(...Kt),Ot=Object.getPrototypeOf(Ot)}Ct[Q]=Ut,this._cache.set(x,Ct)}return Ut}_fire(Q,at){at=at||{},at.currentTarget=this,at.type=Q;const ct=this._getProtoListeners(Q);if(ct)for(let Ct=0;Ct<ct.length;Ct++)ct[Ct].handler.call(this,at);const dt=this.eventListeners[Q];if(dt)for(let Ct=0;Ct<dt.length;Ct++)dt[Ct].handler.call(this,at)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(Q){const at=Q?Q.pointerId:void 0,ct=this.getStage(),dt=this.getAbsolutePosition();if(!ct)return;const Ct=ct._getPointerById(at)||ct._changedPointerPositions[0]||dt;W.DD._dragElements.set(this._id,{node:this,startPointerPos:Ct,offset:{x:Ct.x-dt.x,y:Ct.y-dt.y},dragStatus:"ready",pointerId:at})}startDrag(Q,at=!0){W.DD._dragElements.has(this._id)||this._createDragElement(Q);const ct=W.DD._dragElements.get(this._id);ct.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:Q&&Q.evt},at)}_setDragPosition(Q,at){const ct=this.getStage()._getPointerById(at.pointerId);if(!ct)return;let dt={x:ct.x-at.offset.x,y:ct.y-at.offset.y};const Ct=this.dragBoundFunc();if(Ct!==void 0){const Ut=Ct.call(this,dt,Q);Ut?dt=Ut:z.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==dt.x||this._lastPos.y!==dt.y)&&(this.setAbsolutePosition(dt),this._requestDraw()),this._lastPos=dt}stopDrag(Q){const at=W.DD._dragElements.get(this._id);at&&(at.dragStatus="stopped"),W.DD._endDragBefore(Q),W.DD._endDragAfter(Q)}setDraggable(Q){this._setAttr("draggable",Q),this._dragChange()}isDragging(){const Q=W.DD._dragElements.get(this._id);return Q?Q.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(Q){if(!(!(Q.evt.button!==void 0)||et.Konva.dragButtons.indexOf(Q.evt.button)>=0)||this.isDragging())return;let dt=!1;W.DD._dragElements.forEach(Ct=>{this.isAncestorOf(Ct.node)&&(dt=!0)}),dt||this._createDragElement(Q)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const at=W.DD._dragElements.get(this._id),ct=at&&at.dragStatus==="dragging",dt=at&&at.dragStatus==="ready";ct?this.stopDrag():dt&&W.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(Q={x:0,y:0}){const at=this.getStage();if(!at)return!1;const ct={x:-Q.x,y:-Q.y,width:at.width()+2*Q.x,height:at.height()+2*Q.y};return z.Util.haveIntersection(ct,this.getClientRect())}static create(Q,at){return z.Util._isString(Q)&&(Q=JSON.parse(Q)),this._createNode(Q,at)}static _createNode(Q,at){let ct=as.prototype.getClassName.call(Q),dt=Q.children,Ct,Ut,Ot;at&&(Q.attrs.container=at),et.Konva[ct]||(z.Util.warn('Can not find a node with class name "'+ct+'". Fallback to "Shape".'),ct="Shape");const Kt=et.Konva[ct];if(Ct=new Kt(Q.attrs),dt)for(Ut=dt.length,Ot=0;Ot<Ut;Ot++)Ct.add(as._createNode(dt[Ot]));return Ct}};wr.Node=Pt,Pt.prototype.nodeType="Node",Pt.prototype._attrsAffectingSize=[],Pt.prototype.eventListeners={},Pt.prototype.on.call(Pt.prototype,St,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(rt),this._clearSelfAndDescendantCache(D)}),Pt.prototype.on.call(Pt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(gt)}),Pt.prototype.on.call(Pt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(y)}),Pt.prototype.on.call(Pt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(O)});const Tt=J.Factory.addGetterSetter;return Tt(Pt,"zIndex"),Tt(Pt,"absolutePosition"),Tt(Pt,"position"),Tt(Pt,"x",0,(0,c.getNumberValidator)()),Tt(Pt,"y",0,(0,c.getNumberValidator)()),Tt(Pt,"globalCompositeOperation","source-over",(0,c.getStringValidator)()),Tt(Pt,"opacity",1,(0,c.getNumberValidator)()),Tt(Pt,"name","",(0,c.getStringValidator)()),Tt(Pt,"id","",(0,c.getStringValidator)()),Tt(Pt,"rotation",0,(0,c.getNumberValidator)()),J.Factory.addComponentsGetterSetter(Pt,"scale",["x","y"]),Tt(Pt,"scaleX",1,(0,c.getNumberValidator)()),Tt(Pt,"scaleY",1,(0,c.getNumberValidator)()),J.Factory.addComponentsGetterSetter(Pt,"skew",["x","y"]),Tt(Pt,"skewX",0,(0,c.getNumberValidator)()),Tt(Pt,"skewY",0,(0,c.getNumberValidator)()),J.Factory.addComponentsGetterSetter(Pt,"offset",["x","y"]),Tt(Pt,"offsetX",0,(0,c.getNumberValidator)()),Tt(Pt,"offsetY",0,(0,c.getNumberValidator)()),Tt(Pt,"dragDistance",void 0,(0,c.getNumberValidator)()),Tt(Pt,"width",0,(0,c.getNumberValidator)()),Tt(Pt,"height",0,(0,c.getNumberValidator)()),Tt(Pt,"listening",!0,(0,c.getBooleanValidator)()),Tt(Pt,"preventDefault",!0,(0,c.getBooleanValidator)()),Tt(Pt,"filters",void 0,function(Nt){return this._filterUpToDate=!1,Nt}),Tt(Pt,"visible",!0,(0,c.getBooleanValidator)()),Tt(Pt,"transformsEnabled","all",(0,c.getStringValidator)()),Tt(Pt,"size"),Tt(Pt,"dragBoundFunc"),Tt(Pt,"draggable",!1,(0,c.getBooleanValidator)()),J.Factory.backCompat(Pt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),wr}var Sr={},ws;function On(){if(ws)return Sr;ws=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.Container=void 0;const b=Ne(),W=si(),J=De();let et=class extends W.Node{constructor(){super(...arguments),this.children=[]}getChildren(c){const O=this.children||[];return c?O.filter(c):O}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(c=>{c.parent=null,c.index=0,c.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(c=>{c.parent=null,c.index=0,c.destroy()}),this.children=[],this._requestDraw(),this}add(...c){if(c.length===0)return this;if(c.length>1){for(let x=0;x<c.length;x++)this.add(c[x]);return this}const O=c[0];return O.getParent()?(O.moveTo(this),this):(this._validateAdd(O),O.index=this.getChildren().length,O.parent=this,O._clearCaches(),this.getChildren().push(O),this._fire("add",{child:O}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(c){return this._generalFind(c,!1)}findOne(c){const O=this._generalFind(c,!0);return O.length>0?O[0]:void 0}_generalFind(c,O){const x=[];return this._descendants(D=>{const N=D._isMatch(c);return N&&x.push(D),!!(N&&O)}),x}_descendants(c){let O=!1;const x=this.getChildren();for(const D of x){if(O=c(D),O)return!0;if(D.hasChildren()&&(O=D._descendants(c),O))return!0}return!1}toObject(){const c=W.Node.prototype.toObject.call(this);return c.children=[],this.getChildren().forEach(O=>{c.children.push(O.toObject())}),c}isAncestorOf(c){let O=c.getParent();for(;O;){if(O._id===this._id)return!0;O=O.getParent()}return!1}clone(c){const O=W.Node.prototype.clone.call(this,c);return this.getChildren().forEach(function(x){O.add(x.clone())}),O}getAllIntersections(c){const O=[];return this.find("Shape").forEach(x=>{x.isVisible()&&x.intersects(c)&&O.push(x)}),O}_clearSelfAndDescendantCache(c){var O;super._clearSelfAndDescendantCache(c),!this.isCached()&&((O=this.children)===null||O===void 0||O.forEach(function(x){x._clearSelfAndDescendantCache(c)}))}_setChildrenIndices(){var c;(c=this.children)===null||c===void 0||c.forEach(function(O,x){O.index=x}),this._requestDraw()}drawScene(c,O,x){const D=this.getLayer(),N=c||D&&D.getCanvas(),B=N&&N.getContext(),Z=this._getCanvasCache(),G=Z&&Z.scene,d=N&&N.isCache;if(!this.isVisible()&&!d)return this;if(G){B.save();const y=this.getAbsoluteTransform(O).getMatrix();B.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(B),B.restore()}else this._drawChildren("drawScene",N,O,x);return this}drawHit(c,O){if(!this.shouldDrawHit(O))return this;const x=this.getLayer(),D=c||x&&x.hitCanvas,N=D&&D.getContext(),B=this._getCanvasCache();if(B&&B.hit){N.save();const G=this.getAbsoluteTransform(O).getMatrix();N.transform(G[0],G[1],G[2],G[3],G[4],G[5]),this._drawCachedHitCanvas(N),N.restore()}else this._drawChildren("drawHit",D,O);return this}_drawChildren(c,O,x,D){var N;const B=O&&O.getContext(),Z=this.clipWidth(),G=this.clipHeight(),d=this.clipFunc(),y=typeof Z=="number"&&typeof G=="number"||d,S=x===this;if(y){B.save();const H=this.getAbsoluteTransform(x);let P=H.getMatrix();B.transform(P[0],P[1],P[2],P[3],P[4],P[5]),B.beginPath();let g;if(d)g=d.call(this,B,this);else{const L=this.clipX(),K=this.clipY();B.rect(L||0,K||0,Z,G)}B.clip.apply(B,g),P=H.copy().invert().getMatrix(),B.transform(P[0],P[1],P[2],P[3],P[4],P[5])}const R=!S&&this.globalCompositeOperation()!=="source-over"&&c==="drawScene";R&&(B.save(),B._applyGlobalCompositeOperation(this)),(N=this.children)===null||N===void 0||N.forEach(function(H){H[c](O,x,D)}),R&&B.restore(),y&&B.restore()}getClientRect(c={}){var O;const x=c.skipTransform,D=c.relativeTo;let N,B,Z,G,d={x:1/0,y:1/0,width:0,height:0};const y=this;(O=this.children)===null||O===void 0||O.forEach(function(H){if(!H.visible())return;const P=H.getClientRect({relativeTo:y,skipShadow:c.skipShadow,skipStroke:c.skipStroke});P.width===0&&P.height===0||(N===void 0?(N=P.x,B=P.y,Z=P.x+P.width,G=P.y+P.height):(N=Math.min(N,P.x),B=Math.min(B,P.y),Z=Math.max(Z,P.x+P.width),G=Math.max(G,P.y+P.height)))});const S=this.find("Shape");let R=!1;for(let H=0;H<S.length;H++)if(S[H]._isVisible(this)){R=!0;break}return R&&N!==void 0?d={x:N,y:B,width:Z-N,height:G-B}:d={x:0,y:0,width:0,height:0},x?d:this._transformedRect(d,D)}};return Sr.Container=et,b.Factory.addComponentsGetterSetter(et,"clip",["x","y","width","height"]),b.Factory.addGetterSetter(et,"clipX",void 0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(et,"clipY",void 0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(et,"clipWidth",void 0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(et,"clipHeight",void 0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(et,"clipFunc"),Sr}var $n={},$i={},Ss;function Ta(){if(Ss)return $i;Ss=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.getCapturedShape=et,$i.createEvent=z,$i.hasPointerCapture=c,$i.setPointerCapture=O,$i.releaseCapture=x;const b=Oe(),W=new Map,J=b.Konva._global.PointerEvent!==void 0;function et(D){return W.get(D)}function z(D){return{evt:D,pointerId:D.pointerId}}function c(D,N){return W.get(D)===N}function O(D,N){x(D),N.getStage()&&(W.set(D,N),J&&N._fire("gotpointercapture",z(new PointerEvent("gotpointercapture"))))}function x(D,N){const B=W.get(D);if(!B)return;const Z=B.getStage();Z&&Z.content,W.delete(D),J&&B._fire("lostpointercapture",z(new PointerEvent("lostpointercapture")))}return $i}var Cs;function Wa(){return Cs||(Cs=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Stage=b.stages=void 0;const W=ii(),J=Ne(),et=On(),z=Oe(),c=Rn(),O=hs(),x=Oe(),D=Ta(),N="Stage",B="string",Z="px",G="mouseout",d="mouseleave",y="mouseover",S="mouseenter",R="mousemove",H="mousedown",P="mouseup",g="pointermove",L="pointerdown",K="pointerup",f="pointercancel",wt="lostpointercapture",it="pointerout",rt="pointerleave",st="pointerover",gt="pointerenter",St="contextmenu",It="touchstart",Pt="touchend",Tt="touchmove",Nt="touchcancel",Q="wheel",at=5,ct=[[S,"_pointerenter"],[H,"_pointerdown"],[R,"_pointermove"],[P,"_pointerup"],[d,"_pointerleave"],[It,"_pointerdown"],[Tt,"_pointermove"],[Pt,"_pointerup"],[Nt,"_pointercancel"],[y,"_pointerover"],[Q,"_wheel"],[St,"_contextmenu"],[L,"_pointerdown"],[g,"_pointermove"],[K,"_pointerup"],[f,"_pointercancel"],[rt,"_pointerleave"],[wt,"_lostpointercapture"]],dt={mouse:{[it]:G,[rt]:d,[st]:y,[gt]:S,[g]:R,[L]:H,[K]:P,[f]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[it]:"touchout",[rt]:"touchleave",[st]:"touchover",[gt]:"touchenter",[g]:Tt,[L]:It,[K]:Pt,[f]:Nt,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[it]:it,[rt]:rt,[st]:st,[gt]:gt,[g]:g,[L]:L,[K]:K,[f]:f,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Ct=Vt=>Vt.indexOf("pointer")>=0?"pointer":Vt.indexOf("touch")>=0?"touch":"mouse",Ut=Vt=>{const mt=Ct(Vt);if(mt==="pointer")return z.Konva.pointerEventsEnabled&&dt.pointer;if(mt==="touch")return dt.touch;if(mt==="mouse")return dt.mouse};function Ot(Vt={}){return(Vt.clipFunc||Vt.clipWidth||Vt.clipHeight)&&W.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Vt}const Kt="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";b.stages=[];class Xt extends et.Container{constructor(mt){super(Ot(mt)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),b.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ot(this.attrs)}),this._checkVisibility()}_validateAdd(mt){const Dt=mt.getType()==="Layer",Wt=mt.getType()==="FastLayer";Dt||Wt||W.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const mt=this.visible()?"":"none";this.content.style.display=mt}setContainer(mt){if(typeof mt===B){let Dt;if(mt.charAt(0)==="."){const Wt=mt.slice(1);mt=document.getElementsByClassName(Wt)[0]}else mt.charAt(0)!=="#"?Dt=mt:Dt=mt.slice(1),mt=document.getElementById(Dt);if(!mt)throw"Can not find container in document with id "+Dt}return this._setAttr("container",mt),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),mt.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const mt=this.children,Dt=mt.length;for(let Wt=0;Wt<Dt;Wt++)mt[Wt].clear();return this}clone(mt){return mt||(mt={}),mt.container=typeof document<"u"&&document.createElement("div"),et.Container.prototype.clone.call(this,mt)}destroy(){super.destroy();const mt=this.content;mt&&W.Util._isInDocument(mt)&&this.container().removeChild(mt);const Dt=b.stages.indexOf(this);return Dt>-1&&b.stages.splice(Dt,1),W.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const mt=this._pointerPositions[0]||this._changedPointerPositions[0];return mt?{x:mt.x,y:mt.y}:(W.Util.warn(Kt),null)}_getPointerById(mt){return this._pointerPositions.find(Dt=>Dt.id===mt)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(mt){mt=mt||{},mt.x=mt.x||0,mt.y=mt.y||0,mt.width=mt.width||this.width(),mt.height=mt.height||this.height();const Dt=new c.SceneCanvas({width:mt.width,height:mt.height,pixelRatio:mt.pixelRatio||1}),Wt=Dt.getContext()._context,Qt=this.children;return(mt.x||mt.y)&&Wt.translate(-1*mt.x,-1*mt.y),Qt.forEach(function(re){if(!re.isVisible())return;const be=re._toKonvaCanvas(mt);Wt.drawImage(be._canvas,mt.x,mt.y,be.getWidth()/be.getPixelRatio(),be.getHeight()/be.getPixelRatio())}),Dt}getIntersection(mt){if(!mt)return null;const Dt=this.children,Wt=Dt.length,Qt=Wt-1;for(let re=Qt;re>=0;re--){const be=Dt[re].getIntersection(mt);if(be)return be}return null}_resizeDOM(){const mt=this.width(),Dt=this.height();this.content&&(this.content.style.width=mt+Z,this.content.style.height=Dt+Z),this.bufferCanvas.setSize(mt,Dt),this.bufferHitCanvas.setSize(mt,Dt),this.children.forEach(Wt=>{Wt.setSize({width:mt,height:Dt}),Wt.draw()})}add(mt,...Dt){if(arguments.length>1){for(let Qt=0;Qt<arguments.length;Qt++)this.add(arguments[Qt]);return this}super.add(mt);const Wt=this.children.length;return Wt>at&&W.Util.warn("The stage has "+Wt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),mt.setSize({width:this.width(),height:this.height()}),mt.draw(),z.Konva.isBrowser&&this.content.appendChild(mt.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(mt){return D.hasPointerCapture(mt,this)}setPointerCapture(mt){D.setPointerCapture(mt,this)}releaseCapture(mt){D.releaseCapture(mt,this)}getLayers(){return this.children}_bindContentEvents(){z.Konva.isBrowser&&ct.forEach(([mt,Dt])=>{this.content.addEventListener(mt,Wt=>{this[Dt](Wt)},{passive:!1})})}_pointerenter(mt){this.setPointersPositions(mt);const Dt=Ut(mt.type);Dt&&this._fire(Dt.pointerenter,{evt:mt,target:this,currentTarget:this})}_pointerover(mt){this.setPointersPositions(mt);const Dt=Ut(mt.type);Dt&&this._fire(Dt.pointerover,{evt:mt,target:this,currentTarget:this})}_getTargetShape(mt){let Dt=this[mt+"targetShape"];return Dt&&!Dt.getStage()&&(Dt=null),Dt}_pointerleave(mt){const Dt=Ut(mt.type),Wt=Ct(mt.type);if(!Dt)return;this.setPointersPositions(mt);const Qt=this._getTargetShape(Wt),re=!(z.Konva.isDragging()||z.Konva.isTransforming())||z.Konva.hitOnDragEnabled;Qt&&re?(Qt._fireAndBubble(Dt.pointerout,{evt:mt}),Qt._fireAndBubble(Dt.pointerleave,{evt:mt}),this._fire(Dt.pointerleave,{evt:mt,target:this,currentTarget:this}),this[Wt+"targetShape"]=null):re&&(this._fire(Dt.pointerleave,{evt:mt,target:this,currentTarget:this}),this._fire(Dt.pointerout,{evt:mt,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(mt){const Dt=Ut(mt.type),Wt=Ct(mt.type);if(!Dt)return;this.setPointersPositions(mt);let Qt=!1;this._changedPointerPositions.forEach(re=>{const be=this.getIntersection(re);if(O.DD.justDragged=!1,z.Konva["_"+Wt+"ListenClick"]=!0,!be||!be.isListening()){this[Wt+"ClickStartShape"]=void 0;return}z.Konva.capturePointerEventsEnabled&&be.setPointerCapture(re.id),this[Wt+"ClickStartShape"]=be,be._fireAndBubble(Dt.pointerdown,{evt:mt,pointerId:re.id}),Qt=!0;const ce=mt.type.indexOf("touch")>=0;be.preventDefault()&&mt.cancelable&&ce&&mt.preventDefault()}),Qt||this._fire(Dt.pointerdown,{evt:mt,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(mt){const Dt=Ut(mt.type),Wt=Ct(mt.type);if(!Dt||(z.Konva.isDragging()&&O.DD.node.preventDefault()&&mt.cancelable&&mt.preventDefault(),this.setPointersPositions(mt),!(!(z.Konva.isDragging()||z.Konva.isTransforming())||z.Konva.hitOnDragEnabled)))return;const re={};let be=!1;const ce=this._getTargetShape(Wt);this._changedPointerPositions.forEach(we=>{const ge=D.getCapturedShape(we.id)||this.getIntersection(we),Ze=we.id,Re={evt:mt,pointerId:Ze},Ue=ce!==ge;if(Ue&&ce&&(ce._fireAndBubble(Dt.pointerout,{...Re},ge),ce._fireAndBubble(Dt.pointerleave,{...Re},ge)),ge){if(re[ge._id])return;re[ge._id]=!0}ge&&ge.isListening()?(be=!0,Ue&&(ge._fireAndBubble(Dt.pointerover,{...Re},ce),ge._fireAndBubble(Dt.pointerenter,{...Re},ce),this[Wt+"targetShape"]=ge),ge._fireAndBubble(Dt.pointermove,{...Re})):ce&&(this._fire(Dt.pointerover,{evt:mt,target:this,currentTarget:this,pointerId:Ze}),this[Wt+"targetShape"]=null)}),be||this._fire(Dt.pointermove,{evt:mt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(mt){const Dt=Ut(mt.type),Wt=Ct(mt.type);if(!Dt)return;this.setPointersPositions(mt);const Qt=this[Wt+"ClickStartShape"],re=this[Wt+"ClickEndShape"],be={};let ce=!1;this._changedPointerPositions.forEach(we=>{const ge=D.getCapturedShape(we.id)||this.getIntersection(we);if(ge){if(ge.releaseCapture(we.id),be[ge._id])return;be[ge._id]=!0}const Ze=we.id,Re={evt:mt,pointerId:Ze};let Ue=!1;z.Konva["_"+Wt+"InDblClickWindow"]?(Ue=!0,clearTimeout(this[Wt+"DblTimeout"])):O.DD.justDragged||(z.Konva["_"+Wt+"InDblClickWindow"]=!0,clearTimeout(this[Wt+"DblTimeout"])),this[Wt+"DblTimeout"]=setTimeout(function(){z.Konva["_"+Wt+"InDblClickWindow"]=!1},z.Konva.dblClickWindow),ge&&ge.isListening()?(ce=!0,this[Wt+"ClickEndShape"]=ge,ge._fireAndBubble(Dt.pointerup,{...Re}),z.Konva["_"+Wt+"ListenClick"]&&Qt&&Qt===ge&&(ge._fireAndBubble(Dt.pointerclick,{...Re}),Ue&&re&&re===ge&&ge._fireAndBubble(Dt.pointerdblclick,{...Re}))):(this[Wt+"ClickEndShape"]=null,z.Konva["_"+Wt+"ListenClick"]&&this._fire(Dt.pointerclick,{evt:mt,target:this,currentTarget:this,pointerId:Ze}),Ue&&this._fire(Dt.pointerdblclick,{evt:mt,target:this,currentTarget:this,pointerId:Ze}))}),ce||this._fire(Dt.pointerup,{evt:mt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),z.Konva["_"+Wt+"ListenClick"]=!1,mt.cancelable&&Wt!=="touch"&&Wt!=="pointer"&&mt.preventDefault()}_contextmenu(mt){this.setPointersPositions(mt);const Dt=this.getIntersection(this.getPointerPosition());Dt&&Dt.isListening()?Dt._fireAndBubble(St,{evt:mt}):this._fire(St,{evt:mt,target:this,currentTarget:this})}_wheel(mt){this.setPointersPositions(mt);const Dt=this.getIntersection(this.getPointerPosition());Dt&&Dt.isListening()?Dt._fireAndBubble(Q,{evt:mt}):this._fire(Q,{evt:mt,target:this,currentTarget:this})}_pointercancel(mt){this.setPointersPositions(mt);const Dt=D.getCapturedShape(mt.pointerId)||this.getIntersection(this.getPointerPosition());Dt&&Dt._fireAndBubble(K,D.createEvent(mt)),D.releaseCapture(mt.pointerId)}_lostpointercapture(mt){D.releaseCapture(mt.pointerId)}setPointersPositions(mt){const Dt=this._getContentPosition();let Wt=null,Qt=null;mt=mt||window.event,mt.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(mt.touches,re=>{this._pointerPositions.push({id:re.identifier,x:(re.clientX-Dt.left)/Dt.scaleX,y:(re.clientY-Dt.top)/Dt.scaleY})}),Array.prototype.forEach.call(mt.changedTouches||mt.touches,re=>{this._changedPointerPositions.push({id:re.identifier,x:(re.clientX-Dt.left)/Dt.scaleX,y:(re.clientY-Dt.top)/Dt.scaleY})})):(Wt=(mt.clientX-Dt.left)/Dt.scaleX,Qt=(mt.clientY-Dt.top)/Dt.scaleY,this.pointerPos={x:Wt,y:Qt},this._pointerPositions=[{x:Wt,y:Qt,id:W.Util._getFirstPointerId(mt)}],this._changedPointerPositions=[{x:Wt,y:Qt,id:W.Util._getFirstPointerId(mt)}])}_setPointerPosition(mt){W.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(mt)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const mt=this.content.getBoundingClientRect();return{top:mt.top,left:mt.left,scaleX:mt.width/this.content.clientWidth||1,scaleY:mt.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new c.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new c.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!z.Konva.isBrowser)return;const mt=this.container();if(!mt)throw"Stage has no container. A container is required.";mt.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),mt.appendChild(this.content),this._resizeDOM()}cache(){return W.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(mt){mt.batchDraw()}),this}}b.Stage=Xt,Xt.prototype.nodeType=N,(0,x._registerNode)(Xt),J.Factory.addGetterSetter(Xt,"container"),z.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{b.stages.forEach(Vt=>{Vt.batchDraw()})})})($n)),$n}var Cr={},ts={},Ps;function di(){return Ps||(Ps=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Shape=b.shapes=void 0;const W=Oe(),J=ii(),et=Ne(),z=si(),c=De(),O=Oe(),x=Ta(),D="hasShadow",N="shadowRGBA",B="patternImage",Z="linearGradient",G="radialGradient";let d;function y(){return d||(d=J.Util.createCanvasElement().getContext("2d"),d)}b.shapes={};function S(rt){const st=this.attrs.fillRule;st?rt.fill(st):rt.fill()}function R(rt){rt.stroke()}function H(rt){const st=this.attrs.fillRule;st?rt.fill(st):rt.fill()}function P(rt){rt.stroke()}function g(){this._clearCache(D)}function L(){this._clearCache(N)}function K(){this._clearCache(B)}function f(){this._clearCache(Z)}function wt(){this._clearCache(G)}class it extends z.Node{constructor(st){super(st);let gt;for(;gt=J.Util.getRandomColor(),!(gt&&!(gt in b.shapes)););this.colorKey=gt,b.shapes[gt]=this}getContext(){return J.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return J.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(D,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(B,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const gt=y().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(gt&&gt.setTransform){const St=new J.Transform;St.translate(this.fillPatternX(),this.fillPatternY()),St.rotate(W.Konva.getAngle(this.fillPatternRotation())),St.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),St.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const It=St.getMatrix(),Pt=typeof DOMMatrix>"u"?{a:It[0],b:It[1],c:It[2],d:It[3],e:It[4],f:It[5]}:new DOMMatrix(It);gt.setTransform(Pt)}return gt}}_getLinearGradient(){return this._getCache(Z,this.__getLinearGradient)}__getLinearGradient(){const st=this.fillLinearGradientColorStops();if(st){const gt=y(),St=this.fillLinearGradientStartPoint(),It=this.fillLinearGradientEndPoint(),Pt=gt.createLinearGradient(St.x,St.y,It.x,It.y);for(let Tt=0;Tt<st.length;Tt+=2)Pt.addColorStop(st[Tt],st[Tt+1]);return Pt}}_getRadialGradient(){return this._getCache(G,this.__getRadialGradient)}__getRadialGradient(){const st=this.fillRadialGradientColorStops();if(st){const gt=y(),St=this.fillRadialGradientStartPoint(),It=this.fillRadialGradientEndPoint(),Pt=gt.createRadialGradient(St.x,St.y,this.fillRadialGradientStartRadius(),It.x,It.y,this.fillRadialGradientEndRadius());for(let Tt=0;Tt<st.length;Tt+=2)Pt.addColorStop(st[Tt],st[Tt+1]);return Pt}}getShadowRGBA(){return this._getCache(N,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const st=J.Util.colorToRGBA(this.shadowColor());if(st)return"rgba("+st.r+","+st.g+","+st.b+","+st.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const st=this.hitStrokeWidth();return st==="auto"?this.hasStroke():this.strokeEnabled()&&!!st}intersects(st){const gt=this.getStage();if(!gt)return!1;const St=gt.bufferHitCanvas;return St.getContext().clear(),this.drawHit(St,void 0,!0),St.context.getImageData(Math.round(st.x),Math.round(st.y),1,1).data[3]>0}destroy(){return z.Node.prototype.destroy.call(this),delete b.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(st){var gt;if(!((gt=this.attrs.perfectDrawEnabled)!==null&&gt!==void 0?gt:!0))return!1;const It=st||this.hasFill(),Pt=this.hasStroke(),Tt=this.getAbsoluteOpacity()!==1;if(It&&Pt&&Tt)return!0;const Nt=this.hasShadow(),Q=this.shadowForStrokeEnabled();return!!(It&&Pt&&Nt&&Q)}setStrokeHitEnabled(st){J.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),st?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const st=this.size();return{x:this._centroid?-st.width/2:0,y:this._centroid?-st.height/2:0,width:st.width,height:st.height}}getClientRect(st={}){let gt=!1,St=this.getParent();for(;St;){if(St.isCached()){gt=!0;break}St=St.getParent()}const It=st.skipTransform,Pt=st.relativeTo||gt&&this.getStage()||void 0,Tt=this.getSelfRect(),Q=!st.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,at=Tt.width+Q,ct=Tt.height+Q,dt=!st.skipShadow&&this.hasShadow(),Ct=dt?this.shadowOffsetX():0,Ut=dt?this.shadowOffsetY():0,Ot=at+Math.abs(Ct),Kt=ct+Math.abs(Ut),Xt=dt&&this.shadowBlur()||0,Vt=Ot+Xt*2,mt=Kt+Xt*2,Dt={width:Vt,height:mt,x:-(Q/2+Xt)+Math.min(Ct,0)+Tt.x,y:-(Q/2+Xt)+Math.min(Ut,0)+Tt.y};return It?Dt:this._transformedRect(Dt,Pt)}drawScene(st,gt,St){const It=this.getLayer(),Pt=st||It.getCanvas(),Tt=Pt.getContext(),Nt=this._getCanvasCache(),Q=this.getSceneFunc(),at=this.hasShadow();let ct;const dt=gt===this;if(!this.isVisible()&&!dt)return this;if(Nt){Tt.save();const Ct=this.getAbsoluteTransform(gt).getMatrix();return Tt.transform(Ct[0],Ct[1],Ct[2],Ct[3],Ct[4],Ct[5]),this._drawCachedSceneCanvas(Tt),Tt.restore(),this}if(!Q)return this;if(Tt.save(),this._useBufferCanvas()){ct=this.getStage();const Ct=St||ct.bufferCanvas,Ut=Ct.getContext();Ut.clear(),Ut.save(),Ut._applyLineJoin(this);const Ot=this.getAbsoluteTransform(gt).getMatrix();Ut.transform(Ot[0],Ot[1],Ot[2],Ot[3],Ot[4],Ot[5]),Q.call(this,Ut,this),Ut.restore();const Kt=Ct.pixelRatio;at&&Tt._applyShadow(this),Tt._applyOpacity(this),Tt._applyGlobalCompositeOperation(this),Tt.drawImage(Ct._canvas,Ct.x||0,Ct.y||0,Ct.width/Kt,Ct.height/Kt)}else{if(Tt._applyLineJoin(this),!dt){const Ct=this.getAbsoluteTransform(gt).getMatrix();Tt.transform(Ct[0],Ct[1],Ct[2],Ct[3],Ct[4],Ct[5]),Tt._applyOpacity(this),Tt._applyGlobalCompositeOperation(this)}at&&Tt._applyShadow(this),Q.call(this,Tt,this)}return Tt.restore(),this}drawHit(st,gt,St=!1){if(!this.shouldDrawHit(gt,St))return this;const It=this.getLayer(),Pt=st||It.hitCanvas,Tt=Pt&&Pt.getContext(),Nt=this.hitFunc()||this.sceneFunc(),Q=this._getCanvasCache(),at=Q&&Q.hit;if(this.colorKey||J.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),at){Tt.save();const dt=this.getAbsoluteTransform(gt).getMatrix();return Tt.transform(dt[0],dt[1],dt[2],dt[3],dt[4],dt[5]),this._drawCachedHitCanvas(Tt),Tt.restore(),this}if(!Nt)return this;if(Tt.save(),Tt._applyLineJoin(this),!(this===gt)){const dt=this.getAbsoluteTransform(gt).getMatrix();Tt.transform(dt[0],dt[1],dt[2],dt[3],dt[4],dt[5])}return Nt.call(this,Tt,this),Tt.restore(),this}drawHitFromCache(st=0){const gt=this._getCanvasCache(),St=this._getCachedSceneCanvas(),It=gt.hit,Pt=It.getContext(),Tt=It.getWidth(),Nt=It.getHeight();Pt.clear(),Pt.drawImage(St._canvas,0,0,Tt,Nt);try{const Q=Pt.getImageData(0,0,Tt,Nt),at=Q.data,ct=at.length,dt=J.Util._hexToRgb(this.colorKey);for(let Ct=0;Ct<ct;Ct+=4)at[Ct+3]>st?(at[Ct]=dt.r,at[Ct+1]=dt.g,at[Ct+2]=dt.b,at[Ct+3]=255):at[Ct+3]=0;Pt.putImageData(Q,0,0)}catch(Q){J.Util.error("Unable to draw hit graph from cached scene canvas. "+Q.message)}return this}hasPointerCapture(st){return x.hasPointerCapture(st,this)}setPointerCapture(st){x.setPointerCapture(st,this)}releaseCapture(st){x.releaseCapture(st,this)}}b.Shape=it,it.prototype._fillFunc=S,it.prototype._strokeFunc=R,it.prototype._fillFuncHit=H,it.prototype._strokeFuncHit=P,it.prototype._centroid=!1,it.prototype.nodeType="Shape",(0,O._registerNode)(it),it.prototype.eventListeners={},it.prototype.on.call(it.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",g),it.prototype.on.call(it.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",L),it.prototype.on.call(it.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",K),it.prototype.on.call(it.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",f),it.prototype.on.call(it.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",wt),et.Factory.addGetterSetter(it,"stroke",void 0,(0,c.getStringOrGradientValidator)()),et.Factory.addGetterSetter(it,"strokeWidth",2,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillAfterStrokeEnabled",!1),et.Factory.addGetterSetter(it,"hitStrokeWidth","auto",(0,c.getNumberOrAutoValidator)()),et.Factory.addGetterSetter(it,"strokeHitEnabled",!0,(0,c.getBooleanValidator)()),et.Factory.addGetterSetter(it,"perfectDrawEnabled",!0,(0,c.getBooleanValidator)()),et.Factory.addGetterSetter(it,"shadowForStrokeEnabled",!0,(0,c.getBooleanValidator)()),et.Factory.addGetterSetter(it,"lineJoin"),et.Factory.addGetterSetter(it,"lineCap"),et.Factory.addGetterSetter(it,"sceneFunc"),et.Factory.addGetterSetter(it,"hitFunc"),et.Factory.addGetterSetter(it,"dash"),et.Factory.addGetterSetter(it,"dashOffset",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"shadowColor",void 0,(0,c.getStringValidator)()),et.Factory.addGetterSetter(it,"shadowBlur",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"shadowOpacity",1,(0,c.getNumberValidator)()),et.Factory.addComponentsGetterSetter(it,"shadowOffset",["x","y"]),et.Factory.addGetterSetter(it,"shadowOffsetX",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"shadowOffsetY",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillPatternImage"),et.Factory.addGetterSetter(it,"fill",void 0,(0,c.getStringOrGradientValidator)()),et.Factory.addGetterSetter(it,"fillPatternX",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillPatternY",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillLinearGradientColorStops"),et.Factory.addGetterSetter(it,"strokeLinearGradientColorStops"),et.Factory.addGetterSetter(it,"fillRadialGradientStartRadius",0),et.Factory.addGetterSetter(it,"fillRadialGradientEndRadius",0),et.Factory.addGetterSetter(it,"fillRadialGradientColorStops"),et.Factory.addGetterSetter(it,"fillPatternRepeat","repeat"),et.Factory.addGetterSetter(it,"fillEnabled",!0),et.Factory.addGetterSetter(it,"strokeEnabled",!0),et.Factory.addGetterSetter(it,"shadowEnabled",!0),et.Factory.addGetterSetter(it,"dashEnabled",!0),et.Factory.addGetterSetter(it,"strokeScaleEnabled",!0),et.Factory.addGetterSetter(it,"fillPriority","color"),et.Factory.addComponentsGetterSetter(it,"fillPatternOffset",["x","y"]),et.Factory.addGetterSetter(it,"fillPatternOffsetX",0,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillPatternOffsetY",0,(0,c.getNumberValidator)()),et.Factory.addComponentsGetterSetter(it,"fillPatternScale",["x","y"]),et.Factory.addGetterSetter(it,"fillPatternScaleX",1,(0,c.getNumberValidator)()),et.Factory.addGetterSetter(it,"fillPatternScaleY",1,(0,c.getNumberValidator)()),et.Factory.addComponentsGetterSetter(it,"fillLinearGradientStartPoint",["x","y"]),et.Factory.addComponentsGetterSetter(it,"strokeLinearGradientStartPoint",["x","y"]),et.Factory.addGetterSetter(it,"fillLinearGradientStartPointX",0),et.Factory.addGetterSetter(it,"strokeLinearGradientStartPointX",0),et.Factory.addGetterSetter(it,"fillLinearGradientStartPointY",0),et.Factory.addGetterSetter(it,"strokeLinearGradientStartPointY",0),et.Factory.addComponentsGetterSetter(it,"fillLinearGradientEndPoint",["x","y"]),et.Factory.addComponentsGetterSetter(it,"strokeLinearGradientEndPoint",["x","y"]),et.Factory.addGetterSetter(it,"fillLinearGradientEndPointX",0),et.Factory.addGetterSetter(it,"strokeLinearGradientEndPointX",0),et.Factory.addGetterSetter(it,"fillLinearGradientEndPointY",0),et.Factory.addGetterSetter(it,"strokeLinearGradientEndPointY",0),et.Factory.addComponentsGetterSetter(it,"fillRadialGradientStartPoint",["x","y"]),et.Factory.addGetterSetter(it,"fillRadialGradientStartPointX",0),et.Factory.addGetterSetter(it,"fillRadialGradientStartPointY",0),et.Factory.addComponentsGetterSetter(it,"fillRadialGradientEndPoint",["x","y"]),et.Factory.addGetterSetter(it,"fillRadialGradientEndPointX",0),et.Factory.addGetterSetter(it,"fillRadialGradientEndPointY",0),et.Factory.addGetterSetter(it,"fillPatternRotation",0),et.Factory.addGetterSetter(it,"fillRule",void 0,(0,c.getStringValidator)()),et.Factory.backCompat(it,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ts)),ts}var ks;function Ia(){if(ks)return Cr;ks=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.Layer=void 0;const b=ii(),W=On(),J=si(),et=Ne(),z=Rn(),c=De(),O=di(),x=Oe(),D="#",N="beforeDraw",B="draw",Z=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],G=Z.length;let d=class extends W.Container{constructor(S){super(S),this.canvas=new z.SceneCanvas,this.hitCanvas=new z.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(S){return this.getContext().clear(S),this.getHitCanvas().getContext().clear(S),this}setZIndex(S){super.setZIndex(S);const R=this.getStage();return R&&R.content&&(R.content.removeChild(this.getNativeCanvasElement()),S<R.children.length-1?R.content.insertBefore(this.getNativeCanvasElement(),R.children[S+1].getCanvas()._canvas):R.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){J.Node.prototype.moveToTop.call(this);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!J.Node.prototype.moveUp.call(this))return!1;const R=this.getStage();return!R||!R.content?!1:(R.content.removeChild(this.getNativeCanvasElement()),this.index<R.children.length-1?R.content.insertBefore(this.getNativeCanvasElement(),R.children[this.index+1].getCanvas()._canvas):R.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(J.Node.prototype.moveDown.call(this)){const S=this.getStage();if(S){const R=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),R[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(J.Node.prototype.moveToBottom.call(this)){const S=this.getStage();if(S){const R=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),R[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const S=this.getNativeCanvasElement();return J.Node.prototype.remove.call(this),S&&S.parentNode&&b.Util._isInDocument(S)&&S.parentNode.removeChild(S),this}getStage(){return this.parent}setSize({width:S,height:R}){return this.canvas.setSize(S,R),this.hitCanvas.setSize(S,R),this._setSmoothEnabled(),this}_validateAdd(S){const R=S.getType();R!=="Group"&&R!=="Shape"&&b.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(S){return S=S||{},S.width=S.width||this.getWidth(),S.height=S.height||this.getHeight(),S.x=S.x!==void 0?S.x:this.x(),S.y=S.y!==void 0?S.y:this.y(),J.Node.prototype._toKonvaCanvas.call(this,S)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){b.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){b.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,b.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(S){if(!this.isListening()||!this.isVisible())return null;let R=1,H=!1;for(;;){for(let P=0;P<G;P++){const g=Z[P],L=this._getIntersection({x:S.x+g.x*R,y:S.y+g.y*R}),K=L.shape;if(K)return K;if(H=!!L.antialiased,!L.antialiased)break}if(H)R+=1;else return null}}_getIntersection(S){const R=this.hitCanvas.pixelRatio,H=this.hitCanvas.context.getImageData(Math.round(S.x*R),Math.round(S.y*R),1,1).data,P=H[3];if(P===255){const g=b.Util._rgbToHex(H[0],H[1],H[2]),L=O.shapes[D+g];return L?{shape:L}:{antialiased:!0}}else if(P>0)return{antialiased:!0};return{}}drawScene(S,R,H){const P=this.getLayer(),g=S||P&&P.getCanvas();return this._fire(N,{node:this}),this.clearBeforeDraw()&&g.getContext().clear(),W.Container.prototype.drawScene.call(this,g,R,H),this._fire(B,{node:this}),this}drawHit(S,R){const H=this.getLayer(),P=S||H&&H.hitCanvas;return H&&H.clearBeforeDraw()&&H.getHitCanvas().getContext().clear(),W.Container.prototype.drawHit.call(this,P,R),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(S){b.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(S)}getHitGraphEnabled(S){return b.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const S=this.parent;!!this.hitCanvas._canvas.parentNode?S.content.removeChild(this.hitCanvas._canvas):S.content.appendChild(this.hitCanvas._canvas)}destroy(){return b.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Cr.Layer=d,d.prototype.nodeType="Layer",(0,x._registerNode)(d),et.Factory.addGetterSetter(d,"imageSmoothingEnabled",!0),et.Factory.addGetterSetter(d,"clearBeforeDraw",!0),et.Factory.addGetterSetter(d,"hitGraphEnabled",!0,(0,c.getBooleanValidator)()),Cr}var Pr={},As;function Ka(){if(As)return Pr;As=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.FastLayer=void 0;const b=ii(),W=Ia(),J=Oe();let et=class extends W.Layer{constructor(c){super(c),this.listening(!1),b.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Pr.FastLayer=et,et.prototype.nodeType="FastLayer",(0,J._registerNode)(et),Pr}var kr={},Es;function ls(){if(Es)return kr;Es=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.Group=void 0;const b=ii(),W=On(),J=Oe();let et=class extends W.Container{_validateAdd(c){const O=c.getType();O!=="Group"&&O!=="Shape"&&b.Util.throw("You may only add groups and shapes to groups.")}};return kr.Group=et,et.prototype.nodeType="Group",(0,J._registerNode)(et),kr}var Ar={},Ts;function cs(){if(Ts)return Ar;Ts=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.Animation=void 0;const b=Oe(),W=ii(),J=(function(){return b.glob.performance&&b.glob.performance.now?function(){return b.glob.performance.now()}:function(){return new Date().getTime()}})();let et=class gr{constructor(c,O){this.id=gr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:J(),frameRate:0},this.func=c,this.setLayers(O)}setLayers(c){let O=[];return c&&(O=Array.isArray(c)?c:[c]),this.layers=O,this}getLayers(){return this.layers}addLayer(c){const O=this.layers,x=O.length;for(let D=0;D<x;D++)if(O[D]._id===c._id)return!1;return this.layers.push(c),!0}isRunning(){const O=gr.animations,x=O.length;for(let D=0;D<x;D++)if(O[D].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=J(),gr._addAnimation(this),this}stop(){return gr._removeAnimation(this),this}_updateFrameObject(c){this.frame.timeDiff=c-this.frame.lastTime,this.frame.lastTime=c,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(c){this.animations.push(c),this._handleAnimation()}static _removeAnimation(c){const O=c.id,x=this.animations,D=x.length;for(let N=0;N<D;N++)if(x[N].id===O){this.animations.splice(N,1);break}}static _runFrames(){const c={},O=this.animations;for(let x=0;x<O.length;x++){const D=O[x],N=D.layers,B=D.func;D._updateFrameObject(J());const Z=N.length;let G;if(B?G=B.call(D,D.frame)!==!1:G=!0,!!G)for(let d=0;d<Z;d++){const y=N[d];y._id!==void 0&&(c[y._id]=y)}}for(const x in c)c.hasOwnProperty(x)&&c[x].batchDraw()}static _animationLoop(){const c=gr;c.animations.length?(c._runFrames(),W.Util.requestAnimFrame(c._animationLoop)):c.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,W.Util.requestAnimFrame(this._animationLoop))}};return Ar.Animation=et,et.animations=[],et.animIdCounter=0,et.animRunning=!1,Ar}var es={},Is;function Ya(){return Is||(Is=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Easings=b.Tween=void 0;const W=ii(),J=cs(),et=si(),z=Oe(),c={node:1,duration:1,easing:1,onFinish:1,yoyo:1},O=1,x=2,D=3,N=["fill","stroke","shadowColor"];let B=0;class Z{constructor(y,S,R,H,P,g,L){this.prop=y,this.propFunc=S,this.begin=H,this._pos=H,this.duration=g,this._change=0,this.prevPos=0,this.yoyo=L,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=R,this._change=P-this.begin,this.pause()}fire(y){const S=this[y];S&&S()}setTime(y){y>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():y<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=y,this.update())}getTime(){return this._time}setPosition(y){this.prevPos=this._pos,this.propFunc(y),this._pos=y}getPosition(y){return y===void 0&&(y=this._time),this.func(y,this.begin,this._change,this.duration)}play(){this.state=x,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=D,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(y){this.pause(),this._time=y,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const y=this.getTimer()-this._startTime;this.state===x?this.setTime(y):this.state===D&&this.setTime(this.duration-y)}pause(){this.state=O,this.fire("onPause")}getTimer(){return new Date().getTime()}}class G{constructor(y){const S=this,R=y.node,H=R._id,P=y.easing||b.Easings.Linear,g=!!y.yoyo;let L,K;typeof y.duration>"u"?L=.3:y.duration===0?L=.001:L=y.duration,this.node=R,this._id=B++;const f=R.getLayer()||(R instanceof z.Konva.Stage?R.getLayers():null);f||W.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new J.Animation(function(){S.tween.onEnterFrame()},f),this.tween=new Z(K,function(wt){S._tweenFunc(wt)},P,0,1,L*1e3,g),this._addListeners(),G.attrs[H]||(G.attrs[H]={}),G.attrs[H][this._id]||(G.attrs[H][this._id]={}),G.tweens[H]||(G.tweens[H]={});for(K in y)c[K]===void 0&&this._addAttr(K,y[K]);this.reset(),this.onFinish=y.onFinish,this.onReset=y.onReset,this.onUpdate=y.onUpdate}_addAttr(y,S){const R=this.node,H=R._id;let P,g,L,K,f;const wt=G.tweens[H][y];wt&&delete G.attrs[H][wt][y];let it=R.getAttr(y);if(W.Util._isArray(S))if(P=[],g=Math.max(S.length,it.length),y==="points"&&S.length!==it.length&&(S.length>it.length?(K=it,it=W.Util._prepareArrayForTween(it,S,R.closed())):(L=S,S=W.Util._prepareArrayForTween(S,it,R.closed()))),y.indexOf("fill")===0)for(let rt=0;rt<g;rt++)if(rt%2===0)P.push(S[rt]-it[rt]);else{const st=W.Util.colorToRGBA(it[rt]);f=W.Util.colorToRGBA(S[rt]),it[rt]=st,P.push({r:f.r-st.r,g:f.g-st.g,b:f.b-st.b,a:f.a-st.a})}else for(let rt=0;rt<g;rt++)P.push(S[rt]-it[rt]);else N.indexOf(y)!==-1?(it=W.Util.colorToRGBA(it),f=W.Util.colorToRGBA(S),P={r:f.r-it.r,g:f.g-it.g,b:f.b-it.b,a:f.a-it.a}):P=S-it;G.attrs[H][this._id][y]={start:it,diff:P,end:S,trueEnd:L,trueStart:K},G.tweens[H][y]=this._id}_tweenFunc(y){const S=this.node,R=G.attrs[S._id][this._id];let H,P,g,L,K,f,wt,it;for(H in R){if(P=R[H],g=P.start,L=P.diff,it=P.end,W.Util._isArray(g))if(K=[],wt=Math.max(g.length,it.length),H.indexOf("fill")===0)for(f=0;f<wt;f++)f%2===0?K.push((g[f]||0)+L[f]*y):K.push("rgba("+Math.round(g[f].r+L[f].r*y)+","+Math.round(g[f].g+L[f].g*y)+","+Math.round(g[f].b+L[f].b*y)+","+(g[f].a+L[f].a*y)+")");else for(f=0;f<wt;f++)K.push((g[f]||0)+L[f]*y);else N.indexOf(H)!==-1?K="rgba("+Math.round(g.r+L.r*y)+","+Math.round(g.g+L.g*y)+","+Math.round(g.b+L.b*y)+","+(g.a+L.a*y)+")":K=g+L*y;S.setAttr(H,K)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const y=this.node,S=G.attrs[y._id][this._id];S.points&&S.points.trueEnd&&y.setAttr("points",S.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const y=this.node,S=G.attrs[y._id][this._id];S.points&&S.points.trueStart&&y.points(S.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(y){return this.tween.seek(y*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const y=this.node._id,S=this._id,R=G.tweens[y];this.pause(),this.anim&&this.anim.stop();for(const H in R)delete G.tweens[y][H];delete G.attrs[y][S],G.tweens[y]&&(Object.keys(G.tweens[y]).length===0&&delete G.tweens[y],Object.keys(G.attrs[y]).length===0&&delete G.attrs[y])}}b.Tween=G,G.attrs={},G.tweens={},et.Node.prototype.to=function(d){const y=d.onFinish;d.node=this,d.onFinish=function(){this.destroy(),y&&y()},new G(d).play()},b.Easings={BackEaseIn(d,y,S,R){return S*(d/=R)*d*((1.70158+1)*d-1.70158)+y},BackEaseOut(d,y,S,R){return S*((d=d/R-1)*d*((1.70158+1)*d+1.70158)+1)+y},BackEaseInOut(d,y,S,R){let H=1.70158;return(d/=R/2)<1?S/2*(d*d*(((H*=1.525)+1)*d-H))+y:S/2*((d-=2)*d*(((H*=1.525)+1)*d+H)+2)+y},ElasticEaseIn(d,y,S,R,H,P){let g=0;return d===0?y:(d/=R)===1?y+S:(P||(P=R*.3),!H||H<Math.abs(S)?(H=S,g=P/4):g=P/(2*Math.PI)*Math.asin(S/H),-(H*Math.pow(2,10*(d-=1))*Math.sin((d*R-g)*(2*Math.PI)/P))+y)},ElasticEaseOut(d,y,S,R,H,P){let g=0;return d===0?y:(d/=R)===1?y+S:(P||(P=R*.3),!H||H<Math.abs(S)?(H=S,g=P/4):g=P/(2*Math.PI)*Math.asin(S/H),H*Math.pow(2,-10*d)*Math.sin((d*R-g)*(2*Math.PI)/P)+S+y)},ElasticEaseInOut(d,y,S,R,H,P){let g=0;return d===0?y:(d/=R/2)===2?y+S:(P||(P=R*(.3*1.5)),!H||H<Math.abs(S)?(H=S,g=P/4):g=P/(2*Math.PI)*Math.asin(S/H),d<1?-.5*(H*Math.pow(2,10*(d-=1))*Math.sin((d*R-g)*(2*Math.PI)/P))+y:H*Math.pow(2,-10*(d-=1))*Math.sin((d*R-g)*(2*Math.PI)/P)*.5+S+y)},BounceEaseOut(d,y,S,R){return(d/=R)<1/2.75?S*(7.5625*d*d)+y:d<2/2.75?S*(7.5625*(d-=1.5/2.75)*d+.75)+y:d<2.5/2.75?S*(7.5625*(d-=2.25/2.75)*d+.9375)+y:S*(7.5625*(d-=2.625/2.75)*d+.984375)+y},BounceEaseIn(d,y,S,R){return S-b.Easings.BounceEaseOut(R-d,0,S,R)+y},BounceEaseInOut(d,y,S,R){return d<R/2?b.Easings.BounceEaseIn(d*2,0,S,R)*.5+y:b.Easings.BounceEaseOut(d*2-R,0,S,R)*.5+S*.5+y},EaseIn(d,y,S,R){return S*(d/=R)*d+y},EaseOut(d,y,S,R){return-S*(d/=R)*(d-2)+y},EaseInOut(d,y,S,R){return(d/=R/2)<1?S/2*d*d+y:-S/2*(--d*(d-2)-1)+y},StrongEaseIn(d,y,S,R){return S*(d/=R)*d*d*d*d+y},StrongEaseOut(d,y,S,R){return S*((d=d/R-1)*d*d*d*d+1)+y},StrongEaseInOut(d,y,S,R){return(d/=R/2)<1?S/2*d*d*d*d*d+y:S/2*((d-=2)*d*d*d*d+2)+y},Linear(d,y,S,R){return S*d/R+y}}})(es)),es}var Rs;function Xa(){return Rs||(Rs=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.Konva=void 0;const W=Oe(),J=ii(),et=si(),z=On(),c=Wa(),O=Ia(),x=Ka(),D=ls(),N=hs(),B=di(),Z=cs(),G=Ya(),d=Ea(),y=Rn();b.Konva=J.Util._assign(W.Konva,{Util:J.Util,Transform:J.Transform,Node:et.Node,Container:z.Container,Stage:c.Stage,stages:c.stages,Layer:O.Layer,FastLayer:x.FastLayer,Group:D.Group,DD:N.DD,Shape:B.Shape,shapes:B.shapes,Animation:Z.Animation,Tween:G.Tween,Easings:G.Easings,Context:d.Context,Canvas:y.Canvas}),b.default=b.Konva})(Yn)),Yn}var Er={},Os;function Za(){if(Os)return Er;Os=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.Arc=void 0;const b=Ne(),W=di(),J=Oe(),et=De(),z=Oe();let c=class extends W.Shape{_sceneFunc(x){const D=J.Konva.getAngle(this.angle()),N=this.clockwise();x.beginPath(),x.arc(0,0,this.outerRadius(),0,D,N),x.arc(0,0,this.innerRadius(),D,0,!N),x.closePath(),x.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(x){this.outerRadius(x/2)}setHeight(x){this.outerRadius(x/2)}getSelfRect(){const x=this.innerRadius(),D=this.outerRadius(),N=this.clockwise(),B=J.Konva.getAngle(N?360-this.angle():this.angle()),Z=Math.cos(Math.min(B,Math.PI)),G=1,d=Math.sin(Math.min(Math.max(Math.PI,B),3*Math.PI/2)),y=Math.sin(Math.min(B,Math.PI/2)),S=Z*(Z>0?x:D),R=G*D,H=d*(d>0?x:D),P=y*(y>0?D:x);return{x:S,y:N?-1*P:H,width:R-S,height:P-H}}};return Er.Arc=c,c.prototype._centroid=!0,c.prototype.className="Arc",c.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,z._registerNode)(c),b.Factory.addGetterSetter(c,"innerRadius",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"outerRadius",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"angle",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"clockwise",!1,(0,et.getBooleanValidator)()),Er}var Tr={},Ir={},Ns;function Ra(){if(Ns)return Ir;Ns=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Line=void 0;const b=Ne(),W=Oe(),J=di(),et=De();function z(x,D,N,B,Z,G,d){const y=Math.sqrt(Math.pow(N-x,2)+Math.pow(B-D,2)),S=Math.sqrt(Math.pow(Z-N,2)+Math.pow(G-B,2)),R=d*y/(y+S),H=d*S/(y+S),P=N-R*(Z-x),g=B-R*(G-D),L=N+H*(Z-x),K=B+H*(G-D);return[P,g,L,K]}function c(x,D){const N=x.length,B=[];for(let Z=2;Z<N-2;Z+=2){const G=z(x[Z-2],x[Z-1],x[Z],x[Z+1],x[Z+2],x[Z+3],D);isNaN(G[0])||(B.push(G[0]),B.push(G[1]),B.push(x[Z]),B.push(x[Z+1]),B.push(G[2]),B.push(G[3]))}return B}let O=class extends J.Shape{constructor(D){super(D),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(D){const N=this.points(),B=N.length,Z=this.tension(),G=this.closed(),d=this.bezier();if(!B)return;let y=0;if(D.beginPath(),D.moveTo(N[0],N[1]),Z!==0&&B>4){const S=this.getTensionPoints(),R=S.length;for(y=G?0:4,G||D.quadraticCurveTo(S[0],S[1],S[2],S[3]);y<R-2;)D.bezierCurveTo(S[y++],S[y++],S[y++],S[y++],S[y++],S[y++]);G||D.quadraticCurveTo(S[R-2],S[R-1],N[B-2],N[B-1])}else if(d)for(y=2;y<B;)D.bezierCurveTo(N[y++],N[y++],N[y++],N[y++],N[y++],N[y++]);else for(y=2;y<B;y+=2)D.lineTo(N[y],N[y+1]);G?(D.closePath(),D.fillStrokeShape(this)):D.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():c(this.points(),this.tension())}_getTensionPointsClosed(){const D=this.points(),N=D.length,B=this.tension(),Z=z(D[N-2],D[N-1],D[0],D[1],D[2],D[3],B),G=z(D[N-4],D[N-3],D[N-2],D[N-1],D[0],D[1],B),d=c(D,B);return[Z[2],Z[3]].concat(d).concat([G[0],G[1],D[N-2],D[N-1],G[2],G[3],Z[0],Z[1],D[0],D[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let D=this.points();if(D.length<4)return{x:D[0]||0,y:D[1]||0,width:0,height:0};this.tension()!==0?D=[D[0],D[1],...this._getTensionPoints(),D[D.length-2],D[D.length-1]]:D=this.points();let N=D[0],B=D[0],Z=D[1],G=D[1],d,y;for(let S=0;S<D.length/2;S++)d=D[S*2],y=D[S*2+1],N=Math.min(N,d),B=Math.max(B,d),Z=Math.min(Z,y),G=Math.max(G,y);return{x:N,y:Z,width:B-N,height:G-Z}}};return Ir.Line=O,O.prototype.className="Line",O.prototype._attrsAffectingSize=["points","bezier","tension"],(0,W._registerNode)(O),b.Factory.addGetterSetter(O,"closed",!1),b.Factory.addGetterSetter(O,"bezier",!1),b.Factory.addGetterSetter(O,"tension",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(O,"points",[],(0,et.getNumberArrayValidator)()),Ir}var Rr={},is={},Ls;function Qa(){return Ls||(Ls=1,(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.t2length=b.getQuadraticArcLength=b.getCubicArcLength=b.binomialCoefficients=b.cValues=b.tValues=void 0,b.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],b.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],b.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const W=(O,x,D)=>{let N,B;const G=D/2;N=0;for(let d=0;d<20;d++)B=G*b.tValues[20][d]+G,N+=b.cValues[20][d]*et(O,x,B);return G*N};b.getCubicArcLength=W;const J=(O,x,D)=>{D===void 0&&(D=1);const N=O[0]-2*O[1]+O[2],B=x[0]-2*x[1]+x[2],Z=2*O[1]-2*O[0],G=2*x[1]-2*x[0],d=4*(N*N+B*B),y=4*(N*Z+B*G),S=Z*Z+G*G;if(d===0)return D*Math.sqrt(Math.pow(O[2]-O[0],2)+Math.pow(x[2]-x[0],2));const R=y/(2*d),H=S/d,P=D+R,g=H-R*R,L=P*P+g>0?Math.sqrt(P*P+g):0,K=R*R+g>0?Math.sqrt(R*R+g):0,f=R+Math.sqrt(R*R+g)!==0?g*Math.log(Math.abs((P+L)/(R+K))):0;return Math.sqrt(d)/2*(P*L-R*K+f)};b.getQuadraticArcLength=J;function et(O,x,D){const N=z(1,D,O),B=z(1,D,x),Z=N*N+B*B;return Math.sqrt(Z)}const z=(O,x,D)=>{const N=D.length-1;let B,Z;if(N===0)return 0;if(O===0){Z=0;for(let G=0;G<=N;G++)Z+=b.binomialCoefficients[N][G]*Math.pow(1-x,N-G)*Math.pow(x,G)*D[G];return Z}else{B=new Array(N);for(let G=0;G<N;G++)B[G]=N*(D[G+1]-D[G]);return z(O-1,x,B)}},c=(O,x,D)=>{let N=1,B=O/x,Z=(O-D(B))/x,G=0;for(;N>.001;){const d=D(B+Z),y=Math.abs(O-d)/x;if(y<N)N=y,B+=Z;else{const S=D(B-Z),R=Math.abs(O-S)/x;R<N?(N=R,B-=Z):Z/=2}if(G++,G>500)break}return B};b.t2length=c})(is)),is}var Ms;function fs(){if(Ms)return Rr;Ms=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.Path=void 0;const b=Ne(),W=Oe(),J=di(),et=Qa();let z=class Ai extends J.Shape{constructor(O){super(O),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ai.parsePathData(this.data()),this.pathLength=Ai.getPathLength(this.dataArray)}_sceneFunc(O){const x=this.dataArray;O.beginPath();let D=!1;for(let N=0;N<x.length;N++){const B=x[N].command,Z=x[N].points;switch(B){case"L":O.lineTo(Z[0],Z[1]);break;case"M":O.moveTo(Z[0],Z[1]);break;case"C":O.bezierCurveTo(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]);break;case"Q":O.quadraticCurveTo(Z[0],Z[1],Z[2],Z[3]);break;case"A":const G=Z[0],d=Z[1],y=Z[2],S=Z[3],R=Z[4],H=Z[5],P=Z[6],g=Z[7],L=y>S?y:S,K=y>S?1:y/S,f=y>S?S/y:1;O.translate(G,d),O.rotate(P),O.scale(K,f),O.arc(0,0,L,R,R+H,1-g),O.scale(1/K,1/f),O.rotate(-P),O.translate(-G,-d);break;case"z":D=!0,O.closePath();break}}!D&&!this.hasFill()?O.strokeShape(this):O.fillStrokeShape(this)}getSelfRect(){let O=[];this.dataArray.forEach(function(d){if(d.command==="A"){const y=d.points[4],S=d.points[5],R=d.points[4]+S;let H=Math.PI/180;if(Math.abs(y-R)<H&&(H=Math.abs(y-R)),S<0)for(let P=y-H;P>R;P-=H){const g=Ai.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],P,0);O.push(g.x,g.y)}else for(let P=y+H;P<R;P+=H){const g=Ai.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],P,0);O.push(g.x,g.y)}}else if(d.command==="C")for(let y=0;y<=1;y+=.01){const S=Ai.getPointOnCubicBezier(y,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3],d.points[4],d.points[5]);O.push(S.x,S.y)}else O=O.concat(d.points)});let x=O[0],D=O[0],N=O[1],B=O[1],Z,G;for(let d=0;d<O.length/2;d++)Z=O[d*2],G=O[d*2+1],isNaN(Z)||(x=Math.min(x,Z),D=Math.max(D,Z)),isNaN(G)||(N=Math.min(N,G),B=Math.max(B,G));return{x,y:N,width:D-x,height:B-N}}getLength(){return this.pathLength}getPointAtLength(O){return Ai.getPointAtLengthOfDataArray(O,this.dataArray)}static getLineLength(O,x,D,N){return Math.sqrt((D-O)*(D-O)+(N-x)*(N-x))}static getPathLength(O){let x=0;for(let D=0;D<O.length;++D)x+=O[D].pathLength;return x}static getPointAtLengthOfDataArray(O,x){let D,N=0,B=x.length;if(!B)return null;for(;N<B&&O>x[N].pathLength;)O-=x[N].pathLength,++N;if(N===B)return D=x[N-1].points.slice(-2),{x:D[0],y:D[1]};if(O<.01)return x[N].command==="M"?(D=x[N].points.slice(0,2),{x:D[0],y:D[1]}):{x:x[N].start.x,y:x[N].start.y};const Z=x[N],G=Z.points;switch(Z.command){case"L":return Ai.getPointOnLine(O,Z.start.x,Z.start.y,G[0],G[1]);case"C":return Ai.getPointOnCubicBezier((0,et.t2length)(O,Ai.getPathLength(x),L=>(0,et.getCubicArcLength)([Z.start.x,G[0],G[2],G[4]],[Z.start.y,G[1],G[3],G[5]],L)),Z.start.x,Z.start.y,G[0],G[1],G[2],G[3],G[4],G[5]);case"Q":return Ai.getPointOnQuadraticBezier((0,et.t2length)(O,Ai.getPathLength(x),L=>(0,et.getQuadraticArcLength)([Z.start.x,G[0],G[2]],[Z.start.y,G[1],G[3]],L)),Z.start.x,Z.start.y,G[0],G[1],G[2],G[3]);case"A":const d=G[0],y=G[1],S=G[2],R=G[3],H=G[5],P=G[6];let g=G[4];return g+=H*O/Z.pathLength,Ai.getPointOnEllipticalArc(d,y,S,R,g,P)}return null}static getPointOnLine(O,x,D,N,B,Z,G){Z=Z??x,G=G??D;const d=this.getLineLength(x,D,N,B);if(d<1e-10)return{x,y:D};if(N===x)return{x:Z,y:G+(B>D?O:-O)};const y=(B-D)/(N-x),S=Math.sqrt(O*O/(1+y*y))*(N<x?-1:1),R=y*S;if(Math.abs(G-D-y*(Z-x))<1e-10)return{x:Z+S,y:G+R};const H=((Z-x)*(N-x)+(G-D)*(B-D))/(d*d),P=x+H*(N-x),g=D+H*(B-D),L=this.getLineLength(Z,G,P,g),K=Math.sqrt(O*O-L*L),f=Math.sqrt(K*K/(1+y*y))*(N<x?-1:1),wt=y*f;return{x:P+f,y:g+wt}}static getPointOnCubicBezier(O,x,D,N,B,Z,G,d,y){function S(K){return K*K*K}function R(K){return 3*K*K*(1-K)}function H(K){return 3*K*(1-K)*(1-K)}function P(K){return(1-K)*(1-K)*(1-K)}const g=d*S(O)+Z*R(O)+N*H(O)+x*P(O),L=y*S(O)+G*R(O)+B*H(O)+D*P(O);return{x:g,y:L}}static getPointOnQuadraticBezier(O,x,D,N,B,Z,G){function d(P){return P*P}function y(P){return 2*P*(1-P)}function S(P){return(1-P)*(1-P)}const R=Z*d(O)+N*y(O)+x*S(O),H=G*d(O)+B*y(O)+D*S(O);return{x:R,y:H}}static getPointOnEllipticalArc(O,x,D,N,B,Z){const G=Math.cos(Z),d=Math.sin(Z),y={x:D*Math.cos(B),y:N*Math.sin(B)};return{x:O+(y.x*G-y.y*d),y:x+(y.x*d+y.y*G)}}static parsePathData(O){if(!O)return[];let x=O;const D=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];x=x.replace(new RegExp(" ","g"),",");for(let R=0;R<D.length;R++)x=x.replace(new RegExp(D[R],"g"),"|"+D[R]);const N=x.split("|"),B=[],Z=[];let G=0,d=0;const y=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let S;for(let R=1;R<N.length;R++){let H=N[R],P=H.charAt(0);for(H=H.slice(1),Z.length=0;S=y.exec(H);)Z.push(S[0]);const g=[];for(let L=0,K=Z.length;L<K;L++){if(Z[L]==="00"){g.push(0,0);continue}const f=parseFloat(Z[L]);isNaN(f)?g.push(0):g.push(f)}for(;g.length>0&&!isNaN(g[0]);){let L="",K=[];const f=G,wt=d;let it,rt,st,gt,St,It,Pt,Tt,Nt,Q;switch(P){case"l":G+=g.shift(),d+=g.shift(),L="L",K.push(G,d);break;case"L":G=g.shift(),d=g.shift(),K.push(G,d);break;case"m":const at=g.shift(),ct=g.shift();if(G+=at,d+=ct,L="M",B.length>2&&B[B.length-1].command==="z"){for(let dt=B.length-2;dt>=0;dt--)if(B[dt].command==="M"){G=B[dt].points[0]+at,d=B[dt].points[1]+ct;break}}K.push(G,d),P="l";break;case"M":G=g.shift(),d=g.shift(),L="M",K.push(G,d),P="L";break;case"h":G+=g.shift(),L="L",K.push(G,d);break;case"H":G=g.shift(),L="L",K.push(G,d);break;case"v":d+=g.shift(),L="L",K.push(G,d);break;case"V":d=g.shift(),L="L",K.push(G,d);break;case"C":K.push(g.shift(),g.shift(),g.shift(),g.shift()),G=g.shift(),d=g.shift(),K.push(G,d);break;case"c":K.push(G+g.shift(),d+g.shift(),G+g.shift(),d+g.shift()),G+=g.shift(),d+=g.shift(),L="C",K.push(G,d);break;case"S":rt=G,st=d,it=B[B.length-1],it.command==="C"&&(rt=G+(G-it.points[2]),st=d+(d-it.points[3])),K.push(rt,st,g.shift(),g.shift()),G=g.shift(),d=g.shift(),L="C",K.push(G,d);break;case"s":rt=G,st=d,it=B[B.length-1],it.command==="C"&&(rt=G+(G-it.points[2]),st=d+(d-it.points[3])),K.push(rt,st,G+g.shift(),d+g.shift()),G+=g.shift(),d+=g.shift(),L="C",K.push(G,d);break;case"Q":K.push(g.shift(),g.shift()),G=g.shift(),d=g.shift(),K.push(G,d);break;case"q":K.push(G+g.shift(),d+g.shift()),G+=g.shift(),d+=g.shift(),L="Q",K.push(G,d);break;case"T":rt=G,st=d,it=B[B.length-1],it.command==="Q"&&(rt=G+(G-it.points[0]),st=d+(d-it.points[1])),G=g.shift(),d=g.shift(),L="Q",K.push(rt,st,G,d);break;case"t":rt=G,st=d,it=B[B.length-1],it.command==="Q"&&(rt=G+(G-it.points[0]),st=d+(d-it.points[1])),G+=g.shift(),d+=g.shift(),L="Q",K.push(rt,st,G,d);break;case"A":gt=g.shift(),St=g.shift(),It=g.shift(),Pt=g.shift(),Tt=g.shift(),Nt=G,Q=d,G=g.shift(),d=g.shift(),L="A",K=this.convertEndpointToCenterParameterization(Nt,Q,G,d,Pt,Tt,gt,St,It);break;case"a":gt=g.shift(),St=g.shift(),It=g.shift(),Pt=g.shift(),Tt=g.shift(),Nt=G,Q=d,G+=g.shift(),d+=g.shift(),L="A",K=this.convertEndpointToCenterParameterization(Nt,Q,G,d,Pt,Tt,gt,St,It);break}B.push({command:L||P,points:K,start:{x:f,y:wt},pathLength:this.calcLength(f,wt,L||P,K)})}(P==="z"||P==="Z")&&B.push({command:"z",points:[],start:void 0,pathLength:0})}return B}static calcLength(O,x,D,N){let B,Z,G,d;const y=Ai;switch(D){case"L":return y.getLineLength(O,x,N[0],N[1]);case"C":return(0,et.getCubicArcLength)([O,N[0],N[2],N[4]],[x,N[1],N[3],N[5]],1);case"Q":return(0,et.getQuadraticArcLength)([O,N[0],N[2]],[x,N[1],N[3]],1);case"A":B=0;const S=N[4],R=N[5],H=N[4]+R;let P=Math.PI/180;if(Math.abs(S-H)<P&&(P=Math.abs(S-H)),Z=y.getPointOnEllipticalArc(N[0],N[1],N[2],N[3],S,0),R<0)for(d=S-P;d>H;d-=P)G=y.getPointOnEllipticalArc(N[0],N[1],N[2],N[3],d,0),B+=y.getLineLength(Z.x,Z.y,G.x,G.y),Z=G;else for(d=S+P;d<H;d+=P)G=y.getPointOnEllipticalArc(N[0],N[1],N[2],N[3],d,0),B+=y.getLineLength(Z.x,Z.y,G.x,G.y),Z=G;return G=y.getPointOnEllipticalArc(N[0],N[1],N[2],N[3],H,0),B+=y.getLineLength(Z.x,Z.y,G.x,G.y),B}return 0}static convertEndpointToCenterParameterization(O,x,D,N,B,Z,G,d,y){const S=y*(Math.PI/180),R=Math.cos(S)*(O-D)/2+Math.sin(S)*(x-N)/2,H=-1*Math.sin(S)*(O-D)/2+Math.cos(S)*(x-N)/2,P=R*R/(G*G)+H*H/(d*d);P>1&&(G*=Math.sqrt(P),d*=Math.sqrt(P));let g=Math.sqrt((G*G*(d*d)-G*G*(H*H)-d*d*(R*R))/(G*G*(H*H)+d*d*(R*R)));B===Z&&(g*=-1),isNaN(g)&&(g=0);const L=g*G*H/d,K=g*-d*R/G,f=(O+D)/2+Math.cos(S)*L-Math.sin(S)*K,wt=(x+N)/2+Math.sin(S)*L+Math.cos(S)*K,it=function(Tt){return Math.sqrt(Tt[0]*Tt[0]+Tt[1]*Tt[1])},rt=function(Tt,Nt){return(Tt[0]*Nt[0]+Tt[1]*Nt[1])/(it(Tt)*it(Nt))},st=function(Tt,Nt){return(Tt[0]*Nt[1]<Tt[1]*Nt[0]?-1:1)*Math.acos(rt(Tt,Nt))},gt=st([1,0],[(R-L)/G,(H-K)/d]),St=[(R-L)/G,(H-K)/d],It=[(-1*R-L)/G,(-1*H-K)/d];let Pt=st(St,It);return rt(St,It)<=-1&&(Pt=Math.PI),rt(St,It)>=1&&(Pt=0),Z===0&&Pt>0&&(Pt=Pt-2*Math.PI),Z===1&&Pt<0&&(Pt=Pt+2*Math.PI),[f,wt,G,d,gt,Pt,S,Z]}};return Rr.Path=z,z.prototype.className="Path",z.prototype._attrsAffectingSize=["data"],(0,W._registerNode)(z),b.Factory.addGetterSetter(z,"data"),Rr}var Fs;function Ja(){if(Fs)return Tr;Fs=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Arrow=void 0;const b=Ne(),W=Ra(),J=De(),et=Oe(),z=fs();let c=class extends W.Line{_sceneFunc(x){super._sceneFunc(x);const D=Math.PI*2,N=this.points();let B=N;const Z=this.tension()!==0&&N.length>4;Z&&(B=this.getTensionPoints());const G=this.pointerLength(),d=N.length;let y,S;if(Z){const P=[B[B.length-4],B[B.length-3],B[B.length-2],B[B.length-1],N[d-2],N[d-1]],g=z.Path.calcLength(B[B.length-4],B[B.length-3],"C",P),L=z.Path.getPointOnQuadraticBezier(Math.min(1,1-G/g),P[0],P[1],P[2],P[3],P[4],P[5]);y=N[d-2]-L.x,S=N[d-1]-L.y}else y=N[d-2]-N[d-4],S=N[d-1]-N[d-3];const R=(Math.atan2(S,y)+D)%D,H=this.pointerWidth();this.pointerAtEnding()&&(x.save(),x.beginPath(),x.translate(N[d-2],N[d-1]),x.rotate(R),x.moveTo(0,0),x.lineTo(-G,H/2),x.lineTo(-G,-H/2),x.closePath(),x.restore(),this.__fillStroke(x)),this.pointerAtBeginning()&&(x.save(),x.beginPath(),x.translate(N[0],N[1]),Z?(y=(B[0]+B[2])/2-N[0],S=(B[1]+B[3])/2-N[1]):(y=N[2]-N[0],S=N[3]-N[1]),x.rotate((Math.atan2(-S,-y)+D)%D),x.moveTo(0,0),x.lineTo(-G,H/2),x.lineTo(-G,-H/2),x.closePath(),x.restore(),this.__fillStroke(x))}__fillStroke(x){const D=this.dashEnabled();D&&(this.attrs.dashEnabled=!1,x.setLineDash([])),x.fillStrokeShape(this),D&&(this.attrs.dashEnabled=!0)}getSelfRect(){const x=super.getSelfRect(),D=this.pointerWidth()/2;return{x:x.x,y:x.y-D,width:x.width,height:x.height+D*2}}};return Tr.Arrow=c,c.prototype.className="Arrow",(0,et._registerNode)(c),b.Factory.addGetterSetter(c,"pointerLength",10,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(c,"pointerWidth",10,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(c,"pointerAtBeginning",!1),b.Factory.addGetterSetter(c,"pointerAtEnding",!0),Tr}var Or={},Ds;function $a(){if(Ds)return Or;Ds=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.Circle=void 0;const b=Ne(),W=di(),J=De(),et=Oe();let z=class extends W.Shape{_sceneFunc(O){O.beginPath(),O.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),O.closePath(),O.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(O){this.radius()!==O/2&&this.radius(O/2)}setHeight(O){this.radius()!==O/2&&this.radius(O/2)}};return Or.Circle=z,z.prototype._centroid=!0,z.prototype.className="Circle",z.prototype._attrsAffectingSize=["radius"],(0,et._registerNode)(z),b.Factory.addGetterSetter(z,"radius",0,(0,J.getNumberValidator)()),Or}var Nr={},Bs;function to(){if(Bs)return Nr;Bs=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.Ellipse=void 0;const b=Ne(),W=di(),J=De(),et=Oe();let z=class extends W.Shape{_sceneFunc(O){const x=this.radiusX(),D=this.radiusY();O.beginPath(),O.save(),x!==D&&O.scale(1,D/x),O.arc(0,0,x,0,Math.PI*2,!1),O.restore(),O.closePath(),O.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(O){this.radiusX(O/2)}setHeight(O){this.radiusY(O/2)}};return Nr.Ellipse=z,z.prototype.className="Ellipse",z.prototype._centroid=!0,z.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,et._registerNode)(z),b.Factory.addComponentsGetterSetter(z,"radius",["x","y"]),b.Factory.addGetterSetter(z,"radiusX",0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(z,"radiusY",0,(0,J.getNumberValidator)()),Nr}var Lr={},Vs;function eo(){if(Vs)return Lr;Vs=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.Image=void 0;const b=ii(),W=Ne(),J=di(),et=Oe(),z=De();let c=class Oa extends J.Shape{constructor(x){super(x),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",D=>{this._removeImageLoad(D.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const x=this.image();x&&x.complete||x&&x.readyState===4||x&&x.addEventListener&&x.addEventListener("load",this._loadListener)}_removeImageLoad(x){x&&x.removeEventListener&&x.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const x=!!this.cornerRadius(),D=this.hasShadow();return x&&D?!0:super._useBufferCanvas(!0)}_sceneFunc(x){const D=this.getWidth(),N=this.getHeight(),B=this.cornerRadius(),Z=this.attrs.image;let G;if(Z){const d=this.attrs.cropWidth,y=this.attrs.cropHeight;d&&y?G=[Z,this.cropX(),this.cropY(),d,y,0,0,D,N]:G=[Z,0,0,D,N]}(this.hasFill()||this.hasStroke()||B)&&(x.beginPath(),B?b.Util.drawRoundedRectPath(x,D,N,B):x.rect(0,0,D,N),x.closePath(),x.fillStrokeShape(this)),Z&&(B&&x.clip(),x.drawImage.apply(x,G))}_hitFunc(x){const D=this.width(),N=this.height(),B=this.cornerRadius();x.beginPath(),B?b.Util.drawRoundedRectPath(x,D,N,B):x.rect(0,0,D,N),x.closePath(),x.fillStrokeShape(this)}getWidth(){var x,D;return(x=this.attrs.width)!==null&&x!==void 0?x:(D=this.image())===null||D===void 0?void 0:D.width}getHeight(){var x,D;return(x=this.attrs.height)!==null&&x!==void 0?x:(D=this.image())===null||D===void 0?void 0:D.height}static fromURL(x,D,N=null){const B=b.Util.createImageElement();B.onload=function(){const Z=new Oa({image:B});D(Z)},B.onerror=N,B.crossOrigin="Anonymous",B.src=x}};return Lr.Image=c,c.prototype.className="Image",(0,et._registerNode)(c),W.Factory.addGetterSetter(c,"cornerRadius",0,(0,z.getNumberOrArrayOfNumbersValidator)(4)),W.Factory.addGetterSetter(c,"image"),W.Factory.addComponentsGetterSetter(c,"crop",["x","y","width","height"]),W.Factory.addGetterSetter(c,"cropX",0,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(c,"cropY",0,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(c,"cropWidth",0,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(c,"cropHeight",0,(0,z.getNumberValidator)()),Lr}var ur={},Gs;function io(){if(Gs)return ur;Gs=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.Tag=ur.Label=void 0;const b=Ne(),W=di(),J=ls(),et=De(),z=Oe(),c=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],O="Change.konva",x="none",D="up",N="right",B="down",Z="left",G=c.length;let d=class extends J.Group{constructor(R){super(R),this.on("add.konva",function(H){this._addListeners(H.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(R){let H=this,P;const g=function(){H._sync()};for(P=0;P<G;P++)R.on(c[P]+O,g)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let R=this.getText(),H=this.getTag(),P,g,L,K,f,wt,it;if(R&&H){switch(P=R.width(),g=R.height(),L=H.pointerDirection(),K=H.pointerWidth(),it=H.pointerHeight(),f=0,wt=0,L){case D:f=P/2,wt=-1*it;break;case N:f=P+K,wt=g/2;break;case B:f=P/2,wt=g+it;break;case Z:f=-1*K,wt=g/2;break}H.setAttrs({x:-1*f,y:-1*wt,width:P,height:g}),R.setAttrs({x:-1*f,y:-1*wt})}}};ur.Label=d,d.prototype.className="Label",(0,z._registerNode)(d);class y extends W.Shape{_sceneFunc(R){const H=this.width(),P=this.height(),g=this.pointerDirection(),L=this.pointerWidth(),K=this.pointerHeight(),f=this.cornerRadius();let wt=0,it=0,rt=0,st=0;typeof f=="number"?wt=it=rt=st=Math.min(f,H/2,P/2):(wt=Math.min(f[0]||0,H/2,P/2),it=Math.min(f[1]||0,H/2,P/2),st=Math.min(f[2]||0,H/2,P/2),rt=Math.min(f[3]||0,H/2,P/2)),R.beginPath(),R.moveTo(wt,0),g===D&&(R.lineTo((H-L)/2,0),R.lineTo(H/2,-1*K),R.lineTo((H+L)/2,0)),R.lineTo(H-it,0),R.arc(H-it,it,it,Math.PI*3/2,0,!1),g===N&&(R.lineTo(H,(P-K)/2),R.lineTo(H+L,P/2),R.lineTo(H,(P+K)/2)),R.lineTo(H,P-st),R.arc(H-st,P-st,st,0,Math.PI/2,!1),g===B&&(R.lineTo((H+L)/2,P),R.lineTo(H/2,P+K),R.lineTo((H-L)/2,P)),R.lineTo(rt,P),R.arc(rt,P-rt,rt,Math.PI/2,Math.PI,!1),g===Z&&(R.lineTo(0,(P+K)/2),R.lineTo(-1*L,P/2),R.lineTo(0,(P-K)/2)),R.lineTo(0,wt),R.arc(wt,wt,wt,Math.PI,Math.PI*3/2,!1),R.closePath(),R.fillStrokeShape(this)}getSelfRect(){let R=0,H=0,P=this.pointerWidth(),g=this.pointerHeight(),L=this.pointerDirection(),K=this.width(),f=this.height();return L===D?(H-=g,f+=g):L===B?f+=g:L===Z?(R-=P*1.5,K+=P):L===N&&(K+=P*1.5),{x:R,y:H,width:K,height:f}}}return ur.Tag=y,y.prototype.className="Tag",(0,z._registerNode)(y),b.Factory.addGetterSetter(y,"pointerDirection",x),b.Factory.addGetterSetter(y,"pointerWidth",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(y,"pointerHeight",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(y,"cornerRadius",0,(0,et.getNumberOrArrayOfNumbersValidator)(4)),ur}var Mr={},Us;function Na(){if(Us)return Mr;Us=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Rect=void 0;const b=Ne(),W=di(),J=Oe(),et=ii(),z=De();let c=class extends W.Shape{_sceneFunc(x){const D=this.cornerRadius(),N=this.width(),B=this.height();x.beginPath(),D?et.Util.drawRoundedRectPath(x,N,B,D):x.rect(0,0,N,B),x.closePath(),x.fillStrokeShape(this)}};return Mr.Rect=c,c.prototype.className="Rect",(0,J._registerNode)(c),b.Factory.addGetterSetter(c,"cornerRadius",0,(0,z.getNumberOrArrayOfNumbersValidator)(4)),Mr}var Fr={},zs;function ro(){if(zs)return Fr;zs=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.RegularPolygon=void 0;const b=Ne(),W=di(),J=De(),et=Oe();let z=class extends W.Shape{_sceneFunc(O){const x=this._getPoints();O.beginPath(),O.moveTo(x[0].x,x[0].y);for(let D=1;D<x.length;D++)O.lineTo(x[D].x,x[D].y);O.closePath(),O.fillStrokeShape(this)}_getPoints(){const O=this.attrs.sides,x=this.attrs.radius||0,D=[];for(let N=0;N<O;N++)D.push({x:x*Math.sin(N*2*Math.PI/O),y:-1*x*Math.cos(N*2*Math.PI/O)});return D}getSelfRect(){const O=this._getPoints();let x=O[0].x,D=O[0].y,N=O[0].x,B=O[0].y;return O.forEach(Z=>{x=Math.min(x,Z.x),D=Math.max(D,Z.x),N=Math.min(N,Z.y),B=Math.max(B,Z.y)}),{x,y:N,width:D-x,height:B-N}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(O){this.radius(O/2)}setHeight(O){this.radius(O/2)}};return Fr.RegularPolygon=z,z.prototype.className="RegularPolygon",z.prototype._centroid=!0,z.prototype._attrsAffectingSize=["radius"],(0,et._registerNode)(z),b.Factory.addGetterSetter(z,"radius",0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(z,"sides",0,(0,J.getNumberValidator)()),Fr}var Dr={},Hs;function no(){if(Hs)return Dr;Hs=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.Ring=void 0;const b=Ne(),W=di(),J=De(),et=Oe(),z=Math.PI*2;let c=class extends W.Shape{_sceneFunc(x){x.beginPath(),x.arc(0,0,this.innerRadius(),0,z,!1),x.moveTo(this.outerRadius(),0),x.arc(0,0,this.outerRadius(),z,0,!0),x.closePath(),x.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(x){this.outerRadius(x/2)}setHeight(x){this.outerRadius(x/2)}};return Dr.Ring=c,c.prototype.className="Ring",c.prototype._centroid=!0,c.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,et._registerNode)(c),b.Factory.addGetterSetter(c,"innerRadius",0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(c,"outerRadius",0,(0,J.getNumberValidator)()),Dr}var Br={},js;function so(){if(js)return Br;js=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.Sprite=void 0;const b=Ne(),W=di(),J=cs(),et=De(),z=Oe();let c=class extends W.Shape{constructor(x){super(x),this._updated=!0,this.anim=new J.Animation(()=>{const D=this._updated;return this._updated=!1,D}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(x){const D=this.animation(),N=this.frameIndex(),B=N*4,Z=this.animations()[D],G=this.frameOffsets(),d=Z[B+0],y=Z[B+1],S=Z[B+2],R=Z[B+3],H=this.image();if((this.hasFill()||this.hasStroke())&&(x.beginPath(),x.rect(0,0,S,R),x.closePath(),x.fillStrokeShape(this)),H)if(G){const P=G[D],g=N*2;x.drawImage(H,d,y,S,R,P[g+0],P[g+1],S,R)}else x.drawImage(H,d,y,S,R,0,0,S,R)}_hitFunc(x){const D=this.animation(),N=this.frameIndex(),B=N*4,Z=this.animations()[D],G=this.frameOffsets(),d=Z[B+2],y=Z[B+3];if(x.beginPath(),G){const S=G[D],R=N*2;x.rect(S[R+0],S[R+1],d,y)}else x.rect(0,0,d,y);x.closePath(),x.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const x=this;this.interval=setInterval(function(){x._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const x=this.getLayer();this.anim.setLayers(x),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const x=this.frameIndex(),D=this.animation(),N=this.animations(),B=N[D],Z=B.length/4;x<Z-1?this.frameIndex(x+1):this.frameIndex(0)}};return Br.Sprite=c,c.prototype.className="Sprite",(0,z._registerNode)(c),b.Factory.addGetterSetter(c,"animation"),b.Factory.addGetterSetter(c,"animations"),b.Factory.addGetterSetter(c,"frameOffsets"),b.Factory.addGetterSetter(c,"image"),b.Factory.addGetterSetter(c,"frameIndex",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"frameRate",17,(0,et.getNumberValidator)()),b.Factory.backCompat(c,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Br}var Vr={},qs;function ao(){if(qs)return Vr;qs=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Star=void 0;const b=Ne(),W=di(),J=De(),et=Oe();let z=class extends W.Shape{_sceneFunc(O){const x=this.innerRadius(),D=this.outerRadius(),N=this.numPoints();O.beginPath(),O.moveTo(0,0-D);for(let B=1;B<N*2;B++){const Z=B%2===0?D:x,G=Z*Math.sin(B*Math.PI/N),d=-1*Z*Math.cos(B*Math.PI/N);O.lineTo(G,d)}O.closePath(),O.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(O){this.outerRadius(O/2)}setHeight(O){this.outerRadius(O/2)}};return Vr.Star=z,z.prototype.className="Star",z.prototype._centroid=!0,z.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,et._registerNode)(z),b.Factory.addGetterSetter(z,"numPoints",5,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(z,"innerRadius",0,(0,J.getNumberValidator)()),b.Factory.addGetterSetter(z,"outerRadius",0,(0,J.getNumberValidator)()),Vr}var pr={},Ws;function La(){if(Ws)return pr;Ws=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.Text=void 0,pr.stringToArray=O;const b=ii(),W=Ne(),J=di(),et=Oe(),z=De(),c=Oe();function O(Ut){return[...Ut].reduce((Ot,Kt,Xt,Vt)=>{if(new RegExp("\\p{Emoji}","u").test(Kt)){const mt=Vt[Xt+1];mt&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(mt)?(Ot.push(Kt+mt),Vt[Xt+1]=""):Ot.push(Kt)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(Kt+(Vt[Xt+1]||""))?Ot.push(Kt+Vt[Xt+1]):Xt>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(Kt)?Ot[Ot.length-1]+=Kt:Kt&&Ot.push(Kt);return Ot},[])}const x="auto",D="center",N="inherit",B="justify",Z="Change.konva",G="2d",d="-",y="left",S="text",R="Text",H="top",P="bottom",g="middle",L="normal",K="px ",f=" ",wt="right",it="rtl",rt="word",st="char",gt="none",St="",It=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Pt=It.length;function Tt(Ut){return Ut.split(",").map(Ot=>{Ot=Ot.trim();const Kt=Ot.indexOf(" ")>=0,Xt=Ot.indexOf('"')>=0||Ot.indexOf("'")>=0;return Kt&&!Xt&&(Ot=`"${Ot}"`),Ot}).join(", ")}let Nt;function Q(){return Nt||(Nt=b.Util.createCanvasElement().getContext(G),Nt)}function at(Ut){Ut.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ct(Ut){Ut.setAttr("miterLimit",2),Ut.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function dt(Ut){return Ut=Ut||{},!Ut.fillLinearGradientColorStops&&!Ut.fillRadialGradientColorStops&&!Ut.fillPatternImage&&(Ut.fill=Ut.fill||"black"),Ut}let Ct=class extends J.Shape{constructor(Ot){super(dt(Ot)),this._partialTextX=0,this._partialTextY=0;for(let Kt=0;Kt<Pt;Kt++)this.on(It[Kt]+Z,this._setTextData);this._setTextData()}_sceneFunc(Ot){const Kt=this.textArr,Xt=Kt.length;if(!this.text())return;let Vt=this.padding(),mt=this.fontSize(),Dt=this.lineHeight()*mt,Wt=this.verticalAlign(),Qt=this.direction(),re=0,be=this.align(),ce=this.getWidth(),we=this.letterSpacing(),ge=this.fill(),Ze=this.textDecoration(),Re=Ze.indexOf("underline")!==-1,Ue=Ze.indexOf("line-through")!==-1,_i;Qt=Qt===N?Ot.direction:Qt;let ti=Dt/2,Ve=g;if(et.Konva._fixTextRendering){const Le=this.measureSize("M");Ve="alphabetic",ti=(Le.fontBoundingBoxAscent-Le.fontBoundingBoxDescent)/2+Dt/2}for(Qt===it&&Ot.setAttr("direction",Qt),Ot.setAttr("font",this._getContextFont()),Ot.setAttr("textBaseline",Ve),Ot.setAttr("textAlign",y),Wt===g?re=(this.getHeight()-Xt*Dt-Vt*2)/2:Wt===P&&(re=this.getHeight()-Xt*Dt-Vt*2),Ot.translate(Vt,re+Vt),_i=0;_i<Xt;_i++){let Le=0,Ae=0;const Qe=Kt[_i],_e=Qe.text,t=Qe.width,e=Qe.lastInParagraph;if(Ot.save(),be===wt?Le+=ce-t-Vt*2:be===D&&(Le+=(ce-t-Vt*2)/2),Re){Ot.save(),Ot.beginPath();const r=et.Konva._fixTextRendering?Math.round(mt/4):Math.round(mt/2),n=Le,s=ti+Ae+r;Ot.moveTo(n,s);const u=be===B&&!e?ce-Vt*2:t;Ot.lineTo(n+Math.round(u),s),Ot.lineWidth=mt/15;const h=this._getLinearGradient();Ot.strokeStyle=h||ge,Ot.stroke(),Ot.restore()}if(Ue){Ot.save(),Ot.beginPath();const r=et.Konva._fixTextRendering?-Math.round(mt/4):0;Ot.moveTo(Le,ti+Ae+r);const n=be===B&&!e?ce-Vt*2:t;Ot.lineTo(Le+Math.round(n),ti+Ae+r),Ot.lineWidth=mt/15;const s=this._getLinearGradient();Ot.strokeStyle=s||ge,Ot.stroke(),Ot.restore()}if(Qt!==it&&(we!==0||be===B)){const r=_e.split(" ").length-1,n=O(_e);for(let s=0;s<n.length;s++){const u=n[s];u===" "&&!e&&be===B&&(Le+=(ce-Vt*2-t)/r),this._partialTextX=Le,this._partialTextY=ti+Ae,this._partialText=u,Ot.fillStrokeShape(this),Le+=this.measureSize(u).width+we}}else we!==0&&Ot.setAttr("letterSpacing",`${we}px`),this._partialTextX=Le,this._partialTextY=ti+Ae,this._partialText=_e,Ot.fillStrokeShape(this);Ot.restore(),Xt>1&&(ti+=Dt)}}_hitFunc(Ot){const Kt=this.getWidth(),Xt=this.getHeight();Ot.beginPath(),Ot.rect(0,0,Kt,Xt),Ot.closePath(),Ot.fillStrokeShape(this)}setText(Ot){const Kt=b.Util._isString(Ot)?Ot:Ot==null?"":Ot+"";return this._setAttr(S,Kt),this}getWidth(){return this.attrs.width===x||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===x||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return b.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(Ot){var Kt,Xt,Vt,mt,Dt,Wt,Qt,re,be,ce,we;let ge=Q(),Ze=this.fontSize(),Re;ge.save(),ge.font=this._getContextFont(),Re=ge.measureText(Ot),ge.restore();const Ue=Ze/100;return{actualBoundingBoxAscent:(Kt=Re.actualBoundingBoxAscent)!==null&&Kt!==void 0?Kt:71.58203125*Ue,actualBoundingBoxDescent:(Xt=Re.actualBoundingBoxDescent)!==null&&Xt!==void 0?Xt:0,actualBoundingBoxLeft:(Vt=Re.actualBoundingBoxLeft)!==null&&Vt!==void 0?Vt:-7.421875*Ue,actualBoundingBoxRight:(mt=Re.actualBoundingBoxRight)!==null&&mt!==void 0?mt:75.732421875*Ue,alphabeticBaseline:(Dt=Re.alphabeticBaseline)!==null&&Dt!==void 0?Dt:0,emHeightAscent:(Wt=Re.emHeightAscent)!==null&&Wt!==void 0?Wt:100*Ue,emHeightDescent:(Qt=Re.emHeightDescent)!==null&&Qt!==void 0?Qt:-20*Ue,fontBoundingBoxAscent:(re=Re.fontBoundingBoxAscent)!==null&&re!==void 0?re:91*Ue,fontBoundingBoxDescent:(be=Re.fontBoundingBoxDescent)!==null&&be!==void 0?be:21*Ue,hangingBaseline:(ce=Re.hangingBaseline)!==null&&ce!==void 0?ce:72.80000305175781*Ue,ideographicBaseline:(we=Re.ideographicBaseline)!==null&&we!==void 0?we:-21*Ue,width:Re.width,height:Ze}}_getContextFont(){return this.fontStyle()+f+this.fontVariant()+f+(this.fontSize()+K)+Tt(this.fontFamily())}_addTextLine(Ot){this.align()===B&&(Ot=Ot.trim());const Xt=this._getTextWidth(Ot);return this.textArr.push({text:Ot,width:Xt,lastInParagraph:!1})}_getTextWidth(Ot){const Kt=this.letterSpacing(),Xt=Ot.length;return Q().measureText(Ot).width+Kt*Xt}_setTextData(){let Ot=this.text().split(`
`),Kt=+this.fontSize(),Xt=0,Vt=this.lineHeight()*Kt,mt=this.attrs.width,Dt=this.attrs.height,Wt=mt!==x&&mt!==void 0,Qt=Dt!==x&&Dt!==void 0,re=this.padding(),be=mt-re*2,ce=Dt-re*2,we=0,ge=this.wrap(),Ze=ge!==gt,Re=ge!==st&&Ze,Ue=this.ellipsis();this.textArr=[],Q().font=this._getContextFont();const _i=Ue?this._getTextWidth(St):0;for(let ti=0,Ve=Ot.length;ti<Ve;++ti){let Le=Ot[ti],Ae=this._getTextWidth(Le);if(Wt&&Ae>be)for(;Le.length>0;){let Qe=0,_e=O(Le).length,t="",e=0;for(;Qe<_e;){const r=Qe+_e>>>1,n=O(Le),s=n.slice(0,r+1).join(""),u=this._getTextWidth(s);(Ue&&Qt&&we+Vt>ce?u+_i:u)<=be?(Qe=r+1,t=s,e=u):_e=r}if(t){if(Re){const s=O(Le),u=O(t),h=s[u.length],l=h===f||h===d;let p;if(l&&e<=be)p=u.length;else{const v=u.lastIndexOf(f),T=u.lastIndexOf(d);p=Math.max(v,T)+1}p>0&&(Qe=p,t=s.slice(0,Qe).join(""),e=this._getTextWidth(t))}if(t=t.trimRight(),this._addTextLine(t),Xt=Math.max(Xt,e),we+=Vt,this._shouldHandleEllipsis(we)){this._tryToAddEllipsisToLastLine();break}if(Le=O(Le).slice(Qe).join("").trimLeft(),Le.length>0&&(Ae=this._getTextWidth(Le),Ae<=be)){this._addTextLine(Le),we+=Vt,Xt=Math.max(Xt,Ae);break}}else break}else this._addTextLine(Le),we+=Vt,Xt=Math.max(Xt,Ae),this._shouldHandleEllipsis(we)&&ti<Ve-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),Qt&&we+Vt>ce)break}this.textHeight=Kt,this.textWidth=Xt}_shouldHandleEllipsis(Ot){const Kt=+this.fontSize(),Xt=this.lineHeight()*Kt,Vt=this.attrs.height,mt=Vt!==x&&Vt!==void 0,Dt=this.padding(),Wt=Vt-Dt*2;return!(this.wrap()!==gt)||mt&&Ot+Xt>Wt}_tryToAddEllipsisToLastLine(){const Ot=this.attrs.width,Kt=Ot!==x&&Ot!==void 0,Xt=this.padding(),Vt=Ot-Xt*2,mt=this.ellipsis(),Dt=this.textArr[this.textArr.length-1];!Dt||!mt||(Kt&&(this._getTextWidth(Dt.text+St)<Vt||(Dt.text=Dt.text.slice(0,Dt.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(Dt.text+St))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const Ot=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Kt=this.hasShadow();return Ot&&Kt?!0:super._useBufferCanvas()}};return pr.Text=Ct,Ct.prototype._fillFunc=at,Ct.prototype._strokeFunc=ct,Ct.prototype.className=R,Ct.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,c._registerNode)(Ct),W.Factory.overWriteSetter(Ct,"width",(0,z.getNumberOrAutoValidator)()),W.Factory.overWriteSetter(Ct,"height",(0,z.getNumberOrAutoValidator)()),W.Factory.addGetterSetter(Ct,"direction",N),W.Factory.addGetterSetter(Ct,"fontFamily","Arial"),W.Factory.addGetterSetter(Ct,"fontSize",12,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(Ct,"fontStyle",L),W.Factory.addGetterSetter(Ct,"fontVariant",L),W.Factory.addGetterSetter(Ct,"padding",0,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(Ct,"align",y),W.Factory.addGetterSetter(Ct,"verticalAlign",H),W.Factory.addGetterSetter(Ct,"lineHeight",1,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(Ct,"wrap",rt),W.Factory.addGetterSetter(Ct,"ellipsis",!1,(0,z.getBooleanValidator)()),W.Factory.addGetterSetter(Ct,"letterSpacing",0,(0,z.getNumberValidator)()),W.Factory.addGetterSetter(Ct,"text","",(0,z.getStringValidator)()),W.Factory.addGetterSetter(Ct,"textDecoration",""),pr}var Gr={},Ks;function oo(){if(Ks)return Gr;Ks=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.TextPath=void 0;const b=ii(),W=Ne(),J=di(),et=fs(),z=La(),c=De(),O=Oe(),x="",D="normal";function N(G){G.fillText(this.partialText,0,0)}function B(G){G.strokeText(this.partialText,0,0)}let Z=class extends J.Shape{constructor(d){super(d),this.dummyCanvas=b.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return et.Path.getPathLength(this.dataArray)}_getPointAtLength(d){if(!this.attrs.data)return null;const y=this.pathLength;return d-1>y?null:et.Path.getPointAtLengthOfDataArray(d,this.dataArray)}_readDataAttribute(){this.dataArray=et.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(d){d.setAttr("font",this._getContextFont()),d.setAttr("textBaseline",this.textBaseline()),d.setAttr("textAlign","left"),d.save();const y=this.textDecoration(),S=this.fill(),R=this.fontSize(),H=this.glyphInfo;y==="underline"&&d.beginPath();for(let P=0;P<H.length;P++){d.save();const g=H[P].p0;d.translate(g.x,g.y),d.rotate(H[P].rotation),this.partialText=H[P].text,d.fillStrokeShape(this),y==="underline"&&(P===0&&d.moveTo(0,R/2+1),d.lineTo(R,R/2+1)),d.restore()}y==="underline"&&(d.strokeStyle=S,d.lineWidth=R/20,d.stroke()),d.restore()}_hitFunc(d){d.beginPath();const y=this.glyphInfo;if(y.length>=1){const S=y[0].p0;d.moveTo(S.x,S.y)}for(let S=0;S<y.length;S++){const R=y[S].p1;d.lineTo(R.x,R.y)}d.setAttr("lineWidth",this.fontSize()),d.setAttr("strokeStyle",this.colorKey),d.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return b.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(d){return z.Text.prototype.setText.call(this,d)}_getContextFont(){return z.Text.prototype._getContextFont.call(this)}_getTextSize(d){const S=this.dummyCanvas.getContext("2d");S.save(),S.font=this._getContextFont();const R=S.measureText(d);return S.restore(),{width:R.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:d,height:y}=this._getTextSize(this.attrs.text);if(this.textWidth=d,this.textHeight=y,this.glyphInfo=[],!this.attrs.data)return null;const S=this.letterSpacing(),R=this.align(),H=this.kerningFunc(),P=Math.max(this.textWidth+((this.attrs.text||"").length-1)*S,0);let g=0;R==="center"&&(g=Math.max(0,this.pathLength/2-P/2)),R==="right"&&(g=Math.max(0,this.pathLength-P));const L=(0,z.stringToArray)(this.text());let K=g;for(let f=0;f<L.length;f++){const wt=this._getPointAtLength(K);if(!wt)return;let it=this._getTextSize(L[f]).width+S;if(L[f]===" "&&R==="justify"){const Pt=this.text().split(" ").length-1;it+=(this.pathLength-P)/Pt}const rt=this._getPointAtLength(K+it);if(!rt)return;const st=et.Path.getLineLength(wt.x,wt.y,rt.x,rt.y);let gt=0;if(H)try{gt=H(L[f-1],L[f])*this.fontSize()}catch{gt=0}wt.x+=gt,rt.x+=gt,this.textWidth+=gt;const St=et.Path.getPointOnLine(gt+st/2,wt.x,wt.y,rt.x,rt.y),It=Math.atan2(rt.y-wt.y,rt.x-wt.x);this.glyphInfo.push({transposeX:St.x,transposeY:St.y,text:L[f],rotation:It,p0:wt,p1:rt}),K+=it}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const d=[];this.glyphInfo.forEach(function(K){d.push(K.p0.x),d.push(K.p0.y),d.push(K.p1.x),d.push(K.p1.y)});let y=d[0]||0,S=d[0]||0,R=d[1]||0,H=d[1]||0,P,g;for(let K=0;K<d.length/2;K++)P=d[K*2],g=d[K*2+1],y=Math.min(y,P),S=Math.max(S,P),R=Math.min(R,g),H=Math.max(H,g);const L=this.fontSize();return{x:y-L/2,y:R-L/2,width:S-y+L,height:H-R+L}}destroy(){return b.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Gr.TextPath=Z,Z.prototype._fillFunc=N,Z.prototype._strokeFunc=B,Z.prototype._fillFuncHit=N,Z.prototype._strokeFuncHit=B,Z.prototype.className="TextPath",Z.prototype._attrsAffectingSize=["text","fontSize","data"],(0,O._registerNode)(Z),W.Factory.addGetterSetter(Z,"data"),W.Factory.addGetterSetter(Z,"fontFamily","Arial"),W.Factory.addGetterSetter(Z,"fontSize",12,(0,c.getNumberValidator)()),W.Factory.addGetterSetter(Z,"fontStyle",D),W.Factory.addGetterSetter(Z,"align","left"),W.Factory.addGetterSetter(Z,"letterSpacing",0,(0,c.getNumberValidator)()),W.Factory.addGetterSetter(Z,"textBaseline","middle"),W.Factory.addGetterSetter(Z,"fontVariant",D),W.Factory.addGetterSetter(Z,"text",x),W.Factory.addGetterSetter(Z,"textDecoration",""),W.Factory.addGetterSetter(Z,"kerningFunc",void 0),Gr}var Ur={},Ys;function uo(){if(Ys)return Ur;Ys=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Transformer=void 0;const b=ii(),W=Ne(),J=si(),et=di(),z=Na(),c=ls(),O=Oe(),x=De(),D=Oe(),N="tr-konva",B=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(it=>it+`.${N}`).join(" "),Z="nodesRect",G=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],d={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},y="ontouchstart"in O.Konva._global;function S(it,rt,st){if(it==="rotater")return st;rt+=b.Util.degToRad(d[it]||0);const gt=(b.Util.radToDeg(rt)%360+360)%360;return b.Util._inRange(gt,315+22.5,360)||b.Util._inRange(gt,0,22.5)?"ns-resize":b.Util._inRange(gt,45-22.5,45+22.5)?"nesw-resize":b.Util._inRange(gt,90-22.5,90+22.5)?"ew-resize":b.Util._inRange(gt,135-22.5,135+22.5)?"nwse-resize":b.Util._inRange(gt,180-22.5,180+22.5)?"ns-resize":b.Util._inRange(gt,225-22.5,225+22.5)?"nesw-resize":b.Util._inRange(gt,270-22.5,270+22.5)?"ew-resize":b.Util._inRange(gt,315-22.5,315+22.5)?"nwse-resize":(b.Util.error("Transformer has unknown angle for cursor detection: "+gt),"pointer")}const R=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function H(it){return{x:it.x+it.width/2*Math.cos(it.rotation)+it.height/2*Math.sin(-it.rotation),y:it.y+it.height/2*Math.cos(it.rotation)+it.width/2*Math.sin(it.rotation)}}function P(it,rt,st){const gt=st.x+(it.x-st.x)*Math.cos(rt)-(it.y-st.y)*Math.sin(rt),St=st.y+(it.x-st.x)*Math.sin(rt)+(it.y-st.y)*Math.cos(rt);return{...it,rotation:it.rotation+rt,x:gt,y:St}}function g(it,rt){const st=H(it);return P(it,rt,st)}function L(it,rt,st){let gt=rt;for(let St=0;St<it.length;St++){const It=O.Konva.getAngle(it[St]),Pt=Math.abs(It-rt)%(Math.PI*2);Math.min(Pt,Math.PI*2-Pt)<st&&(gt=It)}return gt}let K=0,f=class extends c.Group{constructor(rt){super(rt),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(B,this.update),this.getNode()&&this.update()}attachTo(rt){return this.setNode(rt),this}setNode(rt){return b.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([rt])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return N+this._id}setNodes(rt=[]){this._nodes&&this._nodes.length&&this.detach();const st=rt.filter(St=>St.isAncestorOf(this)?(b.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=rt=st,rt.length===1&&this.useSingleNodeRotation()?this.rotation(rt[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(St=>{const It=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(St._attrsAffectingSize.length){const Pt=St._attrsAffectingSize.map(Tt=>Tt+"Change."+this._getEventNamespace()).join(" ");St.on(Pt,It)}St.on(G.map(Pt=>Pt+`.${this._getEventNamespace()}`).join(" "),It),St.on(`absoluteTransformChange.${this._getEventNamespace()}`,It),this._proxyDrag(St)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(rt){let st;rt.on(`dragstart.${this._getEventNamespace()}`,gt=>{st=rt.getAbsolutePosition(),!this.isDragging()&&rt!==this.findOne(".back")&&this.startDrag(gt,!1)}),rt.on(`dragmove.${this._getEventNamespace()}`,gt=>{if(!st)return;const St=rt.getAbsolutePosition(),It=St.x-st.x,Pt=St.y-st.y;this.nodes().forEach(Tt=>{if(Tt===rt||Tt.isDragging())return;const Nt=Tt.getAbsolutePosition();Tt.setAbsolutePosition({x:Nt.x+It,y:Nt.y+Pt}),Tt.startDrag(gt)}),st=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(rt=>{rt.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Z),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Z,this.__getNodeRect)}__getNodeShape(rt,st=this.rotation(),gt){const St=rt.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),It=rt.getAbsoluteScale(gt),Pt=rt.getAbsolutePosition(gt),Tt=St.x*It.x-rt.offsetX()*It.x,Nt=St.y*It.y-rt.offsetY()*It.y,Q=(O.Konva.getAngle(rt.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),at={x:Pt.x+Tt*Math.cos(Q)+Nt*Math.sin(-Q),y:Pt.y+Nt*Math.cos(Q)+Tt*Math.sin(Q),width:St.width*It.x,height:St.height*It.y,rotation:Q};return P(at,-O.Konva.getAngle(st),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const st=[];this.nodes().map(Q=>{const at=Q.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),ct=[{x:at.x,y:at.y},{x:at.x+at.width,y:at.y},{x:at.x+at.width,y:at.y+at.height},{x:at.x,y:at.y+at.height}],dt=Q.getAbsoluteTransform();ct.forEach(function(Ct){const Ut=dt.point(Ct);st.push(Ut)})});const gt=new b.Transform;gt.rotate(-O.Konva.getAngle(this.rotation()));let St=1/0,It=1/0,Pt=-1/0,Tt=-1/0;st.forEach(function(Q){const at=gt.point(Q);St===void 0&&(St=Pt=at.x,It=Tt=at.y),St=Math.min(St,at.x),It=Math.min(It,at.y),Pt=Math.max(Pt,at.x),Tt=Math.max(Tt,at.y)}),gt.invert();const Nt=gt.point({x:St,y:It});return{x:Nt.x,y:Nt.y,width:Pt-St,height:Tt-It,rotation:O.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),R.forEach(rt=>{this._createAnchor(rt)}),this._createAnchor("rotater")}_createAnchor(rt){const st=new z.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:rt+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:y?10:"auto"}),gt=this;st.on("mousedown touchstart",function(St){gt._handleMouseDown(St)}),st.on("dragstart",St=>{st.stopDrag(),St.cancelBubble=!0}),st.on("dragend",St=>{St.cancelBubble=!0}),st.on("mouseenter",()=>{const St=O.Konva.getAngle(this.rotation()),It=this.rotateAnchorCursor(),Pt=S(rt,St,It);st.getStage().content&&(st.getStage().content.style.cursor=Pt),this._cursorChange=!0}),st.on("mouseout",()=>{st.getStage().content&&(st.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(st)}_createBack(){const rt=new et.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(st,gt){const St=gt.getParent(),It=St.padding();st.beginPath(),st.rect(-It,-It,gt.width()+It*2,gt.height()+It*2),st.moveTo(gt.width()/2,-It),St.rotateEnabled()&&St.rotateLineVisible()&&st.lineTo(gt.width()/2,-St.rotateAnchorOffset()*b.Util._sign(gt.height())-It),st.fillStrokeShape(gt)},hitFunc:(st,gt)=>{if(!this.shouldOverdrawWholeArea())return;const St=this.padding();st.beginPath(),st.rect(-St,-St,gt.width()+St*2,gt.height()+St*2),st.fillStrokeShape(gt)}});this.add(rt),this._proxyDrag(rt),rt.on("dragstart",st=>{st.cancelBubble=!0}),rt.on("dragmove",st=>{st.cancelBubble=!0}),rt.on("dragend",st=>{st.cancelBubble=!0}),this.on("dragmove",st=>{this.update()})}_handleMouseDown(rt){if(this._transforming)return;this._movingAnchorName=rt.target.name().split(" ")[0];const st=this._getNodeRect(),gt=st.width,St=st.height,It=Math.sqrt(Math.pow(gt,2)+Math.pow(St,2));this.sin=Math.abs(St/It),this.cos=Math.abs(gt/It),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const Pt=rt.target.getAbsolutePosition(),Tt=rt.target.getStage().getPointerPosition();this._anchorDragOffset={x:Tt.x-Pt.x,y:Tt.y-Pt.y},K++,this._fire("transformstart",{evt:rt.evt,target:this.getNode()}),this._nodes.forEach(Nt=>{Nt._fire("transformstart",{evt:rt.evt,target:Nt})})}_handleMouseMove(rt){let st,gt,St;const It=this.findOne("."+this._movingAnchorName),Pt=It.getStage();Pt.setPointersPositions(rt);const Tt=Pt.getPointerPosition();let Nt={x:Tt.x-this._anchorDragOffset.x,y:Tt.y-this._anchorDragOffset.y};const Q=It.getAbsolutePosition();this.anchorDragBoundFunc()&&(Nt=this.anchorDragBoundFunc()(Q,Nt,rt)),It.setAbsolutePosition(Nt);const at=It.getAbsolutePosition();if(Q.x===at.x&&Q.y===at.y)return;if(this._movingAnchorName==="rotater"){const Vt=this._getNodeRect();st=It.x()-Vt.width/2,gt=-It.y()+Vt.height/2;let mt=Math.atan2(-gt,st)+Math.PI/2;Vt.height<0&&(mt-=Math.PI);const Wt=O.Konva.getAngle(this.rotation())+mt,Qt=O.Konva.getAngle(this.rotationSnapTolerance()),be=L(this.rotationSnaps(),Wt,Qt)-Vt.rotation,ce=g(Vt,be);this._fitNodesInto(ce,rt);return}const ct=this.shiftBehavior();let dt;ct==="inverted"?dt=this.keepRatio()&&!rt.shiftKey:ct==="none"?dt=this.keepRatio():dt=this.keepRatio()||rt.shiftKey;let Ct=this.centeredScaling()||rt.altKey;if(this._movingAnchorName==="top-left"){if(dt){const Vt=Ct?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};St=Math.sqrt(Math.pow(Vt.x-It.x(),2)+Math.pow(Vt.y-It.y(),2));const mt=this.findOne(".top-left").x()>Vt.x?-1:1,Dt=this.findOne(".top-left").y()>Vt.y?-1:1;st=St*this.cos*mt,gt=St*this.sin*Dt,this.findOne(".top-left").x(Vt.x-st),this.findOne(".top-left").y(Vt.y-gt)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(It.y());else if(this._movingAnchorName==="top-right"){if(dt){const Vt=Ct?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};St=Math.sqrt(Math.pow(It.x()-Vt.x,2)+Math.pow(Vt.y-It.y(),2));const mt=this.findOne(".top-right").x()<Vt.x?-1:1,Dt=this.findOne(".top-right").y()>Vt.y?-1:1;st=St*this.cos*mt,gt=St*this.sin*Dt,this.findOne(".top-right").x(Vt.x+st),this.findOne(".top-right").y(Vt.y-gt)}var Ut=It.position();this.findOne(".top-left").y(Ut.y),this.findOne(".bottom-right").x(Ut.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(It.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(It.x());else if(this._movingAnchorName==="bottom-left"){if(dt){const Vt=Ct?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};St=Math.sqrt(Math.pow(Vt.x-It.x(),2)+Math.pow(It.y()-Vt.y,2));const mt=Vt.x<It.x()?-1:1,Dt=It.y()<Vt.y?-1:1;st=St*this.cos*mt,gt=St*this.sin*Dt,It.x(Vt.x-st),It.y(Vt.y+gt)}Ut=It.position(),this.findOne(".top-left").x(Ut.x),this.findOne(".bottom-right").y(Ut.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(It.y());else if(this._movingAnchorName==="bottom-right"){if(dt){const Vt=Ct?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};St=Math.sqrt(Math.pow(It.x()-Vt.x,2)+Math.pow(It.y()-Vt.y,2));const mt=this.findOne(".bottom-right").x()<Vt.x?-1:1,Dt=this.findOne(".bottom-right").y()<Vt.y?-1:1;st=St*this.cos*mt,gt=St*this.sin*Dt,this.findOne(".bottom-right").x(Vt.x+st),this.findOne(".bottom-right").y(Vt.y+gt)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(Ct=this.centeredScaling()||rt.altKey,Ct){const Vt=this.findOne(".top-left"),mt=this.findOne(".bottom-right"),Dt=Vt.x(),Wt=Vt.y(),Qt=this.getWidth()-mt.x(),re=this.getHeight()-mt.y();mt.move({x:-Dt,y:-Wt}),Vt.move({x:Qt,y:re})}const Ot=this.findOne(".top-left").getAbsolutePosition();st=Ot.x,gt=Ot.y;const Kt=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),Xt=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:st,y:gt,width:Kt,height:Xt,rotation:O.Konva.getAngle(this.rotation())},rt)}_handleMouseUp(rt){this._removeEvents(rt)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(rt){var st;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const gt=this.getNode();K--,this._fire("transformend",{evt:rt,target:gt}),(st=this.getLayer())===null||st===void 0||st.batchDraw(),gt&&this._nodes.forEach(St=>{var It;St._fire("transformend",{evt:rt,target:St}),(It=St.getLayer())===null||It===void 0||It.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(rt,st){const gt=this._getNodeRect(),St=1;if(b.Util._inRange(rt.width,-this.padding()*2-St,St)){this.update();return}if(b.Util._inRange(rt.height,-this.padding()*2-St,St)){this.update();return}const It=new b.Transform;if(It.rotate(O.Konva.getAngle(this.rotation())),this._movingAnchorName&&rt.width<0&&this._movingAnchorName.indexOf("left")>=0){const dt=It.point({x:-this.padding()*2,y:0});rt.x+=dt.x,rt.y+=dt.y,rt.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=dt.x,this._anchorDragOffset.y-=dt.y}else if(this._movingAnchorName&&rt.width<0&&this._movingAnchorName.indexOf("right")>=0){const dt=It.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=dt.x,this._anchorDragOffset.y-=dt.y,rt.width+=this.padding()*2}if(this._movingAnchorName&&rt.height<0&&this._movingAnchorName.indexOf("top")>=0){const dt=It.point({x:0,y:-this.padding()*2});rt.x+=dt.x,rt.y+=dt.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=dt.x,this._anchorDragOffset.y-=dt.y,rt.height+=this.padding()*2}else if(this._movingAnchorName&&rt.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const dt=It.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=dt.x,this._anchorDragOffset.y-=dt.y,rt.height+=this.padding()*2}if(this.boundBoxFunc()){const dt=this.boundBoxFunc()(gt,rt);dt?rt=dt:b.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const Pt=1e7,Tt=new b.Transform;Tt.translate(gt.x,gt.y),Tt.rotate(gt.rotation),Tt.scale(gt.width/Pt,gt.height/Pt);const Nt=new b.Transform,Q=rt.width/Pt,at=rt.height/Pt;this.flipEnabled()===!1?(Nt.translate(rt.x,rt.y),Nt.rotate(rt.rotation),Nt.translate(rt.width<0?rt.width:0,rt.height<0?rt.height:0),Nt.scale(Math.abs(Q),Math.abs(at))):(Nt.translate(rt.x,rt.y),Nt.rotate(rt.rotation),Nt.scale(Q,at));const ct=Nt.multiply(Tt.invert());this._nodes.forEach(dt=>{var Ct;const Ut=dt.getParent().getAbsoluteTransform(),Ot=dt.getTransform().copy();Ot.translate(dt.offsetX(),dt.offsetY());const Kt=new b.Transform;Kt.multiply(Ut.copy().invert()).multiply(ct).multiply(Ut).multiply(Ot);const Xt=Kt.decompose();dt.setAttrs(Xt),(Ct=dt.getLayer())===null||Ct===void 0||Ct.batchDraw()}),this.rotation(b.Util._getRotation(rt.rotation)),this._nodes.forEach(dt=>{this._fire("transform",{evt:st,target:dt}),dt._fire("transform",{evt:st,target:dt})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(rt,st){this.findOne(rt).setAttrs(st)}update(){var rt;const st=this._getNodeRect();this.rotation(b.Util._getRotation(st.rotation));const gt=st.width,St=st.height,It=this.enabledAnchors(),Pt=this.resizeEnabled(),Tt=this.padding(),Nt=this.anchorSize(),Q=this.find("._anchor");Q.forEach(ct=>{ct.setAttrs({width:Nt,height:Nt,offsetX:Nt/2,offsetY:Nt/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:Nt/2+Tt,offsetY:Nt/2+Tt,visible:Pt&&It.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:gt/2,y:0,offsetY:Nt/2+Tt,visible:Pt&&It.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:gt,y:0,offsetX:Nt/2-Tt,offsetY:Nt/2+Tt,visible:Pt&&It.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:St/2,offsetX:Nt/2+Tt,visible:Pt&&It.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:gt,y:St/2,offsetX:Nt/2-Tt,visible:Pt&&It.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:St,offsetX:Nt/2+Tt,offsetY:Nt/2-Tt,visible:Pt&&It.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:gt/2,y:St,offsetY:Nt/2-Tt,visible:Pt&&It.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:gt,y:St,offsetX:Nt/2-Tt,offsetY:Nt/2-Tt,visible:Pt&&It.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:gt/2,y:-this.rotateAnchorOffset()*b.Util._sign(St)-Tt,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:gt,height:St,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const at=this.anchorStyleFunc();at&&Q.forEach(ct=>{at(ct)}),(rt=this.getLayer())===null||rt===void 0||rt.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const rt=this.findOne("."+this._movingAnchorName);rt&&rt.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),c.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return J.Node.prototype.toObject.call(this)}clone(rt){return J.Node.prototype.clone.call(this,rt)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ur.Transformer=f,f.isTransforming=()=>K>0;function wt(it){return it instanceof Array||b.Util.warn("enabledAnchors value should be an array"),it instanceof Array&&it.forEach(function(rt){R.indexOf(rt)===-1&&b.Util.warn("Unknown anchor name: "+rt+". Available names are: "+R.join(", "))}),it||[]}return f.prototype.className="Transformer",(0,D._registerNode)(f),W.Factory.addGetterSetter(f,"enabledAnchors",R,wt),W.Factory.addGetterSetter(f,"flipEnabled",!0,(0,x.getBooleanValidator)()),W.Factory.addGetterSetter(f,"resizeEnabled",!0),W.Factory.addGetterSetter(f,"anchorSize",10,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"rotateEnabled",!0),W.Factory.addGetterSetter(f,"rotateLineVisible",!0),W.Factory.addGetterSetter(f,"rotationSnaps",[]),W.Factory.addGetterSetter(f,"rotateAnchorOffset",50,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"rotateAnchorCursor","crosshair"),W.Factory.addGetterSetter(f,"rotationSnapTolerance",5,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"borderEnabled",!0),W.Factory.addGetterSetter(f,"anchorStroke","rgb(0, 161, 255)"),W.Factory.addGetterSetter(f,"anchorStrokeWidth",1,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"anchorFill","white"),W.Factory.addGetterSetter(f,"anchorCornerRadius",0,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"borderStroke","rgb(0, 161, 255)"),W.Factory.addGetterSetter(f,"borderStrokeWidth",1,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"borderDash"),W.Factory.addGetterSetter(f,"keepRatio",!0),W.Factory.addGetterSetter(f,"shiftBehavior","default"),W.Factory.addGetterSetter(f,"centeredScaling",!1),W.Factory.addGetterSetter(f,"ignoreStroke",!1),W.Factory.addGetterSetter(f,"padding",0,(0,x.getNumberValidator)()),W.Factory.addGetterSetter(f,"nodes"),W.Factory.addGetterSetter(f,"node"),W.Factory.addGetterSetter(f,"boundBoxFunc"),W.Factory.addGetterSetter(f,"anchorDragBoundFunc"),W.Factory.addGetterSetter(f,"anchorStyleFunc"),W.Factory.addGetterSetter(f,"shouldOverdrawWholeArea",!1),W.Factory.addGetterSetter(f,"useSingleNodeRotation",!0),W.Factory.backCompat(f,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Ur}var zr={},Xs;function ho(){if(Xs)return zr;Xs=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.Wedge=void 0;const b=Ne(),W=di(),J=Oe(),et=De(),z=Oe();let c=class extends W.Shape{_sceneFunc(x){x.beginPath(),x.arc(0,0,this.radius(),0,J.Konva.getAngle(this.angle()),this.clockwise()),x.lineTo(0,0),x.closePath(),x.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(x){this.radius(x/2)}setHeight(x){this.radius(x/2)}};return zr.Wedge=c,c.prototype.className="Wedge",c.prototype._centroid=!0,c.prototype._attrsAffectingSize=["radius"],(0,z._registerNode)(c),b.Factory.addGetterSetter(c,"radius",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"angle",0,(0,et.getNumberValidator)()),b.Factory.addGetterSetter(c,"clockwise",!1),b.Factory.backCompat(c,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),zr}var Hr={},Zs;function lo(){if(Zs)return Hr;Zs=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.Blur=void 0;const b=Ne(),W=si(),J=De();function et(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const z=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],c=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function O(D,N){const B=D.data,Z=D.width,G=D.height;let d,y,S,R,H,P,g,L,K,f,wt,it,rt,st,gt,St,It,Pt,Tt,Nt;const Q=N+N+1,at=Z-1,ct=G-1,dt=N+1,Ct=dt*(dt+1)/2,Ut=new et,Ot=z[N],Kt=c[N];let Xt=null,Vt=Ut,mt=null,Dt=null;for(let Wt=1;Wt<Q;Wt++)Vt=Vt.next=new et,Wt===dt&&(Xt=Vt);Vt.next=Ut,S=y=0;for(let Wt=0;Wt<G;Wt++){it=rt=st=gt=R=H=P=g=0,L=dt*(St=B[y]),K=dt*(It=B[y+1]),f=dt*(Pt=B[y+2]),wt=dt*(Tt=B[y+3]),R+=Ct*St,H+=Ct*It,P+=Ct*Pt,g+=Ct*Tt,Vt=Ut;for(let Qt=0;Qt<dt;Qt++)Vt.r=St,Vt.g=It,Vt.b=Pt,Vt.a=Tt,Vt=Vt.next;for(let Qt=1;Qt<dt;Qt++)d=y+((at<Qt?at:Qt)<<2),R+=(Vt.r=St=B[d])*(Nt=dt-Qt),H+=(Vt.g=It=B[d+1])*Nt,P+=(Vt.b=Pt=B[d+2])*Nt,g+=(Vt.a=Tt=B[d+3])*Nt,it+=St,rt+=It,st+=Pt,gt+=Tt,Vt=Vt.next;mt=Ut,Dt=Xt;for(let Qt=0;Qt<Z;Qt++)B[y+3]=Tt=g*Ot>>Kt,Tt!==0?(Tt=255/Tt,B[y]=(R*Ot>>Kt)*Tt,B[y+1]=(H*Ot>>Kt)*Tt,B[y+2]=(P*Ot>>Kt)*Tt):B[y]=B[y+1]=B[y+2]=0,R-=L,H-=K,P-=f,g-=wt,L-=mt.r,K-=mt.g,f-=mt.b,wt-=mt.a,d=S+((d=Qt+N+1)<at?d:at)<<2,it+=mt.r=B[d],rt+=mt.g=B[d+1],st+=mt.b=B[d+2],gt+=mt.a=B[d+3],R+=it,H+=rt,P+=st,g+=gt,mt=mt.next,L+=St=Dt.r,K+=It=Dt.g,f+=Pt=Dt.b,wt+=Tt=Dt.a,it-=St,rt-=It,st-=Pt,gt-=Tt,Dt=Dt.next,y+=4;S+=Z}for(let Wt=0;Wt<Z;Wt++){rt=st=gt=it=H=P=g=R=0,y=Wt<<2,L=dt*(St=B[y]),K=dt*(It=B[y+1]),f=dt*(Pt=B[y+2]),wt=dt*(Tt=B[y+3]),R+=Ct*St,H+=Ct*It,P+=Ct*Pt,g+=Ct*Tt,Vt=Ut;for(let re=0;re<dt;re++)Vt.r=St,Vt.g=It,Vt.b=Pt,Vt.a=Tt,Vt=Vt.next;let Qt=Z;for(let re=1;re<=N;re++)y=Qt+Wt<<2,R+=(Vt.r=St=B[y])*(Nt=dt-re),H+=(Vt.g=It=B[y+1])*Nt,P+=(Vt.b=Pt=B[y+2])*Nt,g+=(Vt.a=Tt=B[y+3])*Nt,it+=St,rt+=It,st+=Pt,gt+=Tt,Vt=Vt.next,re<ct&&(Qt+=Z);y=Wt,mt=Ut,Dt=Xt;for(let re=0;re<G;re++)d=y<<2,B[d+3]=Tt=g*Ot>>Kt,Tt>0?(Tt=255/Tt,B[d]=(R*Ot>>Kt)*Tt,B[d+1]=(H*Ot>>Kt)*Tt,B[d+2]=(P*Ot>>Kt)*Tt):B[d]=B[d+1]=B[d+2]=0,R-=L,H-=K,P-=f,g-=wt,L-=mt.r,K-=mt.g,f-=mt.b,wt-=mt.a,d=Wt+((d=re+dt)<ct?d:ct)*Z<<2,R+=it+=mt.r=B[d],H+=rt+=mt.g=B[d+1],P+=st+=mt.b=B[d+2],g+=gt+=mt.a=B[d+3],mt=mt.next,L+=St=Dt.r,K+=It=Dt.g,f+=Pt=Dt.b,wt+=Tt=Dt.a,it-=St,rt-=It,st-=Pt,gt-=Tt,Dt=Dt.next,y+=Z}}const x=function(N){const B=Math.round(this.blurRadius());B>0&&O(N,B)};return Hr.Blur=x,b.Factory.addGetterSetter(W.Node,"blurRadius",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),Hr}var jr={},Qs;function co(){if(Qs)return jr;Qs=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.Brighten=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=this.brightness()*255,O=z.data,x=O.length;for(let D=0;D<x;D+=4)O[D]+=c,O[D+1]+=c,O[D+2]+=c};return jr.Brighten=et,b.Factory.addGetterSetter(W.Node,"brightness",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),jr}var qr={},Js;function fo(){if(Js)return qr;Js=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Contrast=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=Math.pow((this.contrast()+100)/100,2),O=z.data,x=O.length;let D=150,N=150,B=150;for(let Z=0;Z<x;Z+=4)D=O[Z],N=O[Z+1],B=O[Z+2],D/=255,D-=.5,D*=c,D+=.5,D*=255,N/=255,N-=.5,N*=c,N+=.5,N*=255,B/=255,B-=.5,B*=c,B+=.5,B*=255,D=D<0?0:D>255?255:D,N=N<0?0:N>255?255:N,B=B<0?0:B>255?255:B,O[Z]=D,O[Z+1]=N,O[Z+2]=B};return qr.Contrast=et,b.Factory.addGetterSetter(W.Node,"contrast",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),qr}var Wr={},$s;function po(){if($s)return Wr;$s=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Emboss=void 0;const b=Ne(),W=si(),J=ii(),et=De(),z=function(c){const O=this.embossStrength()*10,x=this.embossWhiteLevel()*255,D=this.embossDirection(),N=this.embossBlend(),B=c.data,Z=c.width,G=c.height,d=Z*4;let y=0,S=0,R=G;switch(D){case"top-left":y=-1,S=-1;break;case"top":y=-1,S=0;break;case"top-right":y=-1,S=1;break;case"right":y=0,S=1;break;case"bottom-right":y=1,S=1;break;case"bottom":y=1,S=0;break;case"bottom-left":y=1,S=-1;break;case"left":y=0,S=-1;break;default:J.Util.error("Unknown emboss direction: "+D)}do{const H=(R-1)*d;let P=y;R+P<1&&(P=0),R+P>G&&(P=0);const g=(R-1+P)*Z*4;let L=Z;do{const K=H+(L-1)*4;let f=S;L+f<1&&(f=0),L+f>Z&&(f=0);const wt=g+(L-1+f)*4,it=B[K]-B[wt],rt=B[K+1]-B[wt+1],st=B[K+2]-B[wt+2];let gt=it;const St=gt>0?gt:-gt,It=rt>0?rt:-rt,Pt=st>0?st:-st;if(It>St&&(gt=rt),Pt>St&&(gt=st),gt*=O,N){const Tt=B[K]+gt,Nt=B[K+1]+gt,Q=B[K+2]+gt;B[K]=Tt>255?255:Tt<0?0:Tt,B[K+1]=Nt>255?255:Nt<0?0:Nt,B[K+2]=Q>255?255:Q<0?0:Q}else{let Tt=x-gt;Tt<0?Tt=0:Tt>255&&(Tt=255),B[K]=B[K+1]=B[K+2]=Tt}}while(--L)}while(--R)};return Wr.Emboss=z,b.Factory.addGetterSetter(W.Node,"embossStrength",.5,(0,et.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"embossWhiteLevel",.5,(0,et.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"embossDirection","top-left",void 0,b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"embossBlend",!1,void 0,b.Factory.afterSetFilter),Wr}var Kr={},ta;function go(){if(ta)return Kr;ta=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.Enhance=void 0;const b=Ne(),W=si(),J=De();function et(c,O,x,D,N){const B=x-O,Z=N-D;if(B===0)return D+Z/2;if(Z===0)return D;let G=(c-O)/B;return G=Z*G+D,G}const z=function(c){const O=c.data,x=O.length;let D=O[0],N=D,B,Z=O[1],G=Z,d,y=O[2],S=y,R;const H=this.enhance();if(H===0)return;for(let it=0;it<x;it+=4)B=O[it+0],B<D?D=B:B>N&&(N=B),d=O[it+1],d<Z?Z=d:d>G&&(G=d),R=O[it+2],R<y?y=R:R>S&&(S=R);N===D&&(N=255,D=0),G===Z&&(G=255,Z=0),S===y&&(S=255,y=0);let P,g,L,K,f,wt;if(H>0)P=N+H*(255-N),g=D-H*(D-0),L=G+H*(255-G),K=Z-H*(Z-0),f=S+H*(255-S),wt=y-H*(y-0);else{const it=(N+D)*.5;P=N+H*(N-it),g=D+H*(D-it);const rt=(G+Z)*.5;L=G+H*(G-rt),K=Z+H*(Z-rt);const st=(S+y)*.5;f=S+H*(S-st),wt=y+H*(y-st)}for(let it=0;it<x;it+=4)O[it+0]=et(O[it+0],D,N,g,P),O[it+1]=et(O[it+1],Z,G,K,L),O[it+2]=et(O[it+2],y,S,wt,f)};return Kr.Enhance=z,b.Factory.addGetterSetter(W.Node,"enhance",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),Kr}var Yr={},ea;function _o(){if(ea)return Yr;ea=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.Grayscale=void 0;const b=function(W){const J=W.data,et=J.length;for(let z=0;z<et;z+=4){const c=.34*J[z]+.5*J[z+1]+.16*J[z+2];J[z]=c,J[z+1]=c,J[z+2]=c}};return Yr.Grayscale=b,Yr}var Xr={},ia;function vo(){if(ia)return Xr;ia=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.HSL=void 0;const b=Ne(),W=si(),J=De();b.Factory.addGetterSetter(W.Node,"hue",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"saturation",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"luminance",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter);const et=function(z){const c=z.data,O=c.length,x=1,D=Math.pow(2,this.saturation()),N=Math.abs(this.hue()+360)%360,B=this.luminance()*127,Z=x*D*Math.cos(N*Math.PI/180),G=x*D*Math.sin(N*Math.PI/180),d=.299*x+.701*Z+.167*G,y=.587*x-.587*Z+.33*G,S=.114*x-.114*Z-.497*G,R=.299*x-.299*Z-.328*G,H=.587*x+.413*Z+.035*G,P=.114*x-.114*Z+.293*G,g=.299*x-.3*Z+1.25*G,L=.587*x-.586*Z-1.05*G,K=.114*x+.886*Z-.2*G;let f,wt,it,rt;for(let st=0;st<O;st+=4)f=c[st+0],wt=c[st+1],it=c[st+2],rt=c[st+3],c[st+0]=d*f+y*wt+S*it+B,c[st+1]=R*f+H*wt+P*it+B,c[st+2]=g*f+L*wt+K*it+B,c[st+3]=rt};return Xr.HSL=et,Xr}var Zr={},ra;function mo(){if(ra)return Zr;ra=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.HSV=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=z.data,O=c.length,x=Math.pow(2,this.value()),D=Math.pow(2,this.saturation()),N=Math.abs(this.hue()+360)%360,B=x*D*Math.cos(N*Math.PI/180),Z=x*D*Math.sin(N*Math.PI/180),G=.299*x+.701*B+.167*Z,d=.587*x-.587*B+.33*Z,y=.114*x-.114*B-.497*Z,S=.299*x-.299*B-.328*Z,R=.587*x+.413*B+.035*Z,H=.114*x-.114*B+.293*Z,P=.299*x-.3*B+1.25*Z,g=.587*x-.586*B-1.05*Z,L=.114*x+.886*B-.2*Z;for(let K=0;K<O;K+=4){const f=c[K+0],wt=c[K+1],it=c[K+2],rt=c[K+3];c[K+0]=G*f+d*wt+y*it,c[K+1]=S*f+R*wt+H*it,c[K+2]=P*f+g*wt+L*it,c[K+3]=rt}};return Zr.HSV=et,b.Factory.addGetterSetter(W.Node,"hue",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"saturation",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"value",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),Zr}var Qr={},na;function yo(){if(na)return Qr;na=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.Invert=void 0;const b=function(W){const J=W.data,et=J.length;for(let z=0;z<et;z+=4)J[z]=255-J[z],J[z+1]=255-J[z+1],J[z+2]=255-J[z+2]};return Qr.Invert=b,Qr}var Jr={},sa;function bo(){if(sa)return Jr;sa=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.Kaleidoscope=void 0;const b=Ne(),W=si(),J=ii(),et=De(),z=function(x,D,N){const B=x.data,Z=D.data,G=x.width,d=x.height,y=N.polarCenterX||G/2,S=N.polarCenterY||d/2;let R=Math.sqrt(y*y+S*S),H=G-y,P=d-S;const g=Math.sqrt(H*H+P*P);R=g>R?g:R;const L=d,K=G,f=360/K*Math.PI/180;for(let wt=0;wt<K;wt+=1){const it=Math.sin(wt*f),rt=Math.cos(wt*f);for(let st=0;st<L;st+=1){H=Math.floor(y+R*st/L*rt),P=Math.floor(S+R*st/L*it);let gt=(P*G+H)*4;const St=B[gt+0],It=B[gt+1],Pt=B[gt+2],Tt=B[gt+3];gt=(wt+st*G)*4,Z[gt+0]=St,Z[gt+1]=It,Z[gt+2]=Pt,Z[gt+3]=Tt}}},c=function(x,D,N){const B=x.data,Z=D.data,G=x.width,d=x.height,y=N.polarCenterX||G/2,S=N.polarCenterY||d/2;let R=Math.sqrt(y*y+S*S),H=G-y,P=d-S;const g=Math.sqrt(H*H+P*P);R=g>R?g:R;const L=d,K=G,f=0;let wt,it;for(H=0;H<G;H+=1)for(P=0;P<d;P+=1){const rt=H-y,st=P-S,gt=Math.sqrt(rt*rt+st*st)*L/R;let St=(Math.atan2(st,rt)*180/Math.PI+360+f)%360;St=St*K/360,wt=Math.floor(St),it=Math.floor(gt);let It=(it*G+wt)*4;const Pt=B[It+0],Tt=B[It+1],Nt=B[It+2],Q=B[It+3];It=(P*G+H)*4,Z[It+0]=Pt,Z[It+1]=Tt,Z[It+2]=Nt,Z[It+3]=Q}},O=function(x){const D=x.width,N=x.height;let B,Z,G,d,y,S,R,H,P,g,L=Math.round(this.kaleidoscopePower());const K=Math.round(this.kaleidoscopeAngle()),f=Math.floor(D*(K%360)/360);if(L<1)return;const wt=J.Util.createCanvasElement();wt.width=D,wt.height=N;const it=wt.getContext("2d").getImageData(0,0,D,N);J.Util.releaseCanvas(wt),z(x,it,{polarCenterX:D/2,polarCenterY:N/2});let rt=D/Math.pow(2,L);for(;rt<=8;)rt=rt*2,L-=1;rt=Math.ceil(rt);let st=rt,gt=0,St=st,It=1;for(f+rt>D&&(gt=st,St=0,It=-1),Z=0;Z<N;Z+=1)for(B=gt;B!==St;B+=It)G=Math.round(B+f)%D,P=(D*Z+G)*4,y=it.data[P+0],S=it.data[P+1],R=it.data[P+2],H=it.data[P+3],g=(D*Z+B)*4,it.data[g+0]=y,it.data[g+1]=S,it.data[g+2]=R,it.data[g+3]=H;for(Z=0;Z<N;Z+=1)for(st=Math.floor(rt),d=0;d<L;d+=1){for(B=0;B<st+1;B+=1)P=(D*Z+B)*4,y=it.data[P+0],S=it.data[P+1],R=it.data[P+2],H=it.data[P+3],g=(D*Z+st*2-B-1)*4,it.data[g+0]=y,it.data[g+1]=S,it.data[g+2]=R,it.data[g+3]=H;st*=2}c(it,x,{})};return Jr.Kaleidoscope=O,b.Factory.addGetterSetter(W.Node,"kaleidoscopePower",2,(0,et.getNumberValidator)(),b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"kaleidoscopeAngle",0,(0,et.getNumberValidator)(),b.Factory.afterSetFilter),Jr}var $r={},aa;function xo(){if(aa)return $r;aa=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.Mask=void 0;const b=Ne(),W=si(),J=De();function et(G,d,y){let S=(y*G.width+d)*4;const R=[];return R.push(G.data[S++],G.data[S++],G.data[S++],G.data[S++]),R}function z(G,d){return Math.sqrt(Math.pow(G[0]-d[0],2)+Math.pow(G[1]-d[1],2)+Math.pow(G[2]-d[2],2))}function c(G){const d=[0,0,0];for(let y=0;y<G.length;y++)d[0]+=G[y][0],d[1]+=G[y][1],d[2]+=G[y][2];return d[0]/=G.length,d[1]/=G.length,d[2]/=G.length,d}function O(G,d){const y=et(G,0,0),S=et(G,G.width-1,0),R=et(G,0,G.height-1),H=et(G,G.width-1,G.height-1),P=d||10;if(z(y,S)<P&&z(S,H)<P&&z(H,R)<P&&z(R,y)<P){const g=c([S,y,H,R]),L=[];for(let K=0;K<G.width*G.height;K++){const f=z(g,[G.data[K*4],G.data[K*4+1],G.data[K*4+2]]);L[K]=f<P?0:255}return L}}function x(G,d){for(let y=0;y<G.width*G.height;y++)G.data[4*y+3]=d[y]}function D(G,d,y){const S=[1,1,1,1,0,1,1,1,1],R=Math.round(Math.sqrt(S.length)),H=Math.floor(R/2),P=[];for(let g=0;g<y;g++)for(let L=0;L<d;L++){const K=g*d+L;let f=0;for(let wt=0;wt<R;wt++)for(let it=0;it<R;it++){const rt=g+wt-H,st=L+it-H;if(rt>=0&&rt<y&&st>=0&&st<d){const gt=rt*d+st,St=S[wt*R+it];f+=G[gt]*St}}P[K]=f===2040?255:0}return P}function N(G,d,y){const S=[1,1,1,1,1,1,1,1,1],R=Math.round(Math.sqrt(S.length)),H=Math.floor(R/2),P=[];for(let g=0;g<y;g++)for(let L=0;L<d;L++){const K=g*d+L;let f=0;for(let wt=0;wt<R;wt++)for(let it=0;it<R;it++){const rt=g+wt-H,st=L+it-H;if(rt>=0&&rt<y&&st>=0&&st<d){const gt=rt*d+st,St=S[wt*R+it];f+=G[gt]*St}}P[K]=f>=1020?255:0}return P}function B(G,d,y){const S=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],R=Math.round(Math.sqrt(S.length)),H=Math.floor(R/2),P=[];for(let g=0;g<y;g++)for(let L=0;L<d;L++){const K=g*d+L;let f=0;for(let wt=0;wt<R;wt++)for(let it=0;it<R;it++){const rt=g+wt-H,st=L+it-H;if(rt>=0&&rt<y&&st>=0&&st<d){const gt=rt*d+st,St=S[wt*R+it];f+=G[gt]*St}}P[K]=f}return P}const Z=function(G){const d=this.threshold();let y=O(G,d);return y&&(y=D(y,G.width,G.height),y=N(y,G.width,G.height),y=B(y,G.width,G.height),x(G,y)),G};return $r.Mask=Z,b.Factory.addGetterSetter(W.Node,"threshold",0,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),$r}var tn={},oa;function wo(){if(oa)return tn;oa=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.Noise=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=this.noise()*255,O=z.data,x=O.length,D=c/2;for(let N=0;N<x;N+=4)O[N+0]+=D-2*D*Math.random(),O[N+1]+=D-2*D*Math.random(),O[N+2]+=D-2*D*Math.random()};return tn.Noise=et,b.Factory.addGetterSetter(W.Node,"noise",.2,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),tn}var en={},ua;function So(){if(ua)return en;ua=1,Object.defineProperty(en,"__esModule",{value:!0}),en.Pixelate=void 0;const b=Ne(),W=ii(),J=si(),et=De(),z=function(c){let O=Math.ceil(this.pixelSize()),x=c.width,D=c.height,N=Math.ceil(x/O),B=Math.ceil(D/O),Z=c.data;if(O<=0){W.Util.error("pixelSize value can not be <= 0");return}for(let G=0;G<N;G+=1)for(let d=0;d<B;d+=1){let y=0,S=0,R=0,H=0;const P=G*O,g=P+O,L=d*O,K=L+O;let f=0;for(let wt=P;wt<g;wt+=1)if(!(wt>=x))for(let it=L;it<K;it+=1){if(it>=D)continue;const rt=(x*it+wt)*4;y+=Z[rt+0],S+=Z[rt+1],R+=Z[rt+2],H+=Z[rt+3],f+=1}y=y/f,S=S/f,R=R/f,H=H/f;for(let wt=P;wt<g;wt+=1)if(!(wt>=x))for(let it=L;it<K;it+=1){if(it>=D)continue;const rt=(x*it+wt)*4;Z[rt+0]=y,Z[rt+1]=S,Z[rt+2]=R,Z[rt+3]=H}}};return en.Pixelate=z,b.Factory.addGetterSetter(J.Node,"pixelSize",8,(0,et.getNumberValidator)(),b.Factory.afterSetFilter),en}var rn={},ha;function Co(){if(ha)return rn;ha=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.Posterize=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=Math.round(this.levels()*254)+1,O=z.data,x=O.length,D=255/c;for(let N=0;N<x;N+=1)O[N]=Math.floor(O[N]/D)*D};return rn.Posterize=et,b.Factory.addGetterSetter(W.Node,"levels",.5,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),rn}var nn={},la;function Po(){if(la)return nn;la=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.RGB=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=z.data,O=c.length,x=this.red(),D=this.green(),N=this.blue();for(let B=0;B<O;B+=4){const Z=(.34*c[B]+.5*c[B+1]+.16*c[B+2])/255;c[B]=Z*x,c[B+1]=Z*D,c[B+2]=Z*N,c[B+3]=c[B+3]}};return nn.RGB=et,b.Factory.addGetterSetter(W.Node,"red",0,function(z){return this._filterUpToDate=!1,z>255?255:z<0?0:Math.round(z)}),b.Factory.addGetterSetter(W.Node,"green",0,function(z){return this._filterUpToDate=!1,z>255?255:z<0?0:Math.round(z)}),b.Factory.addGetterSetter(W.Node,"blue",0,J.RGBComponent,b.Factory.afterSetFilter),nn}var sn={},ca;function ko(){if(ca)return sn;ca=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.RGBA=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=z.data,O=c.length,x=this.red(),D=this.green(),N=this.blue(),B=this.alpha();for(let Z=0;Z<O;Z+=4){const G=1-B;c[Z]=x*B+c[Z]*G,c[Z+1]=D*B+c[Z+1]*G,c[Z+2]=N*B+c[Z+2]*G}};return sn.RGBA=et,b.Factory.addGetterSetter(W.Node,"red",0,function(z){return this._filterUpToDate=!1,z>255?255:z<0?0:Math.round(z)}),b.Factory.addGetterSetter(W.Node,"green",0,function(z){return this._filterUpToDate=!1,z>255?255:z<0?0:Math.round(z)}),b.Factory.addGetterSetter(W.Node,"blue",0,J.RGBComponent,b.Factory.afterSetFilter),b.Factory.addGetterSetter(W.Node,"alpha",1,function(z){return this._filterUpToDate=!1,z>1?1:z<0?0:z}),sn}var an={},fa;function Ao(){if(fa)return an;fa=1,Object.defineProperty(an,"__esModule",{value:!0}),an.Sepia=void 0;const b=function(W){const J=W.data,et=J.length;for(let z=0;z<et;z+=4){const c=J[z+0],O=J[z+1],x=J[z+2];J[z+0]=Math.min(255,c*.393+O*.769+x*.189),J[z+1]=Math.min(255,c*.349+O*.686+x*.168),J[z+2]=Math.min(255,c*.272+O*.534+x*.131)}};return an.Sepia=b,an}var on={},da;function Eo(){if(da)return on;da=1,Object.defineProperty(on,"__esModule",{value:!0}),on.Solarize=void 0;const b=function(W){const J=W.data,et=W.width,z=W.height,c=et*4;let O=z;do{const x=(O-1)*c;let D=et;do{const N=x+(D-1)*4;let B=J[N],Z=J[N+1],G=J[N+2];B>127&&(B=255-B),Z>127&&(Z=255-Z),G>127&&(G=255-G),J[N]=B,J[N+1]=Z,J[N+2]=G}while(--D)}while(--O)};return on.Solarize=b,on}var un={},pa;function To(){if(pa)return un;pa=1,Object.defineProperty(un,"__esModule",{value:!0}),un.Threshold=void 0;const b=Ne(),W=si(),J=De(),et=function(z){const c=this.threshold()*255,O=z.data,x=O.length;for(let D=0;D<x;D+=1)O[D]=O[D]<c?0:255};return un.Threshold=et,b.Factory.addGetterSetter(W.Node,"threshold",.5,(0,J.getNumberValidator)(),b.Factory.afterSetFilter),un}var ga;function Io(){if(ga)return xr;ga=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.Konva=void 0;const b=Xa(),W=Za(),J=Ja(),et=$a(),z=to(),c=eo(),O=io(),x=Ra(),D=fs(),N=Na(),B=ro(),Z=no(),G=so(),d=ao(),y=La(),S=oo(),R=uo(),H=ho(),P=lo(),g=co(),L=fo(),K=po(),f=go(),wt=_o(),it=vo(),rt=mo(),st=yo(),gt=bo(),St=xo(),It=wo(),Pt=So(),Tt=Co(),Nt=Po(),Q=ko(),at=Ao(),ct=Eo(),dt=To();return xr.Konva=b.Konva.Util._assign(b.Konva,{Arc:W.Arc,Arrow:J.Arrow,Circle:et.Circle,Ellipse:z.Ellipse,Image:c.Image,Label:O.Label,Tag:O.Tag,Line:x.Line,Path:D.Path,Rect:N.Rect,RegularPolygon:B.RegularPolygon,Ring:Z.Ring,Sprite:G.Sprite,Star:d.Star,Text:y.Text,TextPath:S.TextPath,Transformer:R.Transformer,Wedge:H.Wedge,Filters:{Blur:P.Blur,Brighten:g.Brighten,Contrast:L.Contrast,Emboss:K.Emboss,Enhance:f.Enhance,Grayscale:wt.Grayscale,HSL:it.HSL,HSV:rt.HSV,Invert:st.Invert,Kaleidoscope:gt.Kaleidoscope,Mask:St.Mask,Noise:It.Noise,Pixelate:Pt.Pixelate,Posterize:Tt.Posterize,RGB:Nt.RGB,RGBA:Q.RGBA,Sepia:at.Sepia,Solarize:ct.Solarize,Threshold:dt.Threshold}}),xr}var Ro=Pn.exports,_a;function Oo(){if(_a)return Pn.exports;_a=1,Object.defineProperty(Ro,"__esModule",{value:!0});const b=Io();return Pn.exports=b.Konva,Pn.exports}var No=Oo();const Ii=Aa(No),gi={screenWidth:window.innerWidth,screenHeight:window.innerHeight,wallWidth:2500,wallHeight:3330,gridFrequency:200};function En(b,W,J=1){b.offsetX(b.width()/2),b.offsetY(b.height()/2),b.position({x:W.screenWidth/2,y:W.screenHeight/2}),b.scale({x:W.screenHeight/W.wallHeight*J,y:W.screenHeight/W.wallHeight*J})}class Lo{constructor(){this.socket=null,this.listeners=new Set}connect(W){this.socket||(this.socket=new WebSocket(W),this.socket.onopen=()=>{console.log("[WS] Connected to",W)},this.socket.onmessage=J=>{try{const et=JSON.parse(J.data);this.listeners.forEach(z=>z(et))}catch(et){console.error("[WS] Invalid message",et)}},this.socket.onclose=()=>{console.log("[WS] Disconnected"),this.socket=null},this.socket.onerror=J=>{console.error("[WS] Error:",J)})}subscribe(W){return this.listeners.add(W),()=>{this.listeners.delete(W)}}send(W){this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(W)):console.warn("[WS] Tried to send message but socket not open")}disconnect(){this.socket&&(this.socket.close(),this.socket=null)}}const cn=new Lo;function Mo(b){throw new Error('Could not dynamically require "'+b+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kn={exports:{}};const Fo={},Do=Object.freeze(Object.defineProperty({__proto__:null,default:Fo},Symbol.toStringTag,{value:"Module"})),va=qa(Do);var ln={exports:{}},Bo=ln.exports,ma;function Vo(){return ma||(ma=1,(function(b,W){(function(J,et){et(W)})(Bo,(function(J){var et=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],z=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],c="-----------------------------------------------------------------------------------------------------------------------------------------------------",O="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",x={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},D="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",N={5:D,"5module":D+" export import",6:D+" const class extends export import super"},B=/^in(stanceof)?$/,Z=new RegExp("["+O+"]"),G=new RegExp("["+O+c+"]");function d(i,o){for(var E=65536,q=0;q<o.length;q+=2){if(E+=o[q],E>i)return!1;if(E+=o[q+1],E>=i)return!0}return!1}function y(i,o){return i<65?i===36:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&Z.test(String.fromCharCode(i)):o===!1?!1:d(i,z)}function S(i,o){return i<48?i===36:i<58?!0:i<65?!1:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&G.test(String.fromCharCode(i)):o===!1?!1:d(i,z)||d(i,et)}var R=function(o,E){E===void 0&&(E={}),this.label=o,this.keyword=E.keyword,this.beforeExpr=!!E.beforeExpr,this.startsExpr=!!E.startsExpr,this.isLoop=!!E.isLoop,this.isAssign=!!E.isAssign,this.prefix=!!E.prefix,this.postfix=!!E.postfix,this.binop=E.binop||null,this.updateContext=null};function H(i,o){return new R(i,{beforeExpr:!0,binop:o})}var P={beforeExpr:!0},g={startsExpr:!0},L={};function K(i,o){return o===void 0&&(o={}),o.keyword=i,L[i]=new R(i,o)}var f={num:new R("num",g),regexp:new R("regexp",g),string:new R("string",g),name:new R("name",g),privateId:new R("privateId",g),eof:new R("eof"),bracketL:new R("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new R("]"),braceL:new R("{",{beforeExpr:!0,startsExpr:!0}),braceR:new R("}"),parenL:new R("(",{beforeExpr:!0,startsExpr:!0}),parenR:new R(")"),comma:new R(",",P),semi:new R(";",P),colon:new R(":",P),dot:new R("."),question:new R("?",P),questionDot:new R("?."),arrow:new R("=>",P),template:new R("template"),invalidTemplate:new R("invalidTemplate"),ellipsis:new R("...",P),backQuote:new R("`",g),dollarBraceL:new R("${",{beforeExpr:!0,startsExpr:!0}),eq:new R("=",{beforeExpr:!0,isAssign:!0}),assign:new R("_=",{beforeExpr:!0,isAssign:!0}),incDec:new R("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new R("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:H("||",1),logicalAND:H("&&",2),bitwiseOR:H("|",3),bitwiseXOR:H("^",4),bitwiseAND:H("&",5),equality:H("==/!=/===/!==",6),relational:H("</>/<=/>=",7),bitShift:H("<</>>/>>>",8),plusMin:new R("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:H("%",10),star:H("*",10),slash:H("/",10),starstar:new R("**",{beforeExpr:!0}),coalesce:H("??",1),_break:K("break"),_case:K("case",P),_catch:K("catch"),_continue:K("continue"),_debugger:K("debugger"),_default:K("default",P),_do:K("do",{isLoop:!0,beforeExpr:!0}),_else:K("else",P),_finally:K("finally"),_for:K("for",{isLoop:!0}),_function:K("function",g),_if:K("if"),_return:K("return",P),_switch:K("switch"),_throw:K("throw",P),_try:K("try"),_var:K("var"),_const:K("const"),_while:K("while",{isLoop:!0}),_with:K("with"),_new:K("new",{beforeExpr:!0,startsExpr:!0}),_this:K("this",g),_super:K("super",g),_class:K("class",g),_extends:K("extends",P),_export:K("export"),_import:K("import",g),_null:K("null",g),_true:K("true",g),_false:K("false",g),_in:K("in",{beforeExpr:!0,binop:7}),_instanceof:K("instanceof",{beforeExpr:!0,binop:7}),_typeof:K("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:K("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:K("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},wt=/\r\n?|\n|\u2028|\u2029/,it=new RegExp(wt.source,"g");function rt(i){return i===10||i===13||i===8232||i===8233}function st(i,o,E){E===void 0&&(E=i.length);for(var q=o;q<E;q++){var ht=i.charCodeAt(q);if(rt(ht))return q<E-1&&ht===13&&i.charCodeAt(q+1)===10?q+2:q+1}return-1}var gt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,St=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,It=Object.prototype,Pt=It.hasOwnProperty,Tt=It.toString,Nt=Object.hasOwn||(function(i,o){return Pt.call(i,o)}),Q=Array.isArray||(function(i){return Tt.call(i)==="[object Array]"}),at=Object.create(null);function ct(i){return at[i]||(at[i]=new RegExp("^(?:"+i.replace(/ /g,"|")+")$"))}function dt(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}var Ct=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Ut=function(o,E){this.line=o,this.column=E};Ut.prototype.offset=function(o){return new Ut(this.line,this.column+o)};var Ot=function(o,E,q){this.start=E,this.end=q,o.sourceFile!==null&&(this.source=o.sourceFile)};function Kt(i,o){for(var E=1,q=0;;){var ht=st(i,q,o);if(ht<0)return new Ut(E,o-q);++E,q=ht}}var Xt={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Vt=!1;function mt(i){var o={};for(var E in Xt)o[E]=i&&Nt(i,E)?i[E]:Xt[E];if(o.ecmaVersion==="latest"?o.ecmaVersion=1e8:o.ecmaVersion==null?(!Vt&&typeof console=="object"&&console.warn&&(Vt=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),o.ecmaVersion=11):o.ecmaVersion>=2015&&(o.ecmaVersion-=2009),o.allowReserved==null&&(o.allowReserved=o.ecmaVersion<5),(!i||i.allowHashBang==null)&&(o.allowHashBang=o.ecmaVersion>=14),Q(o.onToken)){var q=o.onToken;o.onToken=function(ht){return q.push(ht)}}return Q(o.onComment)&&(o.onComment=Dt(o,o.onComment)),o}function Dt(i,o){return function(E,q,ht,Lt,Ft,Yt){var ae={type:E?"Block":"Line",value:q,start:ht,end:Lt};i.locations&&(ae.loc=new Ot(this,Ft,Yt)),i.ranges&&(ae.range=[ht,Lt]),o.push(ae)}}var Wt=1,Qt=2,re=4,be=8,ce=16,we=32,ge=64,Ze=128,Re=256,Ue=512,_i=Wt|Qt|Re;function ti(i,o){return Qt|(i?re:0)|(o?be:0)}var Ve=0,Le=1,Ae=2,Qe=3,_e=4,t=5,e=function(o,E,q){this.options=o=mt(o),this.sourceFile=o.sourceFile,this.keywords=ct(N[o.ecmaVersion>=6?6:o.sourceType==="module"?"5module":5]);var ht="";o.allowReserved!==!0&&(ht=x[o.ecmaVersion>=6?6:o.ecmaVersion===5?5:3],o.sourceType==="module"&&(ht+=" await")),this.reservedWords=ct(ht);var Lt=(ht?ht+" ":"")+x.strict;this.reservedWordsStrict=ct(Lt),this.reservedWordsStrictBind=ct(Lt+" "+x.strictBind),this.input=String(E),this.containsEsc=!1,q?(this.pos=q,this.lineStart=this.input.lastIndexOf(`
`,q-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(wt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=f.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=o.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&o.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Wt),this.regexpState=null,this.privateNameStack=[]},r={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};e.prototype.parse=function(){var o=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(o)},r.inFunction.get=function(){return(this.currentVarScope().flags&Qt)>0},r.inGenerator.get=function(){return(this.currentVarScope().flags&be)>0},r.inAsync.get=function(){return(this.currentVarScope().flags&re)>0},r.canAwait.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var o=this.scopeStack[i],E=o.flags;if(E&(Re|Ue))return!1;if(E&Qt)return(E&re)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},r.allowSuper.get=function(){var i=this.currentThisScope(),o=i.flags;return(o&ge)>0||this.options.allowSuperOutsideMethod},r.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Ze)>0},r.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},r.allowNewDotTarget.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var o=this.scopeStack[i],E=o.flags;if(E&(Re|Ue)||E&Qt&&!(E&ce))return!0}return!1},r.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Re)>0},e.extend=function(){for(var o=[],E=arguments.length;E--;)o[E]=arguments[E];for(var q=this,ht=0;ht<o.length;ht++)q=o[ht](q);return q},e.parse=function(o,E){return new this(E,o).parse()},e.parseExpressionAt=function(o,E,q){var ht=new this(q,o,E);return ht.nextToken(),ht.parseExpression()},e.tokenizer=function(o,E){return new this(E,o)},Object.defineProperties(e.prototype,r);var n=e.prototype,s=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;n.strictDirective=function(i){if(this.options.ecmaVersion<5)return!1;for(;;){St.lastIndex=i,i+=St.exec(this.input)[0].length;var o=s.exec(this.input.slice(i));if(!o)return!1;if((o[1]||o[2])==="use strict"){St.lastIndex=i+o[0].length;var E=St.exec(this.input),q=E.index+E[0].length,ht=this.input.charAt(q);return ht===";"||ht==="}"||wt.test(E[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(ht)||ht==="!"&&this.input.charAt(q+1)==="=")}i+=o[0].length,St.lastIndex=i,i+=St.exec(this.input)[0].length,this.input[i]===";"&&i++}},n.eat=function(i){return this.type===i?(this.next(),!0):!1},n.isContextual=function(i){return this.type===f.name&&this.value===i&&!this.containsEsc},n.eatContextual=function(i){return this.isContextual(i)?(this.next(),!0):!1},n.expectContextual=function(i){this.eatContextual(i)||this.unexpected()},n.canInsertSemicolon=function(){return this.type===f.eof||this.type===f.braceR||wt.test(this.input.slice(this.lastTokEnd,this.start))},n.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},n.semicolon=function(){!this.eat(f.semi)&&!this.insertSemicolon()&&this.unexpected()},n.afterTrailingComma=function(i,o){if(this.type===i)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),o||this.next(),!0},n.expect=function(i){this.eat(i)||this.unexpected()},n.unexpected=function(i){this.raise(i??this.start,"Unexpected token")};var u=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};n.checkPatternErrors=function(i,o){if(i){i.trailingComma>-1&&this.raiseRecoverable(i.trailingComma,"Comma is not permitted after the rest element");var E=o?i.parenthesizedAssign:i.parenthesizedBind;E>-1&&this.raiseRecoverable(E,o?"Assigning to rvalue":"Parenthesized pattern")}},n.checkExpressionErrors=function(i,o){if(!i)return!1;var E=i.shorthandAssign,q=i.doubleProto;if(!o)return E>=0||q>=0;E>=0&&this.raise(E,"Shorthand property assignments are valid only in destructuring patterns"),q>=0&&this.raiseRecoverable(q,"Redefinition of __proto__ property")},n.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},n.isSimpleAssignTarget=function(i){return i.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(i.expression):i.type==="Identifier"||i.type==="MemberExpression"};var h=e.prototype;h.parseTopLevel=function(i){var o=Object.create(null);for(i.body||(i.body=[]);this.type!==f.eof;){var E=this.parseStatement(null,!0,o);i.body.push(E)}if(this.inModule)for(var q=0,ht=Object.keys(this.undefinedExports);q<ht.length;q+=1){var Lt=ht[q];this.raiseRecoverable(this.undefinedExports[Lt].start,"Export '"+Lt+"' is not defined")}return this.adaptDirectivePrologue(i.body),this.next(),i.sourceType=this.options.sourceType,this.finishNode(i,"Program")};var l={kind:"loop"},p={kind:"switch"};h.isLet=function(i){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;St.lastIndex=this.pos;var o=St.exec(this.input),E=this.pos+o[0].length,q=this.input.charCodeAt(E);if(q===91||q===92)return!0;if(i)return!1;if(q===123||q>55295&&q<56320)return!0;if(y(q,!0)){for(var ht=E+1;S(q=this.input.charCodeAt(ht),!0);)++ht;if(q===92||q>55295&&q<56320)return!0;var Lt=this.input.slice(E,ht);if(!B.test(Lt))return!0}return!1},h.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;St.lastIndex=this.pos;var i=St.exec(this.input),o=this.pos+i[0].length,E;return!wt.test(this.input.slice(this.pos,o))&&this.input.slice(o,o+8)==="function"&&(o+8===this.input.length||!(S(E=this.input.charCodeAt(o+8))||E>55295&&E<56320))},h.isUsingKeyword=function(i,o){if(this.options.ecmaVersion<17||!this.isContextual(i?"await":"using"))return!1;St.lastIndex=this.pos;var E=St.exec(this.input),q=this.pos+E[0].length;if(wt.test(this.input.slice(this.pos,q)))return!1;if(i){var ht=q+5,Lt;if(this.input.slice(q,ht)!=="using"||ht===this.input.length||S(Lt=this.input.charCodeAt(ht))||Lt>55295&&Lt<56320)return!1;St.lastIndex=ht;var Ft=St.exec(this.input);if(Ft&&wt.test(this.input.slice(ht,ht+Ft[0].length)))return!1}if(o){var Yt=q+2,ae;if(this.input.slice(q,Yt)==="of"&&(Yt===this.input.length||!S(ae=this.input.charCodeAt(Yt))&&!(ae>55295&&ae<56320)))return!1}var xe=this.input.charCodeAt(q);return y(xe,!0)||xe===92},h.isAwaitUsing=function(i){return this.isUsingKeyword(!0,i)},h.isUsing=function(i){return this.isUsingKeyword(!1,i)},h.parseStatement=function(i,o,E){var q=this.type,ht=this.startNode(),Lt;switch(this.isLet(i)&&(q=f._var,Lt="let"),q){case f._break:case f._continue:return this.parseBreakContinueStatement(ht,q.keyword);case f._debugger:return this.parseDebuggerStatement(ht);case f._do:return this.parseDoStatement(ht);case f._for:return this.parseForStatement(ht);case f._function:return i&&(this.strict||i!=="if"&&i!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(ht,!1,!i);case f._class:return i&&this.unexpected(),this.parseClass(ht,!0);case f._if:return this.parseIfStatement(ht);case f._return:return this.parseReturnStatement(ht);case f._switch:return this.parseSwitchStatement(ht);case f._throw:return this.parseThrowStatement(ht);case f._try:return this.parseTryStatement(ht);case f._const:case f._var:return Lt=Lt||this.value,i&&Lt!=="var"&&this.unexpected(),this.parseVarStatement(ht,Lt);case f._while:return this.parseWhileStatement(ht);case f._with:return this.parseWithStatement(ht);case f.braceL:return this.parseBlock(!0,ht);case f.semi:return this.parseEmptyStatement(ht);case f._export:case f._import:if(this.options.ecmaVersion>10&&q===f._import){St.lastIndex=this.pos;var Ft=St.exec(this.input),Yt=this.pos+Ft[0].length,ae=this.input.charCodeAt(Yt);if(ae===40||ae===46)return this.parseExpressionStatement(ht,this.parseExpression())}return this.options.allowImportExportEverywhere||(o||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),q===f._import?this.parseImport(ht):this.parseExport(ht,E);default:if(this.isAsyncFunction())return i&&this.unexpected(),this.next(),this.parseFunctionStatement(ht,!0,!i);var xe=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(xe)return o&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),xe==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(ht,!1,xe),this.semicolon(),this.finishNode(ht,"VariableDeclaration");var Te=this.value,qe=this.parseExpression();return q===f.name&&qe.type==="Identifier"&&this.eat(f.colon)?this.parseLabeledStatement(ht,Te,qe,i):this.parseExpressionStatement(ht,qe)}},h.parseBreakContinueStatement=function(i,o){var E=o==="break";this.next(),this.eat(f.semi)||this.insertSemicolon()?i.label=null:this.type!==f.name?this.unexpected():(i.label=this.parseIdent(),this.semicolon());for(var q=0;q<this.labels.length;++q){var ht=this.labels[q];if((i.label==null||ht.name===i.label.name)&&(ht.kind!=null&&(E||ht.kind==="loop")||i.label&&E))break}return q===this.labels.length&&this.raise(i.start,"Unsyntactic "+o),this.finishNode(i,E?"BreakStatement":"ContinueStatement")},h.parseDebuggerStatement=function(i){return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement")},h.parseDoStatement=function(i){return this.next(),this.labels.push(l),i.body=this.parseStatement("do"),this.labels.pop(),this.expect(f._while),i.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(f.semi):this.semicolon(),this.finishNode(i,"DoWhileStatement")},h.parseForStatement=function(i){this.next();var o=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(l),this.enterScope(0),this.expect(f.parenL),this.type===f.semi)return o>-1&&this.unexpected(o),this.parseFor(i,null);var E=this.isLet();if(this.type===f._var||this.type===f._const||E){var q=this.startNode(),ht=E?"let":this.value;return this.next(),this.parseVar(q,!0,ht),this.finishNode(q,"VariableDeclaration"),this.parseForAfterInit(i,q,o)}var Lt=this.isContextual("let"),Ft=!1,Yt=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(Yt){var ae=this.startNode();return this.next(),Yt==="await using"&&this.next(),this.parseVar(ae,!0,Yt),this.finishNode(ae,"VariableDeclaration"),this.parseForAfterInit(i,ae,o)}var xe=this.containsEsc,Te=new u,qe=this.start,ei=o>-1?this.parseExprSubscripts(Te,"await"):this.parseExpression(!0,Te);return this.type===f._in||(Ft=this.options.ecmaVersion>=6&&this.isContextual("of"))?(o>-1?(this.type===f._in&&this.unexpected(o),i.await=!0):Ft&&this.options.ecmaVersion>=8&&(ei.start===qe&&!xe&&ei.type==="Identifier"&&ei.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(i.await=!1)),Lt&&Ft&&this.raise(ei.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(ei,!1,Te),this.checkLValPattern(ei),this.parseForIn(i,ei)):(this.checkExpressionErrors(Te,!0),o>-1&&this.unexpected(o),this.parseFor(i,ei))},h.parseForAfterInit=function(i,o,E){return(this.type===f._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&o.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===f._in?E>-1&&this.unexpected(E):i.await=E>-1),this.parseForIn(i,o)):(E>-1&&this.unexpected(E),this.parseFor(i,o))},h.parseFunctionStatement=function(i,o,E){return this.next(),this.parseFunction(i,T|(E?0:I),!1,o)},h.parseIfStatement=function(i){return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement("if"),i.alternate=this.eat(f._else)?this.parseStatement("if"):null,this.finishNode(i,"IfStatement")},h.parseReturnStatement=function(i){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(f.semi)||this.insertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement")},h.parseSwitchStatement=function(i){this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.expect(f.braceL),this.labels.push(p),this.enterScope(0);for(var o,E=!1;this.type!==f.braceR;)if(this.type===f._case||this.type===f._default){var q=this.type===f._case;o&&this.finishNode(o,"SwitchCase"),i.cases.push(o=this.startNode()),o.consequent=[],this.next(),q?o.test=this.parseExpression():(E&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),E=!0,o.test=null),this.expect(f.colon)}else o||this.unexpected(),o.consequent.push(this.parseStatement(null));return this.exitScope(),o&&this.finishNode(o,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(i,"SwitchStatement")},h.parseThrowStatement=function(i){return this.next(),wt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement")};var v=[];h.parseCatchClauseParam=function(){var i=this.parseBindingAtom(),o=i.type==="Identifier";return this.enterScope(o?we:0),this.checkLValPattern(i,o?_e:Ae),this.expect(f.parenR),i},h.parseTryStatement=function(i){if(this.next(),i.block=this.parseBlock(),i.handler=null,this.type===f._catch){var o=this.startNode();this.next(),this.eat(f.parenL)?o.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),o.param=null,this.enterScope(0)),o.body=this.parseBlock(!1),this.exitScope(),i.handler=this.finishNode(o,"CatchClause")}return i.finalizer=this.eat(f._finally)?this.parseBlock():null,!i.handler&&!i.finalizer&&this.raise(i.start,"Missing catch or finally clause"),this.finishNode(i,"TryStatement")},h.parseVarStatement=function(i,o,E){return this.next(),this.parseVar(i,!1,o,E),this.semicolon(),this.finishNode(i,"VariableDeclaration")},h.parseWhileStatement=function(i){return this.next(),i.test=this.parseParenExpression(),this.labels.push(l),i.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(i,"WhileStatement")},h.parseWithStatement=function(i){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement("with"),this.finishNode(i,"WithStatement")},h.parseEmptyStatement=function(i){return this.next(),this.finishNode(i,"EmptyStatement")},h.parseLabeledStatement=function(i,o,E,q){for(var ht=0,Lt=this.labels;ht<Lt.length;ht+=1){var Ft=Lt[ht];Ft.name===o&&this.raise(E.start,"Label '"+o+"' is already declared")}for(var Yt=this.type.isLoop?"loop":this.type===f._switch?"switch":null,ae=this.labels.length-1;ae>=0;ae--){var xe=this.labels[ae];if(xe.statementStart===i.start)xe.statementStart=this.start,xe.kind=Yt;else break}return this.labels.push({name:o,kind:Yt,statementStart:this.start}),i.body=this.parseStatement(q?q.indexOf("label")===-1?q+"label":q:"label"),this.labels.pop(),i.label=E,this.finishNode(i,"LabeledStatement")},h.parseExpressionStatement=function(i,o){return i.expression=o,this.semicolon(),this.finishNode(i,"ExpressionStatement")},h.parseBlock=function(i,o,E){for(i===void 0&&(i=!0),o===void 0&&(o=this.startNode()),o.body=[],this.expect(f.braceL),i&&this.enterScope(0);this.type!==f.braceR;){var q=this.parseStatement(null);o.body.push(q)}return E&&(this.strict=!1),this.next(),i&&this.exitScope(),this.finishNode(o,"BlockStatement")},h.parseFor=function(i,o){return i.init=o,this.expect(f.semi),i.test=this.type===f.semi?null:this.parseExpression(),this.expect(f.semi),i.update=this.type===f.parenR?null:this.parseExpression(),this.expect(f.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,"ForStatement")},h.parseForIn=function(i,o){var E=this.type===f._in;return this.next(),o.type==="VariableDeclaration"&&o.declarations[0].init!=null&&(!E||this.options.ecmaVersion<8||this.strict||o.kind!=="var"||o.declarations[0].id.type!=="Identifier")&&this.raise(o.start,(E?"for-in":"for-of")+" loop variable declaration may not have an initializer"),i.left=o,i.right=E?this.parseExpression():this.parseMaybeAssign(),this.expect(f.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,E?"ForInStatement":"ForOfStatement")},h.parseVar=function(i,o,E,q){for(i.declarations=[],i.kind=E;;){var ht=this.startNode();if(this.parseVarId(ht,E),this.eat(f.eq)?ht.init=this.parseMaybeAssign(o):!q&&E==="const"&&!(this.type===f._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!q&&(E==="using"||E==="await using")&&this.options.ecmaVersion>=17&&this.type!==f._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+E+" declaration"):!q&&ht.id.type!=="Identifier"&&!(o&&(this.type===f._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):ht.init=null,i.declarations.push(this.finishNode(ht,"VariableDeclarator")),!this.eat(f.comma))break}return i},h.parseVarId=function(i,o){i.id=o==="using"||o==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(i.id,o==="var"?Le:Ae,!1)};var T=1,I=2,C=4;h.parseFunction=function(i,o,E,q,ht){this.initFunction(i),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!q)&&(this.type===f.star&&o&I&&this.unexpected(),i.generator=this.eat(f.star)),this.options.ecmaVersion>=8&&(i.async=!!q),o&T&&(i.id=o&C&&this.type!==f.name?null:this.parseIdent(),i.id&&!(o&I)&&this.checkLValSimple(i.id,this.strict||i.generator||i.async?this.treatFunctionsAsVar?Le:Ae:Qe));var Lt=this.yieldPos,Ft=this.awaitPos,Yt=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ti(i.async,i.generator)),o&T||(i.id=this.type===f.name?this.parseIdent():null),this.parseFunctionParams(i),this.parseFunctionBody(i,E,!1,ht),this.yieldPos=Lt,this.awaitPos=Ft,this.awaitIdentPos=Yt,this.finishNode(i,o&T?"FunctionDeclaration":"FunctionExpression")},h.parseFunctionParams=function(i){this.expect(f.parenL),i.params=this.parseBindingList(f.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},h.parseClass=function(i,o){this.next();var E=this.strict;this.strict=!0,this.parseClassId(i,o),this.parseClassSuper(i);var q=this.enterClassBody(),ht=this.startNode(),Lt=!1;for(ht.body=[],this.expect(f.braceL);this.type!==f.braceR;){var Ft=this.parseClassElement(i.superClass!==null);Ft&&(ht.body.push(Ft),Ft.type==="MethodDefinition"&&Ft.kind==="constructor"?(Lt&&this.raiseRecoverable(Ft.start,"Duplicate constructor in the same class"),Lt=!0):Ft.key&&Ft.key.type==="PrivateIdentifier"&&w(q,Ft)&&this.raiseRecoverable(Ft.key.start,"Identifier '#"+Ft.key.name+"' has already been declared"))}return this.strict=E,this.next(),i.body=this.finishNode(ht,"ClassBody"),this.exitClassBody(),this.finishNode(i,o?"ClassDeclaration":"ClassExpression")},h.parseClassElement=function(i){if(this.eat(f.semi))return null;var o=this.options.ecmaVersion,E=this.startNode(),q="",ht=!1,Lt=!1,Ft="method",Yt=!1;if(this.eatContextual("static")){if(o>=13&&this.eat(f.braceL))return this.parseClassStaticBlock(E),E;this.isClassElementNameStart()||this.type===f.star?Yt=!0:q="static"}if(E.static=Yt,!q&&o>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===f.star)&&!this.canInsertSemicolon()?Lt=!0:q="async"),!q&&(o>=9||!Lt)&&this.eat(f.star)&&(ht=!0),!q&&!Lt&&!ht){var ae=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Ft=ae:q=ae)}if(q?(E.computed=!1,E.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),E.key.name=q,this.finishNode(E.key,"Identifier")):this.parseClassElementName(E),o<13||this.type===f.parenL||Ft!=="method"||ht||Lt){var xe=!E.static&&Y(E,"constructor"),Te=xe&&i;xe&&Ft!=="method"&&this.raise(E.key.start,"Constructor can't have get/set modifier"),E.kind=xe?"constructor":Ft,this.parseClassMethod(E,ht,Lt,Te)}else this.parseClassField(E);return E},h.isClassElementNameStart=function(){return this.type===f.name||this.type===f.privateId||this.type===f.num||this.type===f.string||this.type===f.bracketL||this.type.keyword},h.parseClassElementName=function(i){this.type===f.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),i.computed=!1,i.key=this.parsePrivateIdent()):this.parsePropertyName(i)},h.parseClassMethod=function(i,o,E,q){var ht=i.key;i.kind==="constructor"?(o&&this.raise(ht.start,"Constructor can't be a generator"),E&&this.raise(ht.start,"Constructor can't be an async method")):i.static&&Y(i,"prototype")&&this.raise(ht.start,"Classes may not have a static property named prototype");var Lt=i.value=this.parseMethod(o,E,q);return i.kind==="get"&&Lt.params.length!==0&&this.raiseRecoverable(Lt.start,"getter should have no params"),i.kind==="set"&&Lt.params.length!==1&&this.raiseRecoverable(Lt.start,"setter should have exactly one param"),i.kind==="set"&&Lt.params[0].type==="RestElement"&&this.raiseRecoverable(Lt.params[0].start,"Setter cannot use rest params"),this.finishNode(i,"MethodDefinition")},h.parseClassField=function(i){return Y(i,"constructor")?this.raise(i.key.start,"Classes can't have a field named 'constructor'"):i.static&&Y(i,"prototype")&&this.raise(i.key.start,"Classes can't have a static field named 'prototype'"),this.eat(f.eq)?(this.enterScope(Ue|ge),i.value=this.parseMaybeAssign(),this.exitScope()):i.value=null,this.semicolon(),this.finishNode(i,"PropertyDefinition")},h.parseClassStaticBlock=function(i){i.body=[];var o=this.labels;for(this.labels=[],this.enterScope(Re|ge);this.type!==f.braceR;){var E=this.parseStatement(null);i.body.push(E)}return this.next(),this.exitScope(),this.labels=o,this.finishNode(i,"StaticBlock")},h.parseClassId=function(i,o){this.type===f.name?(i.id=this.parseIdent(),o&&this.checkLValSimple(i.id,Ae,!1)):(o===!0&&this.unexpected(),i.id=null)},h.parseClassSuper=function(i){i.superClass=this.eat(f._extends)?this.parseExprSubscripts(null,!1):null},h.enterClassBody=function(){var i={declared:Object.create(null),used:[]};return this.privateNameStack.push(i),i.declared},h.exitClassBody=function(){var i=this.privateNameStack.pop(),o=i.declared,E=i.used;if(this.options.checkPrivateFields)for(var q=this.privateNameStack.length,ht=q===0?null:this.privateNameStack[q-1],Lt=0;Lt<E.length;++Lt){var Ft=E[Lt];Nt(o,Ft.name)||(ht?ht.used.push(Ft):this.raiseRecoverable(Ft.start,"Private field '#"+Ft.name+"' must be declared in an enclosing class"))}};function w(i,o){var E=o.key.name,q=i[E],ht="true";return o.type==="MethodDefinition"&&(o.kind==="get"||o.kind==="set")&&(ht=(o.static?"s":"i")+o.kind),q==="iget"&&ht==="iset"||q==="iset"&&ht==="iget"||q==="sget"&&ht==="sset"||q==="sset"&&ht==="sget"?(i[E]="true",!1):q?!0:(i[E]=ht,!1)}function Y(i,o){var E=i.computed,q=i.key;return!E&&(q.type==="Identifier"&&q.name===o||q.type==="Literal"&&q.value===o)}h.parseExportAllDeclaration=function(i,o){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(i.exported=this.parseModuleExportName(),this.checkExport(o,i.exported,this.lastTokStart)):i.exported=null),this.expectContextual("from"),this.type!==f.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ExportAllDeclaration")},h.parseExport=function(i,o){if(this.next(),this.eat(f.star))return this.parseExportAllDeclaration(i,o);if(this.eat(f._default))return this.checkExport(o,"default",this.lastTokStart),i.declaration=this.parseExportDefaultDeclaration(),this.finishNode(i,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())i.declaration=this.parseExportDeclaration(i),i.declaration.type==="VariableDeclaration"?this.checkVariableExport(o,i.declaration.declarations):this.checkExport(o,i.declaration.id,i.declaration.id.start),i.specifiers=[],i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[]);else{if(i.declaration=null,i.specifiers=this.parseExportSpecifiers(o),this.eatContextual("from"))this.type!==f.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause());else{for(var E=0,q=i.specifiers;E<q.length;E+=1){var ht=q[E];this.checkUnreserved(ht.local),this.checkLocalExport(ht.local),ht.local.type==="Literal"&&this.raise(ht.local.start,"A string literal cannot be used as an exported binding without `from`.")}i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[])}this.semicolon()}return this.finishNode(i,"ExportNamedDeclaration")},h.parseExportDeclaration=function(i){return this.parseStatement(null)},h.parseExportDefaultDeclaration=function(){var i;if(this.type===f._function||(i=this.isAsyncFunction())){var o=this.startNode();return this.next(),i&&this.next(),this.parseFunction(o,T|C,!1,i)}else if(this.type===f._class){var E=this.startNode();return this.parseClass(E,"nullableID")}else{var q=this.parseMaybeAssign();return this.semicolon(),q}},h.checkExport=function(i,o,E){i&&(typeof o!="string"&&(o=o.type==="Identifier"?o.name:o.value),Nt(i,o)&&this.raiseRecoverable(E,"Duplicate export '"+o+"'"),i[o]=!0)},h.checkPatternExport=function(i,o){var E=o.type;if(E==="Identifier")this.checkExport(i,o,o.start);else if(E==="ObjectPattern")for(var q=0,ht=o.properties;q<ht.length;q+=1){var Lt=ht[q];this.checkPatternExport(i,Lt)}else if(E==="ArrayPattern")for(var Ft=0,Yt=o.elements;Ft<Yt.length;Ft+=1){var ae=Yt[Ft];ae&&this.checkPatternExport(i,ae)}else E==="Property"?this.checkPatternExport(i,o.value):E==="AssignmentPattern"?this.checkPatternExport(i,o.left):E==="RestElement"&&this.checkPatternExport(i,o.argument)},h.checkVariableExport=function(i,o){if(i)for(var E=0,q=o;E<q.length;E+=1){var ht=q[E];this.checkPatternExport(i,ht.id)}},h.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},h.parseExportSpecifier=function(i){var o=this.startNode();return o.local=this.parseModuleExportName(),o.exported=this.eatContextual("as")?this.parseModuleExportName():o.local,this.checkExport(i,o.exported,o.exported.start),this.finishNode(o,"ExportSpecifier")},h.parseExportSpecifiers=function(i){var o=[],E=!0;for(this.expect(f.braceL);!this.eat(f.braceR);){if(E)E=!1;else if(this.expect(f.comma),this.afterTrailingComma(f.braceR))break;o.push(this.parseExportSpecifier(i))}return o},h.parseImport=function(i){return this.next(),this.type===f.string?(i.specifiers=v,i.source=this.parseExprAtom()):(i.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),i.source=this.type===f.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ImportDeclaration")},h.parseImportSpecifier=function(){var i=this.startNode();return i.imported=this.parseModuleExportName(),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLValSimple(i.local,Ae),this.finishNode(i,"ImportSpecifier")},h.parseImportDefaultSpecifier=function(){var i=this.startNode();return i.local=this.parseIdent(),this.checkLValSimple(i.local,Ae),this.finishNode(i,"ImportDefaultSpecifier")},h.parseImportNamespaceSpecifier=function(){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLValSimple(i.local,Ae),this.finishNode(i,"ImportNamespaceSpecifier")},h.parseImportSpecifiers=function(){var i=[],o=!0;if(this.type===f.name&&(i.push(this.parseImportDefaultSpecifier()),!this.eat(f.comma)))return i;if(this.type===f.star)return i.push(this.parseImportNamespaceSpecifier()),i;for(this.expect(f.braceL);!this.eat(f.braceR);){if(o)o=!1;else if(this.expect(f.comma),this.afterTrailingComma(f.braceR))break;i.push(this.parseImportSpecifier())}return i},h.parseWithClause=function(){var i=[];if(!this.eat(f._with))return i;this.expect(f.braceL);for(var o={},E=!0;!this.eat(f.braceR);){if(E)E=!1;else if(this.expect(f.comma),this.afterTrailingComma(f.braceR))break;var q=this.parseImportAttribute(),ht=q.key.type==="Identifier"?q.key.name:q.key.value;Nt(o,ht)&&this.raiseRecoverable(q.key.start,"Duplicate attribute key '"+ht+"'"),o[ht]=!0,i.push(q)}return i},h.parseImportAttribute=function(){var i=this.startNode();return i.key=this.type===f.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(f.colon),this.type!==f.string&&this.unexpected(),i.value=this.parseExprAtom(),this.finishNode(i,"ImportAttribute")},h.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===f.string){var i=this.parseLiteral(this.value);return Ct.test(i.value)&&this.raise(i.start,"An export name cannot include a lone surrogate."),i}return this.parseIdent(!0)},h.adaptDirectivePrologue=function(i){for(var o=0;o<i.length&&this.isDirectiveCandidate(i[o]);++o)i[o].directive=i[o].expression.raw.slice(1,-1)},h.isDirectiveCandidate=function(i){return this.options.ecmaVersion>=5&&i.type==="ExpressionStatement"&&i.expression.type==="Literal"&&typeof i.expression.value=="string"&&(this.input[i.start]==='"'||this.input[i.start]==="'")};var M=e.prototype;M.toAssignable=function(i,o,E){if(this.options.ecmaVersion>=6&&i)switch(i.type){case"Identifier":this.inAsync&&i.name==="await"&&this.raise(i.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":i.type="ObjectPattern",E&&this.checkPatternErrors(E,!0);for(var q=0,ht=i.properties;q<ht.length;q+=1){var Lt=ht[q];this.toAssignable(Lt,o),Lt.type==="RestElement"&&(Lt.argument.type==="ArrayPattern"||Lt.argument.type==="ObjectPattern")&&this.raise(Lt.argument.start,"Unexpected token")}break;case"Property":i.kind!=="init"&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,o);break;case"ArrayExpression":i.type="ArrayPattern",E&&this.checkPatternErrors(E,!0),this.toAssignableList(i.elements,o);break;case"SpreadElement":i.type="RestElement",this.toAssignable(i.argument,o),i.argument.type==="AssignmentPattern"&&this.raise(i.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":i.operator!=="="&&this.raise(i.left.end,"Only '=' operator can be used for specifying default value."),i.type="AssignmentPattern",delete i.operator,this.toAssignable(i.left,o);break;case"ParenthesizedExpression":this.toAssignable(i.expression,o,E);break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!o)break;default:this.raise(i.start,"Assigning to rvalue")}else E&&this.checkPatternErrors(E,!0);return i},M.toAssignableList=function(i,o){for(var E=i.length,q=0;q<E;q++){var ht=i[q];ht&&this.toAssignable(ht,o)}if(E){var Lt=i[E-1];this.options.ecmaVersion===6&&o&&Lt&&Lt.type==="RestElement"&&Lt.argument.type!=="Identifier"&&this.unexpected(Lt.argument.start)}return i},M.parseSpread=function(i){var o=this.startNode();return this.next(),o.argument=this.parseMaybeAssign(!1,i),this.finishNode(o,"SpreadElement")},M.parseRestBinding=function(){var i=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==f.name&&this.unexpected(),i.argument=this.parseBindingAtom(),this.finishNode(i,"RestElement")},M.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case f.bracketL:var i=this.startNode();return this.next(),i.elements=this.parseBindingList(f.bracketR,!0,!0),this.finishNode(i,"ArrayPattern");case f.braceL:return this.parseObj(!0)}return this.parseIdent()},M.parseBindingList=function(i,o,E,q){for(var ht=[],Lt=!0;!this.eat(i);)if(Lt?Lt=!1:this.expect(f.comma),o&&this.type===f.comma)ht.push(null);else{if(E&&this.afterTrailingComma(i))break;if(this.type===f.ellipsis){var Ft=this.parseRestBinding();this.parseBindingListItem(Ft),ht.push(Ft),this.type===f.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(i);break}else ht.push(this.parseAssignableListItem(q))}return ht},M.parseAssignableListItem=function(i){var o=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(o),o},M.parseBindingListItem=function(i){return i},M.parseMaybeDefault=function(i,o,E){if(E=E||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(f.eq))return E;var q=this.startNodeAt(i,o);return q.left=E,q.right=this.parseMaybeAssign(),this.finishNode(q,"AssignmentPattern")},M.checkLValSimple=function(i,o,E){o===void 0&&(o=Ve);var q=o!==Ve;switch(i.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(i.name)&&this.raiseRecoverable(i.start,(q?"Binding ":"Assigning to ")+i.name+" in strict mode"),q&&(o===Ae&&i.name==="let"&&this.raiseRecoverable(i.start,"let is disallowed as a lexically bound name"),E&&(Nt(E,i.name)&&this.raiseRecoverable(i.start,"Argument name clash"),E[i.name]=!0),o!==t&&this.declareName(i.name,o,i.start));break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":q&&this.raiseRecoverable(i.start,"Binding member expression");break;case"ParenthesizedExpression":return q&&this.raiseRecoverable(i.start,"Binding parenthesized expression"),this.checkLValSimple(i.expression,o,E);default:this.raise(i.start,(q?"Binding":"Assigning to")+" rvalue")}},M.checkLValPattern=function(i,o,E){switch(o===void 0&&(o=Ve),i.type){case"ObjectPattern":for(var q=0,ht=i.properties;q<ht.length;q+=1){var Lt=ht[q];this.checkLValInnerPattern(Lt,o,E)}break;case"ArrayPattern":for(var Ft=0,Yt=i.elements;Ft<Yt.length;Ft+=1){var ae=Yt[Ft];ae&&this.checkLValInnerPattern(ae,o,E)}break;default:this.checkLValSimple(i,o,E)}},M.checkLValInnerPattern=function(i,o,E){switch(o===void 0&&(o=Ve),i.type){case"Property":this.checkLValInnerPattern(i.value,o,E);break;case"AssignmentPattern":this.checkLValPattern(i.left,o,E);break;case"RestElement":this.checkLValPattern(i.argument,o,E);break;default:this.checkLValPattern(i,o,E)}};var j=function(o,E,q,ht,Lt){this.token=o,this.isExpr=!!E,this.preserveSpace=!!q,this.override=ht,this.generator=!!Lt},k={b_stat:new j("{",!1),b_expr:new j("{",!0),b_tmpl:new j("${",!1),p_stat:new j("(",!1),p_expr:new j("(",!0),q_tmpl:new j("`",!0,!0,function(i){return i.tryReadTemplateToken()}),f_stat:new j("function",!1),f_expr:new j("function",!0),f_expr_gen:new j("function",!0,!1,null,!0),f_gen:new j("function",!1,!1,null,!0)},V=e.prototype;V.initialContext=function(){return[k.b_stat]},V.curContext=function(){return this.context[this.context.length-1]},V.braceIsBlock=function(i){var o=this.curContext();return o===k.f_expr||o===k.f_stat?!0:i===f.colon&&(o===k.b_stat||o===k.b_expr)?!o.isExpr:i===f._return||i===f.name&&this.exprAllowed?wt.test(this.input.slice(this.lastTokEnd,this.start)):i===f._else||i===f.semi||i===f.eof||i===f.parenR||i===f.arrow?!0:i===f.braceL?o===k.b_stat:i===f._var||i===f._const||i===f.name?!1:!this.exprAllowed},V.inGeneratorContext=function(){for(var i=this.context.length-1;i>=1;i--){var o=this.context[i];if(o.token==="function")return o.generator}return!1},V.updateContext=function(i){var o,E=this.type;E.keyword&&i===f.dot?this.exprAllowed=!1:(o=E.updateContext)?o.call(this,i):this.exprAllowed=E.beforeExpr},V.overrideContext=function(i){this.curContext()!==i&&(this.context[this.context.length-1]=i)},f.parenR.updateContext=f.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var i=this.context.pop();i===k.b_stat&&this.curContext().token==="function"&&(i=this.context.pop()),this.exprAllowed=!i.isExpr},f.braceL.updateContext=function(i){this.context.push(this.braceIsBlock(i)?k.b_stat:k.b_expr),this.exprAllowed=!0},f.dollarBraceL.updateContext=function(){this.context.push(k.b_tmpl),this.exprAllowed=!0},f.parenL.updateContext=function(i){var o=i===f._if||i===f._for||i===f._with||i===f._while;this.context.push(o?k.p_stat:k.p_expr),this.exprAllowed=!0},f.incDec.updateContext=function(){},f._function.updateContext=f._class.updateContext=function(i){i.beforeExpr&&i!==f._else&&!(i===f.semi&&this.curContext()!==k.p_stat)&&!(i===f._return&&wt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((i===f.colon||i===f.braceL)&&this.curContext()===k.b_stat)?this.context.push(k.f_expr):this.context.push(k.f_stat),this.exprAllowed=!1},f.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},f.backQuote.updateContext=function(){this.curContext()===k.q_tmpl?this.context.pop():this.context.push(k.q_tmpl),this.exprAllowed=!1},f.star.updateContext=function(i){if(i===f._function){var o=this.context.length-1;this.context[o]===k.f_expr?this.context[o]=k.f_expr_gen:this.context[o]=k.f_gen}this.exprAllowed=!0},f.name.updateContext=function(i){var o=!1;this.options.ecmaVersion>=6&&i!==f.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(o=!0),this.exprAllowed=o};var m=e.prototype;m.checkPropClash=function(i,o,E){if(!(this.options.ecmaVersion>=9&&i.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(i.computed||i.method||i.shorthand))){var q=i.key,ht;switch(q.type){case"Identifier":ht=q.name;break;case"Literal":ht=String(q.value);break;default:return}var Lt=i.kind;if(this.options.ecmaVersion>=6){ht==="__proto__"&&Lt==="init"&&(o.proto&&(E?E.doubleProto<0&&(E.doubleProto=q.start):this.raiseRecoverable(q.start,"Redefinition of __proto__ property")),o.proto=!0);return}ht="$"+ht;var Ft=o[ht];if(Ft){var Yt;Lt==="init"?Yt=this.strict&&Ft.init||Ft.get||Ft.set:Yt=Ft.init||Ft[Lt],Yt&&this.raiseRecoverable(q.start,"Redefinition of property")}else Ft=o[ht]={init:!1,get:!1,set:!1};Ft[Lt]=!0}},m.parseExpression=function(i,o){var E=this.start,q=this.startLoc,ht=this.parseMaybeAssign(i,o);if(this.type===f.comma){var Lt=this.startNodeAt(E,q);for(Lt.expressions=[ht];this.eat(f.comma);)Lt.expressions.push(this.parseMaybeAssign(i,o));return this.finishNode(Lt,"SequenceExpression")}return ht},m.parseMaybeAssign=function(i,o,E){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(i);this.exprAllowed=!1}var q=!1,ht=-1,Lt=-1,Ft=-1;o?(ht=o.parenthesizedAssign,Lt=o.trailingComma,Ft=o.doubleProto,o.parenthesizedAssign=o.trailingComma=-1):(o=new u,q=!0);var Yt=this.start,ae=this.startLoc;(this.type===f.parenL||this.type===f.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=i==="await");var xe=this.parseMaybeConditional(i,o);if(E&&(xe=E.call(this,xe,Yt,ae)),this.type.isAssign){var Te=this.startNodeAt(Yt,ae);return Te.operator=this.value,this.type===f.eq&&(xe=this.toAssignable(xe,!1,o)),q||(o.parenthesizedAssign=o.trailingComma=o.doubleProto=-1),o.shorthandAssign>=xe.start&&(o.shorthandAssign=-1),this.type===f.eq?this.checkLValPattern(xe):this.checkLValSimple(xe),Te.left=xe,this.next(),Te.right=this.parseMaybeAssign(i),Ft>-1&&(o.doubleProto=Ft),this.finishNode(Te,"AssignmentExpression")}else q&&this.checkExpressionErrors(o,!0);return ht>-1&&(o.parenthesizedAssign=ht),Lt>-1&&(o.trailingComma=Lt),xe},m.parseMaybeConditional=function(i,o){var E=this.start,q=this.startLoc,ht=this.parseExprOps(i,o);if(this.checkExpressionErrors(o))return ht;if(this.eat(f.question)){var Lt=this.startNodeAt(E,q);return Lt.test=ht,Lt.consequent=this.parseMaybeAssign(),this.expect(f.colon),Lt.alternate=this.parseMaybeAssign(i),this.finishNode(Lt,"ConditionalExpression")}return ht},m.parseExprOps=function(i,o){var E=this.start,q=this.startLoc,ht=this.parseMaybeUnary(o,!1,!1,i);return this.checkExpressionErrors(o)||ht.start===E&&ht.type==="ArrowFunctionExpression"?ht:this.parseExprOp(ht,E,q,-1,i)},m.parseExprOp=function(i,o,E,q,ht){var Lt=this.type.binop;if(Lt!=null&&(!ht||this.type!==f._in)&&Lt>q){var Ft=this.type===f.logicalOR||this.type===f.logicalAND,Yt=this.type===f.coalesce;Yt&&(Lt=f.logicalAND.binop);var ae=this.value;this.next();var xe=this.start,Te=this.startLoc,qe=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,ht),xe,Te,Lt,ht),ei=this.buildBinary(o,E,i,qe,ae,Ft||Yt);return(Ft&&this.type===f.coalesce||Yt&&(this.type===f.logicalOR||this.type===f.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(ei,o,E,q,ht)}return i},m.buildBinary=function(i,o,E,q,ht,Lt){q.type==="PrivateIdentifier"&&this.raise(q.start,"Private identifier can only be left side of binary expression");var Ft=this.startNodeAt(i,o);return Ft.left=E,Ft.operator=ht,Ft.right=q,this.finishNode(Ft,Lt?"LogicalExpression":"BinaryExpression")},m.parseMaybeUnary=function(i,o,E,q){var ht=this.start,Lt=this.startLoc,Ft;if(this.isContextual("await")&&this.canAwait)Ft=this.parseAwait(q),o=!0;else if(this.type.prefix){var Yt=this.startNode(),ae=this.type===f.incDec;Yt.operator=this.value,Yt.prefix=!0,this.next(),Yt.argument=this.parseMaybeUnary(null,!0,ae,q),this.checkExpressionErrors(i,!0),ae?this.checkLValSimple(Yt.argument):this.strict&&Yt.operator==="delete"&&F(Yt.argument)?this.raiseRecoverable(Yt.start,"Deleting local variable in strict mode"):Yt.operator==="delete"&&X(Yt.argument)?this.raiseRecoverable(Yt.start,"Private fields can not be deleted"):o=!0,Ft=this.finishNode(Yt,ae?"UpdateExpression":"UnaryExpression")}else if(!o&&this.type===f.privateId)(q||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Ft=this.parsePrivateIdent(),this.type!==f._in&&this.unexpected();else{if(Ft=this.parseExprSubscripts(i,q),this.checkExpressionErrors(i))return Ft;for(;this.type.postfix&&!this.canInsertSemicolon();){var xe=this.startNodeAt(ht,Lt);xe.operator=this.value,xe.prefix=!1,xe.argument=Ft,this.checkLValSimple(Ft),this.next(),Ft=this.finishNode(xe,"UpdateExpression")}}if(!E&&this.eat(f.starstar))if(o)this.unexpected(this.lastTokStart);else return this.buildBinary(ht,Lt,Ft,this.parseMaybeUnary(null,!1,!1,q),"**",!1);else return Ft};function F(i){return i.type==="Identifier"||i.type==="ParenthesizedExpression"&&F(i.expression)}function X(i){return i.type==="MemberExpression"&&i.property.type==="PrivateIdentifier"||i.type==="ChainExpression"&&X(i.expression)||i.type==="ParenthesizedExpression"&&X(i.expression)}m.parseExprSubscripts=function(i,o){var E=this.start,q=this.startLoc,ht=this.parseExprAtom(i,o);if(ht.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return ht;var Lt=this.parseSubscripts(ht,E,q,!1,o);return i&&Lt.type==="MemberExpression"&&(i.parenthesizedAssign>=Lt.start&&(i.parenthesizedAssign=-1),i.parenthesizedBind>=Lt.start&&(i.parenthesizedBind=-1),i.trailingComma>=Lt.start&&(i.trailingComma=-1)),Lt},m.parseSubscripts=function(i,o,E,q,ht){for(var Lt=this.options.ecmaVersion>=8&&i.type==="Identifier"&&i.name==="async"&&this.lastTokEnd===i.end&&!this.canInsertSemicolon()&&i.end-i.start===5&&this.potentialArrowAt===i.start,Ft=!1;;){var Yt=this.parseSubscript(i,o,E,q,Lt,Ft,ht);if(Yt.optional&&(Ft=!0),Yt===i||Yt.type==="ArrowFunctionExpression"){if(Ft){var ae=this.startNodeAt(o,E);ae.expression=Yt,Yt=this.finishNode(ae,"ChainExpression")}return Yt}i=Yt}},m.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(f.arrow)},m.parseSubscriptAsyncArrow=function(i,o,E,q){return this.parseArrowExpression(this.startNodeAt(i,o),E,!0,q)},m.parseSubscript=function(i,o,E,q,ht,Lt,Ft){var Yt=this.options.ecmaVersion>=11,ae=Yt&&this.eat(f.questionDot);q&&ae&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var xe=this.eat(f.bracketL);if(xe||ae&&this.type!==f.parenL&&this.type!==f.backQuote||this.eat(f.dot)){var Te=this.startNodeAt(o,E);Te.object=i,xe?(Te.property=this.parseExpression(),this.expect(f.bracketR)):this.type===f.privateId&&i.type!=="Super"?Te.property=this.parsePrivateIdent():Te.property=this.parseIdent(this.options.allowReserved!=="never"),Te.computed=!!xe,Yt&&(Te.optional=ae),i=this.finishNode(Te,"MemberExpression")}else if(!q&&this.eat(f.parenL)){var qe=new u,ei=this.yieldPos,Di=this.awaitPos,mi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Ti=this.parseExprList(f.parenR,this.options.ecmaVersion>=8,!1,qe);if(ht&&!ae&&this.shouldParseAsyncArrow())return this.checkPatternErrors(qe,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=ei,this.awaitPos=Di,this.awaitIdentPos=mi,this.parseSubscriptAsyncArrow(o,E,Ti,Ft);this.checkExpressionErrors(qe,!0),this.yieldPos=ei||this.yieldPos,this.awaitPos=Di||this.awaitPos,this.awaitIdentPos=mi||this.awaitIdentPos;var Ni=this.startNodeAt(o,E);Ni.callee=i,Ni.arguments=Ti,Yt&&(Ni.optional=ae),i=this.finishNode(Ni,"CallExpression")}else if(this.type===f.backQuote){(ae||Lt)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var zi=this.startNodeAt(o,E);zi.tag=i,zi.quasi=this.parseTemplate({isTagged:!0}),i=this.finishNode(zi,"TaggedTemplateExpression")}return i},m.parseExprAtom=function(i,o,E){this.type===f.slash&&this.readRegexp();var q,ht=this.potentialArrowAt===this.start;switch(this.type){case f._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),q=this.startNode(),this.next(),this.type===f.parenL&&!this.allowDirectSuper&&this.raise(q.start,"super() call outside constructor of a subclass"),this.type!==f.dot&&this.type!==f.bracketL&&this.type!==f.parenL&&this.unexpected(),this.finishNode(q,"Super");case f._this:return q=this.startNode(),this.next(),this.finishNode(q,"ThisExpression");case f.name:var Lt=this.start,Ft=this.startLoc,Yt=this.containsEsc,ae=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Yt&&ae.name==="async"&&!this.canInsertSemicolon()&&this.eat(f._function))return this.overrideContext(k.f_expr),this.parseFunction(this.startNodeAt(Lt,Ft),0,!1,!0,o);if(ht&&!this.canInsertSemicolon()){if(this.eat(f.arrow))return this.parseArrowExpression(this.startNodeAt(Lt,Ft),[ae],!1,o);if(this.options.ecmaVersion>=8&&ae.name==="async"&&this.type===f.name&&!Yt&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return ae=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(f.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Lt,Ft),[ae],!0,o)}return ae;case f.regexp:var xe=this.value;return q=this.parseLiteral(xe.value),q.regex={pattern:xe.pattern,flags:xe.flags},q;case f.num:case f.string:return this.parseLiteral(this.value);case f._null:case f._true:case f._false:return q=this.startNode(),q.value=this.type===f._null?null:this.type===f._true,q.raw=this.type.keyword,this.next(),this.finishNode(q,"Literal");case f.parenL:var Te=this.start,qe=this.parseParenAndDistinguishExpression(ht,o);return i&&(i.parenthesizedAssign<0&&!this.isSimpleAssignTarget(qe)&&(i.parenthesizedAssign=Te),i.parenthesizedBind<0&&(i.parenthesizedBind=Te)),qe;case f.bracketL:return q=this.startNode(),this.next(),q.elements=this.parseExprList(f.bracketR,!0,!0,i),this.finishNode(q,"ArrayExpression");case f.braceL:return this.overrideContext(k.b_expr),this.parseObj(!1,i);case f._function:return q=this.startNode(),this.next(),this.parseFunction(q,0);case f._class:return this.parseClass(this.startNode(),!1);case f._new:return this.parseNew();case f.backQuote:return this.parseTemplate();case f._import:return this.options.ecmaVersion>=11?this.parseExprImport(E):this.unexpected();default:return this.parseExprAtomDefault()}},m.parseExprAtomDefault=function(){this.unexpected()},m.parseExprImport=function(i){var o=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===f.parenL&&!i)return this.parseDynamicImport(o);if(this.type===f.dot){var E=this.startNodeAt(o.start,o.loc&&o.loc.start);return E.name="import",o.meta=this.finishNode(E,"Identifier"),this.parseImportMeta(o)}else this.unexpected()},m.parseDynamicImport=function(i){if(this.next(),i.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(f.parenR)?i.options=null:(this.expect(f.comma),this.afterTrailingComma(f.parenR)?i.options=null:(i.options=this.parseMaybeAssign(),this.eat(f.parenR)||(this.expect(f.comma),this.afterTrailingComma(f.parenR)||this.unexpected())));else if(!this.eat(f.parenR)){var o=this.start;this.eat(f.comma)&&this.eat(f.parenR)?this.raiseRecoverable(o,"Trailing comma is not allowed in import()"):this.unexpected(o)}return this.finishNode(i,"ImportExpression")},m.parseImportMeta=function(i){this.next();var o=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="meta"&&this.raiseRecoverable(i.property.start,"The only valid meta property for import is 'import.meta'"),o&&this.raiseRecoverable(i.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(i.start,"Cannot use 'import.meta' outside a module"),this.finishNode(i,"MetaProperty")},m.parseLiteral=function(i){var o=this.startNode();return o.value=i,o.raw=this.input.slice(this.start,this.end),o.raw.charCodeAt(o.raw.length-1)===110&&(o.bigint=o.value!=null?o.value.toString():o.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(o,"Literal")},m.parseParenExpression=function(){this.expect(f.parenL);var i=this.parseExpression();return this.expect(f.parenR),i},m.shouldParseArrow=function(i){return!this.canInsertSemicolon()},m.parseParenAndDistinguishExpression=function(i,o){var E=this.start,q=this.startLoc,ht,Lt=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Ft=this.start,Yt=this.startLoc,ae=[],xe=!0,Te=!1,qe=new u,ei=this.yieldPos,Di=this.awaitPos,mi;for(this.yieldPos=0,this.awaitPos=0;this.type!==f.parenR;)if(xe?xe=!1:this.expect(f.comma),Lt&&this.afterTrailingComma(f.parenR,!0)){Te=!0;break}else if(this.type===f.ellipsis){mi=this.start,ae.push(this.parseParenItem(this.parseRestBinding())),this.type===f.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else ae.push(this.parseMaybeAssign(!1,qe,this.parseParenItem));var Ti=this.lastTokEnd,Ni=this.lastTokEndLoc;if(this.expect(f.parenR),i&&this.shouldParseArrow(ae)&&this.eat(f.arrow))return this.checkPatternErrors(qe,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=ei,this.awaitPos=Di,this.parseParenArrowList(E,q,ae,o);(!ae.length||Te)&&this.unexpected(this.lastTokStart),mi&&this.unexpected(mi),this.checkExpressionErrors(qe,!0),this.yieldPos=ei||this.yieldPos,this.awaitPos=Di||this.awaitPos,ae.length>1?(ht=this.startNodeAt(Ft,Yt),ht.expressions=ae,this.finishNodeAt(ht,"SequenceExpression",Ti,Ni)):ht=ae[0]}else ht=this.parseParenExpression();if(this.options.preserveParens){var zi=this.startNodeAt(E,q);return zi.expression=ht,this.finishNode(zi,"ParenthesizedExpression")}else return ht},m.parseParenItem=function(i){return i},m.parseParenArrowList=function(i,o,E,q){return this.parseArrowExpression(this.startNodeAt(i,o),E,!1,q)};var tt=[];m.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var i=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===f.dot){var o=this.startNodeAt(i.start,i.loc&&i.loc.start);o.name="new",i.meta=this.finishNode(o,"Identifier"),this.next();var E=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="target"&&this.raiseRecoverable(i.property.start,"The only valid meta property for new is 'new.target'"),E&&this.raiseRecoverable(i.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(i.start,"'new.target' can only be used in functions and class static block"),this.finishNode(i,"MetaProperty")}var q=this.start,ht=this.startLoc;return i.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),q,ht,!0,!1),this.eat(f.parenL)?i.arguments=this.parseExprList(f.parenR,this.options.ecmaVersion>=8,!1):i.arguments=tt,this.finishNode(i,"NewExpression")},m.parseTemplateElement=function(i){var o=i.isTagged,E=this.startNode();return this.type===f.invalidTemplate?(o||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),E.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):E.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),E.tail=this.type===f.backQuote,this.finishNode(E,"TemplateElement")},m.parseTemplate=function(i){i===void 0&&(i={});var o=i.isTagged;o===void 0&&(o=!1);var E=this.startNode();this.next(),E.expressions=[];var q=this.parseTemplateElement({isTagged:o});for(E.quasis=[q];!q.tail;)this.type===f.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(f.dollarBraceL),E.expressions.push(this.parseExpression()),this.expect(f.braceR),E.quasis.push(q=this.parseTemplateElement({isTagged:o}));return this.next(),this.finishNode(E,"TemplateLiteral")},m.isAsyncProp=function(i){return!i.computed&&i.key.type==="Identifier"&&i.key.name==="async"&&(this.type===f.name||this.type===f.num||this.type===f.string||this.type===f.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===f.star)&&!wt.test(this.input.slice(this.lastTokEnd,this.start))},m.parseObj=function(i,o){var E=this.startNode(),q=!0,ht={};for(E.properties=[],this.next();!this.eat(f.braceR);){if(q)q=!1;else if(this.expect(f.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(f.braceR))break;var Lt=this.parseProperty(i,o);i||this.checkPropClash(Lt,ht,o),E.properties.push(Lt)}return this.finishNode(E,i?"ObjectPattern":"ObjectExpression")},m.parseProperty=function(i,o){var E=this.startNode(),q,ht,Lt,Ft;if(this.options.ecmaVersion>=9&&this.eat(f.ellipsis))return i?(E.argument=this.parseIdent(!1),this.type===f.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(E,"RestElement")):(E.argument=this.parseMaybeAssign(!1,o),this.type===f.comma&&o&&o.trailingComma<0&&(o.trailingComma=this.start),this.finishNode(E,"SpreadElement"));this.options.ecmaVersion>=6&&(E.method=!1,E.shorthand=!1,(i||o)&&(Lt=this.start,Ft=this.startLoc),i||(q=this.eat(f.star)));var Yt=this.containsEsc;return this.parsePropertyName(E),!i&&!Yt&&this.options.ecmaVersion>=8&&!q&&this.isAsyncProp(E)?(ht=!0,q=this.options.ecmaVersion>=9&&this.eat(f.star),this.parsePropertyName(E)):ht=!1,this.parsePropertyValue(E,i,q,ht,Lt,Ft,o,Yt),this.finishNode(E,"Property")},m.parseGetterSetter=function(i){var o=i.key.name;this.parsePropertyName(i),i.value=this.parseMethod(!1),i.kind=o;var E=i.kind==="get"?0:1;if(i.value.params.length!==E){var q=i.value.start;i.kind==="get"?this.raiseRecoverable(q,"getter should have no params"):this.raiseRecoverable(q,"setter should have exactly one param")}else i.kind==="set"&&i.value.params[0].type==="RestElement"&&this.raiseRecoverable(i.value.params[0].start,"Setter cannot use rest params")},m.parsePropertyValue=function(i,o,E,q,ht,Lt,Ft,Yt){(E||q)&&this.type===f.colon&&this.unexpected(),this.eat(f.colon)?(i.value=o?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Ft),i.kind="init"):this.options.ecmaVersion>=6&&this.type===f.parenL?(o&&this.unexpected(),i.method=!0,i.value=this.parseMethod(E,q),i.kind="init"):!o&&!Yt&&this.options.ecmaVersion>=5&&!i.computed&&i.key.type==="Identifier"&&(i.key.name==="get"||i.key.name==="set")&&this.type!==f.comma&&this.type!==f.braceR&&this.type!==f.eq?((E||q)&&this.unexpected(),this.parseGetterSetter(i)):this.options.ecmaVersion>=6&&!i.computed&&i.key.type==="Identifier"?((E||q)&&this.unexpected(),this.checkUnreserved(i.key),i.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=ht),o?i.value=this.parseMaybeDefault(ht,Lt,this.copyNode(i.key)):this.type===f.eq&&Ft?(Ft.shorthandAssign<0&&(Ft.shorthandAssign=this.start),i.value=this.parseMaybeDefault(ht,Lt,this.copyNode(i.key))):i.value=this.copyNode(i.key),i.kind="init",i.shorthand=!0):this.unexpected()},m.parsePropertyName=function(i){if(this.options.ecmaVersion>=6){if(this.eat(f.bracketL))return i.computed=!0,i.key=this.parseMaybeAssign(),this.expect(f.bracketR),i.key;i.computed=!1}return i.key=this.type===f.num||this.type===f.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},m.initFunction=function(i){i.id=null,this.options.ecmaVersion>=6&&(i.generator=i.expression=!1),this.options.ecmaVersion>=8&&(i.async=!1)},m.parseMethod=function(i,o,E){var q=this.startNode(),ht=this.yieldPos,Lt=this.awaitPos,Ft=this.awaitIdentPos;return this.initFunction(q),this.options.ecmaVersion>=6&&(q.generator=i),this.options.ecmaVersion>=8&&(q.async=!!o),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ti(o,q.generator)|ge|(E?Ze:0)),this.expect(f.parenL),q.params=this.parseBindingList(f.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(q,!1,!0,!1),this.yieldPos=ht,this.awaitPos=Lt,this.awaitIdentPos=Ft,this.finishNode(q,"FunctionExpression")},m.parseArrowExpression=function(i,o,E,q){var ht=this.yieldPos,Lt=this.awaitPos,Ft=this.awaitIdentPos;return this.enterScope(ti(E,!1)|ce),this.initFunction(i),this.options.ecmaVersion>=8&&(i.async=!!E),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,i.params=this.toAssignableList(o,!0),this.parseFunctionBody(i,!0,!1,q),this.yieldPos=ht,this.awaitPos=Lt,this.awaitIdentPos=Ft,this.finishNode(i,"ArrowFunctionExpression")},m.parseFunctionBody=function(i,o,E,q){var ht=o&&this.type!==f.braceL,Lt=this.strict,Ft=!1;if(ht)i.body=this.parseMaybeAssign(q),i.expression=!0,this.checkParams(i,!1);else{var Yt=this.options.ecmaVersion>=7&&!this.isSimpleParamList(i.params);(!Lt||Yt)&&(Ft=this.strictDirective(this.end),Ft&&Yt&&this.raiseRecoverable(i.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var ae=this.labels;this.labels=[],Ft&&(this.strict=!0),this.checkParams(i,!Lt&&!Ft&&!o&&!E&&this.isSimpleParamList(i.params)),this.strict&&i.id&&this.checkLValSimple(i.id,t),i.body=this.parseBlock(!1,void 0,Ft&&!Lt),i.expression=!1,this.adaptDirectivePrologue(i.body.body),this.labels=ae}this.exitScope()},m.isSimpleParamList=function(i){for(var o=0,E=i;o<E.length;o+=1){var q=E[o];if(q.type!=="Identifier")return!1}return!0},m.checkParams=function(i,o){for(var E=Object.create(null),q=0,ht=i.params;q<ht.length;q+=1){var Lt=ht[q];this.checkLValInnerPattern(Lt,Le,o?null:E)}},m.parseExprList=function(i,o,E,q){for(var ht=[],Lt=!0;!this.eat(i);){if(Lt)Lt=!1;else if(this.expect(f.comma),o&&this.afterTrailingComma(i))break;var Ft=void 0;E&&this.type===f.comma?Ft=null:this.type===f.ellipsis?(Ft=this.parseSpread(q),q&&this.type===f.comma&&q.trailingComma<0&&(q.trailingComma=this.start)):Ft=this.parseMaybeAssign(!1,q),ht.push(Ft)}return ht},m.checkUnreserved=function(i){var o=i.start,E=i.end,q=i.name;if(this.inGenerator&&q==="yield"&&this.raiseRecoverable(o,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&q==="await"&&this.raiseRecoverable(o,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&_i)&&q==="arguments"&&this.raiseRecoverable(o,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(q==="arguments"||q==="await")&&this.raise(o,"Cannot use "+q+" in class static initialization block"),this.keywords.test(q)&&this.raise(o,"Unexpected keyword '"+q+"'"),!(this.options.ecmaVersion<6&&this.input.slice(o,E).indexOf("\\")!==-1)){var ht=this.strict?this.reservedWordsStrict:this.reservedWords;ht.test(q)&&(!this.inAsync&&q==="await"&&this.raiseRecoverable(o,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(o,"The keyword '"+q+"' is reserved"))}},m.parseIdent=function(i){var o=this.parseIdentNode();return this.next(!!i),this.finishNode(o,"Identifier"),i||(this.checkUnreserved(o),o.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=o.start)),o},m.parseIdentNode=function(){var i=this.startNode();return this.type===f.name?i.name=this.value:this.type.keyword?(i.name=this.type.keyword,(i.name==="class"||i.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=f.name):this.unexpected(),i},m.parsePrivateIdent=function(){var i=this.startNode();return this.type===f.privateId?i.name=this.value:this.unexpected(),this.next(),this.finishNode(i,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(i.start,"Private field '#"+i.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(i)),i},m.parseYield=function(i){this.yieldPos||(this.yieldPos=this.start);var o=this.startNode();return this.next(),this.type===f.semi||this.canInsertSemicolon()||this.type!==f.star&&!this.type.startsExpr?(o.delegate=!1,o.argument=null):(o.delegate=this.eat(f.star),o.argument=this.parseMaybeAssign(i)),this.finishNode(o,"YieldExpression")},m.parseAwait=function(i){this.awaitPos||(this.awaitPos=this.start);var o=this.startNode();return this.next(),o.argument=this.parseMaybeUnary(null,!0,!1,i),this.finishNode(o,"AwaitExpression")};var U=e.prototype;U.raise=function(i,o){var E=Kt(this.input,i);o+=" ("+E.line+":"+E.column+")",this.sourceFile&&(o+=" in "+this.sourceFile);var q=new SyntaxError(o);throw q.pos=i,q.loc=E,q.raisedAt=this.pos,q},U.raiseRecoverable=U.raise,U.curPosition=function(){if(this.options.locations)return new Ut(this.curLine,this.pos-this.lineStart)};var nt=e.prototype,ut=function(o){this.flags=o,this.var=[],this.lexical=[],this.functions=[]};nt.enterScope=function(i){this.scopeStack.push(new ut(i))},nt.exitScope=function(){this.scopeStack.pop()},nt.treatFunctionsAsVarInScope=function(i){return i.flags&Qt||!this.inModule&&i.flags&Wt},nt.declareName=function(i,o,E){var q=!1;if(o===Ae){var ht=this.currentScope();q=ht.lexical.indexOf(i)>-1||ht.functions.indexOf(i)>-1||ht.var.indexOf(i)>-1,ht.lexical.push(i),this.inModule&&ht.flags&Wt&&delete this.undefinedExports[i]}else if(o===_e){var Lt=this.currentScope();Lt.lexical.push(i)}else if(o===Qe){var Ft=this.currentScope();this.treatFunctionsAsVar?q=Ft.lexical.indexOf(i)>-1:q=Ft.lexical.indexOf(i)>-1||Ft.var.indexOf(i)>-1,Ft.functions.push(i)}else for(var Yt=this.scopeStack.length-1;Yt>=0;--Yt){var ae=this.scopeStack[Yt];if(ae.lexical.indexOf(i)>-1&&!(ae.flags&we&&ae.lexical[0]===i)||!this.treatFunctionsAsVarInScope(ae)&&ae.functions.indexOf(i)>-1){q=!0;break}if(ae.var.push(i),this.inModule&&ae.flags&Wt&&delete this.undefinedExports[i],ae.flags&_i)break}q&&this.raiseRecoverable(E,"Identifier '"+i+"' has already been declared")},nt.checkLocalExport=function(i){this.scopeStack[0].lexical.indexOf(i.name)===-1&&this.scopeStack[0].var.indexOf(i.name)===-1&&(this.undefinedExports[i.name]=i)},nt.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},nt.currentVarScope=function(){for(var i=this.scopeStack.length-1;;i--){var o=this.scopeStack[i];if(o.flags&(_i|Ue|Re))return o}},nt.currentThisScope=function(){for(var i=this.scopeStack.length-1;;i--){var o=this.scopeStack[i];if(o.flags&(_i|Ue|Re)&&!(o.flags&ce))return o}};var pt=function(o,E,q){this.type="",this.start=E,this.end=0,o.options.locations&&(this.loc=new Ot(o,q)),o.options.directSourceFile&&(this.sourceFile=o.options.directSourceFile),o.options.ranges&&(this.range=[E,0])},bt=e.prototype;bt.startNode=function(){return new pt(this,this.start,this.startLoc)},bt.startNodeAt=function(i,o){return new pt(this,i,o)};function ot(i,o,E,q){return i.type=o,i.end=E,this.options.locations&&(i.loc.end=q),this.options.ranges&&(i.range[1]=E),i}bt.finishNode=function(i,o){return ot.call(this,i,o,this.lastTokEnd,this.lastTokEndLoc)},bt.finishNodeAt=function(i,o,E,q){return ot.call(this,i,o,E,q)},bt.copyNode=function(i){var o=new pt(this,i.start,this.startLoc);for(var E in i)o[E]=i[E];return o};var xt="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",yt="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",At=yt+" Extended_Pictographic",Rt=At,Mt=Rt+" EBase EComp EMod EPres ExtPict",jt=Mt,$t=jt,ie={9:yt,10:At,11:Rt,12:Mt,13:jt,14:$t},oe="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",zt={9:"",10:"",11:"",12:"",13:"",14:oe},Ht="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ne="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ue=ne+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",se=ue+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",fe=se+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",de=fe+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ye=de+" "+xt,Ce={9:ne,10:ue,11:se,12:fe,13:de,14:ye},ve={};function Xe(i){var o=ve[i]={binary:ct(ie[i]+" "+Ht),binaryOfStrings:ct(zt[i]),nonBinary:{General_Category:ct(Ht),Script:ct(Ce[i])}};o.nonBinary.Script_Extensions=o.nonBinary.Script,o.nonBinary.gc=o.nonBinary.General_Category,o.nonBinary.sc=o.nonBinary.Script,o.nonBinary.scx=o.nonBinary.Script_Extensions}for(var Be=0,$e=[9,10,11,12,13,14];Be<$e.length;Be+=1){var We=$e[Be];Xe(We)}var Zt=e.prototype,ze=function(o,E){this.parent=o,this.base=E||this};ze.prototype.separatedFrom=function(o){for(var E=this;E;E=E.parent)for(var q=o;q;q=q.parent)if(E.base===q.base&&E!==q)return!0;return!1},ze.prototype.sibling=function(){return new ze(this.parent,this.base)};var Ke=function(o){this.parser=o,this.validFlags="gim"+(o.options.ecmaVersion>=6?"uy":"")+(o.options.ecmaVersion>=9?"s":"")+(o.options.ecmaVersion>=13?"d":"")+(o.options.ecmaVersion>=15?"v":""),this.unicodeProperties=ve[o.options.ecmaVersion>=14?14:o.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Ke.prototype.reset=function(o,E,q){var ht=q.indexOf("v")!==-1,Lt=q.indexOf("u")!==-1;this.start=o|0,this.source=E+"",this.flags=q,ht&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Lt&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Lt&&this.parser.options.ecmaVersion>=9)},Ke.prototype.raise=function(o){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+o)},Ke.prototype.at=function(o,E){E===void 0&&(E=!1);var q=this.source,ht=q.length;if(o>=ht)return-1;var Lt=q.charCodeAt(o);if(!(E||this.switchU)||Lt<=55295||Lt>=57344||o+1>=ht)return Lt;var Ft=q.charCodeAt(o+1);return Ft>=56320&&Ft<=57343?(Lt<<10)+Ft-56613888:Lt},Ke.prototype.nextIndex=function(o,E){E===void 0&&(E=!1);var q=this.source,ht=q.length;if(o>=ht)return ht;var Lt=q.charCodeAt(o),Ft;return!(E||this.switchU)||Lt<=55295||Lt>=57344||o+1>=ht||(Ft=q.charCodeAt(o+1))<56320||Ft>57343?o+1:o+2},Ke.prototype.current=function(o){return o===void 0&&(o=!1),this.at(this.pos,o)},Ke.prototype.lookahead=function(o){return o===void 0&&(o=!1),this.at(this.nextIndex(this.pos,o),o)},Ke.prototype.advance=function(o){o===void 0&&(o=!1),this.pos=this.nextIndex(this.pos,o)},Ke.prototype.eat=function(o,E){return E===void 0&&(E=!1),this.current(E)===o?(this.advance(E),!0):!1},Ke.prototype.eatChars=function(o,E){E===void 0&&(E=!1);for(var q=this.pos,ht=0,Lt=o;ht<Lt.length;ht+=1){var Ft=Lt[ht],Yt=this.at(q,E);if(Yt===-1||Yt!==Ft)return!1;q=this.nextIndex(q,E)}return this.pos=q,!0},Zt.validateRegExpFlags=function(i){for(var o=i.validFlags,E=i.flags,q=!1,ht=!1,Lt=0;Lt<E.length;Lt++){var Ft=E.charAt(Lt);o.indexOf(Ft)===-1&&this.raise(i.start,"Invalid regular expression flag"),E.indexOf(Ft,Lt+1)>-1&&this.raise(i.start,"Duplicate regular expression flag"),Ft==="u"&&(q=!0),Ft==="v"&&(ht=!0)}this.options.ecmaVersion>=15&&q&&ht&&this.raise(i.start,"Invalid regular expression flag")};function Je(i){for(var o in i)return!0;return!1}Zt.validateRegExpPattern=function(i){this.regexp_pattern(i),!i.switchN&&this.options.ecmaVersion>=9&&Je(i.groupNames)&&(i.switchN=!0,this.regexp_pattern(i))},Zt.regexp_pattern=function(i){i.pos=0,i.lastIntValue=0,i.lastStringValue="",i.lastAssertionIsQuantifiable=!1,i.numCapturingParens=0,i.maxBackReference=0,i.groupNames=Object.create(null),i.backReferenceNames.length=0,i.branchID=null,this.regexp_disjunction(i),i.pos!==i.source.length&&(i.eat(41)&&i.raise("Unmatched ')'"),(i.eat(93)||i.eat(125))&&i.raise("Lone quantifier brackets")),i.maxBackReference>i.numCapturingParens&&i.raise("Invalid escape");for(var o=0,E=i.backReferenceNames;o<E.length;o+=1){var q=E[o];i.groupNames[q]||i.raise("Invalid named capture referenced")}},Zt.regexp_disjunction=function(i){var o=this.options.ecmaVersion>=16;for(o&&(i.branchID=new ze(i.branchID,null)),this.regexp_alternative(i);i.eat(124);)o&&(i.branchID=i.branchID.sibling()),this.regexp_alternative(i);o&&(i.branchID=i.branchID.parent),this.regexp_eatQuantifier(i,!0)&&i.raise("Nothing to repeat"),i.eat(123)&&i.raise("Lone quantifier brackets")},Zt.regexp_alternative=function(i){for(;i.pos<i.source.length&&this.regexp_eatTerm(i););},Zt.regexp_eatTerm=function(i){return this.regexp_eatAssertion(i)?(i.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(i)&&i.switchU&&i.raise("Invalid quantifier"),!0):(i.switchU?this.regexp_eatAtom(i):this.regexp_eatExtendedAtom(i))?(this.regexp_eatQuantifier(i),!0):!1},Zt.regexp_eatAssertion=function(i){var o=i.pos;if(i.lastAssertionIsQuantifiable=!1,i.eat(94)||i.eat(36))return!0;if(i.eat(92)){if(i.eat(66)||i.eat(98))return!0;i.pos=o}if(i.eat(40)&&i.eat(63)){var E=!1;if(this.options.ecmaVersion>=9&&(E=i.eat(60)),i.eat(61)||i.eat(33))return this.regexp_disjunction(i),i.eat(41)||i.raise("Unterminated group"),i.lastAssertionIsQuantifiable=!E,!0}return i.pos=o,!1},Zt.regexp_eatQuantifier=function(i,o){return o===void 0&&(o=!1),this.regexp_eatQuantifierPrefix(i,o)?(i.eat(63),!0):!1},Zt.regexp_eatQuantifierPrefix=function(i,o){return i.eat(42)||i.eat(43)||i.eat(63)||this.regexp_eatBracedQuantifier(i,o)},Zt.regexp_eatBracedQuantifier=function(i,o){var E=i.pos;if(i.eat(123)){var q=0,ht=-1;if(this.regexp_eatDecimalDigits(i)&&(q=i.lastIntValue,i.eat(44)&&this.regexp_eatDecimalDigits(i)&&(ht=i.lastIntValue),i.eat(125)))return ht!==-1&&ht<q&&!o&&i.raise("numbers out of order in {} quantifier"),!0;i.switchU&&!o&&i.raise("Incomplete quantifier"),i.pos=E}return!1},Zt.regexp_eatAtom=function(i){return this.regexp_eatPatternCharacters(i)||i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)},Zt.regexp_eatReverseSolidusAtomEscape=function(i){var o=i.pos;if(i.eat(92)){if(this.regexp_eatAtomEscape(i))return!0;i.pos=o}return!1},Zt.regexp_eatUncapturingGroup=function(i){var o=i.pos;if(i.eat(40)){if(i.eat(63)){if(this.options.ecmaVersion>=16){var E=this.regexp_eatModifiers(i),q=i.eat(45);if(E||q){for(var ht=0;ht<E.length;ht++){var Lt=E.charAt(ht);E.indexOf(Lt,ht+1)>-1&&i.raise("Duplicate regular expression modifiers")}if(q){var Ft=this.regexp_eatModifiers(i);!E&&!Ft&&i.current()===58&&i.raise("Invalid regular expression modifiers");for(var Yt=0;Yt<Ft.length;Yt++){var ae=Ft.charAt(Yt);(Ft.indexOf(ae,Yt+1)>-1||E.indexOf(ae)>-1)&&i.raise("Duplicate regular expression modifiers")}}}}if(i.eat(58)){if(this.regexp_disjunction(i),i.eat(41))return!0;i.raise("Unterminated group")}}i.pos=o}return!1},Zt.regexp_eatCapturingGroup=function(i){if(i.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(i):i.current()===63&&i.raise("Invalid group"),this.regexp_disjunction(i),i.eat(41))return i.numCapturingParens+=1,!0;i.raise("Unterminated group")}return!1},Zt.regexp_eatModifiers=function(i){for(var o="",E=0;(E=i.current())!==-1&&ci(E);)o+=dt(E),i.advance();return o};function ci(i){return i===105||i===109||i===115}Zt.regexp_eatExtendedAtom=function(i){return i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)||this.regexp_eatInvalidBracedQuantifier(i)||this.regexp_eatExtendedPatternCharacter(i)},Zt.regexp_eatInvalidBracedQuantifier=function(i){return this.regexp_eatBracedQuantifier(i,!0)&&i.raise("Nothing to repeat"),!1},Zt.regexp_eatSyntaxCharacter=function(i){var o=i.current();return Ei(o)?(i.lastIntValue=o,i.advance(),!0):!1};function Ei(i){return i===36||i>=40&&i<=43||i===46||i===63||i>=91&&i<=94||i>=123&&i<=125}Zt.regexp_eatPatternCharacters=function(i){for(var o=i.pos,E=0;(E=i.current())!==-1&&!Ei(E);)i.advance();return i.pos!==o},Zt.regexp_eatExtendedPatternCharacter=function(i){var o=i.current();return o!==-1&&o!==36&&!(o>=40&&o<=43)&&o!==46&&o!==63&&o!==91&&o!==94&&o!==124?(i.advance(),!0):!1},Zt.regexp_groupSpecifier=function(i){if(i.eat(63)){this.regexp_eatGroupName(i)||i.raise("Invalid group");var o=this.options.ecmaVersion>=16,E=i.groupNames[i.lastStringValue];if(E)if(o)for(var q=0,ht=E;q<ht.length;q+=1){var Lt=ht[q];Lt.separatedFrom(i.branchID)||i.raise("Duplicate capture group name")}else i.raise("Duplicate capture group name");o?(E||(i.groupNames[i.lastStringValue]=[])).push(i.branchID):i.groupNames[i.lastStringValue]=!0}},Zt.regexp_eatGroupName=function(i){if(i.lastStringValue="",i.eat(60)){if(this.regexp_eatRegExpIdentifierName(i)&&i.eat(62))return!0;i.raise("Invalid capture group name")}return!1},Zt.regexp_eatRegExpIdentifierName=function(i){if(i.lastStringValue="",this.regexp_eatRegExpIdentifierStart(i)){for(i.lastStringValue+=dt(i.lastIntValue);this.regexp_eatRegExpIdentifierPart(i);)i.lastStringValue+=dt(i.lastIntValue);return!0}return!1},Zt.regexp_eatRegExpIdentifierStart=function(i){var o=i.pos,E=this.options.ecmaVersion>=11,q=i.current(E);return i.advance(E),q===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,E)&&(q=i.lastIntValue),bi(q)?(i.lastIntValue=q,!0):(i.pos=o,!1)};function bi(i){return y(i,!0)||i===36||i===95}Zt.regexp_eatRegExpIdentifierPart=function(i){var o=i.pos,E=this.options.ecmaVersion>=11,q=i.current(E);return i.advance(E),q===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,E)&&(q=i.lastIntValue),vi(q)?(i.lastIntValue=q,!0):(i.pos=o,!1)};function vi(i){return S(i,!0)||i===36||i===95||i===8204||i===8205}Zt.regexp_eatAtomEscape=function(i){return this.regexp_eatBackReference(i)||this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)||i.switchN&&this.regexp_eatKGroupName(i)?!0:(i.switchU&&(i.current()===99&&i.raise("Invalid unicode escape"),i.raise("Invalid escape")),!1)},Zt.regexp_eatBackReference=function(i){var o=i.pos;if(this.regexp_eatDecimalEscape(i)){var E=i.lastIntValue;if(i.switchU)return E>i.maxBackReference&&(i.maxBackReference=E),!0;if(E<=i.numCapturingParens)return!0;i.pos=o}return!1},Zt.regexp_eatKGroupName=function(i){if(i.eat(107)){if(this.regexp_eatGroupName(i))return i.backReferenceNames.push(i.lastStringValue),!0;i.raise("Invalid named reference")}return!1},Zt.regexp_eatCharacterEscape=function(i){return this.regexp_eatControlEscape(i)||this.regexp_eatCControlLetter(i)||this.regexp_eatZero(i)||this.regexp_eatHexEscapeSequence(i)||this.regexp_eatRegExpUnicodeEscapeSequence(i,!1)||!i.switchU&&this.regexp_eatLegacyOctalEscapeSequence(i)||this.regexp_eatIdentityEscape(i)},Zt.regexp_eatCControlLetter=function(i){var o=i.pos;if(i.eat(99)){if(this.regexp_eatControlLetter(i))return!0;i.pos=o}return!1},Zt.regexp_eatZero=function(i){return i.current()===48&&!Li(i.lookahead())?(i.lastIntValue=0,i.advance(),!0):!1},Zt.regexp_eatControlEscape=function(i){var o=i.current();return o===116?(i.lastIntValue=9,i.advance(),!0):o===110?(i.lastIntValue=10,i.advance(),!0):o===118?(i.lastIntValue=11,i.advance(),!0):o===102?(i.lastIntValue=12,i.advance(),!0):o===114?(i.lastIntValue=13,i.advance(),!0):!1},Zt.regexp_eatControlLetter=function(i){var o=i.current();return ai(o)?(i.lastIntValue=o%32,i.advance(),!0):!1};function ai(i){return i>=65&&i<=90||i>=97&&i<=122}Zt.regexp_eatRegExpUnicodeEscapeSequence=function(i,o){o===void 0&&(o=!1);var E=i.pos,q=o||i.switchU;if(i.eat(117)){if(this.regexp_eatFixedHexDigits(i,4)){var ht=i.lastIntValue;if(q&&ht>=55296&&ht<=56319){var Lt=i.pos;if(i.eat(92)&&i.eat(117)&&this.regexp_eatFixedHexDigits(i,4)){var Ft=i.lastIntValue;if(Ft>=56320&&Ft<=57343)return i.lastIntValue=(ht-55296)*1024+(Ft-56320)+65536,!0}i.pos=Lt,i.lastIntValue=ht}return!0}if(q&&i.eat(123)&&this.regexp_eatHexDigits(i)&&i.eat(125)&&fi(i.lastIntValue))return!0;q&&i.raise("Invalid unicode escape"),i.pos=E}return!1};function fi(i){return i>=0&&i<=1114111}Zt.regexp_eatIdentityEscape=function(i){if(i.switchU)return this.regexp_eatSyntaxCharacter(i)?!0:i.eat(47)?(i.lastIntValue=47,!0):!1;var o=i.current();return o!==99&&(!i.switchN||o!==107)?(i.lastIntValue=o,i.advance(),!0):!1},Zt.regexp_eatDecimalEscape=function(i){i.lastIntValue=0;var o=i.current();if(o>=49&&o<=57){do i.lastIntValue=10*i.lastIntValue+(o-48),i.advance();while((o=i.current())>=48&&o<=57);return!0}return!1};var Ci=0,Me=1,oi=2;Zt.regexp_eatCharacterClassEscape=function(i){var o=i.current();if(tr(o))return i.lastIntValue=-1,i.advance(),Me;var E=!1;if(i.switchU&&this.options.ecmaVersion>=9&&((E=o===80)||o===112)){i.lastIntValue=-1,i.advance();var q;if(i.eat(123)&&(q=this.regexp_eatUnicodePropertyValueExpression(i))&&i.eat(125))return E&&q===oi&&i.raise("Invalid property name"),q;i.raise("Invalid property name")}return Ci};function tr(i){return i===100||i===68||i===115||i===83||i===119||i===87}Zt.regexp_eatUnicodePropertyValueExpression=function(i){var o=i.pos;if(this.regexp_eatUnicodePropertyName(i)&&i.eat(61)){var E=i.lastStringValue;if(this.regexp_eatUnicodePropertyValue(i)){var q=i.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(i,E,q),Me}}if(i.pos=o,this.regexp_eatLoneUnicodePropertyNameOrValue(i)){var ht=i.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(i,ht)}return Ci},Zt.regexp_validateUnicodePropertyNameAndValue=function(i,o,E){Nt(i.unicodeProperties.nonBinary,o)||i.raise("Invalid property name"),i.unicodeProperties.nonBinary[o].test(E)||i.raise("Invalid property value")},Zt.regexp_validateUnicodePropertyNameOrValue=function(i,o){if(i.unicodeProperties.binary.test(o))return Me;if(i.switchV&&i.unicodeProperties.binaryOfStrings.test(o))return oi;i.raise("Invalid property name")},Zt.regexp_eatUnicodePropertyName=function(i){var o=0;for(i.lastStringValue="";Gi(o=i.current());)i.lastStringValue+=dt(o),i.advance();return i.lastStringValue!==""};function Gi(i){return ai(i)||i===95}Zt.regexp_eatUnicodePropertyValue=function(i){var o=0;for(i.lastStringValue="";er(o=i.current());)i.lastStringValue+=dt(o),i.advance();return i.lastStringValue!==""};function er(i){return Gi(i)||Li(i)}Zt.regexp_eatLoneUnicodePropertyNameOrValue=function(i){return this.regexp_eatUnicodePropertyValue(i)},Zt.regexp_eatCharacterClass=function(i){if(i.eat(91)){var o=i.eat(94),E=this.regexp_classContents(i);return i.eat(93)||i.raise("Unterminated character class"),o&&E===oi&&i.raise("Negated character class may contain strings"),!0}return!1},Zt.regexp_classContents=function(i){return i.current()===93?Me:i.switchV?this.regexp_classSetExpression(i):(this.regexp_nonEmptyClassRanges(i),Me)},Zt.regexp_nonEmptyClassRanges=function(i){for(;this.regexp_eatClassAtom(i);){var o=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassAtom(i)){var E=i.lastIntValue;i.switchU&&(o===-1||E===-1)&&i.raise("Invalid character class"),o!==-1&&E!==-1&&o>E&&i.raise("Range out of order in character class")}}},Zt.regexp_eatClassAtom=function(i){var o=i.pos;if(i.eat(92)){if(this.regexp_eatClassEscape(i))return!0;if(i.switchU){var E=i.current();(E===99||Oi(E))&&i.raise("Invalid class escape"),i.raise("Invalid escape")}i.pos=o}var q=i.current();return q!==93?(i.lastIntValue=q,i.advance(),!0):!1},Zt.regexp_eatClassEscape=function(i){var o=i.pos;if(i.eat(98))return i.lastIntValue=8,!0;if(i.switchU&&i.eat(45))return i.lastIntValue=45,!0;if(!i.switchU&&i.eat(99)){if(this.regexp_eatClassControlLetter(i))return!0;i.pos=o}return this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)},Zt.regexp_classSetExpression=function(i){var o=Me,E;if(!this.regexp_eatClassSetRange(i))if(E=this.regexp_eatClassSetOperand(i)){E===oi&&(o=oi);for(var q=i.pos;i.eatChars([38,38]);){if(i.current()!==38&&(E=this.regexp_eatClassSetOperand(i))){E!==oi&&(o=Me);continue}i.raise("Invalid character in character class")}if(q!==i.pos)return o;for(;i.eatChars([45,45]);)this.regexp_eatClassSetOperand(i)||i.raise("Invalid character in character class");if(q!==i.pos)return o}else i.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(i)){if(E=this.regexp_eatClassSetOperand(i),!E)return o;E===oi&&(o=oi)}},Zt.regexp_eatClassSetRange=function(i){var o=i.pos;if(this.regexp_eatClassSetCharacter(i)){var E=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassSetCharacter(i)){var q=i.lastIntValue;return E!==-1&&q!==-1&&E>q&&i.raise("Range out of order in character class"),!0}i.pos=o}return!1},Zt.regexp_eatClassSetOperand=function(i){return this.regexp_eatClassSetCharacter(i)?Me:this.regexp_eatClassStringDisjunction(i)||this.regexp_eatNestedClass(i)},Zt.regexp_eatNestedClass=function(i){var o=i.pos;if(i.eat(91)){var E=i.eat(94),q=this.regexp_classContents(i);if(i.eat(93))return E&&q===oi&&i.raise("Negated character class may contain strings"),q;i.pos=o}if(i.eat(92)){var ht=this.regexp_eatCharacterClassEscape(i);if(ht)return ht;i.pos=o}return null},Zt.regexp_eatClassStringDisjunction=function(i){var o=i.pos;if(i.eatChars([92,113])){if(i.eat(123)){var E=this.regexp_classStringDisjunctionContents(i);if(i.eat(125))return E}else i.raise("Invalid escape");i.pos=o}return null},Zt.regexp_classStringDisjunctionContents=function(i){for(var o=this.regexp_classString(i);i.eat(124);)this.regexp_classString(i)===oi&&(o=oi);return o},Zt.regexp_classString=function(i){for(var o=0;this.regexp_eatClassSetCharacter(i);)o++;return o===1?Me:oi},Zt.regexp_eatClassSetCharacter=function(i){var o=i.pos;if(i.eat(92))return this.regexp_eatCharacterEscape(i)||this.regexp_eatClassSetReservedPunctuator(i)?!0:i.eat(98)?(i.lastIntValue=8,!0):(i.pos=o,!1);var E=i.current();return E<0||E===i.lookahead()&&ir(E)||hr(E)?!1:(i.advance(),i.lastIntValue=E,!0)};function ir(i){return i===33||i>=35&&i<=38||i>=42&&i<=44||i===46||i>=58&&i<=64||i===94||i===96||i===126}function hr(i){return i===40||i===41||i===45||i===47||i>=91&&i<=93||i>=123&&i<=125}Zt.regexp_eatClassSetReservedPunctuator=function(i){var o=i.current();return Xi(o)?(i.lastIntValue=o,i.advance(),!0):!1};function Xi(i){return i===33||i===35||i===37||i===38||i===44||i===45||i>=58&&i<=62||i===64||i===96||i===126}Zt.regexp_eatClassControlLetter=function(i){var o=i.current();return Li(o)||o===95?(i.lastIntValue=o%32,i.advance(),!0):!1},Zt.regexp_eatHexEscapeSequence=function(i){var o=i.pos;if(i.eat(120)){if(this.regexp_eatFixedHexDigits(i,2))return!0;i.switchU&&i.raise("Invalid escape"),i.pos=o}return!1},Zt.regexp_eatDecimalDigits=function(i){var o=i.pos,E=0;for(i.lastIntValue=0;Li(E=i.current());)i.lastIntValue=10*i.lastIntValue+(E-48),i.advance();return i.pos!==o};function Li(i){return i>=48&&i<=57}Zt.regexp_eatHexDigits=function(i){var o=i.pos,E=0;for(i.lastIntValue=0;Ui(E=i.current());)i.lastIntValue=16*i.lastIntValue+Ri(E),i.advance();return i.pos!==o};function Ui(i){return i>=48&&i<=57||i>=65&&i<=70||i>=97&&i<=102}function Ri(i){return i>=65&&i<=70?10+(i-65):i>=97&&i<=102?10+(i-97):i-48}Zt.regexp_eatLegacyOctalEscapeSequence=function(i){if(this.regexp_eatOctalDigit(i)){var o=i.lastIntValue;if(this.regexp_eatOctalDigit(i)){var E=i.lastIntValue;o<=3&&this.regexp_eatOctalDigit(i)?i.lastIntValue=o*64+E*8+i.lastIntValue:i.lastIntValue=o*8+E}else i.lastIntValue=o;return!0}return!1},Zt.regexp_eatOctalDigit=function(i){var o=i.current();return Oi(o)?(i.lastIntValue=o-48,i.advance(),!0):(i.lastIntValue=0,!1)};function Oi(i){return i>=48&&i<=55}Zt.regexp_eatFixedHexDigits=function(i,o){var E=i.pos;i.lastIntValue=0;for(var q=0;q<o;++q){var ht=i.current();if(!Ui(ht))return i.pos=E,!1;i.lastIntValue=16*i.lastIntValue+Ri(ht),i.advance()}return!0};var xi=function(o){this.type=o.type,this.value=o.value,this.start=o.start,this.end=o.end,o.options.locations&&(this.loc=new Ot(o,o.startLoc,o.endLoc)),o.options.ranges&&(this.range=[o.start,o.end])},me=e.prototype;me.next=function(i){!i&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new xi(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},me.getToken=function(){return this.next(),new xi(this)},typeof Symbol<"u"&&(me[Symbol.iterator]=function(){var i=this;return{next:function(){var o=i.getToken();return{done:o.type===f.eof,value:o}}}}),me.nextToken=function(){var i=this.curContext();if((!i||!i.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(f.eof);if(i.override)return i.override(this);this.readToken(this.fullCharCodeAtPos())},me.readToken=function(i){return y(i,this.options.ecmaVersion>=6)||i===92?this.readWord():this.getTokenFromCode(i)},me.fullCharCodeAtPos=function(){var i=this.input.charCodeAt(this.pos);if(i<=55295||i>=56320)return i;var o=this.input.charCodeAt(this.pos+1);return o<=56319||o>=57344?i:(i<<10)+o-56613888},me.skipBlockComment=function(){var i=this.options.onComment&&this.curPosition(),o=this.pos,E=this.input.indexOf("*/",this.pos+=2);if(E===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=E+2,this.options.locations)for(var q=void 0,ht=o;(q=st(this.input,ht,this.pos))>-1;)++this.curLine,ht=this.lineStart=q;this.options.onComment&&this.options.onComment(!0,this.input.slice(o+2,E),o,this.pos,i,this.curPosition())},me.skipLineComment=function(i){for(var o=this.pos,E=this.options.onComment&&this.curPosition(),q=this.input.charCodeAt(this.pos+=i);this.pos<this.input.length&&!rt(q);)q=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(o+i,this.pos),o,this.pos,E,this.curPosition())},me.skipSpace=function(){t:for(;this.pos<this.input.length;){var i=this.input.charCodeAt(this.pos);switch(i){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(i>8&&i<14||i>=5760&&gt.test(String.fromCharCode(i)))++this.pos;else break t}}},me.finishToken=function(i,o){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var E=this.type;this.type=i,this.value=o,this.updateContext(E)},me.readToken_dot=function(){var i=this.input.charCodeAt(this.pos+1);if(i>=48&&i<=57)return this.readNumber(!0);var o=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&i===46&&o===46?(this.pos+=3,this.finishToken(f.ellipsis)):(++this.pos,this.finishToken(f.dot))},me.readToken_slash=function(){var i=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):i===61?this.finishOp(f.assign,2):this.finishOp(f.slash,1)},me.readToken_mult_modulo_exp=function(i){var o=this.input.charCodeAt(this.pos+1),E=1,q=i===42?f.star:f.modulo;return this.options.ecmaVersion>=7&&i===42&&o===42&&(++E,q=f.starstar,o=this.input.charCodeAt(this.pos+2)),o===61?this.finishOp(f.assign,E+1):this.finishOp(q,E)},me.readToken_pipe_amp=function(i){var o=this.input.charCodeAt(this.pos+1);if(o===i){if(this.options.ecmaVersion>=12){var E=this.input.charCodeAt(this.pos+2);if(E===61)return this.finishOp(f.assign,3)}return this.finishOp(i===124?f.logicalOR:f.logicalAND,2)}return o===61?this.finishOp(f.assign,2):this.finishOp(i===124?f.bitwiseOR:f.bitwiseAND,1)},me.readToken_caret=function(){var i=this.input.charCodeAt(this.pos+1);return i===61?this.finishOp(f.assign,2):this.finishOp(f.bitwiseXOR,1)},me.readToken_plus_min=function(i){var o=this.input.charCodeAt(this.pos+1);return o===i?o===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||wt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(f.incDec,2):o===61?this.finishOp(f.assign,2):this.finishOp(f.plusMin,1)},me.readToken_lt_gt=function(i){var o=this.input.charCodeAt(this.pos+1),E=1;return o===i?(E=i===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+E)===61?this.finishOp(f.assign,E+1):this.finishOp(f.bitShift,E)):o===33&&i===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(o===61&&(E=2),this.finishOp(f.relational,E))},me.readToken_eq_excl=function(i){var o=this.input.charCodeAt(this.pos+1);return o===61?this.finishOp(f.equality,this.input.charCodeAt(this.pos+2)===61?3:2):i===61&&o===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(f.arrow)):this.finishOp(i===61?f.eq:f.prefix,1)},me.readToken_question=function(){var i=this.options.ecmaVersion;if(i>=11){var o=this.input.charCodeAt(this.pos+1);if(o===46){var E=this.input.charCodeAt(this.pos+2);if(E<48||E>57)return this.finishOp(f.questionDot,2)}if(o===63){if(i>=12){var q=this.input.charCodeAt(this.pos+2);if(q===61)return this.finishOp(f.assign,3)}return this.finishOp(f.coalesce,2)}}return this.finishOp(f.question,1)},me.readToken_numberSign=function(){var i=this.options.ecmaVersion,o=35;if(i>=13&&(++this.pos,o=this.fullCharCodeAtPos(),y(o,!0)||o===92))return this.finishToken(f.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+dt(o)+"'")},me.getTokenFromCode=function(i){switch(i){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(f.parenL);case 41:return++this.pos,this.finishToken(f.parenR);case 59:return++this.pos,this.finishToken(f.semi);case 44:return++this.pos,this.finishToken(f.comma);case 91:return++this.pos,this.finishToken(f.bracketL);case 93:return++this.pos,this.finishToken(f.bracketR);case 123:return++this.pos,this.finishToken(f.braceL);case 125:return++this.pos,this.finishToken(f.braceR);case 58:return++this.pos,this.finishToken(f.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(f.backQuote);case 48:var o=this.input.charCodeAt(this.pos+1);if(o===120||o===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(o===111||o===79)return this.readRadixNumber(8);if(o===98||o===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(i);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(i);case 124:case 38:return this.readToken_pipe_amp(i);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(i);case 60:case 62:return this.readToken_lt_gt(i);case 61:case 33:return this.readToken_eq_excl(i);case 63:return this.readToken_question();case 126:return this.finishOp(f.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+dt(i)+"'")},me.finishOp=function(i,o){var E=this.input.slice(this.pos,this.pos+o);return this.pos+=o,this.finishToken(i,E)},me.readRegexp=function(){for(var i,o,E=this.pos;;){this.pos>=this.input.length&&this.raise(E,"Unterminated regular expression");var q=this.input.charAt(this.pos);if(wt.test(q)&&this.raise(E,"Unterminated regular expression"),i)i=!1;else{if(q==="[")o=!0;else if(q==="]"&&o)o=!1;else if(q==="/"&&!o)break;i=q==="\\"}++this.pos}var ht=this.input.slice(E,this.pos);++this.pos;var Lt=this.pos,Ft=this.readWord1();this.containsEsc&&this.unexpected(Lt);var Yt=this.regexpState||(this.regexpState=new Ke(this));Yt.reset(E,ht,Ft),this.validateRegExpFlags(Yt),this.validateRegExpPattern(Yt);var ae=null;try{ae=new RegExp(ht,Ft)}catch{}return this.finishToken(f.regexp,{pattern:ht,flags:Ft,value:ae})},me.readInt=function(i,o,E){for(var q=this.options.ecmaVersion>=12&&o===void 0,ht=E&&this.input.charCodeAt(this.pos)===48,Lt=this.pos,Ft=0,Yt=0,ae=0,xe=o??1/0;ae<xe;++ae,++this.pos){var Te=this.input.charCodeAt(this.pos),qe=void 0;if(q&&Te===95){ht&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Yt===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),ae===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Yt=Te;continue}if(Te>=97?qe=Te-97+10:Te>=65?qe=Te-65+10:Te>=48&&Te<=57?qe=Te-48:qe=1/0,qe>=i)break;Yt=Te,Ft=Ft*i+qe}return q&&Yt===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Lt||o!=null&&this.pos-Lt!==o?null:Ft};function wi(i,o){return o?parseInt(i,8):parseFloat(i.replace(/_/g,""))}function Pi(i){return typeof BigInt!="function"?null:BigInt(i.replace(/_/g,""))}me.readRadixNumber=function(i){var o=this.pos;this.pos+=2;var E=this.readInt(i);return E==null&&this.raise(this.start+2,"Expected number in radix "+i),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(E=Pi(this.input.slice(o,this.pos)),++this.pos):y(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(f.num,E)},me.readNumber=function(i){var o=this.pos;!i&&this.readInt(10,void 0,!0)===null&&this.raise(o,"Invalid number");var E=this.pos-o>=2&&this.input.charCodeAt(o)===48;E&&this.strict&&this.raise(o,"Invalid number");var q=this.input.charCodeAt(this.pos);if(!E&&!i&&this.options.ecmaVersion>=11&&q===110){var ht=Pi(this.input.slice(o,this.pos));return++this.pos,y(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(f.num,ht)}E&&/[89]/.test(this.input.slice(o,this.pos))&&(E=!1),q===46&&!E&&(++this.pos,this.readInt(10),q=this.input.charCodeAt(this.pos)),(q===69||q===101)&&!E&&(q=this.input.charCodeAt(++this.pos),(q===43||q===45)&&++this.pos,this.readInt(10)===null&&this.raise(o,"Invalid number")),y(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Lt=wi(this.input.slice(o,this.pos),E);return this.finishToken(f.num,Lt)},me.readCodePoint=function(){var i=this.input.charCodeAt(this.pos),o;if(i===123){this.options.ecmaVersion<6&&this.unexpected();var E=++this.pos;o=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,o>1114111&&this.invalidStringToken(E,"Code point out of bounds")}else o=this.readHexChar(4);return o},me.readString=function(i){for(var o="",E=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var q=this.input.charCodeAt(this.pos);if(q===i)break;q===92?(o+=this.input.slice(E,this.pos),o+=this.readEscapedChar(!1),E=this.pos):q===8232||q===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(rt(q)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return o+=this.input.slice(E,this.pos++),this.finishToken(f.string,o)};var Si={};me.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(i){if(i===Si)this.readInvalidTemplateToken();else throw i}this.inTemplateElement=!1},me.invalidStringToken=function(i,o){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Si;this.raise(i,o)},me.readTmplToken=function(){for(var i="",o=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var E=this.input.charCodeAt(this.pos);if(E===96||E===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===f.template||this.type===f.invalidTemplate)?E===36?(this.pos+=2,this.finishToken(f.dollarBraceL)):(++this.pos,this.finishToken(f.backQuote)):(i+=this.input.slice(o,this.pos),this.finishToken(f.template,i));if(E===92)i+=this.input.slice(o,this.pos),i+=this.readEscapedChar(!0),o=this.pos;else if(rt(E)){switch(i+=this.input.slice(o,this.pos),++this.pos,E){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:i+=`
`;break;default:i+=String.fromCharCode(E);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),o=this.pos}else++this.pos}},me.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(f.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},me.readEscapedChar=function(i){var o=this.input.charCodeAt(++this.pos);switch(++this.pos,o){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return dt(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),i){var E=this.pos-1;this.invalidStringToken(E,"Invalid escape sequence in template string")}default:if(o>=48&&o<=55){var q=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],ht=parseInt(q,8);return ht>255&&(q=q.slice(0,-1),ht=parseInt(q,8)),this.pos+=q.length-1,o=this.input.charCodeAt(this.pos),(q!=="0"||o===56||o===57)&&(this.strict||i)&&this.invalidStringToken(this.pos-1-q.length,i?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(ht)}return rt(o)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(o)}},me.readHexChar=function(i){var o=this.pos,E=this.readInt(16,i);return E===null&&this.invalidStringToken(o,"Bad character escape sequence"),E},me.readWord1=function(){this.containsEsc=!1;for(var i="",o=!0,E=this.pos,q=this.options.ecmaVersion>=6;this.pos<this.input.length;){var ht=this.fullCharCodeAtPos();if(S(ht,q))this.pos+=ht<=65535?1:2;else if(ht===92){this.containsEsc=!0,i+=this.input.slice(E,this.pos);var Lt=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Ft=this.readCodePoint();(o?y:S)(Ft,q)||this.invalidStringToken(Lt,"Invalid Unicode escape"),i+=dt(Ft),E=this.pos}else break;o=!1}return i+this.input.slice(E,this.pos)},me.readWord=function(){var i=this.readWord1(),o=f.name;return this.keywords.test(i)&&(o=L[i]),this.finishToken(o,i)};var Mi="8.15.0";e.acorn={Parser:e,version:Mi,defaultOptions:Xt,Position:Ut,SourceLocation:Ot,getLineInfo:Kt,Node:pt,TokenType:R,tokTypes:f,keywordTypes:L,TokContext:j,tokContexts:k,isIdentifierChar:S,isIdentifierStart:y,Token:xi,isNewLine:rt,lineBreak:wt,lineBreakG:it,nonASCIIwhitespace:gt};function ji(i,o){return e.parse(i,o)}function Fi(i,o,E){return e.parseExpressionAt(i,o,E)}function rr(i,o){return e.tokenizer(i,o)}J.Node=pt,J.Parser=e,J.Position=Ut,J.SourceLocation=Ot,J.TokContext=j,J.Token=xi,J.TokenType=R,J.defaultOptions=Xt,J.getLineInfo=Kt,J.isIdentifierChar=S,J.isIdentifierStart=y,J.isNewLine=rt,J.keywordTypes=L,J.lineBreak=wt,J.lineBreakG=it,J.nonASCIIwhitespace=gt,J.parse=ji,J.parseExpressionAt=Fi,J.tokContexts=k,J.tokTypes=f,J.tokenizer=rr,J.version=Mi}))})(ln,ln.exports)),ln.exports}/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var Go=kn.exports,ya;function Uo(){return ya||(ya=1,(function(b){(function(W,J){W=W||va;var et=W.window,z=W.document,c=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],r=e.slice,n=Object.create,s=Object.getOwnPropertyDescriptor,u=Object.defineProperty,h=e.forEach||function(C,w){for(var Y=0,M=this.length;Y<M;Y++)C.call(w,this[Y],Y,this)},l=function(C,w){for(var Y in this)this.hasOwnProperty(Y)&&C.call(w,this[Y],Y,this)},p=Object.assign||function(C){for(var w=1,Y=arguments.length;w<Y;w++){var M=arguments[w];for(var j in M)M.hasOwnProperty(j)&&(C[j]=M[j])}return C},v=function(C,w,Y){if(C){var M=s(C,"length");(M&&typeof M.value=="number"?h:l).call(C,w,Y=Y||C)}return Y};function T(C,w,Y,M,j){var k={};function V(U,nt){nt=nt||(nt=s(w,U))&&(nt.get?nt:nt.value),typeof nt=="string"&&nt[0]==="#"&&(nt=C[nt.substring(1)]||nt);var ut=typeof nt=="function",pt=nt,bt=j||ut&&!nt.base?nt&&nt.get?U in C:C[U]:null,ot;(!j||!bt)&&(ut&&bt&&(nt.base=bt),ut&&M!==!1&&(ot=U.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(k[ot[3].toLowerCase()+ot[4]]=ot[2]),(!pt||ut||!pt.get||typeof pt.get!="function"||!I.isPlainObject(pt))&&(pt={value:pt,writable:!0}),(s(C,U)||{configurable:!0}).configurable&&(pt.configurable=!0,pt.enumerable=Y??!ot),u(C,U,pt))}if(w){for(var m in w)w.hasOwnProperty(m)&&!t.test(m)&&V(m);for(var m in k){var F=k[m],X=C["set"+F],tt=C["get"+F]||X&&C["is"+F];tt&&(M===!0||tt.length===0)&&V(m,{get:tt,set:X})}}return C}function I(){for(var C=0,w=arguments.length;C<w;C++){var Y=arguments[C];Y&&p(this,Y)}return this}return T(I,{inject:function(C){if(C){var w=C.statics===!0?C:C.statics,Y=C.beans,M=C.preserve;w!==C&&T(this.prototype,C,C.enumerable,Y,M),T(this,w,null,Y,M)}for(var j=1,k=arguments.length;j<k;j++)this.inject(arguments[j]);return this},extend:function(){for(var C=this,w,Y,M=0,j,k=arguments.length;M<k&&!(w&&Y);M++)j=arguments[M],w=w||j.initialize,Y=Y||j.prototype;return w=w||function(){C.apply(this,arguments)},Y=w.prototype=Y||n(this.prototype),u(Y,"constructor",{value:w,writable:!0,configurable:!0}),T(w,this),arguments.length&&this.inject.apply(w,arguments),w.base=C,w}}).inject({enumerable:!1,initialize:I,set:I,inject:function(){for(var C=0,w=arguments.length;C<w;C++){var Y=arguments[C];Y&&T(this,Y,Y.enumerable,Y.beans,Y.preserve)}return this},extend:function(){var C=n(this);return C.inject.apply(C,arguments)},each:function(C,w){return v(this,C,w)},clone:function(){return new this.constructor(this)},statics:{set:p,each:v,create:n,define:u,describe:s,clone:function(C){return p(new C.constructor,C)},isPlainObject:function(C){var w=C!=null&&C.constructor;return w&&(w===Object||w===I||w.name==="Object")},pick:function(C,w){return C!==J?C:w},slice:function(C,w,Y){return r.call(C,w,Y)}}})};b.exports=c,c.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+c.each(this,function(t,e){if(!/^_/.test(e)){var r=typeof t;this.push(e+": "+(r==="number"?B.instance.number(t):r==="string"?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return c.importJSON(t,this)},exportJSON:function(t){return c.exportJSON(this,t)},toJSON:function(){return c.serialize(this)},set:function(t,e){return t&&c.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),r=e.prototype._class;return r&&!c.exports[r]&&(c.exports[r]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&typeof t=="object"&&typeof e=="object"){if(Array.isArray(t)&&Array.isArray(e)){var r=t.length;if(r!==e.length)return!1;for(;r--;)if(!c.equals(t[r],e[r]))return!1}else{var n=Object.keys(t),r=n.length;if(r!==Object.keys(e).length)return!1;for(;r--;){var s=n[r];if(!(e.hasOwnProperty(s)&&c.equals(t[s],e[s])))return!1}}return!0}return!1},read:function(t,e,r,n){if(this===c){var s=this.peek(t,e);return t.__index++,s}var u=this.prototype,h=u._readIndex,l=e||h&&t.__index||0,p=t.length,v=t[l];if(n=n||p-l,v instanceof this||r&&r.readNull&&v==null&&n<=1)return h&&(t.__index=l+1),v&&r&&r.clone?v.clone():v;if(v=c.create(u),h&&(v.__read=!0),v=v.initialize.apply(v,l>0||l+n<p?c.slice(t,l,l+n):t)||v,h){t.__index=l+v.__read;var T=v.__filtered;T&&(t.__filtered=T,v.__filtered=J),v.__read=J}return v},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,r,n){for(var s=[],u,h=e||0,l=n?h+n:t.length,p=h;p<l;p++)s.push(Array.isArray(u=t[p])?this.read(u,0,r):this.read(t,p,r,1));return s},readNamed:function(t,e,r,n,s){var u=this.getNamed(t,e),h=u!==J;if(h){var l=t.__filtered;if(!l){var p=this.getSource(t);l=t.__filtered=c.create(p),l.__unfiltered=p}l[e]=J}return this.read(h?[u]:t,r,n,s)},readSupported:function(t,e){var r=this.getSource(t),n=this,s=!1;return r&&Object.keys(r).forEach(function(u){if(u in e){var h=n.readNamed(t,u);h!==J&&(e[u]=h),s=!0}}),s},getSource:function(t){var e=t.__source;if(e===J){var r=t.length===1&&t[0];e=t.__source=r&&c.isPlainObject(r)?r:null}return e},getNamed:function(t,e){var r=this.getSource(t);if(r)return e?r[e]:t.__filtered||r},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,r,n){var s;function u(T){if(!(r&&T in r)&&!(s&&T in s)){var I=e[T];I!==J&&(t[T]=I)}}if(n){for(var h={},l=0,p,v=n.length;l<v;l++)(p=n[l])in e&&(u(p),h[p]=!0);s=h}return Object.keys(e.__unfiltered||e).forEach(u),t},isPlainValue:function(t,e){return c.isPlainObject(t)||Array.isArray(t)||e&&typeof t=="string"},serialize:function(t,e,r,n){e=e||{};var s=!n,u;if(s&&(e.formatter=new B(e.precision),n={length:0,definitions:{},references:{},add:function(I,C){var w="#"+I._id,Y=this.references[w];if(!Y){this.length++;var M=C.call(I),j=I._class;j&&M[0]!==j&&M.unshift(j),this.definitions[w]=M,Y=this.references[w]=[w]}return Y}}),t&&t._serialize){u=t._serialize(e,n);var h=t._class;h&&!t._compactSerialize&&(s||!r)&&u[0]!==h&&u.unshift(h)}else if(Array.isArray(t)){u=[];for(var l=0,p=t.length;l<p;l++)u[l]=c.serialize(t[l],e,r,n)}else if(c.isPlainObject(t)){u={};for(var v=Object.keys(t),l=0,p=v.length;l<p;l++){var T=v[l];u[T]=c.serialize(t[T],e,r,n)}}else typeof t=="number"?u=e.formatter.number(t,e.precision):u=t;return s&&n.length>0?[["dictionary",n.definitions],u]:u},deserialize:function(t,e,r,n,s){var u=t,h=!r,l=h&&t&&t.length&&t[0][0]==="dictionary";if(r=r||{},Array.isArray(t)){var p=t[0],v=p==="dictionary";if(t.length==1&&/^#/.test(p))return r.dictionary[p];p=c.exports[p],u=[];for(var T=p?1:0,I=t.length;T<I;T++)u.push(c.deserialize(t[T],e,r,v,l));if(p){var C=u;e?u=e(p,C,h||s):u=new p(C)}}else if(c.isPlainObject(t)){u={},n&&(r.dictionary=u);for(var w in t)u[w]=c.deserialize(t[w],e,r)}return l?u[1]:u},exportJSON:function(t,e){var r=c.serialize(t,e);return e&&e.asString==!1?r:JSON.stringify(r)},importJSON:function(t,e){return c.deserialize(typeof t=="string"?JSON.parse(t):t,function(r,n,s){var u=s&&e&&e.constructor===r,h=u?e:c.create(r.prototype);if(n.length===1&&h instanceof f&&(u||!(h instanceof it))){var l=n[0];c.isPlainObject(l)&&(l.insert=!1,u&&(n=n.concat([f.INSERT])))}return(u?h.set:r).apply(h,n),u&&(e=null),h})},push:function(t,e){var r=e.length;if(r<4096)t.push.apply(t,e);else{var n=t.length;t.length+=r;for(var s=0;s<r;s++)t[n+s]=e[s]}return t},splice:function(t,e,r,n){var s=e&&e.length,u=r===J;r=u?t.length:r,r>t.length&&(r=t.length);for(var h=0;h<s;h++)e[h]._index=r+h;if(u)return c.push(t,e),[];var l=[r,n];e&&c.push(l,e);for(var p=t.splice.apply(t,l),h=0,v=p.length;h<v;h++)p[h]._index=J;for(var h=r+s,v=t.length;h<v;h++)t[h]._index=h;return p},capitalize:function(t){return t.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(e,r){return r.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var O={on:function(t,e){if(typeof t!="string")c.each(t,function(u,h){this.on(h,u)},this);else{var r=this._eventTypes,n=r&&r[t],s=this._callbacks=this._callbacks||{};s=s[t]=s[t]||[],s.indexOf(e)===-1&&(s.push(e),n&&n.install&&s.length===1&&n.install.call(this,t))}return this},off:function(t,e){if(typeof t!="string"){c.each(t,function(h,l){this.off(l,h)},this);return}var r=this._eventTypes,n=r&&r[t],s=this._callbacks&&this._callbacks[t],u;return s&&(!e||(u=s.indexOf(e))!==-1&&s.length===1?(n&&n.uninstall&&n.uninstall.call(this,t),delete this._callbacks[t]):u!==-1&&s.splice(u,1)),this},once:function(t,e){return this.on(t,function r(){e.apply(this,arguments),this.off(t,r)})},emit:function(t,e){var r=this._callbacks&&this._callbacks[t];if(!r)return!1;var n=c.slice(arguments,1),s=e&&e.target&&!e.currentTarget;r=r.slice(),s&&(e.currentTarget=this);for(var u=0,h=r.length;u<h;u++)if(r[u].apply(this,n)==!1){e&&e.stop&&e.stop();break}return s&&delete e.currentTarget,!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,r=this._callbacks,n=t?"install":"uninstall";if(e){for(var s in r)if(r[s].length>0){var u=e[s],h=u&&u[n];h&&h.call(this,s)}}},statics:{inject:function t(e){var r=e._events;if(r){var n={};c.each(r,function(s,u){var h=typeof s=="string",l=h?s:u,p=c.capitalize(l),v=l.substring(2).toLowerCase();n[v]=h?{}:s,l="_"+l,e["get"+p]=function(){return this[l]},e["set"+p]=function(T){var I=this[l];I&&this.off(v,I),T&&this.on(v,T),this[l]=T}}),e._eventTypes=n}return t.base.apply(this,arguments)}}},x=c.extend({_class:"PaperScope",initialize:function t(){_e=this,this.settings=new c({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var e=t.prototype;if(!this.support){var r=Ve.getContext(1,1)||{};e.support={nativeDash:"setLineDash"in r||"mozDash"in r,nativeBlendModes:Le.nativeModes},Ve.release(r)}if(!this.agent){var n=W.navigator.userAgent.toLowerCase(),s=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(n)||[])[0],u=s==="darwin"?"mac":s,h=e.agent=e.browser={platform:u};u&&(h[u]=!0),n.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(l,p,v,T,I){if(!h.chrome){var C=p==="opera"?T:/^(node|trident)$/.test(p)?I:v;h.version=C,h.versionNumber=parseFloat(C),p={trident:"msie",jsdom:"node"}[p]||p,h.name=p,h[p]=!0}}),h.chrome&&delete h.webkit,h.atom&&delete h.chrome}},version:"0.12.18",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var r=_e.PaperScript.execute(t,this,e);return re.updateFocus(),r},install:function(t){var e=this;c.each(["project","view","tool"],function(n){c.define(t,n,{configurable:!0,get:function(){return e[n]}})});for(var r in this)!/^_/.test(r)&&this[r]&&(t[r]=this[r])},setup:function(t){return _e=this,this.project=new K(t),this},createCanvas:function(t,e){return Ve.getCanvas(t,e)},activate:function(){_e=this},clear:function(){for(var t=this.projects,e=this.tools,r=t.length-1;r>=0;r--)t[r].remove();for(var r=e.length-1;r>=0;r--)e[r].remove()},remove:function(){this.clear(),delete x._scopes[this._id]},statics:new function(){function t(e){return e+="Attribute",function(r,n){return r[e](n)||r[e]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(e){return this._scopes[e]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),D=c.extend(O,{initialize:function(t){this._scope=_e,this._index=this._scope[this._list].push(this)-1,(t||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(c.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),N={findItemBoundsCollisions:function(t,e,r){function n(h){for(var l=new Array(h.length),p=0;p<h.length;p++){var v=h[p].getBounds();l[p]=[v.left,v.top,v.right,v.bottom]}return l}var s=n(t),u=!e||e===t?s:n(e);return this.findBoundsCollisions(s,u,r||0)},findCurveBoundsCollisions:function(t,e,r,n){function s(C){for(var w=Math.min,Y=Math.max,M=new Array(C.length),j=0;j<C.length;j++){var k=C[j];M[j]=[w(k[0],k[2],k[4],k[6]),w(k[1],k[3],k[5],k[7]),Y(k[0],k[2],k[4],k[6]),Y(k[1],k[3],k[5],k[7])]}return M}var u=s(t),h=!e||e===t?u:s(e);if(n){for(var l=this.findBoundsCollisions(u,h,r||0,!1,!0),p=this.findBoundsCollisions(u,h,r||0,!0,!0),v=[],T=0,I=l.length;T<I;T++)v[T]={hor:l[T],ver:p[T]};return v}return this.findBoundsCollisions(u,h,r||0)},findBoundsCollisions:function(t,e,r,n,s){var u=!e||t===e,h=u?t:t.concat(e),l=t.length,p=h.length;function v($t,ie,oe){for(var zt=0,Ht=$t.length;zt<Ht;){var ne=Ht+zt>>>1;h[$t[ne]][ie]<oe?zt=ne+1:Ht=ne}return zt-1}for(var T=n?1:0,I=T+2,C=n?0:1,w=C+2,Y=new Array(p),M=0;M<p;M++)Y[M]=M;Y.sort(function($t,ie){return h[$t][T]-h[ie][T]});for(var j=[],k=new Array(l),M=0;M<p;M++){var V=Y[M],m=h[V],F=u?V:V-l,X=V<l,tt=u||!X,U=X?[]:null;if(j.length){var nt=v(j,I,m[T]-r)+1;if(j.splice(0,nt),u&&s){U=U.concat(j);for(var ut=0;ut<j.length;ut++){var pt=j[ut];k[pt].push(F)}}else for(var bt=m[w],ot=m[C],ut=0;ut<j.length;ut++){var pt=j[ut],xt=h[pt],yt=pt<l,At=u||pt>=l;(s||(X&&At||tt&&yt)&&bt>=xt[C]-r&&ot<=xt[w]+r)&&(X&&At&&U.push(u?pt:pt-l),tt&&yt&&k[pt].push(F))}}if(X&&(t===e&&U.push(V),k[V]=U),j.length){var Rt=m[I],Mt=v(j,I,Rt);j.splice(Mt+1,0,V)}else j.push(V)}for(var M=0;M<k.length;M++){var jt=k[M];jt&&jt.sort(function(ie,oe){return ie-oe})}return k}},B=c.extend({initialize:function(t){this.precision=c.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,r){return this.number(t)+(r||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});B.instance=new B;var Z=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],r=Math.abs,n=Math.sqrt,s=Math.pow,u=Math.log2||function(I){return Math.log(I)*Math.LOG2E},h=1e-12,l=112e-18;function p(I,C,w){return I<C?C:I>w?w:I}function v(I,C,w){function Y(nt){var ut=nt*134217729,pt=nt-ut,bt=pt+ut,ot=nt-bt;return[bt,ot]}var M=C*C-I*w,j=C*C+I*w;if(r(M)*3<j){var k=Y(I),V=Y(C),m=Y(w),F=C*C,X=V[0]*V[0]-F+2*V[0]*V[1]+V[1]*V[1],tt=I*w,U=k[0]*m[0]-tt+k[0]*m[1]+k[1]*m[0]+k[1]*m[1];M=F-tt+(X-U)}return M}function T(){var I=Math.max.apply(Math,arguments);return I&&(I<1e-8||I>1e8)?s(2,-Math.round(u(I))):0}return{EPSILON:h,MACHINE_EPSILON:l,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(n(2)-1)/3,isZero:function(I){return I>=-h&&I<=h},isMachineZero:function(I){return I>=-l&&I<=l},clamp:p,integrate:function(I,C,w,Y){for(var M=t[Y-2],j=e[Y-2],k=(w-C)*.5,V=k+C,m=0,F=Y+1>>1,X=Y&1?j[m++]*I(V):0;m<F;){var tt=k*M[m];X+=j[m++]*(I(V+tt)+I(V-tt))}return k*X},findRoot:function(I,C,w,Y,M,j,k){for(var V=0;V<j;V++){var m=I(w),F=m/C(w),X=w-F;if(r(F)<k){w=X;break}m>0?(M=w,w=X<=Y?(Y+M)*.5:X):(Y=w,w=X>=M?(Y+M)*.5:X)}return p(w,Y,M)},solveQuadratic:function(I,C,w,Y,M,j){var k,V=1/0;if(r(I)<h){if(r(C)<h)return r(w)<h?-1:0;k=-w/C}else{C*=-.5;var m=v(I,C,w);if(m&&r(m)<l){var F=T(r(I),r(C),r(w));F&&(I*=F,C*=F,w*=F,m=v(I,C,w))}if(m>=-l){var X=m<0?0:n(m),tt=C+(C<0?-X:X);tt===0?(k=w/I,V=-k):(k=tt/I,V=w/tt)}}var U=0,nt=M==null,ut=M-h,pt=j+h;return isFinite(k)&&(nt||k>ut&&k<pt)&&(Y[U++]=nt?k:p(k,M,j)),V!==k&&isFinite(V)&&(nt||V>ut&&V<pt)&&(Y[U++]=nt?V:p(V,M,j)),U},solveCubic:function(I,C,w,Y,M,j,k){var V=T(r(I),r(C),r(w),r(Y)),m,F,X,tt,U;V&&(I*=V,C*=V,w*=V,Y*=V);function nt(Mt){m=Mt;var jt=I*m;F=jt+C,X=F*m+w,tt=(jt+F)*m+X,U=X*m+Y}if(r(I)<h)I=C,F=w,X=Y,m=1/0;else if(r(Y)<h)F=C,X=w,m=0;else{nt(-(C/I)/3);var ut=U/I,pt=s(r(ut),1/3),bt=ut<0?-1:1,ot=-tt/I,xt=ot>0?1.324717957244746*Math.max(pt,n(ot)):pt,yt=m-bt*xt;if(yt!==m){do nt(yt),yt=tt===0?m:m-U/tt/(1+l);while(bt*yt>bt*m);r(I)*m*m>r(Y/m)&&(X=-Y/m,F=(X-w)/m)}}var At=Z.solveQuadratic(I,F,X,M,j,k),Rt=j==null;return isFinite(m)&&(At===0||At>0&&m!==M[0]&&m!==M[1])&&(Rt||m>j-h&&m<k+h)&&(M[At++]=Rt?m:p(m,j,k)),At}}},G={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}else return this._id++}},d=c.extend({_class:"Point",_readIndex:!0,initialize:function(e,r){var n=typeof e,s=this.__read,u=0;if(n==="number"){var h=typeof r=="number";this._set(e,h?r:e),s&&(u=h?2:1)}else if(n==="undefined"||e===null)this._set(0,0),s&&(u=e===null?1:0);else{var l=n==="string"?e.split(/[\s,]+/)||[]:e;u=1,Array.isArray(l)?this._set(+l[0],+(l.length>1?l[1]:l[0])):"x"in l?this._set(l.x||0,l.y||0):"width"in l?this._set(l.width||0,l.height||0):"angle"in l?(this._set(l.length||0,0),this.setAngle(l.angle||0)):(this._set(0,0),u=0)}return s&&(this.__read=u),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new d(this.x,this.y)},toString:function(){var t=B.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var r=t/this.getLength();Z.isZero(r)&&this.getAngle(),this._set(this.x*r,this.y*r)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=d.read(arguments),e=this.getLength()*t.getLength();if(Z.isZero(e))return NaN;var r=this.dot(t)/e;return Math.acos(r<-1?-1:r>1?1:r)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=d.read(arguments);return Math.atan2(this.cross(t),this.dot(t))*180/Math.PI},getDistance:function(){var t=arguments,e=d.read(t),r=e.x-this.x,n=e.y-this.y,s=r*r+n*n,u=c.read(t);return u?s:Math.sqrt(s)},normalize:function(t){t===J&&(t=1);var e=this.getLength(),r=e!==0?t/e:0,n=new d(this.x*r,this.y*r);return r>=0&&(n._angle=this._angle),n},rotate:function(t,e){if(t===0)return this.clone();t=t*Math.PI/180;var r=e?this.subtract(e):this,n=Math.sin(t),s=Math.cos(t);return r=new d(r.x*s-r.y*n,r.x*n+r.y*s),e?r.add(e):r},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=d.read(arguments);return new d(this.x+t.x,this.y+t.y)},subtract:function(){var t=d.read(arguments);return new d(this.x-t.x,this.y-t.y)},multiply:function(){var t=d.read(arguments);return new d(this.x*t.x,this.y*t.y)},divide:function(){var t=d.read(arguments);return new d(this.x/t.x,this.y/t.y)},modulo:function(){var t=d.read(arguments);return new d(this.x%t.x,this.y%t.y)},negate:function(){return new d(-this.x,-this.y)},isInside:function(){return H.read(arguments).contains(this)},isClose:function(){var t=arguments,e=d.read(t),r=c.read(t);return this.getDistance(e)<=r},isCollinear:function(){var t=d.read(arguments);return d.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=d.read(arguments);return d.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=Z.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=d.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=d.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=d.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new d(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=d.read(t),r=d.read(t);return new d(Math.min(e.x,r.x),Math.min(e.y,r.y))},max:function(){var t=arguments,e=d.read(t),r=d.read(t);return new d(Math.max(e.x,r.x),Math.max(e.y,r.y))},random:function(){return new d(Math.random(),Math.random())},isCollinear:function(t,e,r,n){return Math.abs(t*n-e*r)<=Math.sqrt((t*t+e*e)*(r*r+n*n))*1e-8},isOrthogonal:function(t,e,r,n){return Math.abs(t*r+e*n)<=Math.sqrt((t*t+e*e)*(r*r+n*n))*1e-8}}},c.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new d(e(this.x),e(this.y))}},{})),y=d.extend({initialize:function(e,r,n,s){this._x=e,this._y=r,this._owner=n,this._setter=s},_set:function(t,e,r){return this._x=t,this._y=e,r||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),S=c.extend({_class:"Size",_readIndex:!0,initialize:function(e,r){var n=typeof e,s=this.__read,u=0;if(n==="number"){var h=typeof r=="number";this._set(e,h?r:e),s&&(u=h?2:1)}else if(n==="undefined"||e===null)this._set(0,0),s&&(u=e===null?1:0);else{var l=n==="string"?e.split(/[\s,]+/)||[]:e;u=1,Array.isArray(l)?this._set(+l[0],+(l.length>1?l[1]:l[0])):"width"in l?this._set(l.width||0,l.height||0):"x"in l?this._set(l.x||0,l.y||0):(this._set(0,0),u=0)}return s&&(this.__read=u),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new S(this.width,this.height)},toString:function(){var t=B.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=S.read(arguments);return new S(this.width+t.width,this.height+t.height)},subtract:function(){var t=S.read(arguments);return new S(this.width-t.width,this.height-t.height)},multiply:function(){var t=S.read(arguments);return new S(this.width*t.width,this.height*t.height)},divide:function(){var t=S.read(arguments);return new S(this.width/t.width,this.height/t.height)},modulo:function(){var t=S.read(arguments);return new S(this.width%t.width,this.height%t.height)},negate:function(){return new S(-this.width,-this.height)},isZero:function(){var t=Z.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new S(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new S(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new S(Math.random(),Math.random())}}},c.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new S(e(this.width),e(this.height))}},{})),R=S.extend({initialize:function(e,r,n,s){this._width=e,this._height=r,this._owner=n,this._setter=s},_set:function(t,e,r){return this._width=t,this._height=e,r||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),H=c.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(e,r,n,s){var u=arguments,h=typeof e,l;if(h==="number"?(this._set(e,r,n,s),l=4):h==="undefined"||e===null?(this._set(0,0,0,0),l=e===null?1:0):u.length===1&&(Array.isArray(e)?(this._set.apply(this,e),l=1):e.x!==J||e.width!==J?(this._set(e.x||0,e.y||0,e.width||0,e.height||0),l=1):e.from===J&&e.to===J&&(this._set(0,0,0,0),c.readSupported(u,this)&&(l=1))),l===J){var p=d.readNamed(u,"from"),v=c.peek(u),T=p.x,I=p.y,C,w;if(v&&v.x!==J||c.hasNamed(u,"to")){var Y=d.readNamed(u,"to");C=Y.x-T,w=Y.y-I,C<0&&(T=Y.x,C=-C),w<0&&(I=Y.y,w=-w)}else{var M=S.read(u);C=M.width,w=M.height}this._set(T,I,C,w),l=u.__index}var j=u.__filtered;return j&&(this.__filtered=j),this.__read&&(this.__read=l),this},set:"#initialize",_set:function(t,e,r,n){return this.x=t,this.y=e,this.width=r,this.height=n,this},clone:function(){return new H(this.x,this.y,this.width,this.height)},equals:function(t){var e=c.isPlainValue(t)?H.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=B.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){var e=t?d:y;return new e(this.x,this.y,this,"setPoint")},setPoint:function(){var t=d.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){var e=t?S:R;return new e(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=S.read(arguments),e=this._sx,r=this._sy,n=t.width,s=t.height;e&&(this.x+=(this.width-n)*e),r&&(this.y+=(this.height-s)*r),this.width=n,this.height=s,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=this._sx===.5?e*2:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=this._sy===.5?e*2:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=this._sx===.5?e*2:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=this._sy===.5?e*2:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||this._sx===.5?this.x=t-this.width/2:(this._sx&&(this.x+=(t-this.x)*2*this._sx),this.width=(t-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||this._sy===.5?this.y=t-this.height/2:(this._sy&&(this.y+=(t-this.y)*2*this._sy),this.height=(t-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(t){var e=t?d:y;return new e(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=d.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(t){return t&&t.width!==J||(Array.isArray(t)?t:arguments).length===4?this._containsRectangle(H.read(arguments)):this._containsPoint(d.read(arguments))},_containsPoint:function(t){var e=t.x,r=t.y;return e>=this.x&&r>=this.y&&e<=this.x+this.width&&r<=this.y+this.height},_containsRectangle:function(t){var e=t.x,r=t.y;return e>=this.x&&r>=this.y&&e+t.width<=this.x+this.width&&r+t.height<=this.y+this.height},intersects:function(){var t=H.read(arguments),e=c.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=H.read(arguments),e=Math.max(this.x,t.x),r=Math.max(this.y,t.y),n=Math.min(this.x+this.width,t.x+t.width),s=Math.min(this.y+this.height,t.y+t.height);return new H(e,r,n-e,s-r)},unite:function(){var t=H.read(arguments),e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),n=Math.max(this.x+this.width,t.x+t.width),s=Math.max(this.y+this.height,t.y+t.height);return new H(e,r,n-e,s-r)},include:function(){var t=d.read(arguments),e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),n=Math.max(this.x+this.width,t.x),s=Math.max(this.y+this.height,t.y);return new H(e,r,n-e,s-r)},expand:function(){var t=S.read(arguments),e=t.width,r=t.height;return new H(this.x-e/2,this.y-r/2,this.width+e,this.height+r)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===J?t:e)-this.height)}},c.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,e){var r=t.join(""),n=/^[RL]/.test(r);e>=4&&(t[1]+=n?"Y":"X");var s=t[n?0:1],u=t[n?1:0],h="get"+s,l="get"+u,p="set"+s,v="set"+u,T="get"+r,I="set"+r;this[T]=function(C){var w=C?d:y;return new w(this[h](),this[l](),this,I)},this[I]=function(){var C=d.read(arguments);this[p](C.x),this[v](C.y)}},{beans:!0})),P=H.extend({initialize:function(e,r,n,s,u,h){this._set(e,r,n,s,!0),this._owner=u,this._setter=h},_set:function(t,e,r,n,s){return this._x=t,this._y=e,this._width=r,this._height=n,s||this._owner[this._setter](this),this}},new function(){var t=H.prototype;return c.each(["x","y","width","height"],function(e){var r=c.capitalize(e),n="_"+e;this["get"+r]=function(){return this[n]},this["set"+r]=function(s){this[n]=s,this._dontNotify||this._owner[this._setter](this)}},c.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var r="set"+e;this[r]=function(){this._dontNotify=!0,t[r].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(e){var r=this._owner;r._changeSelection&&r._changeSelection(2,e)}}))}),g=c.extend({_class:"Matrix",initialize:function t(e,r){var n=arguments,s=n.length,u=!0;if(s>=6?this._set.apply(this,n):s===1||s===2?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,r):Array.isArray(e)?this._set.apply(this,r?e.concat([r]):e):u=!1:s?u=!1:this.reset(),!u)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,r,n,s,u,h){return this._a=t,this._b=e,this._c=r,this._d=n,this._tx=s,this._ty=u,h||this._changed(),this},_serialize:function(t,e){return c.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new g(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=B.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var r=this._owner;return r?(r.transform(null,c.pick(t,!0),e),this.isIdentity()):!1},translate:function(){var t=d.read(arguments),e=t.x,r=t.y;return this._tx+=e*this._a+r*this._c,this._ty+=e*this._b+r*this._d,this._changed(),this},scale:function(){var t=arguments,e=d.read(t),r=d.read(t,0,{readNull:!0});return r&&this.translate(r),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,r&&this.translate(r.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=d.read(arguments,1),r=e.x,n=e.y,s=Math.cos(t),u=Math.sin(t),h=r-r*s+n*u,l=n-r*u-n*s,p=this._a,v=this._b,T=this._c,I=this._d;return this._a=s*p+u*T,this._b=s*v+u*I,this._c=-u*p+s*T,this._d=-u*v+s*I,this._tx+=h*p+l*T,this._ty+=h*v+l*I,this._changed(),this},shear:function(){var t=arguments,e=d.read(t),r=d.read(t,0,{readNull:!0});r&&this.translate(r);var n=this._a,s=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*n,this._d+=e.x*s,r&&this.translate(r.negate()),this._changed(),this},skew:function(){var t=arguments,e=d.read(t),r=d.read(t,0,{readNull:!0}),n=Math.PI/180,s=new d(Math.tan(e.x*n),Math.tan(e.y*n));return this.shear(s,r)},append:function(t,e){if(t){var r=this._a,n=this._b,s=this._c,u=this._d,h=t._a,l=t._c,p=t._b,v=t._d,T=t._tx,I=t._ty;this._a=h*r+p*s,this._c=l*r+v*s,this._b=h*n+p*u,this._d=l*n+v*u,this._tx+=T*r+I*s,this._ty+=T*n+I*u,e||this._changed()}return this},prepend:function(t,e){if(t){var r=this._a,n=this._b,s=this._c,u=this._d,h=this._tx,l=this._ty,p=t._a,v=t._c,T=t._b,I=t._d,C=t._tx,w=t._ty;this._a=p*r+v*n,this._c=p*s+v*u,this._b=T*r+I*n,this._d=T*s+I*u,this._tx=p*h+v*l+C,this._ty=T*h+I*l+w,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,r=this._c,n=this._d,s=this._tx,u=this._ty,h=t*n-e*r,l=null;return h&&!isNaN(h)&&isFinite(s)&&isFinite(u)&&(this._a=n/h,this._b=-e/h,this._c=-r/h,this._d=t/h,this._tx=(r*u-n*s)/h,this._ty=(e*s-t*u)/h,l=this),l},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new g(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,r){return arguments.length<3?this._transformPoint(d.read(arguments)):this._transformCoordinates(t,e,r)},_transformPoint:function(t,e,r){var n=t.x,s=t.y;return e||(e=new d),e._set(n*this._a+s*this._c+this._tx,n*this._b+s*this._d+this._ty,r)},_transformCoordinates:function(t,e,r){for(var n=0,s=2*r;n<s;n+=2){var u=t[n],h=t[n+1];e[n]=u*this._a+h*this._c+this._tx,e[n+1]=u*this._b+h*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,r=t.y,n=e+t.width,s=r+t.height,u=[e,r,n,r,n,s,e,s];return this._transformCoordinates(u,u,4)},_transformBounds:function(t,e,r){for(var n=this._transformCorners(t),s=n.slice(0,2),u=s.slice(),h=2;h<8;h++){var l=n[h],p=h&1;l<s[p]?s[p]=l:l>u[p]&&(u[p]=l)}return e||(e=new H),e._set(s[0],s[1],u[0]-s[0],u[1]-s[1],r)},inverseTransform:function(){return this._inverseTransform(d.read(arguments))},_inverseTransform:function(t,e,r){var n=this._a,s=this._b,u=this._c,h=this._d,l=this._tx,p=this._ty,v=n*h-s*u,T=null;if(v&&!isNaN(v)&&isFinite(l)&&isFinite(p)){var I=t.x-this._tx,C=t.y-this._ty;e||(e=new d),T=e._set((I*h-C*u)/v,(C*n-I*s)/v,r)}return T},decompose:function(){var t=this._a,e=this._b,r=this._c,n=this._d,s=t*n-e*r,u=Math.sqrt,h=Math.atan2,l=180/Math.PI,p,v,T;if(t!==0||e!==0){var I=u(t*t+e*e);p=Math.acos(t/I)*(e>0?1:-1),v=[I,s/I],T=[h(t*r+e*n,I*I),0]}else if(r!==0||n!==0){var C=u(r*r+n*n);p=Math.asin(r/C)*(n>0?1:-1),v=[s/C,C],T=[0,h(t*r+e*n,C*C)]}else p=0,T=v=[0,0];return{translation:this.getTranslation(),rotation:p*l,scaling:new d(v),skewing:new d(T[0]*l,T[1]*l)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new d(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},c.each(["a","b","c","d","tx","ty"],function(t){var e=c.capitalize(t),r="_"+t;this["get"+e]=function(){return this[r]},this["set"+e]=function(n){this[r]=n,this._changed()}},{})),L=c.extend({_class:"Line",initialize:function(e,r,n,s,u){var h=!1;arguments.length>=4?(this._px=e,this._py=r,this._vx=n,this._vy=s,h=u):(this._px=e.x,this._py=e.y,this._vx=r.x,this._vy=r.y,h=n),h||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new d(this._px,this._py)},getVector:function(){return new d(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return L.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return L.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return L.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return d.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return d.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,r,n,s,u,h,l,p,v){p||(r-=t,n-=e,h-=s,l-=u);var T=r*l-n*h;if(!Z.isMachineZero(T)){var I=t-s,C=e-u,w=(h*C-l*I)/T,Y=(r*C-n*I)/T,M=1e-12,j=-M,k=1+M;if(v||j<w&&w<k&&j<Y&&Y<k)return v||(w=w<=0?0:w>=1?1:w),new d(t+w*r,e+w*n)}},getSide:function(t,e,r,n,s,u,h,l){h||(r-=t,n-=e);var p=s-t,v=u-e,T=p*n-v*r;return!l&&Z.isMachineZero(T)&&(T=(p*r+p*r)/(r*r+n*n),T>=0&&T<=1&&(T=0)),T<0?-1:T>0?1:0},getSignedDistance:function(t,e,r,n,s,u,h){return h||(r-=t,n-=e),r===0?n>0?s-t:t-s:n===0?r<0?u-e:e-u:((s-t)*n-(u-e)*r)/(n>r?n*Math.sqrt(1+r*r/(n*n)):r*Math.sqrt(1+n*n/(r*r)))},getDistance:function(t,e,r,n,s,u,h){return Math.abs(L.getSignedDistance(t,e,r,n,s,u,h))}}}),K=D.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(e){D.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Dt(null,null,this),this._view=re.create(this,e||Ve.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return c.serialize(this._children,t,!0,e)},_changed:function(t,e){if(t&1){var r=this._view;r&&(r._needsUpdate=!0,!r._requested&&r._autoUpdate&&r.requestUpdate())}var n=this._changes;if(n&&e){var s=this._changesById,u=e._id,h=s[u];h?h.flags|=t:n.push(s[u]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return t.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new it({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:gt,match:function(r){var n=r._definition,s=n._id;return e[s]||(e[s]=!0,t.push(n)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var r in t){var n=t[r],s=n._selection;s&1&&n.isInserted()?e.push(n):s||this._updateSelection(n)}return e},_updateSelection:function(t){var e=t._id,r=this._selectionItems;t._selection?r[e]!==t&&(this._selectionCount++,r[e]=t):r[e]===t&&(this._selectionCount--,delete r[e])},selectAll:function(){for(var t=this._children,e=0,r=t.length;e<r;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(J,t)},insertLayer:function(t,e){if(e instanceof it){e._remove(!1,!0),c.splice(this._children,[e],t,0),e._setProject(this,!0);var r=e._name;r&&e.setName(r),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,r){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(J,new it(f.NO_INSERT),!0)).insertChild(t,e),r&&e.activate&&e.activate(),e},getItems:function(t){return f._getItems(this,t)},getItem:function(t){return f._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return c.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){t==="mouseup"&&(e.mousedrag=null);var r=e[t];if(r){for(var n in r){var s=r[n];for(var u in e){var h=e[u];h&&h!=r&&delete h[s._id]}s.remove()}e[t]=null}}},draw:function(t,e,r){this._updateVersion++,t.save(),e.applyToContext(t);for(var n=this._children,s=new c({offset:new d(0,0),pixelRatio:r,viewMatrix:e.isIdentity()?null:e,matrices:[new g],updateMatrix:!0}),u=0,h=n.length;u<h;u++)n[u].draw(t,s);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var l=this._selectionItems,p=this._scope.settings.handleSize,v=this._updateVersion;for(var T in l)l[T]._drawSelection(t,e,p,l,v);t.restore()}}}),f=c.extend(O,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=c.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new g,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return c.each(t,function(e){this._events[e]={install:function(r){this.getView()._countItemEvent(r,1)},uninstall:function(r){this.getView()._countItemEvent(r,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var r=t&&c.isPlainObject(t),n=r&&t.internal===!0,s=this._matrix=new g,u=r&&t.project||_e.project,h=_e.settings;return this._id=n?null:G.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&h.applyMatrix,e&&s.translate(e),s._owner=this,this._style=new Dt(u._currentStyle,this,u),n||r&&t.insert==!1||!h.insertItems&&!(r&&t.insert==!0)?this._setProject(u):(r&&t.parent||u)._insertItem(J,this,!0),r&&t!==f.NO_INSERT&&t!==f.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),r},_serialize:function(t,e){var r={},n=this;function s(u){for(var h in u){var l=n[h];c.equals(l,h==="leading"?u.fontSize*1.2:u[h])||(r[h]=c.serialize(l,t,h!=="data",e))}}return s(this._serializeFields),this instanceof wt||s(this._style._defaults),[this._class,r]},_changed:function(t){var e=this._symbol,r=this._parent||e,n=this._project;t&8&&(this._bounds=this._position=this._decomposed=J),t&16&&(this._globalMatrix=J),r&&t&72&&f._clearBoundsCache(r),t&2&&f._clearBoundsCache(this),n&&n._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var r=e._children,n=e._namedChildren;(n[t]=n[t]||[]).push(this),t in r||(r[t]=this)}this._name=t||J,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},c.each(["locked","visible","blendMode","opacity","guide"],function(t){var e=c.capitalize(t),r="_"+t,n={locked:256,visible:265};this["get"+e]=function(){return this[r]},this["set"+e]=function(s){s!=this[r]&&(this[r]=s,this._changed(n[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var r=this._selection;this.setSelection(e?r|t:r&~t)},isSelected:function(){if(this._selectChildren){for(var t=this._children,e=0,r=t.length;e<r;e++)if(t[e].isSelected())return!0}return!!(this._selection&1)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,r=0,n=e.length;r<n;r++)e[r].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(this._selection&1);if(t&&e){for(var r=0,n=t.length;r<n;r++)if(!t[r].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var r=0,n=e.length;r<n;r++)e[r].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?d:y,r=this._position||(this._position=this._getPositionFromBounds());return new e(r.x,r.y,this,"setPosition")},setPosition:function(){this.translate(d.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new y(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=d.read(arguments,0,{clone:!0,readNull:!0}),this._position=J}},c.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,e){this[e]=function(r){return this.getBounds(r,t)}},{beans:!0,getBounds:function(t,e){var r=e||t instanceof g,n=c.set({},r?e:t,this._boundsOptions);(!n.stroke||this.getStrokeScaling())&&(n.cacheItem=this);var s=this._getCachedBounds(r&&t,n).rect;return arguments.length?s:new P(s.x,s.y,s.width,s.height,this,"setBounds")},setBounds:function(){var t=H.read(arguments),e=this.getBounds(),r=this._matrix,n=new g,s=t.getCenter();n.translate(s),(t.width!=e.width||t.height!=e.height)&&(r.isInvertible()||(r.set(r._backup||new g().translate(r.getTranslation())),e=this.getBounds()),n.scale(e.width!==0?t.width/e.width:0,e.height!==0?t.height/e.height:0)),s=e.getCenter(),n.translate(-s.x,-s.y),this.transform(n)},_getBounds:function(t,e){var r=this._children;return!r||!r.length?new H:(f._updateBoundsCache(this,e.cacheItem),f._getBounds(r,t,e))},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,r){t=t&&t._orNullIfIdentity();var n=e.internal&&!r,s=e.cacheItem,u=n?null:this._matrix._orNullIfIdentity(),h=s&&(!t||t.equals(u))&&this._getBoundsCacheKey(e,n),l=this._bounds;if(f._updateBoundsCache(this._parent||this._symbol,s),h&&l&&h in l){var p=l[h];return{rect:p.rect.clone(),nonscaling:p.nonscaling}}var v=this._getBounds(t||u,e),T=v.rect||v,I=this._style,C=v.nonscaling||I.hasStroke()&&!I.getStrokeScaling();if(h){l||(this._bounds=l={});var p=l[h]={rect:T.clone(),nonscaling:C,internal:n}}return{rect:T,nonscaling:C}},_getStrokeMatrix:function(t,e){var r=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,n=r?r.getViewMatrix().invert():t;return n&&n._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var r=e._id,n=t._boundsCache=t._boundsCache||{ids:{},list:[]};n.ids[r]||(n.list.push(e),n.ids[r]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=J;for(var r=0,n=e.list,s=n.length;r<s;r++){var u=n[r];u!==t&&(u._bounds=u._position=J,u._boundsCache&&f._clearBoundsCache(u))}}},_getBounds:function(t,e,r){var n=1/0,s=-n,u=n,h=s,l=!1;r=r||{};for(var p=0,v=t.length;p<v;p++){var T=t[p];if(T._visible&&!T.isEmpty(!0)){var I=T._getCachedBounds(e&&e.appended(T._matrix),r,!0),C=I.rect;n=Math.min(C.x,n),u=Math.min(C.y,u),s=Math.max(C.x+C.width,s),h=Math.max(C.y+C.height,h),I.nonscaling&&(l=!0)}}return{rect:isFinite(n)?new H(n,u,s-n,h-u):new H,nonscaling:l}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(e!=null&&t!=null){var r=this._decomposed;this.rotate(t-e),r&&(r.rotation=t,this._decomposed=r)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new y(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=d.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var r=this.getRotation(),n=this._decomposed,s=new g,u=Z.isZero;if(u(t.x)||u(t.y))s.translate(n.translation),r&&s.rotate(r),s.scale(e.x,e.y),this._matrix.set(s);else{var h=this.getPosition(!0);s.translate(h),r&&s.rotate(r),s.scale(e.x/t.x,e.y/t.y),r&&s.rotate(-r),s.translate(h.negate()),this.transform(s)}n&&(n.scaling=e,this._decomposed=n)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var r=this._parent,n=[];r;){if(!r._globalMatrix){e=null;for(var s=0,u=n.length;s<u;s++)n[s]._globalMatrix=null;break}n.push(r),r=r._parent}if(!e){e=this._globalMatrix=this._matrix.clone();var r=this._parent;r&&e.prepend(r.getGlobalMatrix(!0))}return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var r=this._children,n=0,s=r&&r.length;n<s;n++)r[n]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var r=this._children,n=0,s=r&&r.length;n<s;n++)r[n]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof it)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(t){var e=this._parent,r=e&&e._children;r&&e.insertChildren(t in r?t:J,[this])},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return c.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(f.NO_INSERT),r=this._children,n=c.pick(t?t.insert:J,t===J||t===!0),s=c.pick(t?t.deep:J,!0);r&&e.copyAttributes(this),(!r||s)&&e.copyContent(this),r||e.copyAttributes(this),n&&e.insertAbove(this);var u=this._name,h=this._parent;if(u&&h){for(var r=h._children,l=u,p=1;r[u];)u=l+" "+p++;u!==l&&e.setName(u)}return e},copyContent:function(t){for(var e=t._children,r=0,n=e&&e.length;r<n;r++)this.addChild(e[r].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var r=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],n=0,s=r.length;n<s;n++){var u=r[n];t.hasOwnProperty(u)&&(this[u]=t[u])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var h=t._data,l=t._name;this._data=h?c.clone(h):null,l&&this.setName(l)},rasterize:function(t,e){var r,n,s;c.isPlainObject(t)?(r=t.resolution,n=t.insert,s=t.raster):(r=t,n=e),s||(s=new st(f.NO_INSERT));var u=this.getStrokeBounds(),h=(r||this.getView().getResolution())/72,l=u.getTopLeft().floor(),p=u.getBottomRight().ceil(),v=new S(p.subtract(l)),T=v.multiply(h);if(s.setSize(T,!0),!T.isZero()){var I=s.getContext(!0),C=new g().scale(h).translate(l.negate());I.save(),C.applyToContext(I),this.draw(I,new c({matrices:[C]})),I.restore()}return s._matrix.set(new g().translate(l.add(v.divide(2))).scale(1/h)),(n===J||n)&&s.insertAbove(this),s},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(d.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var r=e.length-1;r>=0;r--)if(e[r].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return H.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new ct.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof f?this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0:!1}},new function(){function t(){var n=arguments;return this._hitTest(d.read(n),It.getOptions(n))}function e(){var n=arguments,s=d.read(n),u=It.getOptions(n),h=[];return this._hitTest(s,new c({all:h},u)),h}function r(n,s,u,h){var l=this._children;if(l)for(var p=l.length-1;p>=0;p--){var v=l[p],T=v!==h&&v._hitTest(n,s,u);if(T&&!s.all)return T}return null}return K.inject({hitTest:t,hitTestAll:e,_hitTest:r}),{hitTest:t,hitTestAll:e,_hitTestChildren:r}},{_hitTest:function(t,e,r){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var n=this._matrix,s=r?r.appended(n):this.getGlobalMatrix().prepend(this.getView()._matrix),u=Math.max(e.tolerance,1e-12),h=e._tolerancePadding=new S(ct._getStrokePadding(u,n._shiftless().invert()));if(t=n._inverseTransform(t),!t||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(h.multiply(2))._containsPoint(t))return null;var l=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==c.hyphenate(this._class)||e.class&&!(this instanceof e.class)),p=e.match,v=this,T,I;function C(m){return m&&p&&!p(m)&&(m=null),m&&e.all&&e.all.push(m),m}function w(m,F){var X=F?T["get"+F]():v.getPosition();if(t.subtract(X).divide(h).length<=1)return new It(m,v,{name:F?c.hyphenate(F):m,point:X})}var Y=e.position,M=e.center,j=e.bounds;if(l&&this._parent&&(Y||M||j)){if((M||j)&&(T=this.getInternalBounds()),I=Y&&w("position")||M&&w("center","Center"),!I&&j)for(var k=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],V=0;V<8&&!I;V++)I=w("bounds",k[V]);I=C(I)}return I||(I=this._hitTestChildren(t,e,s)||l&&C(this._hitTestSelf(t,e,s,this.getStrokeScaling()?null:s._shiftless().invert()))||null),I&&I.point&&(I.point=n.transform(I.point)),I},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new It("fill",this)},matches:function(t,e){function r(h,l){for(var p in h)if(h.hasOwnProperty(p)){var v=h[p],T=l[p];if(c.isPlainObject(v)&&c.isPlainObject(T)){if(!r(v,T))return!1}else if(!c.equals(v,T))return!1}return!0}var n=typeof t;if(n==="object"){for(var s in t)if(t.hasOwnProperty(s)&&!this.matches(s,t[s]))return!1;return!0}else{if(n==="function")return t(this);if(t==="match")return e(this);var u=/^(empty|editable)$/.test(t)?this["is"+c.capitalize(t)]():t==="type"?c.hyphenate(this._class):this[t];if(t==="class"){if(typeof e=="function")return this instanceof e;u=this._class}if(typeof e=="function")return!!e(u);if(e){if(e.test)return e.test(u);if(c.isPlainObject(e))return r(e,u)}return c.equals(u,e)}},getItems:function(t){return f._getItems(this,t,this._matrix)},getItem:function(t){return f._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,r,n,s,u){if(!s){var h=typeof r=="object"&&r,l=h&&h.overlapping,p=h&&h.inside,v=l||p,C=v&&H.read([v]);s={items:[],recursive:h&&h.recursive!==!1,inside:!!p,overlapping:!!l,rect:C,path:l&&new ct.Rectangle({rectangle:C,insert:!1})},h&&(r=c.filter({},r,{recursive:!0,inside:!0,overlapping:!0}))}var T=e._children,I=s.items,C=s.rect;n=C&&(n||new g);for(var w=0,Y=T&&T.length;w<Y;w++){var M=T[w],j=n&&n.appended(M._matrix),k=!0;if(C){var v=M.getBounds(j);if(!C.intersects(v))continue;C.contains(v)||s.overlapping&&(v.contains(C)||s.path.intersects(M,j))||(k=!1)}if(k&&M.matches(r)&&(I.push(M),u)||(s.recursive!==!1&&t(M,r,j,s,u),u&&I.length>0))break}return I}}},{importJSON:function(t){var e=c.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(J,t)},insertChild:function(t,e){var r=e?this.insertChildren(t,[e]):null;return r&&r[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var r=this._children;if(r&&e&&e.length>0){e=c.slice(e);for(var n={},s=e.length-1;s>=0;s--){var u=e[s],h=u&&u._id;!u||n[h]?e.splice(s,1):(u._remove(!1,!0),n[h]=!0)}c.splice(r,e,t,0);for(var l=this._project,p=l._changes,s=0,v=e.length;s<v;s++){var u=e[s],T=u._name;u._parent=this,u._setProject(l,!0),T&&u.setName(T),p&&u._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var r=t&&t._getOwner(),n=t!==this&&r?this:null;return n&&(n._remove(!1,!0),r._insertItem(t._index+e,n)),n},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(J,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(J,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&e.length===1){var r=e[0].reduce(t);return this._parent?(r.insertAbove(this),this.remove()):r.remove(),r}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,r=t._namedChildren,n=this._name,s=r[n],u=s?s.indexOf(this):-1;u!==-1&&(e[n]==this&&delete e[n],s.splice(u,1),s.length?e[n]=s[0]:delete r[n])}},_remove:function(t,e){var r=this._getOwner(),n=this._project,s=this._index;return this._style&&this._style._dispose(),r?(this._name&&this._removeNamed(),s!=null&&(n._activeLayer===this&&(n._activeLayer=this.getNextSibling()||this.getPreviousSibling()),c.splice(r._children,null,s,1)),this._installEvents(!1),t&&n._changes&&this._changed(5),e&&r._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=c.pick(e,this._children.length);for(var r=c.splice(this._children,null,t,e-t),n=r.length-1;n>=0;n--)r[n]._remove(!0,!1);return r.length>0&&this._changed(11),r},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,r=e?e.length:0;if(t){for(var n=0;n<r;n++)if(!e[n].isEmpty(t))return!1;return!0}return!r},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(h){var l=[];do l.unshift(h);while(h=h._parent);return l}for(var r=e(this),n=e(t),s=0,u=Math.min(r.length,n.length);s<u;s++)if(r[s]!=n[s])return r[s]._index<n[s]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(t){return this._getOrder(t)===-1},isBelow:function(t){return this._getOrder(t)===1},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return t?t.isDescendant(this):!1},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},c.each(["rotate","scale","shear","skew"],function(t){var e=t==="rotate";this[t]=function(){var r=arguments,n=(e?c:d).read(r),s=d.read(r,0,{readNull:!0});return this.transform(new g()[t](n,s||this.getPosition(!0)))}},{translate:function(){var t=new g;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,r){var n=this._matrix,s=t&&!t.isIdentity(),u=r&&this._canApplyMatrix||this._applyMatrix&&(s||!n.isIdentity()||e&&this._children);if(!s&&!u)return this;if(s){!t.isInvertible()&&n.isInvertible()&&(n._backup=n.getValues()),n.prepend(t,!0);var h=this._style,l=h.getFillColor(!0),p=h.getStrokeColor(!0);l&&l.transform(t),p&&p.transform(t)}if(u&&(u=this._transformContent(n,e,r))){var v=this._pivot;v&&n._transformPoint(v,v,!0),n.reset(!0),r&&this._canApplyMatrix&&(this._applyMatrix=!0)}var T=this._bounds,I=this._position;(s||u)&&this._changed(25);var C=s&&T&&t.decompose();if(C&&C.skewing.isZero()&&C.rotation%90===0){for(var w in T){var Y=T[w];if(Y.nonscaling)delete T[w];else if(u||!Y.internal){var M=Y.rect;t._transformBounds(M,M)}}this._bounds=T;var j=T[this._getBoundsCacheKey(this._boundsOptions||{})];j&&(this._position=this._getPositionFromBounds(j.rect))}else s&&I&&this._pivot&&(this._position=t._transformPoint(I,I));return this},_transformContent:function(t,e,r){var n=this._children;if(n){for(var s=0,u=n.length;s<u;s++)n[s].transform(t,e,r);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(d.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(d.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(d.read(arguments))},localToParent:function(){return this._matrix._transformPoint(d.read(arguments))},fitBounds:function(t,e){t=H.read(arguments);var r=this.getBounds(),n=r.height/r.width,s=t.height/t.width,u=(e?n>s:n<s)?t.width/r.width:t.height/r.height,h=new H(new d,new S(r.width*u,r.height*u));h.setCenter(t.getCenter()),this.setBounds(h)}}),{_setStyles:function(t,e,r){var n=this._style,s=this._matrix;if(n.hasFill()&&(t.fillStyle=n.getFillColor().toCanvasStyle(t,s)),n.hasStroke()){t.strokeStyle=n.getStrokeColor().toCanvasStyle(t,s),t.lineWidth=n.getStrokeWidth();var u=n.getStrokeJoin(),h=n.getStrokeCap(),l=n.getMiterLimit();if(u&&(t.lineJoin=u),h&&(t.lineCap=h),l&&(t.miterLimit=l),_e.support.nativeDash){var p=n.getDashArray(),v=n.getDashOffset();p&&p.length&&("setLineDash"in t?(t.setLineDash(p),t.lineDashOffset=v):(t.mozDash=p,t.mozDashOffset=v))}}if(n.hasShadow()){var T=e.pixelRatio||1,I=r._shiftless().prepend(new g().scale(T,T)),C=I.transform(new d(n.getShadowBlur(),0)),w=I.transform(this.getShadowOffset());t.shadowColor=n.getShadowColor().toCanvasStyle(t),t.shadowBlur=C.getLength(),t.shadowOffsetX=w.x,t.shadowOffsetY=w.y}},draw:function(t,e,r){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var n=e.matrices,s=e.viewMatrix,u=this._matrix,h=n[n.length-1].appended(u);if(h.isInvertible()){s=s?s.appended(h):h,n.push(h),e.updateMatrix&&(this._globalMatrix=h);var l=this._blendMode,p=Z.clamp(this._opacity,0,1),v=l==="normal",T=Le.nativeModes[l],I=v&&p===1||e.dontStart||e.clip||(T||v&&p<1)&&this._canComposite(),C=e.pixelRatio||1,w,Y,M;if(!I){var j=this.getStrokeBounds(s);if(!j.width||!j.height){n.pop();return}M=e.offset,Y=e.offset=j.getTopLeft().floor(),w=t,t=Ve.getContext(j.getSize().ceil().add(1).multiply(C)),C!==1&&t.scale(C,C)}t.save();var k=r?r.appended(u):this._canScaleStroke&&!this.getStrokeScaling(!0)&&s,V=!I&&e.clipItem,m=!k||V;if(I?(t.globalAlpha=p,T&&(t.globalCompositeOperation=l)):m&&t.translate(-Y.x,-Y.y),m&&(I?u:s).applyToContext(t),V&&e.clipItem.draw(t,e.extend({clip:!0})),k){t.setTransform(C,0,0,C,0,0);var F=e.offset;F&&t.translate(-F.x,-F.y)}this._draw(t,e,s,k),t.restore(),n.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),I||(Le.process(l,t,w,p,Y.subtract(M).multiply(C)),Ve.release(t),e.offset=M)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof dt)return e._isUpdated(t);var r=this._updateVersion===t;return!r&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,r=!0),r},_drawSelection:function(t,e,r,n,s){var u=this._selection,h=u&1,l=u&2||h&&this._selectBounds,p=u&4;if(this._drawSelected||(h=!1),(h||l||p)&&this._isUpdated(s)){var v,T=this.getSelectedColor(!0)||(v=this.getLayer())&&v.getSelectedColor(!0),I=e.appended(this.getGlobalMatrix(!0)),C=r/2;if(t.strokeStyle=t.fillStyle=T?T.toCanvasStyle(t):"#009dec",h&&this._drawSelected(t,I,n),p){var w=this.getPosition(!0),Y=this._parent,M=Y?Y.localToGlobal(w):w,j=M.x,k=M.y;t.beginPath(),t.arc(j,k,C,0,Math.PI*2,!0),t.stroke();for(var V=[[0,-1],[1,0],[0,1],[-1,0]],m=C,F=r+1,X=0;X<4;X++){var tt=V[X],U=tt[0],nt=tt[1];t.moveTo(j+U*m,k+nt*m),t.lineTo(j+U*F,k+nt*F),t.stroke()}}if(l){var ut=I._transformCorners(this.getInternalBounds());t.beginPath();for(var X=0;X<8;X++)t[X?"lineTo":"moveTo"](ut[X],ut[++X]);t.closePath(),t.stroke();for(var X=0;X<8;X++)t.fillRect(ut[X]-C,ut[++X]-C,r,r)}}},_canComposite:function(){return!1}},c.each(["down","drag","up","move"],function(t){this["removeOn"+c.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(t){for(var e in t)if(t[e]){var r="mouse"+e,n=this._project,s=n._removeSets=n._removeSets||{};s[r]=s[r]||{},s[r][this._id]=this}return this}}),{tween:function(t,e,r){r||(r=e,e=t,t=null,r||(r=e,e=null));var n=r&&r.easing,s=r&&r.start,u=r!=null&&(typeof r=="number"?r:r.duration),h=new _i(this,t,e,u,n,s);function l(p){h._handleFrame(p.time*1e3),h.running||this.off("frame",l)}return u&&this.on("frame",l),h},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),wt=f.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||this.addChildren(Array.isArray(e)?e:arguments)},_changed:function t(e){t.base.call(this,e),e&2050&&(this._clipItem=J)},_getClipItem:function(){var t=this._clipItem;if(t===J){t=null;for(var e=this._children,r=0,n=e.length;r<n;r++)if(e[r]._clipMask){t=e[r];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,r){var n=this._getClipItem();return n?n._getCachedBounds(n._matrix.prepended(e),c.set({},r,{stroke:!1})):t.base.call(this,e,r)},_hitTestChildren:function t(e,r,n){var s=this._getClipItem();return(!s||s.contains(e))&&t.base.call(this,e,r,n,s)},_draw:function(t,e){var r=e.clip,n=!r&&this._getClipItem();e=e.extend({clipItem:n,clip:!1}),r?(t.beginPath(),e.dontStart=e.dontFinish=!0):n&&n.draw(t,e.extend({clip:!0}));for(var s=this._children,u=0,h=s.length;u<h;u++){var l=s[u];l!==n&&l.draw(t,e)}}}),it=wt.extend({_class:"Layer",initialize:function(){wt.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function t(){return this._parent?t.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),rt=f.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(e,r){this._initialize(e,r)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&c.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new R(t.width,t.height,this,"setSize")},setSize:function(){var t=S.read(arguments);if(!this._size)this._size=t.clone();else if(!this._size.equals(t)){var e=this._type,r=t.width,n=t.height;e==="rectangle"?this._radius.set(S.min(this._radius,t.divide(2).abs())):e==="circle"?(r=n=(r+n)/2,this._radius=r/2):e==="ellipse"&&this._radius._set(r/2,n/2),this._size._set(r,n),this._changed(9)}},getRadius:function(){var t=this._radius;return this._type==="circle"?t:new R(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if(e==="circle"){if(t===this._radius)return;var r=t*2;this._radius=t,this._size._set(r,r)}else if(t=S.read(arguments),!this._radius)this._radius=t.clone();else{if(this._radius.equals(t))return;if(this._radius.set(t),e==="rectangle"){var r=S.max(this._size,t.multiply(2));this._size.set(r)}else e==="ellipse"&&this._size._set(t.width*2,t.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new ct[c.capitalize(this._type)]({center:new d,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),_e.settings.applyMatrix&&e.setApplyMatrix(!0),(t===J||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,r,n){var s=this._style,u=s.hasFill(),h=s.hasStroke(),l=e.dontFinish||e.clip,p=!n;if(u||h||l){var v=this._type,T=this._radius,I=v==="circle";if(e.dontStart||t.beginPath(),p&&I)t.arc(0,0,T,0,Math.PI*2,!0);else{var C=I?T:T.width,w=I?T:T.height,Y=this._size,M=Y.width,j=Y.height;if(p&&v==="rectangle"&&C===0&&w===0)t.rect(-M/2,-j/2,M,j);else{var k=M/2,V=j/2,m=1-.5522847498307936,F=C*m,X=w*m,tt=[-k,-V+w,-k,-V+X,-k+F,-V,-k+C,-V,k-C,-V,k-F,-V,k,-V+X,k,-V+w,k,V-w,k,V-X,k-F,V,k-C,V,-k+C,V,-k+F,V,-k,V-X,-k,V-w];n&&n.transform(tt,tt,32),t.moveTo(tt[0],tt[1]),t.bezierCurveTo(tt[2],tt[3],tt[4],tt[5],tt[6],tt[7]),k!==C&&t.lineTo(tt[8],tt[9]),t.bezierCurveTo(tt[10],tt[11],tt[12],tt[13],tt[14],tt[15]),V!==w&&t.lineTo(tt[16],tt[17]),t.bezierCurveTo(tt[18],tt[19],tt[20],tt[21],tt[22],tt[23]),k!==C&&t.lineTo(tt[24],tt[25]),t.bezierCurveTo(tt[26],tt[27],tt[28],tt[29],tt[30],tt[31])}}t.closePath()}!l&&(u||h)&&(this._setStyles(t,e,r),u&&(t.fill(s.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),h&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var r=new H(this._size).setCenter(0,0),n=this._style,s=e.stroke&&n.hasStroke()&&n.getStrokeWidth();return t&&(r=t._transformBounds(r)),s?r.expand(ct._getStrokePadding(s,this._getStrokeMatrix(t,e))):r}},new function(){function t(r,n,s){var u=r._radius;if(!u.isZero())for(var h=r._size.divide(2),l=1;l<=4;l++){var p=new d(l>1&&l<4?-1:1,l>2?-1:1),v=p.multiply(h),T=v.subtract(p.multiply(u)),I=new H(s?v.add(p.multiply(s)):v,T);if(I.contains(n))return{point:T,quadrant:l}}}function e(r,n,s,u){var h=r.divide(n);return(!u||h.isInQuadrant(u))&&h.subtract(h.normalize()).multiply(n).divide(s).length<=1}return{_contains:function r(n){if(this._type==="rectangle"){var s=t(this,n);return s?n.subtract(s.point).divide(this._radius).getLength()<=1:r.base.call(this,n)}else return n.divide(this.size).getLength()<=.5},_hitTestSelf:function r(n,s,u,h){var l=!1,p=this._style,v=s.stroke&&p.hasStroke(),T=s.fill&&p.hasFill();if(v||T){var I=this._type,C=this._radius,w=v?p.getStrokeWidth()/2:0,Y=s._tolerancePadding.add(ct._getStrokePadding(w,!p.getStrokeScaling()&&h));if(I==="rectangle"){var M=Y.multiply(2),j=t(this,n,M);if(j)l=e(n.subtract(j.point),C,Y,j.quadrant);else{var k=new H(this._size).setCenter(0,0),V=k.expand(M),m=k.expand(M.negate());l=V._containsPoint(n)&&!m._containsPoint(n)}}else l=e(n,C,Y)}return l?new It(v?"stroke":"fill",this):r.base.apply(this,arguments)}}},{statics:new function(){function t(e,r,n,s,u){var h=c.create(rt.prototype);return h._type=e,h._size=n,h._radius=s,h._initialize(c.getNamed(u),r),h}return{Circle:function(){var e=arguments,r=d.readNamed(e,"center"),n=c.readNamed(e,"radius");return t("circle",r,new S(n*2),n,e)},Rectangle:function(){var e=arguments,r=H.readNamed(e,"rectangle"),n=S.min(S.readNamed(e,"radius"),r.getSize(!0).divide(2));return t("rectangle",r.getCenter(!0),r.getSize(!0),n,e)},Ellipse:function(){var e=arguments,r=rt._readEllipse(e),n=r.radius;return t("ellipse",r.center,n.multiply(2),n,e)},_readEllipse:function(e){var r,n;if(c.hasNamed(e,"radius"))r=d.readNamed(e,"center"),n=S.readNamed(e,"radius");else{var s=H.readNamed(e,"rectangle");r=s.getCenter(!0),n=s.getSize(!0).divide(2)}return{center:r,radius:n}}}}}),st=f.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(e,r){if(!this._initialize(e,r!==J&&d.read(arguments))){var n,s=typeof e,u=s==="string"?z.getElementById(e):s==="object"?e:null;if(u&&u!==f.NO_INSERT){if(u.getContext||u.naturalHeight!=null)n=u;else if(u){var h=S.read(arguments);h.isZero()||(n=Ve.getCanvas(h))}}n?this.setImage(n):this.setSource(e)}this._size||(this._size=new S,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,r=t._canvas;if(e)this._setImage(e);else if(r){var n=Ve.getCanvas(t._size);n.getContext("2d").drawImage(r,0,0),this._setImage(n)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new R(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var r=S.read(arguments);if(r.equals(this._size))e&&this.clear();else if(r.width>0&&r.height>0){var n=!e&&this.getElement();this._setImage(Ve.getCanvas(r)),n&&this.getContext(!0).drawImage(n,0,0,r.width,r.height)}else this._canvas&&Ve.release(this._canvas),this._size=r.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||t.width===0&&t.height===0},getResolution:function(){var t=this._matrix,e=new d(0,0).transform(t),r=new d(1,0).transform(t).subtract(e),n=new d(0,1).transform(t).subtract(e);return new S(72/r.getLength(),72/n.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function r(n){var s=e.getView(),u=n&&n.type||"load";s&&e.responds(u)&&(_e=s._scope,e.emit(u,new ce(n)))}this._setImage(t),this._loaded?setTimeout(r,0):t&&Qt.add(t,{load:function(n){e._setImage(t),r(n)},error:r})},_setImage:function(t){this._canvas&&Ve.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new S(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=Ve.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch{Ve.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var e=new W.Image,r=this._crossOrigin;r&&(e.crossOrigin=r),t&&(e.src=t),this.setImage(e)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=typeof t=="string"?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=H.read(arguments),e=Ve.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=H.read(arguments),e=new st(f.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var r=this.getCanvas();return r?r.toDataURL.apply(r,arguments):null},drawImage:function(t){var e=d.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,r;if(t?t instanceof at?(r=t,e=t.getBounds()):typeof t=="object"&&("width"in t?e=new H(t):"x"in t&&(e=new H(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var n=32,s=Math.min(e.width,n),u=Math.min(e.height,n),h=st._sampleContext;h?h.clearRect(0,0,n+1,n+1):h=st._sampleContext=Ve.getContext(new S(n)),h.save();var l=new g().scale(s/e.width,u/e.height).translate(-e.x,-e.y);l.applyToContext(h),r&&r.draw(h,new c({clip:!0,matrices:[l]})),this._matrix.applyToContext(h);var p=this.getElement(),v=this._size;p&&h.drawImage(p,-v.width/2,-v.height/2),h.restore();for(var T=h.getImageData(.5,.5,Math.ceil(s),Math.ceil(u)).data,I=[0,0,0],C=0,w=0,Y=T.length;w<Y;w+=4){var M=T[w+3];C+=M,M/=255,I[0]+=T[w]*M,I[1]+=T[w+1]*M,I[2]+=T[w+2]*M}for(var w=0;w<3;w++)I[w]/=C;return C?Xt.read(I):null},getPixel:function(){var t=d.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new Xt("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=d.read(t),r=Xt.read(t),n=r._convert("rgb"),s=r._alpha,u=this.getContext(!0),h=u.createImageData(1,1),l=h.data;l[0]=n[0]*255,l[1]=n[1]*255,l[2]=n[2]*255,l[3]=s!=null?s*255:255,u.putImageData(h,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=S.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=H.read(arguments);return t.isEmpty()&&(t=new H(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var e=d.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,e){var r=new H(this._size).setCenter(0,0);return t?t._transformBounds(r):r},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new It("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,r){var n=this.getElement();if(n&&n.width>0&&n.height>0){t.globalAlpha=Z.clamp(this._opacity,0,1),this._setStyles(t,e,r);var s=this._smoothing,u=s==="off";Wt.setPrefixed(t,u?"imageSmoothingEnabled":"imageSmoothingQuality",u?!1:s),t.drawImage(n,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),gt=f.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(e,r){this._initialize(e,r!==J&&d.read(arguments,1))||this.setDefinition(e instanceof St?e:new St(e))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var r=this._definition._item;return r._getCachedBounds(r._matrix.prepended(t),e)},_hitTestSelf:function(t,e,r){var n=e.extend({all:!1}),s=this._definition._item._hitTest(t,n,r);return s&&(s.item=this),s},_draw:function(t,e){this._definition._item.draw(t,e)}}),St=c.extend({_class:"SymbolDefinition",initialize:function(e,r){this._id=G.get(),this.project=_e.project,e&&this.setItem(e,r)},_serialize:function(t,e){return e.add(this,function(){return c.serialize([this._class,this._item],t,!1,e)})},_changed:function(t){t&8&&f._clearBoundsCache(this),t&1&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new d),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new gt(this,t)},clone:function(){return new St(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),It=c.extend({_class:"HitResult",initialize:function(e,r,n){this.type=e,this.item=r,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&c.read(t);return new c({type:null,tolerance:_e.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),Pt=c.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(e,r,n,s,u,h){var l=arguments.length,p,v,T,I;l>0&&(e==null||typeof e=="object"?l===1&&e&&"point"in e?(p=e.point,v=e.handleIn,T=e.handleOut,I=e.selection):(p=e,v=r,T=n,I=s):(p=[e,r],v=n!==J?[n,s]:null,T=u!==J?[u,h]:null)),new Tt(p,this,"_point"),new Tt(v,this,"_handleIn"),new Tt(T,this,"_handleOut"),I&&this.setSelection(I)},_serialize:function(t,e){var r=this._point,n=this._selection,s=n||this.hasHandles()?[r,this._handleIn,this._handleOut]:r;return n&&s.push(n),c.serialize(s,t,!0,e)},_changed:function(t){var e=this._path;if(e){var r=e._curves,n=this._index,s;r&&((!t||t===this._point||t===this._handleIn)&&(s=n>0?r[n-1]:e._closed?r[r.length-1]:null)&&s._changed(),(!t||t===this._point||t===this._handleOut)&&(s=r[n])&&s._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(d.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(d.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(d.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,r=this._path;this._selection=t=t||0,r&&t!==e&&(r._updateSelection(this,e,t),r._changed(257))},_changeSelection:function(t,e){var r=this._selection;this.setSelection(e?r|t:r&~t)},isSelected:function(){return!!(this._selection&7)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==J?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new Q(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,r){var n=t||{},s=n.type,u=n.factor,h=this.getPrevious(),l=this.getNext(),p=(h||this)._point,v=this._point,T=(l||this)._point,I=p.getDistance(v),C=v.getDistance(T);if(!s||s==="catmull-rom"){var w=u===J?.5:u,Y=Math.pow(I,w),M=Y*Y,j=Math.pow(C,w),k=j*j;if(!e&&h){var V=2*k+3*j*Y+M,m=3*j*(j+Y);this.setHandleIn(m!==0?new d((k*p._x+V*v._x-M*T._x)/m-v._x,(k*p._y+V*v._y-M*T._y)/m-v._y):new d)}if(!r&&l){var V=2*M+3*Y*j+k,m=3*Y*(Y+j);this.setHandleOut(m!==0?new d((M*T._x+V*v._x-k*p._x)/m-v._x,(M*T._y+V*v._y-k*p._y)/m-v._y):new d)}}else if(s==="geometric"){if(h&&l){var F=p.subtract(T),X=u===J?.4:u,tt=X*I/(I+C);e||this.setHandleIn(F.multiply(tt)),r||this.setHandleOut(F.multiply(tt-X))}}else throw new Error("Smoothing method '"+s+"' not supported.")},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,r=t.clone();t.set(e),e.set(r)},reversed:function(){return new Pt(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Pt(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,r){var n=1-r,s=r,u=t._point,h=e._point,l=t._handleIn,p=e._handleIn,v=e._handleOut,T=t._handleOut;this._point._set(n*u._x+s*h._x,n*u._y+s*h._y,!0),this._handleIn._set(n*l._x+s*p._x,n*l._y+s*p._y,!0),this._handleOut._set(n*T._x+s*v._x,n*T._y+s*v._y,!0),this._changed()},_transformCoordinates:function(t,e,r){var n=this._point,s=!r||!this._handleIn.isZero()?this._handleIn:null,u=!r||!this._handleOut.isZero()?this._handleOut:null,h=n._x,l=n._y,p=2;return e[0]=h,e[1]=l,s&&(e[p++]=s._x+h,e[p++]=s._y+l),u&&(e[p++]=u._x+h,e[p++]=u._y+l),t&&(t._transformCoordinates(e,e,p/2),h=e[0],l=e[1],r?(n._x=h,n._y=l,p=2,s&&(s._x=e[p++]-h,s._y=e[p++]-l),u&&(u._x=e[p++]-h,u._y=e[p++]-l)):(s||(e[p++]=h,e[p++]=l),u||(e[p++]=h,e[p++]=l))),e}}),Tt=d.extend({initialize:function(e,r,n){var s,u,h;if(!e)s=u=0;else if((s=e[0])!==J)u=e[1];else{var l=e;(s=l.x)===J&&(l=d.read(arguments),s=l.x),u=l.y,h=l.selected}this._x=s,this._y=u,this._owner=r,r[n]=this,h&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=Z.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),Nt=c.extend({_class:"Curve",beans:!0,initialize:function(e,r,n,s,u,h,l,p){var v=arguments.length,T,I,C,w,Y,M;v===3?(this._path=e,T=r,I=n):v?v===1?"segment1"in e?(T=new Pt(e.segment1),I=new Pt(e.segment2)):"point1"in e?(C=e.point1,Y=e.handle1,M=e.handle2,w=e.point2):Array.isArray(e)&&(C=[e[0],e[1]],w=[e[6],e[7]],Y=[e[2]-e[0],e[3]-e[1]],M=[e[4]-e[6],e[5]-e[7]]):v===2?(T=new Pt(e),I=new Pt(r)):v===4?(C=e,Y=r,M=n,w=s):v===8&&(C=[e,r],w=[l,p],Y=[n-e,s-r],M=[u-l,h-p]):(T=new Pt,I=new Pt),this._segment1=T||new Pt(C,null,Y),this._segment2=I||new Pt(w,M,null)},_serialize:function(t,e){return c.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=J},clone:function(){return new Nt(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return Nt.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,r=e._handleOut;t=e.remove(),t&&this._segment1._handleOut.set(r)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(d.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(d.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(d.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(d.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return Nt.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],r=0;r<8;r+=2)e.push(new d(t[r],t[r+1]));return e}},{getLength:function(){return this._length==null&&(this._length=Nt.getLength(this.getValues(),0,1)),this._length},getArea:function(){return Nt.getArea(this.getValues())},getLine:function(){return new L(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new Nt(Nt.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return Nt.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var r=1e-8,n=1-r,s=null;if(t>=r&&t<=n){var u=Nt.subdivide(this.getValues(),t),h=u[0],l=u[1],p=e||this.hasHandles(),v=this._segment1,T=this._segment2,I=this._path;p&&(v._handleOut._set(h[2]-h[0],h[3]-h[1]),T._handleIn._set(l[4]-l[6],l[5]-l[7]));var C=h[6],w=h[7],Y=new Pt(new d(C,w),p&&new d(h[4]-C,h[5]-w),p&&new d(l[2]-C,l[3]-w));I?(I.insert(v._index+1,Y),s=this.getNext()):(this._segment2=Y,this._changed(),s=new Nt(Y,T))}return s},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===J?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===J?.5:e?t:this.getTimeAt(t))},reversed:function(){return new Nt(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,r,n){var s=t._point,u=t._handleOut,h=e._handleIn,l=e._point,p=s.x,v=s.y,T=l.x,I=l.y,C=n?[p,v,p,v,T,I,T,I]:[p,v,p+u._x,v+u._y,T+h._x,I+h._y,T,I];return r&&r._transformCoordinates(C,C,4),C},subdivide:function(t,e){var r=t[0],n=t[1],s=t[2],u=t[3],h=t[4],l=t[5],p=t[6],v=t[7];e===J&&(e=.5);var T=1-e,I=T*r+e*s,C=T*n+e*u,w=T*s+e*h,Y=T*u+e*l,M=T*h+e*p,j=T*l+e*v,k=T*I+e*w,V=T*C+e*Y,m=T*w+e*M,F=T*Y+e*j,X=T*k+e*m,tt=T*V+e*F;return[[r,n,I,C,k,V,X,tt],[X,tt,m,F,M,j,p,v]]},getMonoCurves:function(t,e){var r=[],n=e?0:1,s=t[n+0],u=t[n+2],h=t[n+4],l=t[n+6];if(s>=u==u>=h&&u>=h==h>=l||Nt.isStraight(t))r.push(t);else{var p=3*(u-h)-s+l,v=2*(s+h)-4*u,T=u-s,I=1e-8,C=1-I,w=[],Y=Z.solveQuadratic(p,v,T,w,I,C);if(!Y)r.push(t);else{w.sort();var M=w[0],j=Nt.subdivide(t,M);r.push(j[0]),Y>1&&(M=(w[1]-M)/(1-M),j=Nt.subdivide(j[1],M),r.push(j[0])),r.push(j[1])}}return r},solveCubic:function(t,e,r,n,s,u){var h=t[e],l=t[e+2],p=t[e+4],v=t[e+6],T=0;if(!(h<r&&v<r&&l<r&&p<r||h>r&&v>r&&l>r&&p>r)){var I=3*(l-h),C=3*(p-l)-I,w=v-h-I-C;T=Z.solveCubic(w,C,I,h-r,n,s,u)}return T},getTimeOf:function(t,e){var r=new d(t[0],t[1]),n=new d(t[6],t[7]),s=1e-12,u=1e-7,h=e.isClose(r,s)?0:e.isClose(n,s)?1:null;if(h===null)for(var l=[e.x,e.y],p=[],v=0;v<2;v++)for(var T=Nt.solveCubic(t,v,l[v],p,0,1),I=0;I<T;I++){var C=p[I];if(e.isClose(Nt.getPoint(t,C),u))return C}return e.isClose(r,u)?0:e.isClose(n,u)?1:null},getNearestTime:function(t,e){if(Nt.isStraight(t)){var r=t[0],n=t[1],s=t[6],u=t[7],h=s-r,l=u-n,p=h*h+l*l;if(p===0)return 0;var v=((e.x-r)*h+(e.y-n)*l)/p;return v<1e-12?0:v>.999999999999?1:Nt.getTimeOf(t,new d(r+v*h,n+v*l))}var T=100,I=1/0,C=0;function w(j){if(j>=0&&j<=1){var k=e.getDistance(Nt.getPoint(t,j),!0);if(k<I)return I=k,C=j,!0}}for(var Y=0;Y<=T;Y++)w(Y/T);for(var M=1/(T*2);M>1e-8;)!w(C-M)&&!w(C+M)&&(M/=2);return C},getPart:function(t,e,r){var n=e>r;if(n){var s=e;e=r,r=s}return e>0&&(t=Nt.subdivide(t,e)[1]),r<1&&(t=Nt.subdivide(t,(r-e)/(1-e))[0]),n?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var r=t[0],n=t[1],s=t[2],u=t[3],h=t[4],l=t[5],p=t[6],v=t[7],T=3*s-2*r-p,I=3*u-2*n-v,C=3*h-2*p-r,w=3*l-2*v-n;return Math.max(T*T,C*C)+Math.max(I*I,w*w)<=16*e*e},getArea:function(t){var e=t[0],r=t[1],n=t[2],s=t[3],u=t[4],h=t[5],l=t[6],p=t[7];return 3*((p-r)*(n+u)-(l-e)*(s+h)+s*(e-u)-n*(r-h)+p*(u+e/3)-l*(h+r/3))/20},getBounds:function(t){for(var e=t.slice(0,2),r=e.slice(),n=[0,0],s=0;s<2;s++)Nt._addBounds(t[s],t[s+2],t[s+4],t[s+6],s,0,e,r,n);return new H(e[0],e[1],r[0]-e[0],r[1]-e[1])},_addBounds:function(t,e,r,n,s,u,h,l,p){function v(X,tt){var U=X-tt,nt=X+tt;U<h[s]&&(h[s]=U),nt>l[s]&&(l[s]=nt)}u/=2;var T=h[s]+u,I=l[s]-u;if(t<T||e<T||r<T||n<T||t>I||e>I||r>I||n>I)if(e<t!=e<n&&r<t!=r<n)v(t,0),v(n,0);else{var C=3*(e-r)-t+n,w=2*(t+r)-4*e,Y=e-t,M=Z.solveQuadratic(C,w,Y,p),j=1e-8,k=1-j;v(n,0);for(var V=0;V<M;V++){var m=p[V],F=1-m;j<=m&&m<=k&&v(F*F*F*t+3*F*F*m*e+3*F*m*m*r+m*m*m*n,u)}}}}},c.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=ct[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}},{}),c.each({isStraight:function(t,e,r,n){if(e.isZero()&&r.isZero())return!0;var s=n.subtract(t);if(s.isZero())return!1;if(s.isCollinear(e)&&s.isCollinear(r)){var u=new L(t,n),h=1e-7;if(u.getDistance(t.add(e))<h&&u.getDistance(n.add(r))<h){var l=s.dot(s),p=s.dot(e)/l,v=s.dot(r)/l;return p>=0&&p<=1&&v<=0&&v>=-1}}return!1},isLinear:function(t,e,r,n){var s=n.subtract(t).divide(3);return e.equals(s)&&r.negate().equals(s)}},function(t,e){this[e]=function(r){var n=this._segment1,s=this._segment2;return t(n._point,n._handleOut,s._handleIn,s._point,r)},this.statics[e]=function(r,n){var s=r[0],u=r[1],h=r[6],l=r[7];return t(new d(s,u),new d(r[2]-s,r[3]-u),new d(r[4]-h,r[5]-l),new d(h,l),n)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new Q(this,t):null},getTimeAt:function(t,e){return Nt.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=d.read(arguments);return t.isZero()?[]:Nt.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(d.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return Nt.getTimeOf(this.getValues(),d.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=d.read(arguments),e=this.getValues(),r=Nt.getNearestTime(e,t),n=Nt.getPoint(e,r);return new Q(this,r,n,null,t.getDistance(n))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return c.each(t,function(e){this[e+"At"]=function(r,n){var s=this.getValues();return Nt[e](s,n?r:Nt.getTimeAt(s,r))},this[e+"AtTime"]=function(r){return Nt[e](this.getValues(),r)}},{statics:{_evaluateMethods:t}})},new function(){function t(n){var s=n[0],u=n[1],h=n[2],l=n[3],p=n[4],v=n[5],T=n[6],I=n[7],C=9*(h-p)+3*(T-s),w=6*(s+p)-12*h,Y=3*(h-s),M=9*(l-v)+3*(I-u),j=6*(u+v)-12*l,k=3*(l-u);return function(V){var m=(C*V+w)*V+Y,F=(M*V+j)*V+k;return Math.sqrt(m*m+F*F)}}function e(n,s){return Math.max(2,Math.min(16,Math.ceil(Math.abs(s-n)*32)))}function r(n,s,u,h){if(s==null||s<0||s>1)return null;var l=n[0],p=n[1],v=n[2],T=n[3],I=n[4],C=n[5],w=n[6],Y=n[7],M=Z.isZero;M(v-l)&&M(T-p)&&(v=l,T=p),M(I-w)&&M(C-Y)&&(I=w,C=Y);var j=3*(v-l),k=3*(I-v)-j,V=w-l-j-k,m=3*(T-p),F=3*(C-T)-m,X=Y-p-m-F,tt,U;if(u===0)tt=s===0?l:s===1?w:((V*s+k)*s+j)*s+l,U=s===0?p:s===1?Y:((X*s+F)*s+m)*s+p;else{var nt=1e-8,ut=1-nt;if(s<nt?(tt=j,U=m):s>ut?(tt=3*(w-I),U=3*(Y-C)):(tt=(3*V*s+2*k)*s+j,U=(3*X*s+2*F)*s+m),h){tt===0&&U===0&&(s<nt||s>ut)&&(tt=I-v,U=C-T);var pt=Math.sqrt(tt*tt+U*U);pt&&(tt/=pt,U/=pt)}if(u===3){var I=6*V*s+2*k,C=6*X*s+2*F,bt=Math.pow(tt*tt+U*U,3/2);tt=bt!==0?(tt*C-U*I)/bt:0,U=0}}return u===2?new d(U,-tt):new d(tt,U)}return{statics:{classify:function(n){var s=n[0],u=n[1],h=n[2],l=n[3],p=n[4],v=n[5],T=n[6],I=n[7],C=s*(I-v)+u*(p-T)+T*v-I*p,w=h*(u-I)+l*(T-s)+s*I-u*T,Y=p*(l-u)+v*(s-h)+h*u-l*s,M=3*Y,j=M-w,k=j-w+C,V=Math.sqrt(k*k+j*j+M*M),m=V!==0?1/V:0,F=Z.isZero,X="serpentine";k*=m,j*=m,M*=m;function tt(pt,bt,ot){var xt=bt!==J,yt=xt&&bt>0&&bt<1,At=xt&&ot>0&&ot<1;return xt&&(!(yt||At)||pt==="loop"&&!(yt&&At))&&(pt="arch",yt=At=!1),{type:pt,roots:yt||At?yt&&At?bt<ot?[bt,ot]:[ot,bt]:[yt?bt:ot]:null}}if(F(k))return F(j)?tt(F(M)?"line":"quadratic"):tt(X,M/(3*j));var U=3*j*j-4*k*M;if(F(U))return tt("cusp",j/(2*k));var nt=U>0?Math.sqrt(U/3):Math.sqrt(-U),ut=2*k;return tt(U>0?X:"loop",(j+nt)/ut,(j-nt)/ut)},getLength:function(n,s,u,h){if(s===J&&(s=0),u===J&&(u=1),Nt.isStraight(n)){var l=n;u<1&&(l=Nt.subdivide(l,u)[0],s/=u),s>0&&(l=Nt.subdivide(l,s)[1]);var p=l[6]-l[0],v=l[7]-l[1];return Math.sqrt(p*p+v*v)}return Z.integrate(h||t(n),s,u,e(s,u))},getTimeAt:function(n,s,u){if(u===J&&(u=s<0?1:0),s===0)return u;var h=Math.abs,l=1e-12,p=s>0,v=p?u:0,T=p?1:u,I=t(n),C=Nt.getLength(n,v,T,I),w=h(s)-C;if(h(w)<l)return p?T:v;if(w>l)return null;var Y=s/C,M=0;function j(k){return M+=Z.integrate(I,u,k,e(u,k)),u=k,M-s}return Z.findRoot(j,I,u+Y,v,T,32,1e-12)},getPoint:function(n,s){return r(n,s,0,!1)},getTangent:function(n,s){return r(n,s,1,!0)},getWeightedTangent:function(n,s){return r(n,s,1,!1)},getNormal:function(n,s){return r(n,s,2,!0)},getWeightedNormal:function(n,s){return r(n,s,2,!1)},getCurvature:function(n,s){return r(n,s,3,!1).x},getPeaks:function(n){var s=n[0],u=n[1],h=n[2],l=n[3],p=n[4],v=n[5],T=n[6],I=n[7],C=-s+3*h-3*p+T,w=3*s-6*h+3*p,Y=-3*s+3*h,M=-u+3*l-3*v+I,j=3*u-6*l+3*v,k=-3*u+3*l,V=1e-8,m=1-V,F=[];return Z.solveCubic(9*(C*C+M*M),9*(C*w+j*M),2*(w*w+j*j)+3*(Y*C+k*M),Y*w+j*k,F,V,m),F.sort()}}}},new function(){function t(w,Y,M,j,k,V,m){var F=!m&&M.getPrevious()===k,X=!m&&M!==k&&M.getNext()===k,tt=1e-8,U=1-tt;if(j!==null&&j>=(F?tt:0)&&j<=(X?U:1)&&V!==null&&V>=(X?tt:0)&&V<=(F?U:1)){var nt=new Q(M,j,null,m),ut=new Q(k,V,null,m);nt._intersection=ut,ut._intersection=nt,(!Y||Y(nt))&&Q.insert(w,nt,!0)}}function e(w,Y,M,j,k,V,m,F,X,tt,U,nt,ut){if(++X>=4096||++F>=40)return X;var pt=1e-9,bt=Y[0],ot=Y[1],xt=Y[6],yt=Y[7],At=L.getSignedDistance,Rt=At(bt,ot,xt,yt,Y[2],Y[3]),Mt=At(bt,ot,xt,yt,Y[4],Y[5]),jt=Rt*Mt>0?3/4:4/9,$t=jt*Math.min(0,Rt,Mt),ie=jt*Math.max(0,Rt,Mt),oe=At(bt,ot,xt,yt,w[0],w[1]),zt=At(bt,ot,xt,yt,w[2],w[3]),Ht=At(bt,ot,xt,yt,w[4],w[5]),ne=At(bt,ot,xt,yt,w[6],w[7]),ue=r(oe,zt,Ht,ne),se=ue[0],fe=ue[1],de,ye;if(Rt===0&&Mt===0&&oe===0&&zt===0&&Ht===0&&ne===0||(de=n(se,fe,$t,ie))==null||(ye=n(se.reverse(),fe.reverse(),$t,ie))==null)return X;var Ce=tt+(U-tt)*de,ve=tt+(U-tt)*ye;if(Math.max(ut-nt,ve-Ce)<pt){var Xe=(Ce+ve)/2,Be=(nt+ut)/2;t(k,V,m?j:M,m?Be:Xe,m?M:j,m?Xe:Be)}else{w=Nt.getPart(w,de,ye);var $e=ut-nt;if(ye-de>.8)if(ve-Ce>$e){var We=Nt.subdivide(w,.5),Xe=(Ce+ve)/2;X=e(Y,We[0],j,M,k,V,!m,F,X,nt,ut,Ce,Xe),X=e(Y,We[1],j,M,k,V,!m,F,X,nt,ut,Xe,ve)}else{var We=Nt.subdivide(Y,.5),Be=(nt+ut)/2;X=e(We[0],w,j,M,k,V,!m,F,X,nt,Be,Ce,ve),X=e(We[1],w,j,M,k,V,!m,F,X,Be,ut,Ce,ve)}else $e===0||$e>=pt?X=e(Y,w,j,M,k,V,!m,F,X,nt,ut,Ce,ve):X=e(w,Y,M,j,k,V,m,F,X,Ce,ve,nt,ut)}return X}function r(w,Y,M,j){var k=[0,w],V=[1/3,Y],m=[2/3,M],F=[1,j],X=Y-(2*w+j)/3,tt=M-(w+2*j)/3,U;if(X*tt<0)U=[[k,V,F],[k,m,F]];else{var nt=X/tt;U=[nt>=2?[k,V,F]:nt<=.5?[k,m,F]:[k,V,m,F],[k,F]]}return(X||tt)<0?U.reverse():U}function n(w,Y,M,j){return w[0][1]<M?s(w,!0,M):Y[0][1]>j?s(Y,!1,j):w[0][0]}function s(w,Y,M){for(var j=w[0][0],k=w[0][1],V=1,m=w.length;V<m;V++){var F=w[V][0],X=w[V][1];if(Y?X>=M:X<=M)return X===M?F:j+(M-k)*(F-j)/(X-k);j=F,k=X}return null}function u(w,Y,M,j,k){var V=Z.isZero;if(V(j)&&V(k)){var m=Nt.getTimeOf(w,new d(Y,M));return m===null?[]:[m]}for(var F=Math.atan2(-k,j),X=Math.sin(F),tt=Math.cos(F),U=[],nt=[],ut=0;ut<8;ut+=2){var pt=w[ut]-Y,bt=w[ut+1]-M;U.push(pt*tt-bt*X,pt*X+bt*tt)}return Nt.solveCubic(U,1,0,nt,0,1),nt}function h(w,Y,M,j,k,V,m){for(var F=Y[0],X=Y[1],tt=Y[6],U=Y[7],nt=u(w,F,X,tt-F,U-X),ut=0,pt=nt.length;ut<pt;ut++){var bt=nt[ut],ot=Nt.getPoint(w,bt),xt=Nt.getTimeOf(Y,ot);xt!==null&&t(k,V,m?j:M,m?xt:bt,m?M:j,m?bt:xt)}}function l(w,Y,M,j,k,V){var m=L.intersect(w[0],w[1],w[6],w[7],Y[0],Y[1],Y[6],Y[7]);m&&t(k,V,M,Nt.getTimeOf(w,m),j,Nt.getTimeOf(Y,m))}function p(w,Y,M,j,k,V){var m=1e-12,F=Math.min,X=Math.max;if(X(w[0],w[2],w[4],w[6])+m>F(Y[0],Y[2],Y[4],Y[6])&&F(w[0],w[2],w[4],w[6])-m<X(Y[0],Y[2],Y[4],Y[6])&&X(w[1],w[3],w[5],w[7])+m>F(Y[1],Y[3],Y[5],Y[7])&&F(w[1],w[3],w[5],w[7])-m<X(Y[1],Y[3],Y[5],Y[7])){var tt=I(w,Y);if(tt)for(var U=0;U<2;U++){var nt=tt[U];t(k,V,M,nt[0],j,nt[1],!0)}else{var ut=Nt.isStraight(w),pt=Nt.isStraight(Y),bt=ut&&pt,ot=ut&&!pt,xt=k.length;if((bt?l:ut||pt?h:e)(ot?Y:w,ot?w:Y,ot?j:M,ot?M:j,k,V,ot,0,0,0,1,0,1),!bt||k.length===xt)for(var U=0;U<4;U++){var yt=U>>1,At=U&1,Rt=yt*6,Mt=At*6,jt=new d(w[Rt],w[Rt+1]),$t=new d(Y[Mt],Y[Mt+1]);jt.isClose($t,m)&&t(k,V,M,yt,j,At)}}}return k}function v(w,Y,M,j){var k=Nt.classify(w);if(k.type==="loop"){var V=k.roots;t(M,j,Y,V[0],Y,V[1])}return M}function T(w,Y,M,j,k,V){var m=1e-7,F=!Y;F&&(Y=w);for(var X=w.length,tt=Y.length,U=new Array(X),nt=F?U:new Array(tt),ut=[],pt=0;pt<X;pt++)U[pt]=w[pt].getValues(j);if(!F)for(var pt=0;pt<tt;pt++)nt[pt]=Y[pt].getValues(k);for(var bt=N.findCurveBoundsCollisions(U,nt,m),ot=0;ot<X;ot++){var xt=w[ot],yt=U[ot];F&&v(yt,xt,ut,M);var At=bt[ot];if(At)for(var Rt=0;Rt<At.length;Rt++){if(V&&ut.length)return ut;var Mt=At[Rt];if(!F||Mt>ot){var jt=Y[Mt],$t=nt[Mt];p(yt,$t,xt,jt,ut,M)}}}return ut}function I(w,Y){function M(ne){var ue=ne[6]-ne[0],se=ne[7]-ne[1];return ue*ue+se*se}var j=Math.abs,k=L.getDistance,V=1e-8,m=1e-7,F=Nt.isStraight(w),X=Nt.isStraight(Y),tt=F&&X,U=M(w)<M(Y),nt=U?Y:w,ut=U?w:Y,pt=nt[0],bt=nt[1],ot=nt[6]-pt,xt=nt[7]-bt;if(k(pt,bt,ot,xt,ut[0],ut[1],!0)<m&&k(pt,bt,ot,xt,ut[6],ut[7],!0)<m)!tt&&k(pt,bt,ot,xt,nt[2],nt[3],!0)<m&&k(pt,bt,ot,xt,nt[4],nt[5],!0)<m&&k(pt,bt,ot,xt,ut[2],ut[3],!0)<m&&k(pt,bt,ot,xt,ut[4],ut[5],!0)<m&&(F=X=tt=!0);else if(tt)return null;if(F^X)return null;for(var yt=[w,Y],At=[],Rt=0;Rt<4&&At.length<2;Rt++){var Mt=Rt&1,jt=Mt^1,$t=Rt>>1,ie=Nt.getTimeOf(yt[Mt],new d(yt[jt][$t?6:0],yt[jt][$t?7:1]));if(ie!=null){var oe=Mt?[$t,ie]:[ie,$t];(!At.length||j(oe[0]-At[0][0])>V&&j(oe[1]-At[0][1])>V)&&At.push(oe)}if(Rt>2&&!At.length)break}if(At.length!==2)At=null;else if(!tt){var zt=Nt.getPart(w,At[0][0],At[1][0]),Ht=Nt.getPart(Y,At[0][1],At[1][1]);(j(Ht[2]-zt[2])>m||j(Ht[3]-zt[3])>m||j(Ht[4]-zt[4])>m||j(Ht[5]-zt[5])>m)&&(At=null)}return At}function C(w,Y){var M=w[0],j=w[1],k=w[2],V=w[3],m=w[4],F=w[5],X=w[6],tt=w[7],U=Y.normalize(),nt=U.x,ut=U.y,pt=3*X-9*m+9*k-3*M,bt=3*tt-9*F+9*V-3*j,ot=6*m-12*k+6*M,xt=6*F-12*V+6*j,yt=3*k-3*M,At=3*V-3*j,Rt=2*pt*ut-2*bt*nt,Mt=[];if(Math.abs(Rt)<Z.CURVETIME_EPSILON){var jt=pt*At-bt*yt,Rt=pt*xt-bt*ot;if(Rt!=0){var $t=-jt/Rt;$t>=0&&$t<=1&&Mt.push($t)}}else{var ie=(ot*ot-4*pt*yt)*ut*ut+(-2*ot*xt+4*bt*yt+4*pt*At)*nt*ut+(xt*xt-4*bt*At)*nt*nt,oe=ot*ut-xt*nt;if(ie>=0&&Rt!=0){var zt=Math.sqrt(ie),Ht=-(oe+zt)/Rt,ne=(-oe+zt)/Rt;Ht>=0&&Ht<=1&&Mt.push(Ht),ne>=0&&ne<=1&&Mt.push(ne)}}return Mt}return{getIntersections:function(w){var Y=this.getValues(),M=w&&w!==this&&w.getValues();return M?p(Y,M,this,w,[]):v(Y,this,[])},statics:{getOverlaps:I,getIntersections:T,getCurveLineIntersections:u,getTimesWithTangent:C}}}),Q=c.extend({_class:"CurveLocation",initialize:function(e,r,n,s,u){if(r>=.99999999){var h=e.getNext();h&&(r=0,e=h)}this._setCurve(e),this._time=r,this._point=n||e.getPointAtTime(r),this._overlap=s,this._distance=u,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),r=this.getTime();r===0?t=e._segment1:r===1?t=e._segment2:r!=null&&(t=e.getPartLength(0,r)<e.getPartLength(r,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function r(n){var s=n&&n.getCurve();if(s&&(e._time=s.getTimeOf(e._point))!=null)return e._setCurve(s),s}return this._curve||r(this._segment)||r(this._segment1)||r(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&e==null?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(t==null){t=0;var e=this.getPath(),r=this.getIndex();if(e&&r!=null)for(var n=e.getCurves(),s=0;s<r;s++)t+=n[s].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(t==null){var e=this.getCurve(),r=this.getTime();this._curveOffset=t=r!=null&&e&&e.getPartLength(0,r)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,r=t&&t.splitAtTime(this.getTime());return r&&this._setSegment(e.getLastSegment()),r},equals:function(t,e){var r=this===t;if(!r&&t instanceof Q){var n=this.getCurve(),s=t.getCurve(),u=n._path,h=s._path;if(u===h){var l=Math.abs,p=1e-7,v=l(this.getOffset()-t.getOffset()),T=!e&&this._intersection,I=!e&&t._intersection;r=(v<p||u&&l(u.getLength()-v)<p)&&(!T&&!I||T&&I&&T.equals(I,!0))}}return r},toString:function(){var t=[],e=this.getPoint(),r=B.instance;e&&t.push("point: "+e);var n=this.getIndex();n!=null&&t.push("index: "+n);var s=this.getTime();return s!=null&&t.push("time: "+r.number(s)),this._distance!=null&&t.push("distance: "+r.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),r=t.getCurve();return!(e.isStraight()&&r.isStraight()&&e.getLine().intersect(r.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),r=t.getTime(),n=1e-8,s=1-n,u=e>=n&&e<=s,h=r>=n&&r<=s;if(u&&h)return!this.isTouching();var l=this.getCurve(),p=l&&e<n?l.getPrevious():l,v=t.getCurve(),T=v&&r<n?v.getPrevious():v;if(e>s&&(l=l.getNext()),r>s&&(v=v.getNext()),!p||!l||!T||!v)return!1;var I=[];function C(nt,ut){var pt=nt.getValues(),bt=Nt.classify(pt).roots||Nt.getPeaks(pt),ot=bt.length,xt=Nt.getLength(pt,ut&&ot?bt[ot-1]:0,!ut&&ot?bt[0]:1);I.push(ot?xt:xt/32)}function w(nt,ut,pt){return ut<pt?nt>ut&&nt<pt:nt>ut||nt<pt}u||(C(p,!0),C(l,!1)),h||(C(T,!0),C(v,!1));var Y=this.getPoint(),M=Math.min.apply(Math,I),j=u?l.getTangentAtTime(e):l.getPointAt(M).subtract(Y),k=u?j.negate():p.getPointAt(-M).subtract(Y),V=h?v.getTangentAtTime(r):v.getPointAt(M).subtract(Y),m=h?V.negate():T.getPointAt(-M).subtract(Y),F=k.getAngle(),X=j.getAngle(),tt=m.getAngle(),U=V.getAngle();return!!(u?w(F,tt,U)^w(X,tt,U)&&w(F,U,tt)^w(X,U,tt):w(tt,F,X)^w(U,F,X)&&w(tt,X,F)^w(U,X,F))},hasOverlap:function(){return!!this._overlap}},c.each(Nt._evaluateMethods,function(t){var e=t+"At";this[t]=function(){var r=this.getCurve(),n=this.getTime();return n!=null&&r&&r[e](n,!0)}},{preserve:!0}),new function(){function t(e,r,n){var s=e.length,u=0,h=s-1;function l(Y,M){for(var j=Y+M;j>=-1&&j<=s;j+=M){var k=e[(j%s+s)%s];if(!r.getPoint().isClose(k.getPoint(),1e-7))break;if(r.equals(k))return k}return null}for(;u<=h;){var p=u+h>>>1,v=e[p],T;if(n&&(T=r.equals(v)?v:l(p,-1)||l(p,1)))return r._overlap&&(T._overlap=T._intersection._overlap=!0),T;var I=r.getPath(),C=v.getPath(),w=I!==C?I._id-C._id:r.getIndex()+r.getTime()-(v.getIndex()+v.getTime());w<0?h=p-1:u=p+1}return e.splice(u,0,r),r}return{statics:{insert:t,expand:function(e){for(var r=e.slice(),n=e.length-1;n>=0;n--)t(r,e[n]._intersection,!1);return r}}}}),at=f.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,r,n;if(c.isPlainObject(t)?(r=t.segments,e=t.pathData):Array.isArray(t)?r=t:typeof t=="string"&&(e=t),r){var s=r[0];n=s&&Array.isArray(s[0])}else e&&(n=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));var u=n?dt:ct;return new u(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),r,n=!1,s,u,h=new d,l=new d;function p(m,F){var X=+r[m];return n&&(X+=h[F]),X}function v(m){return new d(p(m,"x"),p(m+1,"y"))}this.clear();for(var T=0,I=e&&e.length;T<I;T++){var C=e[T],w=C[0],Y=w.toLowerCase();r=C.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var M=r&&r.length;switch(n=w===Y,s==="z"&&!/[mz]/.test(Y)&&this.moveTo(h),Y){case"m":case"l":for(var j=Y==="m",k=0;k<M;k+=2)this[j?"moveTo":"lineTo"](h=v(k)),j&&(l=h,j=!1);u=h;break;case"h":case"v":var V=Y==="h"?"x":"y";h=h.clone();for(var k=0;k<M;k++)h[V]=p(k,V),this.lineTo(h);u=h;break;case"c":for(var k=0;k<M;k+=6)this.cubicCurveTo(v(k),u=v(k+2),h=v(k+4));break;case"s":for(var k=0;k<M;k+=4)this.cubicCurveTo(/[cs]/.test(s)?h.multiply(2).subtract(u):h,u=v(k),h=v(k+2)),s=Y;break;case"q":for(var k=0;k<M;k+=4)this.quadraticCurveTo(u=v(k),h=v(k+2));break;case"t":for(var k=0;k<M;k+=2)this.quadraticCurveTo(u=/[qt]/.test(s)?h.multiply(2).subtract(u):h,h=v(k)),s=Y;break;case"a":for(var k=0;k<M;k+=7)this.arcTo(h=v(k+5),new S(+r[k],+r[k+1]),+r[k+2],+r[k+4],+r[k+3]);break;case"z":this.closePath(1e-12),h=l;break}s=Y}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!(this.getFillRule()==="evenodd"?e.windingL&1||e.windingR&1:e.winding)},getIntersections:function(t,e,r,n){var s=this===t||!t,u=this._matrix._orNullIfIdentity(),h=s?u:(r||t._matrix)._orNullIfIdentity();return s||this.getBounds(u).intersects(t.getBounds(h),1e-12)?Nt.getIntersections(this.getCurves(),!s&&t.getCurves(),e,u,h,n):[]},getCrossings:function(t){return this.getIntersections(t,function(e){return e.isCrossing()})},getNearestLocation:function(){for(var t=d.read(arguments),e=this.getCurves(),r=1/0,n=null,s=0,u=e.length;s<u;s++){var h=e[s].getNearestLocation(t);h._distance<r&&(r=h._distance,n=h)}return n},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()},interpolate:function(t,e,r){var n=!this._children,s=n?"_segments":"_children",u=t[s],h=e[s],l=this[s];if(!u||!h||u.length!==h.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var p=l.length,v=h.length;if(p<v)for(var T=n?Pt:ct,I=p;I<v;I++)this.add(new T);else p>v&&this[n?"removeSegments":"removeChildren"](v,p);for(var I=0;I<v;I++)l[I].interpolate(u[I],h[I],r);n&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var r=this._children||[this],n=t._children?t._children.slice():[t],s=r.length,u=n.length,h=[],l=0;e=!0;for(var p=N.findItemBoundsCollisions(r,n,Z.GEOMETRIC_EPSILON),v=s-1;v>=0&&e;v--){var T=r[v];e=!1;var I=p[v];if(I)for(var C=I.length-1;C>=0&&!e;C--)T.compare(n[I[C]])&&(h[I[C]]||(h[I[C]]=!0,l++),e=!0)}e=e&&l===u}return e}}),ct=at.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(e){this._closed=!1,this._segments=[],this._version=0;var r=arguments,n=Array.isArray(e)?typeof e[0]=="object"?e:r:e&&e.size===J&&(e.x!==J||e.point!==J)?r:null;n&&n.length>0?this.setSegments(n):(this._curves=J,this._segmentSelection=0,!n&&typeof e=="string"&&(this.setPathData(e),e=null)),this._initialize(!n&&e)},_equals:function(t){return this._closed===t._closed&&c.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),e&8){if(this._length=this._area=J,e&32)this._version++;else if(this._curves)for(var r=0,n=this._curves.length;r<n;r++)this._curves[r]._changed()}else e&64&&(this._bounds=J)},getStyle:function(){var t=this._parent;return(t instanceof dt?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),r=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=J,r){var n=t[r-1];typeof n=="boolean"&&(this.setClosed(n),r--),this._add(Pt.readList(t,0,{},r))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var r=this._countCurves();t=this._curves=new Array(r);for(var n=0;n<r;n++)t[n]=new Nt(this,e[n],e[n+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new Nt(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var r=this._segments,n=r.length,s=new B(e),u=new Array(6),h=!0,l,p,v,T,I,C,w,Y,M=[];function j(V,m){if(V._transformCoordinates(t,u),l=u[0],p=u[1],h)M.push("M"+s.pair(l,p)),h=!1;else if(I=u[2],C=u[3],I===l&&C===p&&w===v&&Y===T){if(!m){var F=l-v,X=p-T;M.push(F===0?"v"+s.number(X):X===0?"h"+s.number(F):"l"+s.pair(F,X))}}else M.push("c"+s.pair(w-v,Y-T)+" "+s.pair(I-v,C-T)+" "+s.pair(l-v,p-T));v=l,T=p,w=u[4],Y=u[5]}if(!n)return"";for(var k=0;k<n;k++)j(r[k]);return this._closed&&n>0&&(j(r[0],!0),M.push("z")),M.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,r=new Array(6),n=0,s=e.length;n<s;n++)e[n]._transformCoordinates(t,r,!0);return!0},_add:function(t,h){for(var r=this._segments,n=this._curves,s=t.length,u=h==null,h=u?r.length:h,l=0;l<s;l++){var p=t[l];p._path&&(p=t[l]=p.clone()),p._path=this,p._index=h+l,p._selection&&this._updateSelection(p,0,p._selection)}if(u)c.push(r,t);else{r.splice.apply(r,[h,0].concat(t));for(var l=h+s,v=r.length;l<v;l++)r[l]._index=l}if(n){var T=this._countCurves(),I=h>0&&h+s-1===T?h-1:h,C=I,w=Math.min(I+s,T);t._curves&&(n.splice.apply(n,[I,0].concat(t._curves)),C+=t._curves.length);for(var l=C;l<w;l++)n.splice(l,0,new Nt(this,null,null));this._adjustCurves(I,w)}return this._changed(41),t},_adjustCurves:function(t,e){for(var r=this._segments,n=this._curves,s,u=t;u<e;u++)s=n[u],s._path=this,s._segment1=r[u],s._segment2=r[u+1]||r[0],s._changed();(s=n[this._closed&&!t?r.length-1:t-1])&&(s._segment2=r[t]||r[0],s._changed()),(s=n[e])&&(s._segment1=r[e],s._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&typeof t!="number"?this._add(Pt.readList(e)):this._add([Pt.read(e)])[0]},insert:function(t,e){var r=arguments;return r.length>2&&typeof e!="number"?this._add(Pt.readList(r,1),t):this._add([Pt.read(r,1)],t)[0]},addSegment:function(){return this._add([Pt.read(arguments)])[0]},insertSegment:function(t){return this._add([Pt.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(Pt.readList(t))},insertSegments:function(t,e){return this._add(Pt.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,r){t=t||0,e=c.pick(e,this._segments.length);var n=this._segments,s=this._curves,u=n.length,h=n.splice(t,e-t),l=h.length;if(!l)return h;for(var p=0;p<l;p++){var v=h[p];v._selection&&this._updateSelection(v,v._selection,0),v._index=v._path=null}for(var p=t,T=n.length;p<T;p++)n[p]._index=p;if(s){for(var I=t>0&&e===u+(this._closed?1:0)?t-1:t,s=s.splice(I,l),p=s.length-1;p>=0;p--)s[p]._path=null;r&&(h._curves=s.slice(1)),this._adjustCurves(I,I)}return this._changed(41),h},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,r=t.length;e<r;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,r=t.length;e<r;e++)t[e].clearHandles()},getLength:function(){if(this._length==null){for(var t=this.getCurves(),e=0,r=0,n=t.length;r<n;r++)e+=t[r].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(t==null){var e=this._segments,r=this._closed;t=0;for(var n=0,s=e.length;n<s;n++){var u=n+1===s;t+=Nt.getArea(Nt.getValues(e[n],e[u?0:n+1],null,u&&!r))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===t*7},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){e&1||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,r=e.length,n=t?7:0;this._segmentSelection=n*r;for(var s=0;s<r;s++)e[s]._selection=n},_updateSelection:function(t,e,r){t._selection=r;var n=this._segmentSelection+=r-e;n>0&&this.setSelected(!0)},divideAt:function(t){var e=this.getLocationAt(t),r;return e&&(r=e.getCurve().divideAt(e.getCurveOffset()))?r._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),r=e&&e.index,n=e&&e.time,s=1e-8,u=1-s;n>u&&(r++,n=0);var h=this.getCurves();if(r>=0&&r<h.length){n>=s&&h[r++].divideAtTime(n);var l=this.removeSegments(r,this._segments.length,!0),p;return this._closed?(this.setClosed(!1),p=this):(p=new ct(f.NO_INSERT),p.insertAbove(this),p.copyAttributes(this)),p._add(l,0),this.addSegment(l[0]),p}return null},split:function(t,e){var r,n=e===J?t:(r=this.getCurves()[t])&&r.getLocationAtTime(e);return n!=null?this.splitAt(n):null},join:function(t,e){var r=e||0;if(t&&t!==this){var n=t._segments,s=this.getLastSegment(),u=t.getLastSegment();if(!u)return this;s&&s._point.isClose(u._point,r)&&t.reverse();var h=t.getFirstSegment();if(s&&s._point.isClose(h._point,r))s.setHandleOut(h._handleOut),this._add(n.slice(1));else{var l=this.getFirstSegment();l&&l._point.isClose(h._point,r)&&t.reverse(),u=t.getLastSegment(),l&&l._point.isClose(u._point,r)?(l.setHandleIn(u._handleIn),this._add(n.slice(0,n.length-1),0)):this._add(n.slice())}t._closed&&this._add([n[0]]),t.remove()}var p=this.getFirstSegment(),v=this.getLastSegment();return p!==v&&p._point.isClose(v._point,r)&&(p.setHandleIn(v._handleIn),v.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),r=t&&t.simplify,n=r?1e-7:0,s=e.length-1;s>=0;s--){var u=e[s];!u.hasHandles()&&(!u.hasLength(n)||r&&u.isCollinear(u.getNext()))&&u.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var r=this._segments[t],n=r._handleIn;r._handleIn=r._handleOut,r._handleOut=n,r._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new Ct(this,t||.25,256,!0),r=e.parts,n=r.length,s=[],u=0;u<n;u++)s.push(new Pt(r[u].curve.slice(0,2)));!this._closed&&n>0&&s.push(new Pt(r[n-1].curve.slice(6))),this.setSegments(s)},simplify:function(t){var e=new Ut(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,r=t||{},n=r.type||"asymmetric",s=this._segments,u=s.length,h=this._closed;function l(se,fe){var de=se&&se.index;if(de!=null){var ye=se.path;if(ye&&ye!==e)throw new Error(se._class+" "+de+" of "+ye+" is not part of "+e);fe&&se instanceof Nt&&de++}else de=typeof se=="number"?se:fe;return Math.min(de<0&&h?de%u:de<0?de+u:de,u-1)}var p=h&&r.from===J&&r.to===J,v=l(r.from,0),T=l(r.to,u-1);if(v>T)if(h)v-=u;else{var I=v;v=T,T=I}if(/^(?:asymmetric|continuous)$/.test(n)){var C=n==="asymmetric",w=Math.min,Y=T-v+1,M=Y-1,j=p?w(Y,4):1,k=j,V=j,m=[];if(h||(k=w(1,v),V=w(1,u-T-1)),M+=k+V,M<=1)return;for(var F=0,X=v-k;F<=M;F++,X++)m[F]=s[(X<0?X+u:X)%u]._point;for(var tt=m[0]._x+2*m[1]._x,U=m[0]._y+2*m[1]._y,nt=2,ut=M-1,pt=[tt],bt=[U],ot=[nt],xt=[],yt=[],F=1;F<M;F++){var At=F<ut,Rt=At||C?1:2,Mt=At?4:C?2:7,jt=At?4:C?3:8,$t=At?2:C?0:1,ie=Rt/nt;nt=ot[F]=Mt-ie,tt=pt[F]=jt*m[F]._x+$t*m[F+1]._x-ie*tt,U=bt[F]=jt*m[F]._y+$t*m[F+1]._y-ie*U}xt[ut]=pt[ut]/ot[ut],yt[ut]=bt[ut]/ot[ut];for(var F=M-2;F>=0;F--)xt[F]=(pt[F]-xt[F+1])/ot[F],yt[F]=(bt[F]-yt[F+1])/ot[F];xt[M]=(3*m[M]._x-xt[ut])/2,yt[M]=(3*m[M]._y-yt[ut])/2;for(var F=k,oe=M-V,X=v;F<=oe;F++,X++){var zt=s[X<0?X+u:X],Ht=zt._point,ne=xt[F]-Ht._x,ue=yt[F]-Ht._y;(p||F<oe)&&zt.setHandleOut(ne,ue),(p||F>k)&&zt.setHandleIn(-ne,-ue)}}else for(var F=v;F<=T;F++)s[F<0?F+u:F].smooth(r,!p&&F===v,!p&&F===T)},toShape:function(t){if(!this._closed)return null;var e=this._segments,r,n,s,u;function h(C,w){var Y=e[C],M=Y.getNext(),j=e[w],k=j.getNext();return Y._handleOut.isZero()&&M._handleIn.isZero()&&j._handleOut.isZero()&&k._handleIn.isZero()&&M._point.subtract(Y._point).isCollinear(k._point.subtract(j._point))}function l(C){var w=e[C],Y=w.getPrevious(),M=w.getNext();return Y._handleOut.isZero()&&w._handleIn.isZero()&&w._handleOut.isZero()&&M._handleIn.isZero()&&w._point.subtract(Y._point).isOrthogonal(M._point.subtract(w._point))}function p(C){var w=e[C],Y=w.getNext(),M=w._handleOut,j=Y._handleIn,k=.5522847498307936;if(M.isOrthogonal(j)){var V=w._point,m=Y._point,F=new L(V,M,!0).intersect(new L(m,j,!0),!0);return F&&Z.isZero(M.getLength()/F.subtract(V).getLength()-k)&&Z.isZero(j.getLength()/F.subtract(m).getLength()-k)}return!1}function v(C,w){return e[C]._point.getDistance(e[w]._point)}if(!this.hasHandles()&&e.length===4&&h(0,2)&&h(1,3)&&l(1)?(r=rt.Rectangle,n=new S(v(0,3),v(0,1)),u=e[1]._point.add(e[2]._point).divide(2)):e.length===8&&p(0)&&p(2)&&p(4)&&p(6)&&h(1,5)&&h(3,7)?(r=rt.Rectangle,n=new S(v(1,6),v(0,3)),s=n.subtract(new S(v(0,7),v(1,2))).divide(2),u=e[3]._point.add(e[4]._point).divide(2)):e.length===4&&p(0)&&p(1)&&p(2)&&p(3)&&(Z.isZero(v(0,2)-v(1,3))?(r=rt.Circle,s=v(0,2)/2):(r=rt.Ellipse,s=new S(v(2,0)/2,v(3,1)/2)),u=e[1]._point),r){var T=this.getPosition(!0),I=new r({center:T,size:n,radius:s,insert:!1});return I.copyAttributes(this,!0),I._matrix.prepend(this._matrix),I.rotate(u.subtract(T).getAngle()+90),(t===J||t)&&I.insertAbove(this),I}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof dt)return t.base.call(this,e);var r=this.getCurves(),n=e.getCurves(),s=r.length,u=n.length;if(!s||!u)return s==u;for(var h=r[0].getValues(),l=[],p=0,v,T=0,I,C=0;C<u;C++){var j=n[C].getValues();l.push(j);var w=Nt.getOverlaps(h,j);if(w){v=!C&&w[0][0]>0?u-1:C,I=w[0][1];break}}for(var Y=Math.abs,M=1e-8,j=l[v],k;h&&j;){var w=Nt.getOverlaps(h,j);if(w){var V=w[0][0];if(Y(V-T)<M){T=w[1][0],T===1&&(h=++p<s?r[p].getValues():null,T=0);var m=w[0][1];if(Y(m-I)<M){if(k||(k=[v,m]),I=w[1][1],I===1&&(++v>=u&&(v=0),j=l[v]||n[v].getValues(),I=0),!h)return k[0]===v&&k[1]===I;continue}}}break}return!1},_hitTestSelf:function(t,e,r,n){var s=this,u=this.getStyle(),h=this._segments,l=h.length,p=this._closed,v=e._tolerancePadding,T=v,I,C,w,Y,M,j,k=e.stroke&&u.hasStroke(),V=e.fill&&u.hasFill(),m=e.curves,F=k?u.getStrokeWidth()/2:V&&e.tolerance>0||m?0:null;F!==null&&(F>0?(I=u.getStrokeJoin(),C=u.getStrokeCap(),w=u.getMiterLimit(),T=T.add(ct._getStrokePadding(F,n))):I=C="round");function X(xt,yt){return t.subtract(xt).divide(yt).length<=1}function tt(xt,yt,At){if(!e.selected||yt.isSelected()){var Rt=xt._point;if(yt!==Rt&&(yt=yt.add(Rt)),X(yt,T))return new It(At,s,{segment:xt,point:yt})}}function U(xt,yt){return(yt||e.segments)&&tt(xt,xt._point,"segment")||!yt&&e.handles&&(tt(xt,xt._handleIn,"handle-in")||tt(xt,xt._handleOut,"handle-out"))}function nt(xt){Y.add(xt)}function ut(xt){var yt=p||xt._index>0&&xt._index<l-1;if((yt?I:C)==="round")return X(xt._point,T);if(Y=new ct({internal:!0,closed:!0}),yt?xt.isSmooth()||ct._addBevelJoin(xt,I,F,w,null,n,nt,!0):C==="square"&&ct._addSquareCap(xt,C,F,null,n,nt,!0),!Y.isEmpty()){var At;return Y.contains(t)||(At=Y.getNearestLocation(t))&&X(At.getPoint(),v)}}if(e.ends&&!e.segments&&!p){if(j=U(h[0],!0)||U(h[l-1],!0))return j}else if(e.segments||e.handles){for(var pt=0;pt<l;pt++)if(j=U(h[pt]))return j}if(F!==null){if(M=this.getNearestLocation(t),M){var bt=M.getTime();bt===0||bt===1&&l>1?ut(M.getSegment())||(M=null):X(M.getPoint(),T)||(M=null)}if(!M&&I==="miter"&&l>1)for(var pt=0;pt<l;pt++){var ot=h[pt];if(t.getDistance(ot._point)<=w*F&&ut(ot)){M=ot.getLocation();break}}}return!M&&V&&this._contains(t)||M&&!k&&!m?new It("fill",this):M?new It(k?"stroke":"curve",this,{location:M,point:M.getPoint()}):null}},c.each(Nt._evaluateMethods,function(t){this[t+"At"]=function(e){var r=this.getLocationAt(e);return r&&r[t]()}},{beans:!1,getLocationOf:function(){for(var t=d.read(arguments),e=this.getCurves(),r=0,n=e.length;r<n;r++){var s=e[r].getLocationOf(t);if(s)return s}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if(typeof t=="number"){for(var e=this.getCurves(),r=0,n=0,s=e.length;n<s;n++){var u=r,h=e[n];if(r+=h.getLength(),r>t)return h.getLocationAt(t-u)}if(e.length>0&&t<=this.getLength())return new Q(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=d.read(arguments);if(t.isZero())return[];for(var e=[],r=0,n=this.getCurves(),s=0,u=n.length;s<u;s++){for(var h=n[s],l=h.getTimesWithTangent(t),p=0,v=l.length;p<v;p++){var T=r+h.getOffsetAtTime(l[p]);e.indexOf(T)<0&&e.push(T)}r+=h.length}return e}}),new function(){function t(r,n,s,u){if(u<=0)return;var h=u/2,l=u-2,p=h-1,v=new Array(6),T,I;function C(V){var m=v[V],F=v[V+1];(T!=m||I!=F)&&(r.beginPath(),r.moveTo(T,I),r.lineTo(m,F),r.stroke(),r.beginPath(),r.arc(m,F,h,0,Math.PI*2,!0),r.fill())}for(var w=0,Y=n.length;w<Y;w++){var M=n[w],j=M._selection;if(M._transformCoordinates(s,v),T=v[0],I=v[1],j&2&&C(2),j&4&&C(4),r.fillRect(T-h,I-h,u,u),l>0&&!(j&1)){var k=r.fillStyle;r.fillStyle="#ffffff",r.fillRect(T-p,I-p,l,l),r.fillStyle=k}}}function e(r,n,s){var u=n._segments,h=u.length,l=new Array(6),p=!0,v,T,I,C,w,Y,M,j;function k(m){if(s)m._transformCoordinates(s,l),v=l[0],T=l[1];else{var F=m._point;v=F._x,T=F._y}if(p)r.moveTo(v,T),p=!1;else{if(s)w=l[2],Y=l[3];else{var X=m._handleIn;w=v+X._x,Y=T+X._y}w===v&&Y===T&&M===I&&j===C?r.lineTo(v,T):r.bezierCurveTo(M,j,w,Y,v,T)}if(I=v,C=T,s)M=l[4],j=l[5];else{var X=m._handleOut;M=I+X._x,j=C+X._y}}for(var V=0;V<h;V++)k(u[V]);n._closed&&h>0&&k(u[0])}return{_draw:function(r,n,s,u){var h=n.dontStart,l=n.dontFinish||n.clip,p=this.getStyle(),v=p.hasFill(),T=p.hasStroke(),I=p.getDashArray(),C=!_e.support.nativeDash&&T&&I&&I.length;h||r.beginPath(),(v||T&&!C||l)&&(e(r,this,u),this._closed&&r.closePath());function w(m){return I[(m%C+C)%C]}if(!l&&(v||T)&&(this._setStyles(r,n,s),v&&(r.fill(p.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),T)){if(C){h||r.beginPath();for(var Y=new Ct(this,.25,32,!1,u),M=Y.length,j=-p.getDashOffset(),k,V=0;j>0;)j-=w(V--)+w(V--);for(;j<M;)k=j+w(V++),(j>0||k>0)&&Y.drawPart(r,Math.max(j,0),Math.max(k,0)),j=k+w(V++)}r.stroke()}},_drawSelected:function(r,n){r.beginPath(),e(r,this,n),r.stroke(),t(r,this._segments,n,_e.settings.handleSize)}}},new function(){function t(e){var r=e._segments;if(!r.length)throw new Error("Use a moveTo() command first");return r[r.length-1]}return{moveTo:function(){var e=this._segments;e.length===1&&this.removeSegment(0),e.length||this._add([new Pt(d.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Pt(d.read(arguments))])},cubicCurveTo:function(){var e=arguments,r=d.read(e),n=d.read(e),s=d.read(e),u=t(this);u.setHandleOut(r.subtract(u._point)),this._add([new Pt(s,n.subtract(s))])},quadraticCurveTo:function(){var e=arguments,r=d.read(e),n=d.read(e),s=t(this)._point;this.cubicCurveTo(r.add(s.subtract(r).multiply(1/3)),r.add(n.subtract(r).multiply(1/3)),n)},curveTo:function(){var e=arguments,r=d.read(e),n=d.read(e),s=c.pick(c.read(e),.5),u=1-s,h=t(this)._point,l=r.subtract(h.multiply(u*u)).subtract(n.multiply(s*s)).divide(2*s*u);if(l.isNaN())throw new Error("Cannot put a curve through points with parameter = "+s);this.quadraticCurveTo(l,n)},arcTo:function(){var e=arguments,r=Math.abs,n=Math.sqrt,s=t(this),u=s._point,h=d.read(e),l,p=c.peek(e),v=c.pick(p,!0),T,I,C,w;if(typeof v=="boolean")var Y=u.add(h).divide(2),l=Y.add(Y.subtract(u).rotate(v?-90:90));else if(c.remain(e)<=2)l=h,h=d.read(e);else if(!u.equals(h)){var M=S.read(e),j=Z.isZero;if(j(M.width)||j(M.height))return this.lineTo(h);var k=c.read(e),v=!!c.read(e),V=!!c.read(e),Y=u.add(h).divide(2),m=u.subtract(Y).rotate(-k),F=m.x,X=m.y,tt=r(M.width),U=r(M.height),nt=tt*tt,ut=U*U,pt=F*F,bt=X*X,ot=n(pt/nt+bt/ut);if(ot>1&&(tt*=ot,U*=ot,nt=tt*tt,ut=U*U),ot=(nt*ut-nt*bt-ut*pt)/(nt*bt+ut*pt),r(ot)<1e-12&&(ot=0),ot<0)throw new Error("Cannot create an arc with the given arguments");T=new d(tt*X/U,-U*F/tt).multiply((V===v?-1:1)*n(ot)).rotate(k).add(Y),w=new g().translate(T).rotate(k).scale(tt,U),C=w._inverseTransform(u),I=C.getDirectedAngle(w._inverseTransform(h)),!v&&I>0?I-=360:v&&I<0&&(I+=360)}if(l){var xt=new L(u.add(l).divide(2),l.subtract(u).rotate(90),!0),yt=new L(l.add(h).divide(2),h.subtract(l).rotate(90),!0),At=new L(u,h),Rt=At.getSide(l);if(T=xt.intersect(yt,!0),!T){if(!Rt)return this.lineTo(h);throw new Error("Cannot create an arc with the given arguments")}C=u.subtract(T),I=C.getDirectedAngle(h.subtract(T));var Mt=At.getSide(T,!0);Mt===0?I=Rt*r(I):Rt===Mt&&(I+=I<0?360:-360)}if(I){for(var jt=1e-5,$t=r(I),ie=$t>=360?4:Math.ceil(($t-jt)/90),oe=I/ie,zt=oe*Math.PI/360,Ht=4/3*Math.sin(zt)/(1+Math.cos(zt)),ne=[],ue=0;ue<=ie;ue++){var m=h,se=null;if(ue<ie&&(se=C.rotate(90).multiply(Ht),w?(m=w._transformPoint(C),se=w._transformPoint(C.add(se)).subtract(m)):m=T.add(C)),!ue)s.setHandleOut(se);else{var fe=C.rotate(-90).multiply(Ht);w&&(fe=w._transformPoint(C.add(fe)).subtract(m)),ne.push(new Pt(m,fe,se))}C=C.rotate(oe)}this._add(ne)}},lineBy:function(){var e=d.read(arguments),r=t(this)._point;this.lineTo(r.add(e))},curveBy:function(){var e=arguments,r=d.read(e),n=d.read(e),s=c.read(e),u=t(this)._point;this.curveTo(u.add(r),u.add(n),s)},cubicCurveBy:function(){var e=arguments,r=d.read(e),n=d.read(e),s=d.read(e),u=t(this)._point;this.cubicCurveTo(u.add(r),u.add(n),u.add(s))},quadraticCurveBy:function(){var e=arguments,r=d.read(e),n=d.read(e),s=t(this)._point;this.quadraticCurveTo(s.add(r),s.add(n))},arcBy:function(){var e=arguments,r=t(this)._point,n=r.add(d.read(e)),s=c.pick(c.peek(e),!0);typeof s=="boolean"?this.arcTo(n,s):this.arcTo(n,r.add(d.read(e)))},closePath:function(e){this.setClosed(!0),this.join(this,e)}}},{_getBounds:function(t,e){var r=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return ct[r](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,r,n,s,u){var h=t[0];if(!h)return new H;var l=new Array(6),p=h._transformCoordinates(n,new Array(6)),v=p.slice(0,2),T=v.slice(),I=new Array(2);function C(M){M._transformCoordinates(n,l);for(var j=0;j<2;j++)Nt._addBounds(p[j],p[j+4],l[j+2],l[j],j,u?u[j]:0,v,T,I);var k=p;p=l,l=k}for(var w=1,Y=t.length;w<Y;w++)C(t[w]);return e&&C(h),new H(v[0],v[1],T[0]-v[0],T[1]-v[1])},getStrokeBounds:function(t,e,r,n,s){var u=r.getStyle(),h=u.hasStroke(),l=u.getStrokeWidth(),p=h&&r._getStrokeMatrix(n,s),v=h&&ct._getStrokePadding(l,p),T=ct.getBounds(t,e,r,n,s,v);if(!h)return T;var I=l/2,C=u.getStrokeJoin(),w=u.getStrokeCap(),Y=u.getMiterLimit(),M=new H(new S(v));function j(tt){T=T.include(tt)}function k(tt){T=T.unite(M.setCenter(tt._point.transform(n)))}function V(tt,U){U==="round"||tt.isSmooth()?k(tt):ct._addBevelJoin(tt,U,I,Y,n,p,j)}function m(tt,U){U==="round"?k(tt):ct._addSquareCap(tt,U,I,n,p,j)}var F=t.length-(e?0:1);if(F>0){for(var X=1;X<F;X++)V(t[X],C);e?V(t[0],C):(m(t[0],w),m(t[t.length-1],w))}return T},_getStrokePadding:function(t,e){if(!e)return[t,t];var r=new d(t,0).transform(e),n=new d(0,t).transform(e),s=r.getAngleInRadians(),u=r.getLength(),h=n.getLength(),l=Math.sin(s),p=Math.cos(s),v=Math.tan(s),T=Math.atan2(h*v,u),I=Math.atan2(h,v*u);return[Math.abs(u*Math.cos(T)*p+h*Math.sin(T)*l),Math.abs(h*Math.sin(I)*p+u*Math.cos(I)*l)]},_addBevelJoin:function(t,e,r,n,s,u,h,l){var p=t.getCurve(),v=p.getPrevious(),T=p.getPoint1().transform(s),I=v.getNormalAtTime(1).multiply(r).transform(u),C=p.getNormalAtTime(0).multiply(r).transform(u),w=I.getDirectedAngle(C);if((w<0||w>=180)&&(I=I.negate(),C=C.negate()),l&&h(T),h(T.add(I)),e==="miter"){var Y=new L(T.add(I),new d(-I.y,I.x),!0).intersect(new L(T.add(C),new d(-C.y,C.x),!0),!0);Y&&T.getDistance(Y)<=n*r&&h(Y)}h(T.add(C))},_addSquareCap:function(t,e,r,n,s,u,h){var l=t._point.transform(n),p=t.getLocation(),v=p.getNormal().multiply(p.getTime()===0?r:-r).transform(s);e==="square"&&(h&&(u(l.subtract(v)),u(l.add(v))),l=l.add(v.rotate(-90))),u(l.add(v)),u(l.subtract(v))},getHandleBounds:function(t,e,r,n,s){var u=r.getStyle(),h=s.stroke&&u.hasStroke(),l,p;if(h){var v=r._getStrokeMatrix(n,s),T=u.getStrokeWidth()/2,I=T;u.getStrokeJoin()==="miter"&&(I=T*u.getMiterLimit()),u.getStrokeCap()==="square"&&(I=Math.max(I,T*Math.SQRT2)),l=ct._getStrokePadding(T,v),p=ct._getStrokePadding(I,v)}for(var C=new Array(6),w=1/0,Y=-w,M=w,j=Y,k=0,V=t.length;k<V;k++){var m=t[k];m._transformCoordinates(n,C);for(var F=0;F<6;F+=2){var X=F?l:p,tt=X?X[0]:0,U=X?X[1]:0,nt=C[F],ut=C[F+1],pt=nt-tt,bt=nt+tt,ot=ut-U,xt=ut+U;pt<w&&(w=pt),bt>Y&&(Y=bt),ot<M&&(M=ot),xt>j&&(j=xt)}}return new H(w,M,Y-w,j-M)}}});ct.inject({statics:new function(){var t=.5522847498307936,e=[new Pt([-1,0],[0,t],[0,-t]),new Pt([0,-1],[-t,0],[t,0]),new Pt([1,0],[0,-t],[0,t]),new Pt([0,1],[t,0],[-t,0])];function r(s,u,h){var l=c.getNamed(h),p=new ct(l&&(l.insert==!0?f.INSERT:l.insert==!1?f.NO_INSERT:null));return p._add(s),p._closed=u,p.set(l,f.INSERT)}function n(s,u,h){for(var l=new Array(4),p=0;p<4;p++){var v=e[p];l[p]=new Pt(v._point.multiply(u).add(s),v._handleIn.multiply(u),v._handleOut.multiply(u))}return r(l,!0,h)}return{Line:function(){var s=arguments;return r([new Pt(d.readNamed(s,"from")),new Pt(d.readNamed(s,"to"))],!1,s)},Circle:function(){var s=arguments,u=d.readNamed(s,"center"),h=c.readNamed(s,"radius");return n(u,new S(h),s)},Rectangle:function(){var s=arguments,u=H.readNamed(s,"rectangle"),h=S.readNamed(s,"radius",0,{readNull:!0}),l=u.getBottomLeft(!0),p=u.getTopLeft(!0),v=u.getTopRight(!0),T=u.getBottomRight(!0),I;if(!h||h.isZero())I=[new Pt(l),new Pt(p),new Pt(v),new Pt(T)];else{h=S.min(h,u.getSize(!0).divide(2));var C=h.width,w=h.height,Y=C*t,M=w*t;I=[new Pt(l.add(C,0),null,[-Y,0]),new Pt(l.subtract(0,w),[0,M]),new Pt(p.add(0,w),null,[0,-M]),new Pt(p.add(C,0),[-Y,0],null),new Pt(v.subtract(C,0),null,[Y,0]),new Pt(v.add(0,w),[0,-M],null),new Pt(T.subtract(0,w),null,[0,M]),new Pt(T.subtract(C,0),[Y,0])]}return r(I,!0,s)},RoundRectangle:"#Rectangle",Ellipse:function(){var s=arguments,u=rt._readEllipse(s);return n(u.center,u.radius,s)},Oval:"#Ellipse",Arc:function(){var s=arguments,u=d.readNamed(s,"from"),h=d.readNamed(s,"through"),l=d.readNamed(s,"to"),p=c.getNamed(s),v=new ct(p&&p.insert==!1&&f.NO_INSERT);return v.moveTo(u),v.arcTo(h,l),v.set(p)},RegularPolygon:function(){for(var s=arguments,u=d.readNamed(s,"center"),h=c.readNamed(s,"sides"),l=c.readNamed(s,"radius"),p=360/h,v=h%3===0,T=new d(0,v?-l:l),I=v?-1:.5,C=new Array(h),w=0;w<h;w++)C[w]=new Pt(u.add(T.rotate((w+I)*p)));return r(C,!0,s)},Star:function(){for(var s=arguments,u=d.readNamed(s,"center"),h=c.readNamed(s,"points")*2,l=c.readNamed(s,"radius1"),p=c.readNamed(s,"radius2"),v=360/h,T=new d(0,-1),I=new Array(h),C=0;C<h;C++)I[C]=new Pt(u.add(T.rotate(v*C).multiply(C%2?p:l)));return r(I,!0,s)}}}});var dt=at.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||(typeof e=="string"?this.setPathData(e):this.addChildren(Array.isArray(e)?e:arguments))},insertChildren:function t(e,r){var n=r,s=n[0];s&&typeof s[0]=="number"&&(n=[n]);for(var u=r.length-1;u>=0;u--){var h=n[u];n===r&&!(h instanceof ct)&&(n=c.slice(n)),Array.isArray(h)?n[u]=new ct({segments:h,insert:!1}):h instanceof dt&&(n.splice.apply(n,[u,1].concat(h.removeChildren())),h.remove())}return t.base.call(this,e,n)},reduce:function t(e){for(var r=this._children,n=r.length-1;n>=0;n--){var s=r[n].reduce(e);s.isEmpty()&&s.remove()}if(!r.length){var s=new ct(f.NO_INSERT);return s.copyAttributes(this),s.insertAbove(this),this.remove(),s}return t.base.call(this)},isClosed:function(){for(var t=this._children,e=0,r=t.length;e<r;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,r=0,n=e.length;r<n;r++)e[r].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],r=0,n=t.length;r<n;r++)c.push(e,t[r].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,r=0,n=t.length;r<n;r++)e+=t[r].getArea();return e},getLength:function(){for(var t=this._children,e=0,r=0,n=t.length;r<n;r++)e+=t[r].getLength();return e},getPathData:function(t,e){for(var r=this._children,n=[],s=0,u=r.length;s<u;s++){var h=r[s],l=h._matrix;n.push(h.getPathData(t&&!l.isIdentity()?t.appended(l):t,e))}return n.join("")},_hitTestChildren:function t(e,r,n){return t.base.call(this,e,r.class===ct||r.type==="path"?r:c.set({},r,{fill:!1}),n)},_draw:function(t,e,r,n){var s=this._children;if(s.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var u=0,h=s.length;u<h;u++)s[u].draw(t,e,n);if(!e.clip){this._setStyles(t,e,r);var l=this._style;l.hasFill()&&(t.fill(l.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),l.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,r){for(var n=this._children,s=0,u=n.length;s<u;s++){var h=n[s],l=h._matrix;r[h._id]||h._drawSelected(t,l.isIdentity()?e:e.appended(l))}}},new function(){function t(e,r){var n=e._children;if(r&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return c.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(e){this[e]=function(){var r=t(this,!0);r[e].apply(r,arguments)}},{moveTo:function(){var e=t(this),r=e&&e.isEmpty()?e:new ct(f.NO_INSERT);r!==e&&this.addChild(r),r.moveTo.apply(r,arguments)},moveBy:function(){var e=t(this,!0),r=e&&e.getLastSegment(),n=d.read(arguments);this.moveTo(r?n.add(r._point):n)},closePath:function(e){t(this,!0).closePath(e)}})},c.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(e){for(var r=this._children,n,s=0,u=r.length;s<u;s++)n=r[s][t](e)||n;return n}},{}));at.inject(new function(){var t=Math.min,e=Math.max,r=Math.abs,n={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function s(k){return k._children||[k]}function u(k,V){var m=k.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(V){for(var F=s(m),X=0,tt=F.length;X<tt;X++){var k=F[X];!k._closed&&!k.isEmpty()&&(k.closePath(1e-12),k.getFirstSegment().setHandleIn(0,0),k.getLastSegment().setHandleOut(0,0))}m=m.resolveCrossings().reorient(m.getFillRule()==="nonzero",!0)}return m}function h(k,V,m,F,X){var tt=new dt(f.NO_INSERT);return tt.addChildren(k,!0),tt=tt.reduce({simplify:V}),X&&X.insert==!1||tt.insertAbove(F&&m.isSibling(F)&&m.getIndex()<F.getIndex()?F:m),tt.copyAttributes(m,!0),tt}function l(k){return k.hasOverlap()||k.isCrossing()}function p(k,V,m,F){if(F&&(F.trace==!1||F.stroke)&&/^(subtract|intersect)$/.test(m))return v(k,V,m);var X=u(k,!0),tt=V&&k!==V&&u(V,!0),U=n[m];U[m]=!0,tt&&(U.subtract||U.exclude)^(tt.isClockwise()^X.isClockwise())&&tt.reverse();var nt=w(Q.expand(X.getIntersections(tt,l))),ut=s(X),pt=tt&&s(tt),bt=[],ot=[],xt;function yt(se){for(var fe=0,de=se.length;fe<de;fe++){var ye=se[fe];c.push(bt,ye._segments),c.push(ot,ye.getCurves()),ye._overlapsOnly=!0}}function At(se){for(var fe=[],de=0,ye=se&&se.length;de<ye;de++)fe.push(ot[se[de]]);return fe}if(nt.length){yt(ut),pt&&yt(pt);for(var Rt=new Array(ot.length),Mt=0,jt=ot.length;Mt<jt;Mt++)Rt[Mt]=ot[Mt].getValues();for(var $t=N.findCurveBoundsCollisions(Rt,Rt,0,!0),ie={},Mt=0;Mt<ot.length;Mt++){var oe=ot[Mt],zt=oe._path._id,Ht=ie[zt]=ie[zt]||{};Ht[oe.getIndex()]={hor:At($t[Mt].hor),ver:At($t[Mt].ver)}}for(var Mt=0,jt=nt.length;Mt<jt;Mt++)M(nt[Mt]._segment,X,tt,ie,U);for(var Mt=0,jt=bt.length;Mt<jt;Mt++){var ne=bt[Mt],ue=ne._intersection;ne._winding||M(ne,X,tt,ie,U),ue&&ue._overlap||(ne._path._overlapsOnly=!1)}xt=j(bt,U)}else xt=C(pt?ut.concat(pt):ut.slice(),function(se){return!!U[se]});return h(xt,!0,k,V,F)}function v(k,V,m){var F=u(k),X=u(V),tt=F.getIntersections(X,l),U=m==="subtract",nt=m==="divide",ut={},pt=[];function bt(yt){if(!ut[yt._id]&&(nt||X.contains(yt.getPointAt(yt.getLength()/2))^U))return pt.unshift(yt),ut[yt._id]=!0}for(var ot=tt.length-1;ot>=0;ot--){var xt=tt[ot].split();xt&&(bt(xt)&&xt.getFirstSegment().setHandleIn(0,0),F.getLastSegment().setHandleOut(0,0))}return bt(F),h(pt,!1,k,V)}function T(k,V){for(var m=k;m;){if(m===V)return;m=m._previous}for(;k._next&&k._next!==V;)k=k._next;if(!k._next){for(;V._previous;)V=V._previous;k._next=V,V._previous=k}}function I(k){for(var V=k.length-1;V>=0;V--)k[V].clearHandles()}function C(k,V,m){var F=k&&k.length;if(F){var X=c.each(k,function($t,ie){this[$t._id]={container:null,winding:$t.isClockwise()?1:-1,index:ie}},{}),tt=k.slice().sort(function($t,ie){return r(ie.getArea())-r($t.getArea())}),U=tt[0],nt=N.findItemBoundsCollisions(tt,null,Z.GEOMETRIC_EPSILON);m==null&&(m=U.isClockwise());for(var ut=0;ut<F;ut++){var pt=tt[ut],bt=X[pt._id],ot=0,xt=nt[ut];if(xt){for(var yt=null,At=xt.length-1;At>=0;At--)if(xt[At]<ut){yt=yt||pt.getInteriorPoint();var Rt=tt[xt[At]];if(Rt.contains(yt)){var Mt=X[Rt._id];ot=Mt.winding,bt.winding+=ot,bt.container=Mt.exclude?Mt.container:Rt;break}}}if(V(bt.winding)===V(ot))bt.exclude=!0,k[bt.index]=null;else{var jt=bt.container;pt.setClockwise(jt?!jt.isClockwise():m)}}}return k}function w(k,V,m){var F=V&&[],X=1e-8,tt=1-X,U=!1,nt=m||[],ut=m&&{},pt,bt,ot;function xt(fe){return fe._path._id+"."+fe._segment1._index}for(var yt=(m&&m.length)-1;yt>=0;yt--){var At=m[yt];At._path&&(ut[xt(At)]=!0)}for(var yt=k.length-1;yt>=0;yt--){var Rt=k[yt],Mt=Rt._time,jt=Mt,$t=V&&!V(Rt),At=Rt._curve,ie;if(At&&(At!==bt?(U=!At.hasHandles()||ut&&ut[xt(At)],pt=[],ot=null,bt=At):ot>=X&&(Mt/=ot)),$t){pt&&pt.push(Rt);continue}else V&&F.unshift(Rt);if(ot=jt,Mt<X)ie=At._segment1;else if(Mt>tt)ie=At._segment2;else{var oe=At.divideAtTime(Mt,!0);U&&nt.push(At,oe),ie=oe._segment1;for(var zt=pt.length-1;zt>=0;zt--){var Ht=pt[zt];Ht._time=(Ht._time-Mt)/(1-Mt)}}Rt._setSegment(ie);var ne=ie._intersection,ue=Rt._intersection;if(ne){T(ne,ue);for(var se=ne;se;)T(se._intersection,ne),se=se._next}else ie._intersection=ue}return m||I(nt),F||k}function Y(k,V,m,F,X){var tt=Array.isArray(V)?V:V[m?"hor":"ver"],U=m?1:0,nt=U^1,ut=[k.x,k.y],pt=ut[U],bt=ut[nt],ot=1e-9,xt=1e-6,yt=pt-ot,At=pt+ot,Rt=0,Mt=0,jt=0,$t=0,ie=!1,oe=!1,zt=1,Ht=[],ne,ue;function se(Zt){var ze=Zt[nt+0],Ke=Zt[nt+6];if(!(bt<t(ze,Ke)||bt>e(ze,Ke))){var Je=Zt[U+0],ci=Zt[U+2],Ei=Zt[U+4],bi=Zt[U+6];if(ze===Ke){(Je<At&&bi>yt||bi<At&&Je>yt)&&(ie=!0);return}var vi=bt===ze?0:bt===Ke||yt>e(Je,ci,Ei,bi)||At<t(Je,ci,Ei,bi)?1:Nt.solveCubic(Zt,nt,bt,Ht,0,1)>0?Ht[0]:1,ai=vi===0?Je:vi===1?bi:Nt.getPoint(Zt,vi)[m?"y":"x"],fi=ze>Ke?1:-1,Ci=ne[nt]>ne[nt+6]?1:-1,Me=ne[U+6];return bt!==ze?(ai<yt?jt+=fi:ai>At?$t+=fi:ie=!0,ai>pt-xt&&ai<pt+xt&&(zt/=2)):(fi!==Ci?Je<yt?jt+=fi:Je>At&&($t+=fi):Je!=Me&&(Me<At&&ai>At?($t+=fi,ie=!0):Me>yt&&ai<yt&&(jt+=fi,ie=!0)),zt/=4),ne=Zt,!X&&ai>yt&&ai<At&&Nt.getTangent(Zt,vi)[m?"x":"y"]===0&&Y(k,V,!m,F,!0)}}function fe(Zt){var ze=Zt[nt+0],Ke=Zt[nt+2],Je=Zt[nt+4],ci=Zt[nt+6];if(bt<=e(ze,Ke,Je,ci)&&bt>=t(ze,Ke,Je,ci)){for(var Ei=Zt[U+0],bi=Zt[U+2],vi=Zt[U+4],ai=Zt[U+6],fi=yt>e(Ei,bi,vi,ai)||At<t(Ei,bi,vi,ai)?[Zt]:Nt.getMonoCurves(Zt,m),Ci,Me=0,oi=fi.length;Me<oi;Me++)if(Ci=se(fi[Me]))return Ci}}for(var de=0,ye=tt.length;de<ye;de++){var Ce=tt[de],ve=Ce._path,Xe=Ce.getValues(),Be;if((!de||tt[de-1]._path!==ve)&&(ne=null,ve._closed||(ue=Nt.getValues(ve.getLastCurve().getSegment2(),Ce.getSegment1(),null,!F),ue[nt]!==ue[nt+6]&&(ne=ue)),!ne)){ne=Xe;for(var $e=ve.getLastCurve();$e&&$e!==Ce;){var We=$e.getValues();if(We[nt]!==We[nt+6]){ne=We;break}$e=$e.getPrevious()}}if(Be=fe(Xe))return Be;if(de+1===ye||tt[de+1]._path!==ve){if(ue&&(Be=fe(ue)))return Be;ie&&!jt&&!$t&&(jt=$t=ve.isClockwise(F)^m?1:-1),Rt+=jt,Mt+=$t,jt=$t=0,ie&&(oe=!0,ie=!1),ue=null}}return Rt=r(Rt),Mt=r(Mt),{winding:e(Rt,Mt),windingL:Rt,windingR:Mt,quality:zt,onPath:oe}}function M(k,V,m,F,X){var tt=[],U=k,nt=0,ot;do{var ut=k.getCurve();if(ut){var pt=ut.getLength();tt.push({segment:k,curve:ut,length:pt}),nt+=pt}k=k.getNext()}while(k&&!k._intersection&&k!==U);for(var bt=[.5,.25,.75],ot={winding:0,quality:-1},xt=.001,yt=1-xt,At=0;At<bt.length&&ot.quality<.5;At++)for(var pt=nt*bt[At],Rt=0,Mt=tt.length;Rt<Mt;Rt++){var jt=tt[Rt],$t=jt.length;if(pt<=$t){var ut=jt.curve,ie=ut._path,oe=ie._parent,zt=oe instanceof dt?oe:ie,Ht=Z.clamp(ut.getTimeAt(pt),xt,yt),ne=ut.getPointAtTime(Ht),ue=r(ut.getTangentAtTime(Ht).y)<Math.SQRT1_2,se=null;if(X.subtract&&m){var fe=zt===V?m:V,de=fe._getWinding(ne,ue,!0);if(zt===V&&de.winding||zt===m&&!de.winding){if(de.quality<1)continue;se={winding:0,quality:1}}}se=se||Y(ne,F[ie._id][ut.getIndex()],ue,!0),se.quality>ot.quality&&(ot=se);break}pt-=$t}for(var Rt=tt.length-1;Rt>=0;Rt--)tt[Rt].segment._winding=ot}function j(k,V){var m=[],F;function X(ye){var Ce;return!!(ye&&!ye._visited&&(!V||V[(Ce=ye._winding||{}).winding]&&!(V.unite&&Ce.winding===2&&Ce.windingL&&Ce.windingR)))}function tt(ye){if(ye){for(var Ce=0,ve=F.length;Ce<ve;Ce++)if(ye===F[Ce])return!0}return!1}function U(ye){for(var Ce=ye._segments,ve=0,Xe=Ce.length;ve<Xe;ve++)Ce[ve]._visited=!0}function nt(ye,Ce){var ve=ye._intersection,Xe=ve,Be=[];Ce&&(F=[ye]);function $e(We,Zt){for(;We&&We!==Zt;){var ze=We._segment,Ke=ze&&ze._path;if(Ke){var Je=ze.getNext()||Ke.getFirstSegment(),ci=Je._intersection;ze!==ye&&(tt(ze)||tt(Je)||Je&&X(ze)&&(X(Je)||ci&&X(ci._segment)))&&Be.push(ze),Ce&&F.push(ze)}We=We._next}}if(ve){for($e(ve);ve&&ve._previous;)ve=ve._previous;$e(ve,Xe)}return Be}k.sort(function(ye,Ce){var ve=ye._intersection,Xe=Ce._intersection,Be=!!(ve&&ve._overlap),$e=!!(Xe&&Xe._overlap),We=ye._path,Zt=Ce._path;return Be^$e?Be?1:-1:!ve^!Xe?ve?1:-1:We!==Zt?We._id-Zt._id:ye._index-Ce._index});for(var ut=0,pt=k.length;ut<pt;ut++){var bt=k[ut],ot=X(bt),xt=null,yt=!1,At=!0,Rt=[],Mt,jt,$t;if(ot&&bt._path._overlapsOnly){var ie=bt._path,oe=bt._intersection._segment._path;ie.compare(oe)&&(ie.getArea()&&m.push(ie.clone(!1)),U(ie),U(oe),ot=!1)}for(;ot;){var zt=!xt,Ht=nt(bt,zt),ne=Ht.shift(),yt=!zt&&(tt(bt)||tt(ne)),ue=!yt&&ne;if(zt&&(xt=new ct(f.NO_INSERT),Mt=null),yt){(bt.isFirst()||bt.isLast())&&(At=bt._path._closed),bt._visited=!0;break}if(ue&&Mt&&(Rt.push(Mt),Mt=null),Mt||(ue&&Ht.push(bt),Mt={start:xt._segments.length,crossings:Ht,visited:jt=[],handleIn:$t}),ue&&(bt=ne),!X(bt)){xt.removeSegments(Mt.start);for(var se=0,fe=jt.length;se<fe;se++)jt[se]._visited=!1;jt.length=0;do bt=Mt&&Mt.crossings.shift(),(!bt||!bt._path)&&(bt=null,Mt=Rt.pop(),Mt&&(jt=Mt.visited,$t=Mt.handleIn));while(Mt&&!X(bt));if(!bt)break}var de=bt.getNext();xt.add(new Pt(bt._point,$t,de&&bt._handleOut)),bt._visited=!0,jt.push(bt),bt=de||bt._path.getFirstSegment(),$t=de&&de._handleIn}yt&&(At&&(xt.getFirstSegment().setHandleIn($t),xt.setClosed(At)),xt.getArea()!==0&&m.push(xt))}return m}return{_getWinding:function(k,V,m){return Y(k,this.getCurves(),V,m)},unite:function(k,V){return p(this,k,"unite",V)},intersect:function(k,V){return p(this,k,"intersect",V)},subtract:function(k,V){return p(this,k,"subtract",V)},exclude:function(k,V){return p(this,k,"exclude",V)},divide:function(k,V){return V&&(V.trace==!1||V.stroke)?v(this,k,"divide"):h([this.subtract(k,V),this.intersect(k,V)],!0,this,k,V)},resolveCrossings:function(){var k=this._children,V=k||[this];function m(Mt,jt){var $t=Mt&&Mt._intersection;return $t&&$t._overlap&&$t._path===jt}var F=!1,X=!1,tt=this.getIntersections(null,function(Mt){return Mt.hasOverlap()&&(F=!0)||Mt.isCrossing()&&(X=!0)}),U=F&&X&&[];if(tt=Q.expand(tt),F)for(var nt=w(tt,function(Mt){return Mt.hasOverlap()},U),ut=nt.length-1;ut>=0;ut--){var pt=nt[ut],bt=pt._path,ot=pt._segment,xt=ot.getPrevious(),yt=ot.getNext();m(xt,bt)&&m(yt,bt)&&(ot.remove(),xt._handleOut._set(0,0),yt._handleIn._set(0,0),xt!==ot&&!xt.getCurve().hasLength()&&(yt._handleIn.set(xt._handleIn),xt.remove()))}X&&(w(tt,F&&function(Mt){var jt=Mt.getCurve(),$t=Mt.getSegment(),ie=Mt._intersection,oe=ie._curve,zt=ie._segment;if(jt&&oe&&jt._path&&oe._path)return!0;$t&&($t._intersection=null),zt&&(zt._intersection=null)},U),U&&I(U),V=j(c.each(V,function(Mt){c.push(this,Mt._segments)},[])));var At=V.length,Rt;return At>1&&k?(V!==k&&this.setChildren(V),Rt=this):At===1&&!k&&(V[0]!==this&&this.setSegments(V[0].removeSegments()),Rt=this),Rt||(Rt=new dt(f.NO_INSERT),Rt.addChildren(V),Rt=Rt.reduce(),Rt.copyAttributes(this),this.replaceWith(Rt)),Rt},reorient:function(k,V){var m=this._children;return m&&m.length?this.setChildren(C(this.removeChildren(),function(F){return!!(k?F:F&1)},V)):V!==J&&this.setClockwise(V),this},getInteriorPoint:function(){var k=this.getBounds(),V=k.getCenter(!0);if(!this.contains(V)){for(var m=this.getCurves(),F=V.y,X=[],tt=[],U=0,nt=m.length;U<nt;U++){var ut=m[U].getValues(),pt=ut[1],bt=ut[3],ot=ut[5],xt=ut[7];if(F>=t(pt,bt,ot,xt)&&F<=e(pt,bt,ot,xt))for(var yt=Nt.getMonoCurves(ut),At=0,Rt=yt.length;At<Rt;At++){var Mt=yt[At],jt=Mt[1],$t=Mt[7];if(jt!==$t&&(F>=jt&&F<=$t||F>=$t&&F<=jt)){var ie=F===jt?Mt[0]:F===$t?Mt[6]:Nt.solveCubic(Mt,1,F,tt,0,1)===1?Nt.getPoint(Mt,tt[0]).x:(Mt[0]+Mt[6])/2;X.push(ie)}}}X.length>1&&(X.sort(function(oe,zt){return oe-zt}),V.x=(X[0]+X[1])/2)}return V}}});var Ct=c.extend({_class:"PathFlattener",initialize:function(t,e,r,n,s){var u=[],h=[],l=0,p=1/(r||32),v=t._segments,T=v[0],I;function C(j,k){var V=Nt.getValues(j,k,s);u.push(V),w(V,j._index,0,1)}function w(j,k,V,m){if(m-V>p&&!(n&&Nt.isStraight(j))&&!Nt.isFlatEnough(j,e||.25)){var F=Nt.subdivide(j,.5),X=(V+m)/2;w(F[0],k,V,X),w(F[1],k,X,m)}else{var tt=j[6]-j[0],U=j[7]-j[1],nt=Math.sqrt(tt*tt+U*U);nt>0&&(l+=nt,h.push({offset:l,curve:j,index:k,time:m}))}}for(var Y=1,M=v.length;Y<M;Y++)I=v[Y],C(T,I),T=I;t._closed&&C(I||T,v[0]),this.curves=u,this.parts=h,this.length=l,this.index=0},_get:function(t){for(var e=this.parts,r=e.length,n,s=this.index;n=s,!(!s||e[--s].offset<t););for(;n<r;n++){var u=e[n];if(u.offset>=t){this.index=n;var h=e[n-1],l=h&&h.index===u.index?h.time:0,p=h?h.offset:0;return{index:u.index,time:l+(u.time-l)*(t-p)/(u.offset-p)}}}return{index:e[r-1].index,time:1}},drawPart:function(t,e,r){for(var n=this._get(e),s=this._get(r),u=n.index,h=s.index;u<=h;u++){var l=Nt.getPart(this.curves[u],u===n.index?n.time:0,u===s.index?s.time:1);u===n.index&&t.moveTo(l[0],l[1]),t.bezierCurveTo.apply(t,l.slice(2))}}},c.each(Nt._evaluateMethods,function(t){this[t+"At"]=function(e){var r=this._get(e);return Nt[t](this.curves[r.index],r.time)}},{})),Ut=c.extend({initialize:function(t){for(var e=this.points=[],r=t._segments,n=t._closed,s=0,u,h=r.length;s<h;s++){var l=r[s].point;(!u||!u.equals(l))&&e.push(u=l.clone())}n&&(e.unshift(e[e.length-1]),e.push(e[1])),this.closed=n},fit:function(t){var e=this.points,r=e.length,n=null;return r>0&&(n=[new Pt(e[0])],r>1&&(this.fitCubic(n,t,0,r-1,e[1].subtract(e[0]),e[r-2].subtract(e[r-1])),this.closed&&(n.shift(),n.pop()))),n},fitCubic:function(t,e,r,n,s,u){var h=this.points;if(n-r===1){var l=h[r],p=h[n],v=l.getDistance(p)/3;this.addCurve(t,[l,l.add(s.normalize(v)),p.add(u.normalize(v)),p]);return}for(var T=this.chordLengthParameterize(r,n),I=Math.max(e,e*e),C,w=!0,Y=0;Y<=4;Y++){var M=this.generateBezier(r,n,T,s,u),j=this.findMaxError(r,n,M,T);if(j.error<e&&w){this.addCurve(t,M);return}if(C=j.index,j.error>=I)break;w=this.reparameterize(r,n,T,M),I=j.error}var k=h[C-1].subtract(h[C+1]);this.fitCubic(t,e,r,C,s,k),this.fitCubic(t,e,C,n,k.negate(),u)},addCurve:function(t,e){var r=t[t.length-1];r.setHandleOut(e[1].subtract(e[0])),t.push(new Pt(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,r,n,s){for(var u=1e-12,h=Math.abs,l=this.points,p=l[t],v=l[e],T=[[0,0],[0,0]],I=[0,0],C=0,w=e-t+1;C<w;C++){var Y=r[C],M=1-Y,j=3*Y*M,k=M*M*M,V=j*M,m=j*Y,F=Y*Y*Y,X=n.normalize(V),tt=s.normalize(m),U=l[t+C].subtract(p.multiply(k+V)).subtract(v.multiply(m+F));T[0][0]+=X.dot(X),T[0][1]+=X.dot(tt),T[1][0]=T[0][1],T[1][1]+=tt.dot(tt),I[0]+=X.dot(U),I[1]+=tt.dot(U)}var nt=T[0][0]*T[1][1]-T[1][0]*T[0][1],ut,pt;if(h(nt)>u){var bt=T[0][0]*I[1]-T[1][0]*I[0],ot=I[0]*T[1][1]-I[1]*T[0][1];ut=ot/nt,pt=bt/nt}else{var xt=T[0][0]+T[0][1],yt=T[1][0]+T[1][1];ut=pt=h(xt)>u?I[0]/xt:h(yt)>u?I[1]/yt:0}var At=v.getDistance(p),Rt=u*At,Mt,jt;if(ut<Rt||pt<Rt)ut=pt=At/3;else{var $t=v.subtract(p);Mt=n.normalize(ut),jt=s.normalize(pt),Mt.dot($t)-jt.dot($t)>At*At&&(ut=pt=At/3,Mt=jt=null)}return[p,p.add(Mt||n.normalize(ut)),v.add(jt||s.normalize(pt)),v]},reparameterize:function(t,e,r,n){for(var s=t;s<=e;s++)r[s-t]=this.findRoot(n,this.points[s],r[s-t]);for(var s=1,u=r.length;s<u;s++)if(r[s]<=r[s-1])return!1;return!0},findRoot:function(t,e,r){for(var n=[],s=[],u=0;u<=2;u++)n[u]=t[u+1].subtract(t[u]).multiply(3);for(var u=0;u<=1;u++)s[u]=n[u+1].subtract(n[u]).multiply(2);var h=this.evaluate(3,t,r),l=this.evaluate(2,n,r),p=this.evaluate(1,s,r),v=h.subtract(e),T=l.dot(l)+v.dot(p);return Z.isMachineZero(T)?r:r-v.dot(l)/T},evaluate:function(t,e,r){for(var n=e.slice(),s=1;s<=t;s++)for(var u=0;u<=t-s;u++)n[u]=n[u].multiply(1-r).add(n[u+1].multiply(r));return n[0]},chordLengthParameterize:function(t,e){for(var r=[0],n=t+1;n<=e;n++)r[n-t]=r[n-t-1]+this.points[n].getDistance(this.points[n-1]);for(var n=1,s=e-t;n<=s;n++)r[n]/=r[s];return r},findMaxError:function(t,e,r,n){for(var s=Math.floor((e-t+1)/2),u=0,h=t+1;h<e;h++){var l=this.evaluate(3,r,n[h-t]),p=l.subtract(this.points[h]),v=p.x*p.x+p.y*p.y;v>=u&&(u=v,s=h)}return{error:u,index:s}}}),Ot=f.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(e){this._content="",this._lines=[];var r=e&&c.isPlainObject(e)&&e.x===J&&e.y===J;this._initialize(r&&e,!r&&d.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Kt=Ot.extend({_class:"PointText",initialize:function(){Ot.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new y(t.x,t.y,this,"setPoint")},setPoint:function(){var t=d.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,r){if(this._content){this._setStyles(t,e,r);var n=this._lines,s=this._style,u=s.hasFill(),h=s.hasStroke(),l=s.getLeading(),p=t.shadowColor;t.font=s.getFontStyle(),t.textAlign=s.getJustification();for(var v=0,T=n.length;v<T;v++){t.shadowColor=p;var I=n[v];u&&(t.fillText(I,0,0),t.shadowColor="rgba(0,0,0,0)"),h&&t.strokeText(I,0,0),t.translate(0,l)}}},_getBounds:function(t,e){var r=this._style,n=this._lines,s=n.length,u=r.getJustification(),h=r.getLeading(),l=this.getView().getTextWidth(r.getFontStyle(),n),p=0;u!=="left"&&(p-=l/(u==="center"?2:1));var v=new H(p,s?-.75*h:0,l,s*h);return t?t._transformBounds(v,v):v}}),Xt=c.extend(new function(){var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},e={},r={transparent:[0,0,0,0]},n;function s(l){var p=l.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||l.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),v="rgb",T;if(p){var I=p[4]?4:3;T=new Array(I);for(var C=0;C<I;C++){var w=p[C+1];T[C]=parseInt(w.length==1?w+w:w,16)/255}}else if(p=l.match(/^(rgb|hsl)a?\((.*)\)$/)){v=p[1],T=p[2].trim().split(/[,\s]+/g);for(var Y=v==="hsl",C=0,M=Math.min(T.length,4);C<M;C++){var j=T[C],w=parseFloat(j);if(Y)if(C===0){var k=j.match(/([a-z]*)$/)[1];w*={turn:360,rad:180/Math.PI,grad:.9}[k]||1}else C<3&&(w/=100);else C<3&&(w/=/%$/.test(j)?100:255);T[C]=w}}else{var V=r[l];if(!V)if(et){n||(n=Ve.getContext(1,1,{willReadFrequently:!0}),n.globalCompositeOperation="copy"),n.fillStyle="rgba(0,0,0,0)",n.fillStyle=l,n.fillRect(0,0,1,1);var m=n.getImageData(0,0,1,1).data;V=r[l]=[m[0]/255,m[1]/255,m[2]/255]}else V=[0,0,0];T=V.slice()}return[v,T]}var u=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],h={"rgb-hsb":function(l,p,v){var T=Math.max(l,p,v),I=Math.min(l,p,v),C=T-I,w=C===0?0:(T==l?(p-v)/C+(p<v?6:0):T==p?(v-l)/C+2:(l-p)/C+4)*60;return[w,T===0?0:C/T,T]},"hsb-rgb":function(l,p,v){l=(l/60%6+6)%6;var I=Math.floor(l),T=l-I,I=u[I],C=[v,v*(1-p),v*(1-p*T),v*(1-p*(1-T))];return[C[I[0]],C[I[1]],C[I[2]]]},"rgb-hsl":function(l,p,v){var T=Math.max(l,p,v),I=Math.min(l,p,v),C=T-I,w=C===0,Y=w?0:(T==l?(p-v)/C+(p<v?6:0):T==p?(v-l)/C+2:(l-p)/C+4)*60,M=(T+I)/2,j=w?0:M<.5?C/(T+I):C/(2-T-I);return[Y,j,M]},"hsl-rgb":function(l,p,v){if(l=(l/360%1+1)%1,p===0)return[v,v,v];for(var T=[l+1/3,l,l-1/3],I=v<.5?v*(1+p):v+p-v*p,C=2*v-I,w=[],Y=0;Y<3;Y++){var M=T[Y];M<0&&(M+=1),M>1&&(M-=1),w[Y]=6*M<1?C+(I-C)*6*M:2*M<1?I:3*M<2?C+(I-C)*(2/3-M)*6:C}return w},"rgb-gray":function(l,p,v){return[l*.2989+p*.587+v*.114]},"gray-rgb":function(l){return[l,l,l]},"gray-hsb":function(l){return[0,0,l]},"gray-hsl":function(l){return[0,0,l]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return c.each(t,function(l,p){e[p]=[],c.each(l,function(v,T){var I=c.capitalize(v),C=/^(hue|saturation)$/.test(v),w=e[p][T]=p==="gradient"?v==="gradient"?function(Y){var M=this._components[0];return Y=Vt.read(Array.isArray(Y)?Y:arguments,0,{readNull:!0}),M!==Y&&(M&&M._removeOwner(this),Y&&Y._addOwner(this)),Y}:function(){return d.read(arguments,0,{readNull:v==="highlight",clone:!0})}:function(Y){return Y==null||isNaN(Y)?0:+Y};this["get"+I]=function(){return this._type===p||C&&/^hs[bl]$/.test(this._type)?this._components[T]:this._convert(p)[T]},this["set"+I]=function(Y){this._type!==p&&!(C&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(p),this._properties=t[p],this._type=p),this._components[T]=w.call(this,Y),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function l(p){var v=arguments,T=this.__read,I=0,C,w,Y,M;Array.isArray(p)&&(v=p,p=v[0]);var j=p!=null&&typeof p;if(j==="string"&&p in t&&(C=p,p=v[1],Array.isArray(p)?(w=p,Y=v[2]):(T&&(I=1),v=c.slice(v,1),j=typeof p)),!w){if(M=j==="number"?v:j==="object"&&p.length!=null?p:null,M){C||(C=M.length>=3?"rgb":"gray");var k=t[C].length;Y=M[k],T&&(I+=M===arguments?k+(Y!=null?1:0):1),M.length>k&&(M=c.slice(M,0,k))}else if(j==="string"){var V=s(p);C=V[0],w=V[1],w.length===4&&(Y=w[3],w.length--)}else if(j==="object")if(p.constructor===l){if(C=p._type,w=p._components.slice(),Y=p._alpha,C==="gradient")for(var m=1,F=w.length;m<F;m++){var X=w[m];X&&(w[m]=X.clone())}}else if(p.constructor===Vt)C="gradient",M=v;else{C="hue"in p?"lightness"in p?"hsl":"hsb":"gradient"in p||"stops"in p||"radial"in p?"gradient":"gray"in p?"gray":"rgb";var tt=t[C],U=e[C];this._components=w=[];for(var m=0,F=tt.length;m<F;m++){var nt=p[tt[m]];nt==null&&!m&&C==="gradient"&&"stops"in p&&(nt={stops:p.stops,radial:p.radial}),nt=U[m].call(this,nt),nt!=null&&(w[m]=nt)}Y=p.alpha}T&&C&&(I=1)}if(this._type=C||"rgb",!w){this._components=w=[];for(var U=e[this._type],m=0,F=U.length;m<F;m++){var nt=U[m].call(this,M&&M[m]);nt!=null&&(w[m]=nt)}}return this._components=w,this._properties=t[this._type],this._alpha=Y,T&&(this.__read=I),this},set:"#initialize",_serialize:function(l,p){var v=this.getComponents();return c.serialize(/^(gray|rgb)$/.test(this._type)?v:[this._type].concat(v),l,!0,p)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(l){var p;return this._type===l?this._components.slice():(p=h[this._type+"-"+l])?p.apply(this,this._components):h["rgb-"+l].apply(this,h[this._type+"-rgb"].apply(this,this._components))},convert:function(l){return new Xt(l,this._convert(l),this._alpha)},getType:function(){return this._type},setType:function(l){this._components=this._convert(l),this._properties=t[l],this._type=l},getComponents:function(){var l=this._components.slice();return this._alpha!=null&&l.push(this._alpha),l},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(l){this._alpha=l==null?null:Math.min(Math.max(l,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(l){var p=c.isPlainValue(l,!0)?Xt.read(arguments):l;return p===this||p&&this._class===p._class&&this._type===p._type&&this.getAlpha()===p.getAlpha()&&c.equals(this._components,p._components)||!1},toString:function(){for(var l=this._properties,p=[],v=this._type==="gradient",T=B.instance,I=0,C=l.length;I<C;I++){var w=this._components[I];w!=null&&p.push(l[I]+": "+(v?w:T.number(w)))}return this._alpha!=null&&p.push("alpha: "+T.number(this._alpha)),"{ "+p.join(", ")+" }"},toCSS:function(l){var p=this._convert("rgb"),v=l||this._alpha==null?1:this._alpha;function T(I){return Math.round((I<0?0:I>1?1:I)*255)}return p=[T(p[0]),T(p[1]),T(p[2])],v<1&&p.push(v<0?0:v),l?"#"+((1<<24)+(p[0]<<16)+(p[1]<<8)+p[2]).toString(16).slice(1):(p.length==4?"rgba(":"rgb(")+p.join(",")+")"},toCanvasStyle:function(l,p){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var v=this._components,T=v[0],I=T._stops,C=v[1],w=v[2],Y=v[3],M=p&&p.inverted(),j;if(M&&(C=M._transformPoint(C),w=M._transformPoint(w),Y&&(Y=M._transformPoint(Y))),T._radial){var k=w.getDistance(C);if(Y){var V=Y.subtract(C);V.getLength()>k&&(Y=C.add(V.normalize(k-.1)))}var m=Y||C;j=l.createRadialGradient(m.x,m.y,0,C.x,C.y,k)}else j=l.createLinearGradient(C.x,C.y,w.x,w.y);for(var F=0,X=I.length;F<X;F++){var tt=I[F],U=tt._offset;j.addColorStop(U??F/(X-1),tt._color.toCanvasStyle())}return this._canvasStyle=j},transform:function(l){if(this._type==="gradient"){for(var p=this._components,v=1,T=p.length;v<T;v++){var I=p[v];l._transformPoint(I,I,!0)}this._changed()}},statics:{_types:t,random:function(){var l=Math.random;return new Xt(l(),l(),l())},_setOwner:function(l,p,v){return l&&(l._owner&&p&&l._owner!==p&&(l=l.clone()),!l._owner^!p&&(l._owner=p||null,l._setter=v||null)),l}}})},new function(){var t={add:function(e,r){return e+r},subtract:function(e,r){return e-r},multiply:function(e,r){return e*r},divide:function(e,r){return e/r}};return c.each(t,function(e,r){this[r]=function(n){n=Xt.read(arguments);for(var s=this._type,u=this._components,h=n._convert(s),l=0,p=u.length;l<p;l++)h[l]=e(u[l],h[l]);return new Xt(s,h,this._alpha!=null?e(this._alpha,n.getAlpha()):null)}},{})}),Vt=c.extend({_class:"Gradient",initialize:function(e,r){this._id=G.get(),e&&c.isPlainObject(e)&&(this.set(e),e=r=null),this._stops==null&&this.setStops(e||["white","black"]),this._radial==null&&this.setRadial(typeof r=="string"&&r==="radial"||r||!1)},_serialize:function(t,e){return e.add(this,function(){return c.serialize([this._stops,this._radial],t,!0,e)})},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;e!=-1&&(this._owners.splice(e,1),this._owners.length||(this._owners=J))},clone:function(){for(var t=[],e=0,r=this._stops.length;e<r;e++)t[e]=this._stops[e].clone();return new Vt(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var r=0,n=e.length;r<n;r++)e[r]._owner=J;e=this._stops=mt.readList(t,0,{clone:!0});for(var r=0,n=e.length;r<n;r++)e[r]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,r=t._stops,n=e.length;if(n===r.length){for(var s=0;s<n;s++)if(!e[s].equals(r[s]))return!1;return!0}}return!1}}),mt=c.extend({_class:"GradientStop",initialize:function(e,r){var n=e,s=r;typeof e=="object"&&r===J&&(Array.isArray(e)&&typeof e[0]!="number"?(n=e[0],s=e[1]):("color"in e||"offset"in e||"rampPoint"in e)&&(n=e.color,s=e.offset||e.rampPoint||0)),this.setColor(n),this.setOffset(s)},clone:function(){return new mt(this._color.clone(),this._offset)},_serialize:function(t,e){var r=this._color,n=this._offset;return c.serialize(n==null?[r]:[r,n],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Xt._setOwner(this._color,null),this._color=Xt._setOwner(Xt.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),Dt=c.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new d,selectedColor:null},e=c.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),r=c.set({},e,{fillColor:new Xt}),n={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},s={beans:!0},u={_class:"Style",beans:!0,initialize:function(l,p,v){this._values={},this._owner=p,this._project=p&&p._project||v||_e.project,this._defaults=!p||p instanceof wt?e:p instanceof Ot?r:t,l&&this.set(l)}};return c.each(e,function(h,l){var p=/Color$/.test(l),v=l==="shadowOffset",T=c.capitalize(l),I=n[l],C="set"+T,w="get"+T;u[C]=function(Y){var M=this._owner,j=M&&M._children,k=j&&j.length>0&&!(M instanceof dt);if(k)for(var V=0,m=j.length;V<m;V++)j[V]._style[C](Y);if((l==="selectedColor"||!k)&&l in this._defaults){var F=this._values[l];F!==Y&&(p&&(F&&(Xt._setOwner(F,null),F._canvasStyle=null),Y&&Y.constructor===Xt&&(Y=Xt._setOwner(Y,M,k&&C))),this._values[l]=Y,M&&M._changed(I||129))}},u[w]=function(Y){var M=this._owner,j=M&&M._children,k=j&&j.length>0&&!(M instanceof dt),V;if(k&&!Y)for(var m=0,F=j.length;m<F;m++){var X=j[m]._style[w]();if(!m)V=X;else if(!c.equals(V,X))return J}else if(l in this._defaults){var V=this._values[l];if(V===J)V=this._defaults[l],V&&V.clone&&(V=V.clone());else{var tt=p?Xt:v?d:null;tt&&!(V&&V.constructor===tt)&&(this._values[l]=V=tt.read([V],0,{readNull:!0,clone:!0}))}}return V&&p&&(V=Xt._setOwner(V,M,k&&C)),V},s[w]=function(Y){return this._style[w](Y)},s[C]=function(Y){this._style[C](Y)}}),c.each({Font:"FontFamily",WindingRule:"FillRule"},function(h,l){var p="get"+l,v="set"+l;u[p]=s[p]="#get"+h,u[v]=s[v]="#set"+h}),f.inject(s),u},{set:function(t){var e=t instanceof Dt,r=e?t._values:t;if(r){for(var n in r)if(n in this._defaults){var s=r[n];this[n]=s&&e&&s.clone?s.clone():s}}},equals:function(t){function e(r,n,s){var u=r._values,h=n._values,l=n._defaults;for(var p in u){var v=u[p],T=h[p];if(!(s&&p in h)&&!c.equals(v,T===J?l[p]:T))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;t=this.getFillColor(),t&&(t._canvasStyle=null),t=this.getStrokeColor(),t&&(t._canvasStyle=null),t=this.getShadowColor(),t&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),r=this.getFontSize();return/pt|em|%|px/.test(r)&&(r=this.getView().getPixelSize(r)),e??r*1.2}}),Wt=new function(){function t(e,r,n,s){for(var u=["","webkit","moz","Moz","ms","o"],h=r[0].toUpperCase()+r.substring(1),l=0;l<6;l++){var p=u[l],v=p?p+h:r;if(v in e){if(n)e[v]=s;else return e[v];break}}}return{getStyles:function(e){var r=e&&e.nodeType!==9?e.ownerDocument:e,n=r&&r.defaultView;return n&&n.getComputedStyle(e,"")},getBounds:function(e,r){var n=e.ownerDocument,s=n.body,u=n.documentElement,h;try{h=e.getBoundingClientRect()}catch{h={left:0,top:0,width:0,height:0}}var l=h.left-(u.clientLeft||s.clientLeft||0),p=h.top-(u.clientTop||s.clientTop||0);if(!r){var v=n.defaultView;l+=v.pageXOffset||u.scrollLeft||s.scrollLeft,p+=v.pageYOffset||u.scrollTop||s.scrollTop}return new H(l,p,h.width,h.height)},getViewportBounds:function(e){var r=e.ownerDocument,n=r.defaultView,s=r.documentElement;return new H(0,0,n.innerWidth||s.clientWidth,n.innerHeight||s.clientHeight)},getOffset:function(e,r){return Wt.getBounds(e,r).getPoint()},getSize:function(e){return Wt.getBounds(e,!0).getSize()},isInvisible:function(e){return Wt.getSize(e).equals(new S(0,0))},isInView:function(e){return!Wt.isInvisible(e)&&Wt.getViewportBounds(e).intersects(Wt.getBounds(e,!0))},isInserted:function(e){return z.body.contains(e)},getPrefixed:function(e,r){return e&&t(e,r)},setPrefixed:function(e,r,n){if(typeof r=="object")for(var s in r)t(e,s,!0,r[s]);else t(e,r,!0,n)}}},Qt={add:function(t,e){if(t)for(var r in e)for(var n=e[r],s=r.split(/[\s,]+/g),u=0,h=s.length;u<h;u++){var l=s[u],p=t===z&&(l==="touchstart"||l==="touchmove")?{passive:!1}:!1;t.addEventListener(l,n,p)}},remove:function(t,e){if(t)for(var r in e)for(var n=e[r],s=r.split(/[\s,]+/g),u=0,h=s.length;u<h;u++)t.removeEventListener(s[u],n,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new d(e.pageX||e.clientX+z.documentElement.scrollLeft,e.pageY||e.clientY+z.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return Qt.getPoint(t).subtract(Wt.getOffset(e||Qt.getTarget(t)))}};Qt.requestAnimationFrame=new function(){var t=Wt.getPrefixed(et,"requestAnimationFrame"),e=!1,r=[],n;function s(){var u=r;r=[];for(var h=0,l=u.length;h<l;h++)u[h]();e=t&&r.length,e&&t(s)}return function(u){r.push(u),t?e||(t(s),e=!0):n||(n=setInterval(s,1e3/60))}};var re=c.extend(O,{_class:"View",initialize:function t(e,r){function n(I){return r[I]||parseInt(r.getAttribute(I),10)}function s(){var I=Wt.getSize(r);return I.isNaN()||I.isZero()?new S(n("width"),n("height")):I}var u;if(et&&r){this._id=r.getAttribute("id"),this._id==null&&r.setAttribute("id",this._id="paper-view-"+t._id++),Qt.add(r,this._viewEvents);var h="none";if(Wt.setPrefixed(r.style,{userDrag:h,userSelect:h,touchCallout:h,contentZooming:h,tapHighlightColor:"rgba(0,0,0,0)"}),x.hasAttribute(r,"resize")){var l=this;Qt.add(et,this._windowEvents={resize:function(){l.setViewSize(s())}})}if(u=s(),x.hasAttribute(r,"stats")&&typeof Stats<"u"){this._stats=new Stats;var p=this._stats.domElement,v=p.style,T=Wt.getOffset(r);v.position="absolute",v.left=T.x+"px",v.top=T.y+"px",z.body.appendChild(p)}}else u=new S(r),r=null;this._project=e,this._scope=e._scope,this._element=r,this._pixelRatio||(this._pixelRatio=et&&et.devicePixelRatio||1),this._setElementSize(u.width,u.height),this._viewSize=u,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new g)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!_e.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;re._focused===this&&(re._focused=null),re._views.splice(re._views.indexOf(this),1),delete re._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),Qt.remove(this._element,this._viewEvents),Qt.remove(et,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:c.each(f._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;Qt.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;(!Wt.getPrefixed(z,"hidden")||x.getAttribute(e,"keepalive")==="true")&&Wt.isInView(e)&&t._handleFrame()}t._autoUpdate&&t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){_e=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new c({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var r=this._frameItems;e?(r[t._id]={item:t,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete r[t._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var r=this._frameItems[e];r.item.emit("frame",new c(t,{time:r.time+=t.delta,count:r.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=J},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var t=this._viewSize;return new R(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=S.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var r=this._element;r&&(r.width!==t&&(r.width=t),r.height!==e&&(r.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new H(new d,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Wt.isInView(this._element)},isInserted:function(){return Wt.isInserted(this._element)},getPixelSize:function(t){var e=this._element,r;if(e){var n=e.parentNode,s=z.createElement("div");s.style.fontSize=t,n.appendChild(s),r=parseFloat(Wt.getStyles(s).fontSize),n.removeChild(s)}else r=parseFloat(r);return r},getTextWidth:function(t,e){return 0}},c.each(["rotate","scale","shear","skew"],function(t){var e=t==="rotate";this[t]=function(){var r=arguments,n=(e?c:d).read(r),s=d.read(r,0,{readNull:!0});return this.transform(new g()[t](n,s||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new g;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=d.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new g().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();e!=null&&t!=null&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new y(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=d.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(d.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(d.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(d.read(arguments))},getEventPoint:function(t){return this.viewToProject(Qt.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){z&&typeof e=="string"&&(e=z.getElementById(e));var r=et?be:re;return new r(t,e)}}},new function(){if(!et)return;var t,e,r=!1,n=!1;function s(ot){var xt=Qt.getTarget(ot);return xt.getAttribute&&re._viewsById[xt.getAttribute("id")]}function u(){var ot=re._focused;if(!ot||!ot.isVisible()){for(var xt=0,yt=re._views.length;xt<yt;xt++)if((ot=re._views[xt]).isVisible()){re._focused=e=ot;break}}}function h(ot,xt,yt){ot._handleMouseEvent("mousemove",xt,yt)}var l=et.navigator,p,v,T;l.pointerEnabled||l.msPointerEnabled?(p="pointerdown MSPointerDown",v="pointermove MSPointerMove",T="pointerup pointercancel MSPointerUp MSPointerCancel"):(p="touchstart",v="touchmove",T="touchend touchcancel","ontouchstart"in et&&l.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(p+=" mousedown",v+=" mousemove",T+=" mouseup"));var I={},C={mouseout:function(ot){var xt=re._focused,yt=Qt.getRelatedTarget(ot);if(xt&&(!yt||yt.nodeName==="HTML")){var At=Qt.getOffset(ot,xt._element),Rt=At.x,Mt=Math.abs,jt=Mt(Rt),$t=1<<25,ie=jt-$t;At.x=Mt(ie)<jt?ie*(Rt<0?-1:1):Rt,h(xt,ot,xt.viewToProject(At))}},scroll:u};I[p]=function(ot){var xt=re._focused=s(ot);r||(r=!0,xt._handleMouseEvent("mousedown",ot))},C[v]=function(ot){var xt=re._focused;if(!n){var yt=s(ot);yt?xt!==yt&&(xt&&h(xt,ot),t||(t=xt),xt=re._focused=e=yt):e&&e===xt&&(t&&!t.isInserted()&&(t=null),xt=re._focused=t,t=null,u())}xt&&h(xt,ot)},C[p]=function(){n=!0},C[T]=function(ot){var xt=re._focused;xt&&r&&xt._handleMouseEvent("mouseup",ot),n=r=!1},Qt.add(z,C),Qt.add(et,{load:u});var w=!1,Y=!1,M={doubleclick:"click",mousedrag:"mousemove"},j=!1,k,V,m,F,X,tt,U,nt;function ut(ot,xt,yt,At,Rt,Mt,jt){var $t=!1,ie;function oe(zt,Ht){if(zt.responds(Ht)){if(ie||(ie=new Ze(Ht,At,Rt,xt||zt,Mt?Rt.subtract(Mt):null)),zt.emit(Ht,ie)&&(w=!0,ie.prevented&&(Y=!0),ie.stopped))return $t=!0}else{var ne=M[Ht];if(ne)return oe(zt,ne)}}for(;ot&&ot!==jt&&!oe(ot,yt);)ot=ot._parent;return $t}function pt(ot,xt,yt,At,Rt,Mt){return ot._project.removeOn(yt),Y=w=!1,X&&ut(X,null,yt,At,Rt,Mt)||xt&&xt!==X&&!xt.isDescendant(X)&&ut(xt,null,yt==="mousedrag"?"mousemove":yt,At,Rt,Mt,X)||ut(ot,X||xt||ot,yt,At,Rt,Mt)}var bt={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:I,_handleMouseEvent:function(ot,xt,yt){var At=this._itemEvents,Rt=At.native[ot],Mt=ot==="mousemove",jt=this._scope.tool,$t=this;function ie(fe){return At.virtual[fe]||$t.responds(fe)||jt&&jt.responds(fe)}Mt&&r&&ie("mousedrag")&&(ot="mousedrag"),yt||(yt=this.getEventPoint(xt));var oe=this.getBounds().contains(yt),zt=Rt&&oe&&$t._project.hitTest(yt,{tolerance:0,fill:!0,stroke:!0}),Ht=zt&&zt.item||null,ne=!1,ue={};if(ue[ot.substr(5)]=!0,Rt&&Ht!==F&&(F&&ut(F,null,"mouseleave",xt,yt),Ht&&ut(Ht,null,"mouseenter",xt,yt),F=Ht),j^oe&&(ut(this,null,oe?"mouseenter":"mouseleave",xt,yt),ne=!0),(oe||ue.drag)&&!yt.equals(V)&&(pt(this,Ht,Mt?ot:"mousemove",xt,yt,V),ne=!0),j=oe,ue.down&&oe||ue.up&&k){if(pt(this,Ht,ot,xt,yt,k),ue.down){if(nt=Ht===tt&&Date.now()-U<300,m=tt=Ht,!Y&&Ht){for(var se=Ht;se&&!se.responds("mousedrag");)se=se._parent;se&&(X=Ht)}k=yt}else ue.up&&(!Y&&Ht===m&&(U=Date.now(),pt(this,Ht,nt?"doubleclick":"click",xt,yt,k),nt=!1),m=X=null);j=!1,ne=!0}V=yt,ne&&jt&&(w=jt._handleMouseEvent(ot,xt,yt,ue)||w),xt.cancelable!==!1&&(w&&!ue.move||ue.down&&ie("mouseup"))&&xt.preventDefault()},_handleKeyEvent:function(ot,xt,yt,At){var Rt=this._scope,Mt=Rt.tool,jt;function $t(ie){ie.responds(ot)&&(_e=Rt,ie.emit(ot,jt=jt||new we(ot,xt,yt,At)))}this.isVisible()&&($t(this),Mt&&Mt.responds(ot)&&$t(Mt))},_countItemEvent:function(ot,xt){var yt=this._itemEvents,At=yt.native,Rt=yt.virtual;for(var Mt in bt)At[Mt]=(At[Mt]||0)+(bt[Mt][ot]||0)*xt;Rt[ot]=(Rt[ot]||0)+xt},statics:{updateFocus:u,_resetState:function(){r=n=w=j=!1,t=e=k=V=m=F=X=tt=U=nt=null}}}}),be=re.extend({_class:"CanvasView",initialize:function(e,r){if(!(r instanceof et.HTMLCanvasElement)){var n=S.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+c.slice(arguments,1));r=Ve.getCanvas(n)}var s=this._context=r.getContext("2d");if(s.save(),this._pixelRatio=1,!/^off|false$/.test(x.getAttribute(r,"hidpi"))){var u=et.devicePixelRatio||1,h=Wt.getPrefixed(s,"backingStorePixelRatio")||1;this._pixelRatio=u/h}re.call(this,e,r),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,r){var n=this._pixelRatio;if(t.base.call(this,e*n,r*n),n!==1){var s=this._element,u=this._context;if(!x.hasAttribute(s,"resize")){var h=s.style;h.width=e+"px",h.height=r+"px"}u.restore(),u.save(),u.scale(n,n)}},getContext:function(){return this._context},getPixelSize:function t(e){var r=_e.agent,n;if(r&&r.firefox)n=t.base.call(this,e);else{var s=this._context,u=s.font;s.font=e+" serif",n=parseFloat(s.font),s.font=u}return n},getTextWidth:function(t,e){var r=this._context,n=r.font,s=0;r.font=t;for(var u=0,h=e.length;u<h;u++)s=Math.max(s,r.measureText(e[u]).width);return r.font=n,s},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,r=this._viewSize;return e.clearRect(0,0,r.width+1,r.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),ce=c.extend({_class:"Event",initialize:function(e){this.event=e,this.type=e&&e.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return ge.modifiers}}),we=ce.extend({_class:"KeyEvent",initialize:function(e,r,n,s){this.type=e,this.event=r,this.key=n,this.character=s},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),ge=new function(){var t={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},e={tab:"	",space:" ",enter:"\r"},r={},n={},s,u,h=new c({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var v=_e&&_e.agent;return v&&v.mac?this.meta:this.control}}});function l(v){var T=v.key||v.keyIdentifier;return T=/^U\+/.test(T)?String.fromCharCode(parseInt(T.substr(2),16)):/^Arrow[A-Z]/.test(T)?T.substr(5):T==="Unidentified"||T===J?String.fromCharCode(v.keyCode):T,t[T]||(T.length>1?c.hyphenate(T):T.toLowerCase())}function p(v,T,I,C){var w=re._focused,Y;if(r[T]=v,v?n[T]=I:delete n[T],T.length>1&&(Y=c.camelize(T))in h){h[Y]=v;var M=_e&&_e.agent;if(Y==="meta"&&M&&M.mac)if(v)s={};else{for(var j in s)j in n&&p(!1,j,s[j],C);s=null}}else v&&s&&(s[T]=I);w&&w._handleKeyEvent(v?"keydown":"keyup",C,T,I)}return Qt.add(z,{keydown:function(v){var T=l(v),I=_e&&_e.agent;T.length>1||I&&I.chrome&&(v.altKey||I.mac&&v.metaKey||!I.mac&&v.ctrlKey)?p(!0,T,e[T]||(T.length>1?"":T),v):u=T},keypress:function(v){if(u){var T=l(v),I=v.charCode,C=I>=32?String.fromCharCode(I):T.length>1?"":T;T!==u&&(T=C.toLowerCase()),p(!0,T,C,v),u=null}},keyup:function(v){var T=l(v);T in n&&p(!1,T,n[T],v)}}),Qt.add(et,{blur:function(v){for(var T in n)p(!1,T,n[T],v)}}),{modifiers:h,isDown:function(v){return!!r[v]}}},Ze=ce.extend({_class:"MouseEvent",initialize:function(e,r,n,s,u){this.type=e,this.event=r,this.point=n,this.target=s,this.delta=u},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Re=ce.extend({_class:"ToolEvent",_item:null,initialize:function(e,r,n){this.tool=e,this.type=r,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,r=e._parent;/^(Group|CompoundPath)$/.test(r._class);)e=r,r=r._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Ue=D.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(e){D.call(this),this._moveCount=-1,this._downCount=-1,this.set(e)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,t!=null&&this._maxDistance!=null&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,this._minDistance!=null&&t!=null&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,r,n){_e=this._scope,n.drag&&!this.responds(t)&&(t="mousemove");var s=n.move||n.drag,u=this.responds(t),h=!1,l=this;function p(T,I){var C=r,w=s?l._point:l._downPoint||C;if(s){if(l._moveCount>=0&&C.equals(w))return!1;if(w&&(T!=null||I!=null)){var Y=C.subtract(w),M=Y.getLength();if(M<(T||0))return!1;I&&(C=w.add(Y.normalize(Math.min(M,I))))}l._moveCount++}return l._point=C,l._lastPoint=w||C,n.down&&(l._moveCount=-1,l._downPoint=C,l._downCount++),!0}function v(){u&&(h=l.emit(t,new Re(l,t,e))||h)}if(n.down)p(),v();else if(n.up)p(null,this._maxDistance),v();else if(u)for(;p(this._minDistance,this._maxDistance);)v();return h}}),_i=c.extend(O,{_class:"Tween",statics:{easings:new c({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,r,n,s,u,h){this.object=e;var l=typeof u,p=l==="function";this.type=p?l:l==="string"?u:"linear",this.easing=p?u:t.easings[this.type],this.duration=s,this.running=!1,this._then=null,this._startTime=null;var v=r||n;this._keys=v?Object.keys(v):[],this._parsedKeys=this._parseKeys(this._keys),this._from=v&&this._getState(r),this._to=v&&this._getState(n),h!==!1&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),r=this._keys,n=function(T){return typeof T=="function"?T(e,t):T},s=0,u=r&&r.length;s<u;s++){var h=r[s],l=n(this._from[h]),p=n(this._to[h]),v=l&&p&&l.__add&&p.__add?p.__subtract(l).__multiply(e).__add(l):(p-l)*e+l;this._setProperty(this._parsedKeys[h],v)}this.responds("update")&&this.emit("update",new c({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,r=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(r)},_getState:function(t){for(var e=this._keys,r={},n=0,s=e.length;n<s;n++){var u=e[n],h=this._parsedKeys[u],l=this._getProperty(h),p;if(t){var v=this._resolveValue(l,t[u]);this._setProperty(h,v),p=this._getProperty(h),p=p&&p.clone?p.clone():p,this._setProperty(h,l)}else p=l&&l.clone?l.clone():l;r[u]=p}return r},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&e.length===2){var r=e[0];return r&&r.match&&r.match(/^[+\-\*\/]=/)?this._calculate(t,r[0],e[1]):e}else if(typeof e=="string"){var n=e.match(/^[+\-*/]=(.*)/);if(n){var s=JSON.parse(n[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],s)}}}return e},_calculate:function(t,e,r){return _e.PaperScript.calculateBinary(t,e,r)},_parseKeys:function(t){for(var e={},r=0,n=t.length;r<n;r++){var s=t[r],u=s.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[s]=u.split("/")}return e},_getProperty:function(t,e){for(var r=this.object,n=0,s=t.length-(e||0);n<s&&r;n++)r=r[t[n]];return r},_setProperty:function(t,e){var r=this._getProperty(t,1);r&&(r[t[t.length-1]]=e)}}),ti={request:function(t){var e=new W.XMLHttpRequest;return e.open((t.method||"get").toUpperCase(),t.url,c.pick(t.async,!0)),t.mimeType&&e.overrideMimeType(t.mimeType),e.onload=function(){var r=e.status;r===0||r===200?t.onLoad&&t.onLoad.call(e,e.responseText):e.onerror()},e.onerror=function(){var r=e.status,n='Could not load "'+t.url+'" (Status: '+r+")";if(t.onError)t.onError(n,r);else throw new Error(n)},e.send(null)}},Ve=c.exports.CanvasProvider={canvases:[],getCanvas:function(t,e,r){if(!et)return null;var n,s=!0;typeof t=="object"&&(e=t.height,t=t.width),this.canvases.length?n=this.canvases.pop():(n=z.createElement("canvas"),s=!1);var u=n.getContext("2d",r||{});if(!u)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===t&&n.height===e?s&&u.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),u.save(),n},getContext:function(t,e,r){var n=this.getCanvas(t,e,r);return n?n.getContext("2d",r||{}):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},Le=new function(){var t=Math.min,e=Math.max,r=Math.abs,n,s,u,h,l,p,v,T,I,C,w;function Y(X,tt,U){return .2989*X+.587*tt+.114*U}function M(X,tt,U,pt){var ut=pt-Y(X,tt,U);I=X+ut,C=tt+ut,w=U+ut;var pt=Y(I,C,w),bt=t(I,C,w),ot=e(I,C,w);if(bt<0){var xt=pt-bt;I=pt+(I-pt)*pt/xt,C=pt+(C-pt)*pt/xt,w=pt+(w-pt)*pt/xt}if(ot>255){var yt=255-pt,At=ot-pt;I=pt+(I-pt)*yt/At,C=pt+(C-pt)*yt/At,w=pt+(w-pt)*yt/At}}function j(X,tt,U){return e(X,tt,U)-t(X,tt,U)}function k(X,tt,U,nt){var ut=[X,tt,U],pt=e(X,tt,U),bt=t(X,tt,U),ot;bt=bt===X?0:bt===tt?1:2,pt=pt===X?0:pt===tt?1:2,ot=t(bt,pt)===0?e(bt,pt)===1?2:1:0,ut[pt]>ut[bt]?(ut[ot]=(ut[ot]-ut[bt])*nt/(ut[pt]-ut[bt]),ut[pt]=nt):ut[ot]=ut[pt]=0,ut[bt]=0,I=ut[0],C=ut[1],w=ut[2]}var V={multiply:function(){I=l*n/255,C=p*s/255,w=v*u/255},screen:function(){I=l+n-l*n/255,C=p+s-p*s/255,w=v+u-v*u/255},overlay:function(){I=l<128?2*l*n/255:255-2*(255-l)*(255-n)/255,C=p<128?2*p*s/255:255-2*(255-p)*(255-s)/255,w=v<128?2*v*u/255:255-2*(255-v)*(255-u)/255},"soft-light":function(){var X=n*l/255;I=X+l*(255-(255-l)*(255-n)/255-X)/255,X=s*p/255,C=X+p*(255-(255-p)*(255-s)/255-X)/255,X=u*v/255,w=X+v*(255-(255-v)*(255-u)/255-X)/255},"hard-light":function(){I=n<128?2*n*l/255:255-2*(255-n)*(255-l)/255,C=s<128?2*s*p/255:255-2*(255-s)*(255-p)/255,w=u<128?2*u*v/255:255-2*(255-u)*(255-v)/255},"color-dodge":function(){I=l===0?0:n===255?255:t(255,255*l/(255-n)),C=p===0?0:s===255?255:t(255,255*p/(255-s)),w=v===0?0:u===255?255:t(255,255*v/(255-u))},"color-burn":function(){I=l===255?255:n===0?0:e(0,255-(255-l)*255/n),C=p===255?255:s===0?0:e(0,255-(255-p)*255/s),w=v===255?255:u===0?0:e(0,255-(255-v)*255/u)},darken:function(){I=l<n?l:n,C=p<s?p:s,w=v<u?v:u},lighten:function(){I=l>n?l:n,C=p>s?p:s,w=v>u?v:u},difference:function(){I=l-n,I<0&&(I=-I),C=p-s,C<0&&(C=-C),w=v-u,w<0&&(w=-w)},exclusion:function(){I=l+n*(255-l-l)/255,C=p+s*(255-p-p)/255,w=v+u*(255-v-v)/255},hue:function(){k(n,s,u,j(l,p,v)),M(I,C,w,Y(l,p,v))},saturation:function(){k(l,p,v,j(n,s,u)),M(I,C,w,Y(l,p,v))},luminosity:function(){M(l,p,v,Y(n,s,u))},color:function(){M(n,s,u,Y(l,p,v))},add:function(){I=t(l+n,255),C=t(p+s,255),w=t(v+u,255)},subtract:function(){I=e(l-n,0),C=e(p-s,0),w=e(v-u,0)},average:function(){I=(l+n)/2,C=(p+s)/2,w=(v+u)/2},negation:function(){I=255-r(255-n-l),C=255-r(255-s-p),w=255-r(255-u-v)}},m=this.nativeModes=c.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(X){this[X]=!0},{}),F=Ve.getContext(1,1,{willReadFrequently:!0});F&&(c.each(V,function(X,tt){var U=tt==="darken",nt=!1;F.save();try{F.fillStyle=U?"#300":"#a00",F.fillRect(0,0,1,1),F.globalCompositeOperation=tt,F.globalCompositeOperation===tt&&(F.fillStyle=U?"#a00":"#300",F.fillRect(0,0,1,1),nt=F.getImageData(0,0,1,1).data[0]!==U?170:51)}catch{}F.restore(),m[tt]=nt}),Ve.release(F)),this.process=function(X,tt,U,nt,ut){var pt=tt.canvas,bt=X==="normal";if(bt||m[X])U.save(),U.setTransform(1,0,0,1,0,0),U.globalAlpha=nt,bt||(U.globalCompositeOperation=X),U.drawImage(pt,ut.x,ut.y),U.restore();else{var ot=V[X];if(!ot)return;for(var xt=U.getImageData(ut.x,ut.y,pt.width,pt.height),yt=xt.data,At=tt.getImageData(0,0,pt.width,pt.height).data,Rt=0,Mt=yt.length;Rt<Mt;Rt+=4){n=At[Rt],l=yt[Rt],s=At[Rt+1],p=yt[Rt+1],u=At[Rt+2],v=yt[Rt+2],h=At[Rt+3],T=yt[Rt+3],ot();var jt=h*nt/255,$t=1-jt;yt[Rt]=jt*I+$t*l,yt[Rt+1]=jt*C+$t*p,yt[Rt+2]=jt*w+$t*v,yt[Rt+3]=h*nt+$t*T}U.putImageData(xt,ut.x,ut.y)}}},Ae=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",r="http://www.w3.org/1999/xlink",n={href:r,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function s(l,p,v){return h(z.createElementNS(t,l),p,v)}function u(l,p){var v=n[p],T=v?l.getAttributeNS(v,p):l.getAttribute(p);return T==="null"?null:T}function h(l,p,v){for(var T in p){var I=p[T],C=n[T];typeof I=="number"&&v&&(I=v.number(I)),C?l.setAttributeNS(C,T,I):l.setAttribute(T,I)}return l}return{svg:t,xmlns:e,xlink:r,create:s,get:u,set:h}},Qe=c.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof at||t instanceof rt||t instanceof Ot)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,e){var r=c.capitalize(e),n=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:n,fromSVG:n&&c.each(n,function(s,u){this[s]=u},{}),exportFilter:t[3],get:"get"+r,set:"set"+r}},{});new function(){var t;function e(V,m,F){var X=new c,tt=V.getTranslation();if(m){var U;V.isInvertible()?(V=V._shiftless(),U=V._inverseTransform(tt),tt=null):U=new d,X[F?"cx":"x"]=U.x,X[F?"cy":"y"]=U.y}if(!V.isIdentity()){var nt=V.decompose();if(nt){var ut=[],pt=nt.rotation,bt=nt.scaling,ot=nt.skewing;tt&&!tt.isZero()&&ut.push("translate("+t.point(tt)+")"),pt&&ut.push("rotate("+t.number(pt)+")"),(!Z.isZero(bt.x-1)||!Z.isZero(bt.y-1))&&ut.push("scale("+t.point(bt)+")"),ot.x&&ut.push("skewX("+t.number(ot.x)+")"),ot.y&&ut.push("skewY("+t.number(ot.y)+")"),X.transform=ut.join(" ")}else X.transform="matrix("+V.getValues().join(",")+")"}return X}function r(V,m){for(var F=e(V._matrix),X=V._children,tt=Ae.create("g",F,t),U=0,nt=X.length;U<nt;U++){var ut=X[U],pt=j(ut,m);if(pt)if(ut.isClipMask()){var bt=Ae.create("clipPath");bt.appendChild(pt),Y(ut,bt,"clip"),Ae.set(tt,{"clip-path":"url(#"+bt.id+")"})}else tt.appendChild(pt)}return tt}function n(V,m){var F=e(V._matrix,!0),X=V.getSize(),tt=V.getImage();return F.x-=X.width/2,F.y-=X.height/2,F.width=X.width,F.height=X.height,F.href=m.embedImages==!1&&tt&&tt.src||V.toDataURL(),Ae.create("image",F,t)}function s(V,m){var F=m.matchShapes;if(F){var X=V.toShape(!1);if(X)return u(X)}var tt=V._segments,U=tt.length,nt,ut=e(V._matrix);if(F&&U>=2&&!V.hasHandles())if(U>2){nt=V._closed?"polygon":"polyline";for(var pt=[],bt=0;bt<U;bt++)pt.push(t.point(tt[bt]._point));ut.points=pt.join(" ")}else{nt="line";var ot=tt[0]._point,xt=tt[1]._point;ut.set({x1:ot.x,y1:ot.y,x2:xt.x,y2:xt.y})}else nt="path",ut.d=V.getPathData(null,m.precision);return Ae.create(nt,ut,t)}function u(V){var m=V._type,F=V._radius,X=e(V._matrix,!0,m!=="rectangle");if(m==="rectangle"){m="rect";var tt=V._size,U=tt.width,nt=tt.height;X.x-=U/2,X.y-=nt/2,X.width=U,X.height=nt,F.isZero()&&(F=null)}return F&&(m==="circle"?X.r=F:(X.rx=F.width,X.ry=F.height)),Ae.create(m,X,t)}function h(V,m){var F=e(V._matrix),X=V.getPathData(null,m.precision);return X&&(F.d=X),Ae.create("path",F,t)}function l(V,m){var F=e(V._matrix,!0),X=V._definition,tt=w(X,"symbol"),U=X._item,nt=U.getStrokeBounds();return tt||(tt=Ae.create("symbol",{viewBox:t.rectangle(nt)}),tt.appendChild(j(U,m)),Y(X,tt,"symbol")),F.href="#"+tt.id,F.x+=nt.x,F.y+=nt.y,F.width=nt.width,F.height=nt.height,F.overflow="visible",Ae.create("use",F,t)}function p(V){var m=w(V,"color");if(!m){var F=V.getGradient(),X=F._radial,tt=V.getOrigin(),U=V.getDestination(),nt;if(X){nt={cx:tt.x,cy:tt.y,r:tt.getDistance(U)};var ut=V.getHighlight();ut&&(nt.fx=ut.x,nt.fy=ut.y)}else nt={x1:tt.x,y1:tt.y,x2:U.x,y2:U.y};nt.gradientUnits="userSpaceOnUse",m=Ae.create((X?"radial":"linear")+"Gradient",nt,t);for(var pt=F._stops,bt=0,ot=pt.length;bt<ot;bt++){var xt=pt[bt],yt=xt._color,At=yt.getAlpha(),Rt=xt._offset;nt={offset:Rt??bt/(ot-1)},yt&&(nt["stop-color"]=yt.toCSS(!0)),At<1&&(nt["stop-opacity"]=At),m.appendChild(Ae.create("stop",nt,t))}Y(V,m,"color")}return"url(#"+m.id+")"}function v(V){var m=Ae.create("text",e(V._matrix,!0),t);return m.textContent=V._content,m}var T={Group:r,Layer:r,Raster:n,Path:s,Shape:u,CompoundPath:h,SymbolItem:l,PointText:v};function I(V,m,F,X){var tt={},U=!X&&V.getParent(),nt=[];return V._name!=null&&(tt.id=V._name),c.each(Qe,function(ut){var pt=ut.get,bt=ut.type,ot=V[pt]();if(ut.exportFilter?ut.exportFilter(V,ot):F.reduceAttributes==!1||!U||!c.equals(U[pt](),ot)){if(bt==="color"&&ot!=null){var xt=ot.getAlpha();xt<1&&(tt[ut.attribute+"-opacity"]=xt)}bt==="style"?nt.push(ut.attribute+": "+ot):tt[ut.attribute]=ot==null?"none":bt==="color"?ot.gradient?p(ot):ot.toCSS(!0):bt==="array"?ot.join(","):bt==="lookup"?ut.toSVG[ot]:ot}}),nt.length&&(tt.style=nt.join(";")),tt.opacity===1&&delete tt.opacity,V._visible||(tt.visibility="hidden"),Ae.set(m,tt,t)}var C;function w(V,m){return C||(C={ids:{},svgs:{}}),V&&C.svgs[m+"-"+(V._id||V.__id||(V.__id=G.get("svg")))]}function Y(V,m,F){C||w();var X=C.ids[F]=(C.ids[F]||0)+1;m.id=F+"-"+X,C.svgs[F+"-"+(V._id||V.__id)]=m}function M(V,m){var F=V,X=null;if(C){F=V.nodeName.toLowerCase()==="svg"&&V;for(var tt in C.svgs)X||(F||(F=Ae.create("svg"),F.appendChild(V)),X=F.insertBefore(Ae.create("defs"),F.firstChild)),X.appendChild(C.svgs[tt]);C=null}return m.asString?new W.XMLSerializer().serializeToString(F):F}function j(V,m,F){var X=T[V._class],tt=X&&X(V,m);if(tt){var U=m.onExport;U&&(tt=U(V,tt,m)||tt);var nt=JSON.stringify(V._data);nt&&nt!=="{}"&&nt!=="null"&&tt.setAttribute("data-paper-data",nt)}return tt&&I(V,tt,m,F)}function k(V){return V||(V={}),t=new B(V.precision),V}f.inject({exportSVG:function(V){return V=k(V),M(j(this,V,!0),V)}}),K.inject({exportSVG:function(V){V=k(V);var m=this._children,F=this.getView(),X=c.pick(V.bounds,"view"),tt=V.matrix||X==="view"&&F._matrix,U=tt&&g.read([tt]),nt=X==="view"?new H([0,0],F.getViewSize()):X==="content"?f._getBounds(m,U,{stroke:!0}).rect:H.read([X],0,{readNull:!0}),ut={version:"1.1",xmlns:Ae.svg,"xmlns:xlink":Ae.xlink};nt&&(ut.width=nt.width,ut.height=nt.height,(nt.x||nt.x===0||nt.y||nt.y===0)&&(ut.viewBox=t.rectangle(nt)));var pt=Ae.create("svg",ut,t),bt=pt;U&&!U.isIdentity()&&(bt=pt.appendChild(Ae.create("g",e(U),t)));for(var ot=0,xt=m.length;ot<xt;ot++)bt.appendChild(j(m[ot],V,!0));return M(pt,V)}})},new function(){var t={},e;function r(m,F,X,tt,U,nt){var ut=Ae.get(m,F)||nt,pt=ut==null?tt?null:X?"":0:X?ut:parseFloat(ut);return/%\s*$/.test(ut)?pt/100*(U?1:e[/x|^width/.test(F)?"width":"height"]):pt}function n(m,F,X,tt,U,nt,ut){return F=r(m,F||"x",!1,tt,U,nt),X=r(m,X||"y",!1,tt,U,ut),tt&&(F==null||X==null)?null:new d(F,X)}function s(m,F,X,tt,U){return F=r(m,F||"width",!1,tt,U),X=r(m,X||"height",!1,tt,U),tt&&(F==null||X==null)?null:new S(F,X)}function u(m,F,X){return m==="none"?null:F==="number"?parseFloat(m):F==="array"?m?m.split(/[\s,]+/g).map(parseFloat):[]:F==="color"?j(m)||m:F==="lookup"?X[m]:m}function h(m,F,X,tt){var U=m.childNodes,nt=F==="clippath",ut=F==="defs",pt=new wt,bt=pt._project,ot=bt._currentStyle,xt=[];if(!nt&&!ut&&(pt=M(pt,m,tt),bt._currentStyle=pt._style.clone()),tt)for(var yt=m.querySelectorAll("defs"),At=0,Rt=yt.length;At<Rt;At++)k(yt[At],X,!1);for(var At=0,Rt=U.length;At<Rt;At++){var Mt=U[At],jt;Mt.nodeType===1&&!/^defs$/i.test(Mt.nodeName)&&(jt=k(Mt,X,!1))&&!(jt instanceof St)&&xt.push(jt)}return pt.addChildren(xt),nt&&(pt=M(pt.reduce(),m,tt)),bt._currentStyle=ot,(nt||ut)&&(pt.remove(),pt=null),pt}function l(m,F){for(var X=m.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),tt=[],U=0,nt=X.length;U<nt;U+=2)tt.push(new d(parseFloat(X[U]),parseFloat(X[U+1])));var ut=new ct(tt);return F==="polygon"&&ut.closePath(),ut}function p(m){return at.create(m.getAttribute("d"))}function v(m,F){var X=(r(m,"href",!0)||"").substring(1),tt=F==="radialgradient",U;if(X)U=t[X].getGradient(),U._radial^tt&&(U=U.clone(),U._radial=tt);else{for(var nt=m.childNodes,ut=[],pt=0,bt=nt.length;pt<bt;pt++){var ot=nt[pt];ot.nodeType===1&&ut.push(M(new mt,ot))}U=new Vt(ut,tt)}var xt,yt,At,Rt=r(m,"gradientUnits",!0)!=="userSpaceOnUse";tt?(xt=n(m,"cx","cy",!1,Rt,"50%","50%"),yt=xt.add(r(m,"r",!1,!1,Rt,"50%"),0),At=n(m,"fx","fy",!0,Rt)):(xt=n(m,"x1","y1",!1,Rt,"0%","0%"),yt=n(m,"x2","y2",!1,Rt,"100%","0%"));var Mt=M(new Xt(U,xt,yt,At),m);return Mt._scaleToBounds=Rt,null}var T={"#document":function(m,F,X,tt){for(var U=m.childNodes,nt=0,ut=U.length;nt<ut;nt++){var pt=U[nt];if(pt.nodeType===1)return k(pt,X,tt)}},g:h,svg:h,clippath:h,polygon:l,polyline:l,path:p,lineargradient:v,radialgradient:v,image:function(m){var F=new st(r(m,"href",!0));return F.on("load",function(){var X=s(m);this.setSize(X);var tt=n(m).add(X.divide(2));this._matrix.append(new g().translate(tt))}),F},symbol:function(m,F,X,tt){return new St(h(m,F,X,tt),!0)},defs:h,use:function(m){var F=(r(m,"href",!0)||"").substring(1),X=t[F],tt=n(m);return X?X instanceof St?X.place(tt):X.clone().translate(tt):null},circle:function(m){return new rt.Circle(n(m,"cx","cy"),r(m,"r"))},ellipse:function(m){return new rt.Ellipse({center:n(m,"cx","cy"),radius:s(m,"rx","ry")})},rect:function(m){return new rt.Rectangle(new H(n(m),s(m)),s(m,"rx","ry"))},line:function(m){return new ct.Line(n(m,"x1","y1"),n(m,"x2","y2"))},text:function(m){var F=new Kt(n(m).add(n(m,"dx","dy")));return F.setContent(m.textContent.trim()||""),F},switch:h};function I(m,F,X,tt){if(m.transform){for(var U=(tt.getAttribute(X)||"").split(/\)\s*/g),nt=new g,ut=0,pt=U.length;ut<pt;ut++){var bt=U[ut];if(!bt)break;for(var ot=bt.split(/\(\s*/),xt=ot[0].trim(),yt=ot[1].split(/[\s,]+/g),At=0,Rt=yt.length;At<Rt;At++)yt[At]=parseFloat(yt[At]);switch(xt){case"matrix":nt.append(new g(yt[0],yt[1],yt[2],yt[3],yt[4],yt[5]));break;case"rotate":nt.rotate(yt[0],yt[1]||0,yt[2]||0);break;case"translate":nt.translate(yt[0],yt[1]||0);break;case"scale":nt.scale(yt);break;case"skewX":nt.skew(yt[0],0);break;case"skewY":nt.skew(0,yt[0]);break}}m.transform(nt)}}function C(m,F,X){var tt=X==="fill-opacity"?"getFillColor":"getStrokeColor",U=m[tt]&&m[tt]();U&&U.setAlpha(parseFloat(F))}var w=c.set(c.each(Qe,function(m){this[m.attribute]=function(F,X){if(F[m.set]&&(F[m.set](u(X,m.type,m.fromSVG)),m.type==="color")){var tt=F[m.get]();if(tt&&tt._scaleToBounds){var U=F.getBounds();tt.transform(new g().translate(U.getPoint()).scale(U.getSize()))}}}},{}),{id:function(m,F){t[F]=m,m.setName&&m.setName(F)},"clip-path":function(m,F){var X=j(F);if(X)if(X=X.clone(),X.setClipMask(!0),m instanceof wt)m.insertChild(0,X);else return new wt(X,m)},gradientTransform:I,transform:I,"fill-opacity":C,"stroke-opacity":C,visibility:function(m,F){m.setVisible&&m.setVisible(F==="visible")},display:function(m,F){m.setVisible&&m.setVisible(F!==null)},"stop-color":function(m,F){m.setColor&&m.setColor(F)},"stop-opacity":function(m,F){m._color&&m._color.setAlpha(parseFloat(F))},offset:function(m,F){if(m.setOffset){var X=F.match(/(.*)%$/);m.setOffset(X?X[1]/100:parseFloat(F))}},viewBox:function(m,F,X,tt,U){var nt=new H(u(F,"array")),ut=s(tt,null,null,!0),pt,bt;if(m instanceof wt){var ot=ut?ut.divide(nt.getSize()):1,bt=new g().scale(ot).translate(nt.getPoint().negate());pt=m}else m instanceof St&&(ut&&nt.setSize(ut),pt=m._item);if(pt){if(Y(tt,"overflow",U)!=="visible"){var xt=new rt.Rectangle(nt);xt.setClipMask(!0),pt.addChild(xt)}bt&&pt.transform(bt)}}});function Y(m,F,X){var tt=m.attributes[F],U=tt&&tt.value;if(!U&&m.style){var nt=c.camelize(F);U=m.style[nt],!U&&X.node[nt]!==X.parent[nt]&&(U=X.node[nt])}return U?U==="none"?null:U:J}function M(m,F,X){var tt=F.parentNode,U={node:Wt.getStyles(F)||{},parent:!X&&!/^defs$/i.test(tt.tagName)&&Wt.getStyles(tt)||{}};return c.each(w,function(nt,ut){var pt=Y(F,ut,U);m=pt!==J&&nt(m,pt,ut,F,U)||m}),m}function j(m){var F=m&&m.match(/\((?:["'#]*)([^"')]+)/),X=F&&F[1],tt=X&&t[et?X.replace(et.location.href.split("#")[0]+"#",""):X];return tt&&tt._scaleToBounds&&(tt=tt.clone(),tt._scaleToBounds=!0),tt}function k(m,F,X){var tt=m.nodeName.toLowerCase(),U=tt!=="#document",nt=z.body,ut,pt,bt;X&&U&&(e=_e.getView().getSize(),e=s(m,null,null,!0)||e,ut=Ae.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),pt=m.parentNode,bt=m.nextSibling,ut.appendChild(m),nt.appendChild(ut));var ot=_e.settings,xt=ot.applyMatrix,yt=ot.insertItems;ot.applyMatrix=!1,ot.insertItems=!1;var At=T[tt],Rt=At&&At(m,tt,F,X)||null;if(ot.insertItems=yt,ot.applyMatrix=xt,Rt){U&&!(Rt instanceof wt)&&(Rt=M(Rt,m,X));var Mt=F.onImport,jt=U&&m.getAttribute("data-paper-data");Mt&&(Rt=Mt(m,Rt,F)||Rt),F.expandShapes&&Rt instanceof rt&&(Rt.remove(),Rt=Rt.toPath()),jt&&(Rt._data=JSON.parse(jt))}return ut&&(nt.removeChild(ut),pt&&(bt?pt.insertBefore(m,bt):pt.appendChild(m))),X&&(t={},Rt&&c.pick(F.applyMatrix,xt)&&Rt.matrix.apply(!0,!0)),Rt}function V(m,F,X){if(!m)return null;F=typeof F=="function"?{onLoad:F}:F||{};var tt=_e,U=null;function nt(ot){try{var xt=typeof ot=="object"?ot:new W.DOMParser().parseFromString(ot.trim(),"image/svg+xml");if(!xt.nodeName)throw xt=null,new Error("Unsupported SVG source: "+m);_e=tt,U=k(xt,F,!0),(!F||F.insert!==!1)&&X._insertItem(J,U);var yt=F.onLoad;yt&&yt(U,ot)}catch(At){ut(At)}}function ut(ot,xt){var yt=F.onError;if(yt)yt(ot,xt);else throw new Error(ot)}if(typeof m=="string"&&!/^[\s\S]*</.test(m)){var pt=z.getElementById(m);pt?nt(pt):ti.request({url:m,async:!0,onLoad:nt,onError:ut})}else if(typeof File<"u"&&m instanceof File){var bt=new FileReader;return bt.onload=function(){nt(bt.result)},bt.onerror=function(){ut(bt.error)},bt.readAsText(m)}else nt(m);return U}f.inject({importSVG:function(m,F){return V(m,F,this)}}),K.inject({importSVG:function(m,F){return this.activate(),V(m,F,this)}})},c.exports.PaperScript=(function(){var t=this,e=t.acorn;if(!e&&typeof Mo<"u")try{e=Vo()}catch{}if(!e){var r,n;e=r=n={},(function(M,j){if(typeof r=="object"&&typeof n=="object")return j(r);if(typeof J=="function"&&J.amd)return J(["exports"],j);j(M.acorn||(M.acorn={}))})(this,function(M){M.version="0.5.0";var j,k,V,m;M.parse=function(vt,kt){return k=String(vt),V=k.length,X(kt),fr(),yi(j.program)};var F=M.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function X(vt){j=vt||{};for(var kt in F)Object.prototype.hasOwnProperty.call(j,kt)||(j[kt]=F[kt]);m=j.sourceFile||null}var tt=M.getLineInfo=function(vt,kt){for(var Gt=1,qt=0;;){qi.lastIndex=qt;var Se=qi.exec(vt);if(Se&&Se.index<kt)++Gt,qt=Se.index+Se[0].length;else break}return{line:Gt,column:kt-qt}};M.tokenize=function(vt,kt){k=String(vt),V=k.length,X(kt),fr();var Gt={};function qt(Se){return jt=ut,Wi(Se),Gt.start=nt,Gt.end=ut,Gt.startLoc=pt,Gt.endLoc=bt,Gt.type=ot,Gt.value=xt,Gt}return qt.jumpTo=function(Se,Pe){if(U=Se,j.locations){At=1,Rt=qi.lastIndex=0;for(var Ee;(Ee=qi.exec(k))&&Ee.index<Se;)++At,Rt=Ee.index+Ee[0].length}yt=Pe,Zi()},qt};var U,nt,ut,pt,bt,ot,xt,yt,At,Rt,Mt,jt,$t,ie,oe,zt;function Ht(vt,kt){var Gt=tt(k,vt);kt+=" ("+Gt.line+":"+Gt.column+")";var qt=new SyntaxError(kt);throw qt.pos=vt,qt.loc=Gt,qt.raisedAt=U,qt}var ne=[],ue={type:"num"},se={type:"regexp"},fe={type:"string"},de={type:"name"},ye={type:"eof"},Ce={keyword:"break"},ve={keyword:"case",beforeExpr:!0},Xe={keyword:"catch"},Be={keyword:"continue"},$e={keyword:"debugger"},We={keyword:"default"},Zt={keyword:"do",isLoop:!0},ze={keyword:"else",beforeExpr:!0},Ke={keyword:"finally"},Je={keyword:"for",isLoop:!0},ci={keyword:"function"},Ei={keyword:"if"},bi={keyword:"return",beforeExpr:!0},vi={keyword:"switch"},ai={keyword:"throw",beforeExpr:!0},fi={keyword:"try"},Ci={keyword:"var"},Me={keyword:"while",isLoop:!0},oi={keyword:"with"},tr={keyword:"new",beforeExpr:!0},Gi={keyword:"this"},er={keyword:"null",atomValue:null},ir={keyword:"true",atomValue:!0},hr={keyword:"false",atomValue:!1},Xi={keyword:"in",binop:7,beforeExpr:!0},Li={break:Ce,case:ve,catch:Xe,continue:Be,debugger:$e,default:We,do:Zt,else:ze,finally:Ke,for:Je,function:ci,if:Ei,return:bi,switch:vi,throw:ai,try:fi,var:Ci,while:Me,with:oi,null:er,true:ir,false:hr,new:tr,in:Xi,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Gi,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},Ui={type:"[",beforeExpr:!0},Ri={type:"]"},Oi={type:"{",beforeExpr:!0},xi={type:"}"},me={type:"(",beforeExpr:!0},wi={type:")"},Pi={type:",",beforeExpr:!0},Si={type:";",beforeExpr:!0},Mi={type:":",beforeExpr:!0},ji={type:"."},Fi={type:"?",beforeExpr:!0},rr={binop:10,beforeExpr:!0},i={isAssign:!0,beforeExpr:!0},o={isAssign:!0,beforeExpr:!0},E={postfix:!0,prefix:!0,isUpdate:!0},q={prefix:!0,beforeExpr:!0},ht={binop:1,beforeExpr:!0},Lt={binop:2,beforeExpr:!0},Ft={binop:3,beforeExpr:!0},Yt={binop:4,beforeExpr:!0},ae={binop:5,beforeExpr:!0},xe={binop:6,beforeExpr:!0},Te={binop:7,beforeExpr:!0},qe={binop:8,beforeExpr:!0},ei={binop:9,prefix:!0,beforeExpr:!0},Di={binop:10,beforeExpr:!0};M.tokTypes={bracketL:Ui,bracketR:Ri,braceL:Oi,braceR:xi,parenL:me,parenR:wi,comma:Pi,semi:Si,colon:Mi,dot:ji,question:Fi,slash:rr,eq:i,name:de,eof:ye,num:ue,regexp:se,string:fe};for(var mi in Li)M.tokTypes["_"+mi]=Li[mi];function Ti(vt){vt=vt.split(" ");var kt="",Gt=[];t:for(var qt=0;qt<vt.length;++qt){for(var Se=0;Se<Gt.length;++Se)if(Gt[Se][0].length==vt[qt].length){Gt[Se].push(vt[qt]);continue t}Gt.push([vt[qt]])}function Pe(He){if(He.length==1)return kt+="return str === "+JSON.stringify(He[0])+";";kt+="switch(str){";for(var Vi=0;Vi<He.length;++Vi)kt+="case "+JSON.stringify(He[Vi])+":";kt+="return true}return false;"}if(Gt.length>3){Gt.sort(function(He,Vi){return Vi.length-He.length}),kt+="switch(str.length){";for(var qt=0;qt<Gt.length;++qt){var Ee=Gt[qt];kt+="case "+Ee[0].length+":",Pe(Ee)}kt+="}"}else Pe(vt);return new Function("str",kt)}var Ni=Ti("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),zi=Ti("class enum extends super const export import"),fn=Ti("implements interface let package private protected public static yield"),Hi=Ti("eval arguments"),dn=Ti("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),pn=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,gn="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Nn="------------------------------------------------------------------------------------------------------------------------------------------",nr=new RegExp("["+gn+"]"),_n=new RegExp("["+gn+Nn+"]"),lr=/[\n\r\u2028\u2029]/,qi=/\r\n|[\n\r\u2028\u2029]/g,cr=M.isIdentifierStart=function(vt){return vt<65?vt===36:vt<91?!0:vt<97?vt===95:vt<123?!0:vt>=170&&nr.test(String.fromCharCode(vt))},vn=M.isIdentifierChar=function(vt){return vt<48?vt===36:vt<58?!0:vt<65?!1:vt<91?!0:vt<97?vt===95:vt<123?!0:vt>=170&&_n.test(String.fromCharCode(vt))};function Bi(){this.line=At,this.column=U-Rt}function fr(){At=1,U=Rt=0,yt=!0,Zi()}function ri(vt,kt){ut=U,j.locations&&(bt=new Bi),ot=vt,Zi(),xt=kt,yt=vt.beforeExpr}function Ln(){var vt=j.onComment&&j.locations&&new Bi,kt=U,Gt=k.indexOf("*/",U+=2);if(Gt===-1&&Ht(U-2,"Unterminated comment"),U=Gt+2,j.locations){qi.lastIndex=kt;for(var qt;(qt=qi.exec(k))&&qt.index<U;)++At,Rt=qt.index+qt[0].length}j.onComment&&j.onComment(!0,k.slice(kt+2,Gt),kt,U,vt,j.locations&&new Bi)}function vr(){for(var vt=U,kt=j.onComment&&j.locations&&new Bi,Gt=k.charCodeAt(U+=2);U<V&&Gt!==10&&Gt!==13&&Gt!==8232&&Gt!==8233;)++U,Gt=k.charCodeAt(U);j.onComment&&j.onComment(!1,k.slice(vt+2,U),vt,U,kt,j.locations&&new Bi)}function Zi(){for(;U<V;){var vt=k.charCodeAt(U);if(vt===32)++U;else if(vt===13){++U;var kt=k.charCodeAt(U);kt===10&&++U,j.locations&&(++At,Rt=U)}else if(vt===10||vt===8232||vt===8233)++U,j.locations&&(++At,Rt=U);else if(vt>8&&vt<14)++U;else if(vt===47){var kt=k.charCodeAt(U+1);if(kt===42)Ln();else if(kt===47)vr();else break}else if(vt===160)++U;else if(vt>=5760&&pn.test(String.fromCharCode(vt)))++U;else break}}function Mn(){var vt=k.charCodeAt(U+1);return vt>=48&&vt<=57?a(!0):(++U,ri(ji))}function mn(){var vt=k.charCodeAt(U+1);return yt?(++U,yn()):vt===61?ui(o,2):ui(rr,1)}function Fn(){var vt=k.charCodeAt(U+1);return vt===61?ui(o,2):ui(Di,1)}function Dn(vt){var kt=k.charCodeAt(U+1);return kt===vt?ui(vt===124?ht:Lt,2):kt===61?ui(o,2):ui(vt===124?Ft:ae,1)}function mr(){var vt=k.charCodeAt(U+1);return vt===61?ui(o,2):ui(Yt,1)}function Bn(vt){var kt=k.charCodeAt(U+1);return kt===vt?kt==45&&k.charCodeAt(U+2)==62&&lr.test(k.slice(jt,U))?(U+=3,vr(),Zi(),Wi()):ui(E,2):kt===61?ui(o,2):ui(ei,1)}function Vn(vt){var kt=k.charCodeAt(U+1),Gt=1;return kt===vt?(Gt=vt===62&&k.charCodeAt(U+2)===62?3:2,k.charCodeAt(U+Gt)===61?ui(o,Gt+1):ui(qe,Gt)):kt==33&&vt==60&&k.charCodeAt(U+2)==45&&k.charCodeAt(U+3)==45?(U+=4,vr(),Zi(),Wi()):(kt===61&&(Gt=k.charCodeAt(U+2)===61?3:2),ui(Te,Gt))}function Gn(vt){var kt=k.charCodeAt(U+1);return kt===61?ui(xe,k.charCodeAt(U+2)===61?3:2):ui(vt===61?i:q,1)}function dr(vt){switch(vt){case 46:return Mn();case 40:return++U,ri(me);case 41:return++U,ri(wi);case 59:return++U,ri(Si);case 44:return++U,ri(Pi);case 91:return++U,ri(Ui);case 93:return++U,ri(Ri);case 123:return++U,ri(Oi);case 125:return++U,ri(xi);case 58:return++U,ri(Mi);case 63:return++U,ri(Fi);case 48:var kt=k.charCodeAt(U+1);if(kt===120||kt===88)return bn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return a(!1);case 34:case 39:return _(vt);case 47:return mn();case 37:case 42:return Fn();case 124:case 38:return Dn(vt);case 94:return mr();case 43:case 45:return Bn(vt);case 60:case 62:return Vn(vt);case 61:case 33:return Gn(vt);case 126:return ui(q,1)}return!1}function Wi(vt){if(vt?U=nt+1:nt=U,j.locations&&(pt=new Bi),vt)return yn();if(U>=V)return ri(ye);var kt=k.charCodeAt(U);if(cr(kt)||kt===92)return _t();var Gt=dr(kt);if(Gt===!1){var qt=String.fromCharCode(kt);if(qt==="\\"||nr.test(qt))return _t();Ht(U,"Unexpected character '"+qt+"'")}return Gt}function ui(vt,kt){var Gt=k.slice(U,U+kt);U+=kt,ri(vt,Gt)}function yn(){for(var Se="",vt,kt,Gt=U;;){U>=V&&Ht(Gt,"Unterminated regular expression");var qt=k.charAt(U);if(lr.test(qt)&&Ht(Gt,"Unterminated regular expression"),vt)vt=!1;else{if(qt==="[")kt=!0;else if(qt==="]"&&kt)kt=!1;else if(qt==="/"&&!kt)break;vt=qt==="\\"}++U}var Se=k.slice(Gt,U);++U;var Pe=ft();Pe&&!/^[gmsiy]*$/.test(Pe)&&Ht(Gt,"Invalid regexp flag");try{var Ee=new RegExp(Se,Pe)}catch(He){He instanceof SyntaxError&&Ht(Gt,He.message),Ht(He)}return ri(se,Ee)}function Qi(vt,kt){for(var Gt=U,qt=0,Se=0,Pe=kt??1/0;Se<Pe;++Se){var Ee=k.charCodeAt(U),He;if(Ee>=97?He=Ee-97+10:Ee>=65?He=Ee-65+10:Ee>=48&&Ee<=57?He=Ee-48:He=1/0,He>=vt)break;++U,qt=qt*vt+He}return U===Gt||kt!=null&&U-Gt!==kt?null:qt}function bn(){U+=2;var vt=Qi(16);return vt==null&&Ht(nt+2,"Expected hexadecimal number"),cr(k.charCodeAt(U))&&Ht(U,"Identifier directly after number"),ri(ue,vt)}function a(vt){var kt=U,Gt=!1,qt=k.charCodeAt(U)===48;!vt&&Qi(10)===null&&Ht(kt,"Invalid number"),k.charCodeAt(U)===46&&(++U,Qi(10),Gt=!0);var Se=k.charCodeAt(U);(Se===69||Se===101)&&(Se=k.charCodeAt(++U),(Se===43||Se===45)&&++U,Qi(10)===null&&Ht(kt,"Invalid number"),Gt=!0),cr(k.charCodeAt(U))&&Ht(U,"Identifier directly after number");var Pe=k.slice(kt,U),Ee;return Gt?Ee=parseFloat(Pe):!qt||Pe.length===1?Ee=parseInt(Pe,10):/[89]/.test(Pe)||zt?Ht(kt,"Invalid number"):Ee=parseInt(Pe,8),ri(ue,Ee)}function _(vt){U++;for(var kt="";;){U>=V&&Ht(nt,"Unterminated string constant");var Gt=k.charCodeAt(U);if(Gt===vt)return++U,ri(fe,kt);if(Gt===92){Gt=k.charCodeAt(++U);var qt=/^[0-7]+/.exec(k.slice(U,U+3));for(qt&&(qt=qt[0]);qt&&parseInt(qt,8)>255;)qt=qt.slice(0,-1);if(qt==="0"&&(qt=null),++U,qt)zt&&Ht(U-2,"Octal literal in strict mode"),kt+=String.fromCharCode(parseInt(qt,8)),U+=qt.length-1;else switch(Gt){case 110:kt+=`
`;break;case 114:kt+="\r";break;case 120:kt+=String.fromCharCode(A(2));break;case 117:kt+=String.fromCharCode(A(4));break;case 85:kt+=String.fromCharCode(A(8));break;case 116:kt+="	";break;case 98:kt+="\b";break;case 118:kt+="\v";break;case 102:kt+="\f";break;case 48:kt+="\0";break;case 13:k.charCodeAt(U)===10&&++U;case 10:j.locations&&(Rt=U,++At);break;default:kt+=String.fromCharCode(Gt);break}}else(Gt===13||Gt===10||Gt===8232||Gt===8233)&&Ht(nt,"Unterminated string constant"),kt+=String.fromCharCode(Gt),++U}}function A(vt){var kt=Qi(16,vt);return kt===null&&Ht(nt,"Bad character escape sequence"),kt}var $;function ft(){$=!1;for(var vt,kt=!0,Gt=U;;){var qt=k.charCodeAt(U);if(vn(qt))$&&(vt+=k.charAt(U)),++U;else if(qt===92){$||(vt=k.slice(Gt,U)),$=!0,k.charCodeAt(++U)!=117&&Ht(U,"Expecting Unicode escape sequence \\uXXXX"),++U;var Se=A(4),Pe=String.fromCharCode(Se);Pe||Ht(U-1,"Invalid Unicode escape"),(kt?cr(Se):vn(Se))||Ht(U-4,"Invalid Unicode escape"),vt+=Pe}else break;kt=!1}return $?vt:k.slice(Gt,U)}function _t(){var vt=ft(),kt=de;return!$&&dn(vt)&&(kt=Li[vt]),ri(kt,vt)}function lt(){Mt=nt,jt=ut,$t=bt,Wi()}function Et(vt){if(zt=vt,U=nt,j.locations)for(;U<Rt;)Rt=k.lastIndexOf(`
`,Rt-2)+1,--At;Zi(),Wi()}function Bt(){this.type=null,this.start=nt,this.end=null}function Jt(){this.start=pt,this.end=null,m!==null&&(this.source=m)}function te(){var vt=new Bt;return j.locations&&(vt.loc=new Jt),j.directSourceFile&&(vt.sourceFile=j.directSourceFile),j.ranges&&(vt.range=[nt,0]),vt}function pe(vt){var kt=new Bt;return kt.start=vt.start,j.locations&&(kt.loc=new Jt,kt.loc.start=vt.loc.start),j.ranges&&(kt.range=[vt.range[0],0]),kt}function ee(vt,kt){return vt.type=kt,vt.end=jt,j.locations&&(vt.loc.end=$t),j.ranges&&(vt.range[1]=jt),vt}function he(vt){return j.ecmaVersion>=5&&vt.type==="ExpressionStatement"&&vt.expression.type==="Literal"&&vt.expression.value==="use strict"}function le(vt){if(ot===vt)return lt(),!0}function Ie(){return!j.strictSemicolons&&(ot===ye||ot===xi||lr.test(k.slice(jt,nt)))}function Ge(){!le(Si)&&!Ie()&&Ye()}function ke(vt){ot===vt?lt():Ye()}function Ye(){Ht(nt,"Unexpected token")}function pi(vt){vt.type!=="Identifier"&&vt.type!=="MemberExpression"&&Ht(vt.start,"Assigning to rvalue"),zt&&vt.type==="Identifier"&&Hi(vt.name)&&Ht(vt.start,"Assigning to "+vt.name+" in strict mode")}function yi(vt){Mt=jt=U,j.locations&&($t=new Bi),ie=zt=null,oe=[],Wi();var kt=vt||te(),Gt=!0;for(vt||(kt.body=[]);ot!==ye;){var qt=hi();kt.body.push(qt),Gt&&he(qt)&&Et(!0),Gt=!1}return ee(kt,"Program")}var Fe={kind:"loop"},li={kind:"switch"};function hi(){(ot===rr||ot===o&&xt=="/=")&&Wi(!0);var vt=ot,kt=te();switch(vt){case Ce:case Be:lt();var Gt=vt===Ce;le(Si)||Ie()?kt.label=null:ot!==de?Ye():(kt.label=Ji(),Ge());for(var qt=0;qt<oe.length;++qt){var Se=oe[qt];if((kt.label==null||Se.name===kt.label.name)&&(Se.kind!=null&&(Gt||Se.kind==="loop")||kt.label&&Gt))break}return qt===oe.length&&Ht(kt.start,"Unsyntactic "+vt.keyword),ee(kt,Gt?"BreakStatement":"ContinueStatement");case $e:return lt(),Ge(),ee(kt,"DebuggerStatement");case Zt:return lt(),oe.push(Fe),kt.body=hi(),oe.pop(),ke(Me),kt.test=sr(),Ge(),ee(kt,"DoWhileStatement");case Je:if(lt(),oe.push(Fe),ke(me),ot===Si)return yr(kt,null);if(ot===Ci){var Pe=te();return lt(),wn(Pe,!0),ee(Pe,"VariableDeclaration"),Pe.declarations.length===1&&le(Xi)?xn(kt,Pe):yr(kt,Pe)}var Pe=ni(!1,!0);return le(Xi)?(pi(Pe),xn(kt,Pe)):yr(kt,Pe);case ci:return lt(),qn(kt,!0);case Ei:return lt(),kt.test=sr(),kt.consequent=hi(),kt.alternate=le(ze)?hi():null,ee(kt,"IfStatement");case bi:return!ie&&!j.allowReturnOutsideFunction&&Ht(nt,"'return' outside of function"),lt(),le(Si)||Ie()?kt.argument=null:(kt.argument=ni(),Ge()),ee(kt,"ReturnStatement");case vi:lt(),kt.discriminant=sr(),kt.cases=[],ke(Oi),oe.push(li);for(var Ee,He;ot!=xi;)if(ot===ve||ot===We){var Vi=ot===ve;Ee&&ee(Ee,"SwitchCase"),kt.cases.push(Ee=te()),Ee.consequent=[],lt(),Vi?Ee.test=ni():(He&&Ht(Mt,"Multiple default clauses"),He=!0,Ee.test=null),ke(Mi)}else Ee||Ye(),Ee.consequent.push(hi());return Ee&&ee(Ee,"SwitchCase"),lt(),oe.pop(),ee(kt,"SwitchStatement");case ai:return lt(),lr.test(k.slice(jt,nt))&&Ht(jt,"Illegal newline after throw"),kt.argument=ni(),Ge(),ee(kt,"ThrowStatement");case fi:if(lt(),kt.block=ar(),kt.handler=null,ot===Xe){var or=te();lt(),ke(me),or.param=Ji(),zt&&Hi(or.param.name)&&Ht(or.param.start,"Binding "+or.param.name+" in strict mode"),ke(wi),or.guard=null,or.body=ar(),kt.handler=ee(or,"CatchClause")}return kt.guardedHandlers=ne,kt.finalizer=le(Ke)?ar():null,!kt.handler&&!kt.finalizer&&Ht(kt.start,"Missing catch or finally clause"),ee(kt,"TryStatement");case Ci:return lt(),wn(kt),Ge(),ee(kt,"VariableDeclaration");case Me:return lt(),kt.test=sr(),oe.push(Fe),kt.body=hi(),oe.pop(),ee(kt,"WhileStatement");case oi:return zt&&Ht(nt,"'with' in strict mode"),lt(),kt.object=sr(),kt.body=hi(),ee(kt,"WithStatement");case Oi:return ar();case Si:return lt(),ee(kt,"EmptyStatement");default:var Kn=xt,Sn=ni();if(vt===de&&Sn.type==="Identifier"&&le(Mi)){for(var qt=0;qt<oe.length;++qt)oe[qt].name===Kn&&Ht(Sn.start,"Label '"+Kn+"' is already declared");var ja=ot.isLoop?"loop":ot===vi?"switch":null;return oe.push({name:Kn,kind:ja}),kt.body=hi(),oe.pop(),kt.label=Sn,ee(kt,"LabeledStatement")}else return kt.expression=Sn,Ge(),ee(kt,"ExpressionStatement")}}function sr(){ke(me);var vt=ni();return ke(wi),vt}function ar(vt){var kt=te(),Gt=!0,qt=!1,Se;for(kt.body=[],ke(Oi);!le(xi);){var Pe=hi();kt.body.push(Pe),Gt&&vt&&he(Pe)&&(Se=qt,Et(qt=!0)),Gt=!1}return qt&&!Se&&Et(!1),ee(kt,"BlockStatement")}function yr(vt,kt){return vt.init=kt,ke(Si),vt.test=ot===Si?null:ni(),ke(Si),vt.update=ot===wi?null:ni(),ke(wi),vt.body=hi(),oe.pop(),ee(vt,"ForStatement")}function xn(vt,kt){return vt.left=kt,vt.right=ni(),ke(wi),vt.body=hi(),oe.pop(),ee(vt,"ForInStatement")}function wn(vt,kt){for(vt.declarations=[],vt.kind="var";;){var Gt=te();if(Gt.id=Ji(),zt&&Hi(Gt.id.name)&&Ht(Gt.id.start,"Binding "+Gt.id.name+" in strict mode"),Gt.init=le(i)?ni(!0,kt):null,vt.declarations.push(ee(Gt,"VariableDeclarator")),!le(Pi))break}return vt}function ni(vt,kt){var Gt=Un(kt);if(!vt&&ot===Pi){var qt=pe(Gt);for(qt.expressions=[Gt];le(Pi);)qt.expressions.push(Un(kt));return ee(qt,"SequenceExpression")}return Gt}function Un(vt){var kt=Va(vt);if(ot.isAssign){var Gt=pe(kt);return Gt.operator=xt,Gt.left=kt,lt(),Gt.right=Un(vt),pi(kt),ee(Gt,"AssignmentExpression")}return kt}function Va(vt){var kt=Ga(vt);if(le(Fi)){var Gt=pe(kt);return Gt.test=kt,Gt.consequent=ni(!0),ke(Mi),Gt.alternate=ni(!0,vt),ee(Gt,"ConditionalExpression")}return kt}function Ga(vt){return zn(Hn(),-1,vt)}function zn(vt,kt,Gt){var qt=ot.binop;if(qt!=null&&(!Gt||ot!==Xi)&&qt>kt){var Se=pe(vt);Se.left=vt,Se.operator=xt;var Pe=ot;lt(),Se.right=zn(Hn(),qt,Gt);var Ee=ee(Se,Pe===ht||Pe===Lt?"LogicalExpression":"BinaryExpression");return zn(Ee,kt,Gt)}return vt}function Hn(){if(ot.prefix){var vt=te(),kt=ot.isUpdate;return vt.operator=xt,vt.prefix=!0,yt=!0,lt(),vt.argument=Hn(),kt?pi(vt.argument):zt&&vt.operator==="delete"&&vt.argument.type==="Identifier"&&Ht(vt.start,"Deleting local variable in strict mode"),ee(vt,kt?"UpdateExpression":"UnaryExpression")}for(var Gt=Ua();ot.postfix&&!Ie();){var vt=pe(Gt);vt.operator=xt,vt.prefix=!1,vt.argument=Gt,pi(Gt),lt(),Gt=ee(vt,"UpdateExpression")}return Gt}function Ua(){return br(jn())}function br(vt,kt){if(le(ji)){var Gt=pe(vt);return Gt.object=vt,Gt.property=Ji(!0),Gt.computed=!1,br(ee(Gt,"MemberExpression"),kt)}else if(le(Ui)){var Gt=pe(vt);return Gt.object=vt,Gt.property=ni(),Gt.computed=!0,ke(Ri),br(ee(Gt,"MemberExpression"),kt)}else if(!kt&&le(me)){var Gt=pe(vt);return Gt.callee=vt,Gt.arguments=Wn(wi,!1),br(ee(Gt,"CallExpression"),kt)}else return vt}function jn(){switch(ot){case Gi:var qt=te();return lt(),ee(qt,"ThisExpression");case de:return Ji();case ue:case fe:case se:var qt=te();return qt.value=xt,qt.raw=k.slice(nt,ut),lt(),ee(qt,"Literal");case er:case ir:case hr:var qt=te();return qt.value=ot.atomValue,qt.raw=ot.keyword,lt(),ee(qt,"Literal");case me:var vt=pt,kt=nt;lt();var Gt=ni();return Gt.start=kt,Gt.end=ut,j.locations&&(Gt.loc.start=vt,Gt.loc.end=bt),j.ranges&&(Gt.range=[kt,ut]),ke(wi),Gt;case Ui:var qt=te();return lt(),qt.elements=Wn(Ri,!0,!0),ee(qt,"ArrayExpression");case Oi:return Ha();case ci:var qt=te();return lt(),qn(qt,!1);case tr:return za();default:Ye()}}function za(){var vt=te();return lt(),vt.callee=br(jn(),!0),le(me)?vt.arguments=Wn(wi,!1):vt.arguments=ne,ee(vt,"NewExpression")}function Ha(){var vt=te(),kt=!0,Gt=!1;for(vt.properties=[],lt();!le(xi);){if(kt)kt=!1;else if(ke(Pi),j.allowTrailingCommas&&le(xi))break;var qt={key:ds()},Se=!1,Pe;if(le(Mi)?(qt.value=ni(!0),Pe=qt.kind="init"):j.ecmaVersion>=5&&qt.key.type==="Identifier"&&(qt.key.name==="get"||qt.key.name==="set")?(Se=Gt=!0,Pe=qt.kind=qt.key.name,qt.key=ds(),ot!==me&&Ye(),qt.value=qn(te(),!1)):Ye(),qt.key.type==="Identifier"&&(zt||Gt))for(var Ee=0;Ee<vt.properties.length;++Ee){var He=vt.properties[Ee];if(He.key.name===qt.key.name){var Vi=Pe==He.kind||Se&&He.kind==="init"||Pe==="init"&&(He.kind==="get"||He.kind==="set");Vi&&!zt&&Pe==="init"&&He.kind==="init"&&(Vi=!1),Vi&&Ht(qt.key.start,"Redefinition of property")}}vt.properties.push(qt)}return ee(vt,"ObjectExpression")}function ds(){return ot===ue||ot===fe?jn():Ji(!0)}function qn(vt,kt){ot===de?vt.id=Ji():kt?Ye():vt.id=null,vt.params=[];var Gt=!0;for(ke(me);!le(wi);)Gt?Gt=!1:ke(Pi),vt.params.push(Ji());var qt=ie,Se=oe;if(ie=!0,oe=[],vt.body=ar(!0),ie=qt,oe=Se,zt||vt.body.body.length&&he(vt.body.body[0]))for(var Pe=vt.id?-1:0;Pe<vt.params.length;++Pe){var Ee=Pe<0?vt.id:vt.params[Pe];if((fn(Ee.name)||Hi(Ee.name))&&Ht(Ee.start,"Defining '"+Ee.name+"' in strict mode"),Pe>=0)for(var He=0;He<Pe;++He)Ee.name===vt.params[He].name&&Ht(Ee.start,"Argument name clash in strict mode")}return ee(vt,kt?"FunctionDeclaration":"FunctionExpression")}function Wn(vt,kt,Gt){for(var qt=[],Se=!0;!le(vt);){if(Se)Se=!1;else if(ke(Pi),kt&&j.allowTrailingCommas&&le(vt))break;Gt&&ot===Pi?qt.push(null):qt.push(ni(!0))}return qt}function Ji(vt){var kt=te();return vt&&j.forbidReserved=="everywhere"&&(vt=!1),ot===de?(!vt&&(j.forbidReserved&&(j.ecmaVersion===3?Ni:zi)(xt)||zt&&fn(xt))&&k.slice(nt,ut).indexOf("\\")==-1&&Ht(nt,"The keyword '"+xt+"' is reserved"),kt.name=xt):vt&&ot.keyword?kt.name=ot.keyword:Ye(),yt=!1,lt(),ee(kt,"Identifier")}}),e.version||(e=null)}function s(M,j){return(t.acorn||e).parse(M,j)}var u={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},h={"-":"__negate","+":"__self"},l=c.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(M){this["__"+M]="#"+M},{__self:function(){return this}});d.inject(l),S.inject(l),Xt.inject(l);function p(M,j,k){var V=u[j];if(M&&M[V]){var m=M[V](k);return j==="!="?!m:m}switch(j){case"+":return M+k;case"-":return M-k;case"*":return M*k;case"/":return M/k;case"%":return M%k;case"==":return M==k;case"!=":return M!=k}}function v(M,j){var k=h[M];if(j&&j[k])return j[k]();switch(M){case"+":return+j;case"-":return-j}}function T(M,j){if(!M)return"";j=j||{};var k=[];function V(zt){for(var Ht=0,ne=k.length;Ht<ne;Ht++){var ue=k[Ht];if(ue[0]>=zt)break;zt+=ue[1]}return zt}function m(zt){return M.substring(V(zt.range[0]),V(zt.range[1]))}function F(zt,Ht){return M.substring(V(zt.range[1]),V(Ht.range[0]))}function X(zt,Ht){for(var ne=V(zt.range[0]),ue=V(zt.range[1]),se=0,fe=k.length-1;fe>=0;fe--)if(ne>k[fe][0]){se=fe+1;break}k.splice(se,0,[ne,Ht.length-ue+ne]),M=M.substring(0,ne)+Ht+M.substring(ue)}function tt(zt,Ht){switch(zt.type){case"UnaryExpression":if(zt.operator in h&&zt.argument.type!=="Literal"){var ne=m(zt.argument);X(zt,'$__("'+zt.operator+'", '+ne+")")}break;case"BinaryExpression":if(zt.operator in u&&zt.left.type!=="Literal"){var ue=m(zt.left),se=m(zt.right),fe=F(zt.left,zt.right),de=zt.operator;X(zt,"__$__("+ue+","+fe.replace(new RegExp("\\"+de),'"'+de+'"')+", "+se+")")}break;case"UpdateExpression":case"AssignmentExpression":var ye=Ht&&Ht.type;if(!(ye==="ForStatement"||ye==="BinaryExpression"&&/^[=!<>]/.test(Ht.operator)||ye==="MemberExpression"&&Ht.computed)){if(zt.type==="UpdateExpression"){var ne=m(zt.argument),Ce="__$__("+ne+', "'+zt.operator[0]+'", 1)',ve=ne+" = "+Ce;zt.prefix?ve="("+ve+")":(ye==="AssignmentExpression"||ye==="VariableDeclarator"||ye==="BinaryExpression")&&(m(Ht.left||Ht.id)===ne&&(ve=Ce),ve=ne+"; "+ve),X(zt,ve)}else if(/^.=$/.test(zt.operator)&&zt.left.type!=="Literal"){var ue=m(zt.left),se=m(zt.right),Ce=ue+" = __$__("+ue+', "'+zt.operator[0]+'", '+se+")";X(zt,/^\(.*\)$/.test(m(zt))?"("+Ce+")":Ce)}}break}}function U(zt){switch(zt.type){case"ExportDefaultDeclaration":X({range:[zt.start,zt.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var Ht=zt.declaration,ne=zt.specifiers;if(Ht){var ue=Ht.declarations;ue&&(ue.forEach(function(fe){X(fe,"module.exports."+m(fe))}),X({range:[zt.start,Ht.start+Ht.kind.length]},""))}else if(ne){var se=ne.map(function(fe){var de=m(fe);return"module.exports."+de+" = "+de+"; "}).join("");se&&X(zt,se)}break}}function nt(zt,Ht,ne){if(zt){for(var ue in zt)if(ue!=="range"&&ue!=="loc"){var se=zt[ue];if(Array.isArray(se))for(var fe=0,de=se.length;fe<de;fe++)nt(se[fe],zt,ne);else se&&typeof se=="object"&&nt(se,zt,ne)}ne.operatorOverloading!==!1&&tt(zt,Ht),ne.moduleExports!==!1&&U(zt)}}function ut(zt){var Ht="",ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(zt=(Math.abs(zt)<<1)+(zt<0?1:0);zt||!Ht;){var ue=zt&31;zt>>=5,zt&&(ue|=32),Ht+=ne[ue]}return Ht}var pt=j.url||"",bt=j.sourceMaps,ot=j.paperFeatures||{},xt=j.source||M,yt=j.offset||0,At=_e.agent,Rt=At.versionNumber,Mt=!1,jt=/\r\n|\n|\r/mg,$t;if(bt&&(At.chrome&&Rt>=30||At.webkit&&Rt>=537.76||At.firefox&&Rt>=23||At.node)){if(At.node)yt-=2;else if(et&&pt&&!et.location.href.indexOf(pt)){var ie=z.getElementsByTagName("html")[0].innerHTML;yt=ie.substr(0,ie.indexOf(M)+1).match(jt).length+1}Mt=yt>0&&!(At.chrome&&Rt>=36||At.safari&&Rt>=600||At.firefox&&Rt>=40||At.node);var oe=["AA"+ut(Mt?0:yt)+"A"];oe.length=(M.match(jt)||[]).length+1+(Mt?yt:0),$t={version:3,file:pt,names:[],mappings:oe.join(";AACA"),sourceRoot:"",sources:[pt],sourcesContent:[xt]}}return(ot.operatorOverloading!==!1||ot.moduleExports!==!1)&&nt(s(M,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,ot),$t&&(Mt&&(M=new Array(yt+1).join(`
`)+M),/^(inline|both)$/.test(bt)&&(M+=`
//# sourceMappingURL=data:application/json;base64,`+W.btoa(unescape(encodeURIComponent(JSON.stringify($t))))),M+=`
//# sourceURL=`+(pt||"paperscript")),{url:pt,source:xt,code:M,map:$t}}function I(M,j,k){_e=j;var V=j.getView(),m=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(M)&&!/\bnew\s+Tool\b/.test(M)?new Ue:null,F=m?m._events:[],X=["onFrame","onResize"].concat(F),tt=[],U=[],nt,ut=typeof M=="object"?M:T(M,k);M=ut.code;function pt(Rt,Mt){for(var jt in Rt)(Mt||!/^_/.test(jt))&&new RegExp("([\\b\\s\\W]|^)"+jt.replace(/\$/g,"\\$")+"\\b").test(M)&&(tt.push(jt),U.push(Rt[jt]))}pt({__$__:p,$__:v,paper:j,tool:m},!0),pt(j),M="var module = { exports: {} }; "+M;var yt=c.each(X,function(Rt){new RegExp("\\s+"+Rt+"\\b").test(M)&&(tt.push(Rt),this.push("module.exports."+Rt+" = "+Rt+";"))},[]).join(`
`);yt&&(M+=`
`+yt),M+=`
return module.exports;`;var bt=_e.agent;if(z&&(bt.chrome||bt.firefox&&bt.versionNumber<40)){var ot=z.createElement("script"),xt=z.head||z.getElementsByTagName("head")[0];bt.firefox&&(M=`
`+M),ot.appendChild(z.createTextNode("document.__paperscript__ = function("+tt+") {"+M+`
}`)),xt.appendChild(ot),nt=z.__paperscript__,delete z.__paperscript__,xt.removeChild(ot)}else nt=Function(tt,M);var yt=nt&&nt.apply(j,U),At=yt||{};return c.each(F,function(Rt){var Mt=At[Rt];Mt&&(m[Rt]=Mt)}),V&&(At.onResize&&V.setOnResize(At.onResize),V.emit("resize",{size:V.size,delta:new d}),At.onFrame&&V.setOnFrame(At.onFrame),V.requestUpdate()),yt}function C(M){if(/^text\/(?:x-|)paperscript$/.test(M.type)&&x.getAttribute(M,"ignore")!=="true"){var j=x.getAttribute(M,"canvas"),k=z.getElementById(j),V=M.src||M.getAttribute("data-src"),m=x.hasAttribute(M,"async"),F="data-paper-scope";if(!k)throw new Error('Unable to find canvas with id "'+j+'"');var X=x.get(k.getAttribute(F))||new x().setup(k);return k.setAttribute(F,X._id),V?ti.request({url:V,async:m,mimeType:"text/plain",onLoad:function(tt){I(tt,X,V)}}):I(M.innerHTML,X,M.baseURI),M.setAttribute("data-paper-ignore","true"),X}}function w(){c.each(z&&z.getElementsByTagName("script"),C)}function Y(M){return M?C(M):w()}return et&&(z.readyState==="complete"?setTimeout(w):Qt.add(et,{load:w})),{compile:T,execute:I,load:Y,parse:s,calculateBinary:p,calculateUnary:v}}).call(this);var _e=new(x.inject(c.exports,{Base:c,Numerical:Z,Key:ge,DomEvent:Qt,DomElement:Wt,document:z,window:et,Symbol:St,PlacedSymbol:gt}));return _e.agent.node&&va(_e),typeof J=="function"&&J.amd?J("paper",_e):b&&(b.exports=_e),_e}).call(Go,typeof self=="object"?self:null)})(kn)),kn.exports}var zo=Uo();const je=Aa(zo);function ba(b,W,J,et){var z=b.curve===W,c=W.getNormalAtTime(z?0:1).multiply(et),O=b.point.add(c),x=new je.Segment(O),D=z?"handleOut":"handleIn";return x[D]=b[D].add(J.subtract(c).divide(2)),x}function os(b,W){var J=new je.Curve(b.segment1.handleOut.add(b.segment1.point),new je.Point(0,0),new je.Point(0,0),b.segment2.handleIn.add(b.segment2.point)).getNormalAtTime(.5).multiply(W),et=ba(b.segment1,b,J,W),z=ba(b.segment2,b,J,W),c=new je.Curve(et,z);if(c.getIntersections(c).length===0){var O=Math.min(Math.abs(W)/10,1),x=c.getPointAtTime(.5).getDistance(b.getPointAtTime(.5));if(Math.abs(x-Math.abs(W))>O){var D=b.divideAtTime(.5);if(D!=null)return os(b,W).concat(os(D,W))}}return[et,z]}function Ho(b,W,J,et){var z=b.point.subtract(J).add(W.point.subtract(J)).normalize(Math.abs(et)).add(J),c=new je.Path.Arc({from:b.point,to:W.point,through:z,insert:!1});return b.handleOut=c.firstSegment.handleOut,W.handleIn=c.lastSegment.handleIn,c.segments.length===3?c.segments[1]:null}function rs(b,W){return b.x*W.y-b.y*W.x}function jo(b,W,J,et){var z=b.subtract(W),c=J.subtract(et),O=rs(b,W),x=rs(J,et);return new je.Point(O*c.x-z.x*x,O*c.y-z.y*x).divide(rs(z,c))}function xa(b,W,J,et,z,c){var O=new je.Curve(b[0],b[1]),x=new je.Curve(W[0],W[1]),D=O.getIntersections(x),N=b[1].point.getDistance(W[0].point);if(J.isSmooth())W[0].handleOut=W[0].handleOut.project(J.handleOut),W[0].handleIn=b[1].handleIn.project(J.handleIn),W[0].point=b[1].point.add(W[0].point).divide(2),b.pop();else if(D.length===0)if(N>Math.abs(z)*.1)switch(et){case"miter":var B=jo(O.point2,O.point2.add(O.getTangentAtTime(1)),x.point1,x.point1.add(x.getTangentAtTime(0))),Z=Math.max(B.getDistance(O.point2),B.getDistance(x.point1));Z<Math.abs(z)*c&&b.push(new je.Segment(B));break;case"round":var G=Ho(b[1],W[0],J.point,z);G&&b.push(G);break}else W[0].handleIn=b[1].handleIn,b.pop();else{var d=O.divideAt(D[0]);if(d){var B=d.segment1,y=x.divideAt(x.getIntersections(O)[0]);B.handleOut=y?y.segment1.handleOut:W[0].handleOut,b.pop(),W[0]=B}else W[0].handleIn=b[1].handleIn,b.pop()}}function qo(b,W,J,et,z){for(var c=J.segments,O=b[0].slice(),x=0;x<b.length-1;++x)xa(b[x],b[x+1],c[x+1],W,et,z);return J.closed&&(xa(b[b.length-1],O,c[0],W,et,z),b[0][0]=O[0]),b}function Ma(b){return b.children.length===1&&(b=b.children[0],b.remove()),b}function Fa(b,W){if(W===void 0&&(W=.01),b.closed){var J=Math.abs(b.area*W);if(b.clockwise||b.reverse(),b=b.unite(b,{insert:!1}),b instanceof je.CompoundPath&&(b.children.filter(function(et){return Math.abs(et.area)<J}).forEach(function(et){return et.remove()}),b.children.length===1))return Ma(b)}return b}function Da(b,W){var J=b.segments[0].location.offset,et=b.segments[Math.max(1,Math.floor(b.segments.length/2))].location.offset,z=(J+et)/3,c=W.getNearestLocation(b.getPointAt(z)).offset,O=W.getNearestLocation(b.getPointAt(2*z)).offset;return c<O}function Wo(b){if(b.closed){var W=b.unite(b,{insert:!1});if(W instanceof je.CompoundPath)return W.children.filter(function(J){return J.segments.length>1?!Da(J,b):!0}).forEach(function(J){return J.remove()}),Ma(W)}return b}function Ko(b){return b instanceof je.CompoundPath?b.children.map(function(W){return W.segments}).flat():b.segments}function Yo(b,W){var J=Ko(b).slice();J.forEach(function(et){W.contains(et.point)||et.remove()})}function Xo(b,W){var J=b.clone({insert:!1});return J.reduce({}),b.clockwise||(J.reverse(),W=-W),[J,W]}function Tn(b,W,J,et){var z,c;z=Xo(b,W),c=z[0],W=z[1];for(var O=c.curves.slice(),x=O.map(function(G){return os(G,W)}).flat(),D=[],N=0;N<x.length;N+=2)D.push(x.slice(N,N+2));var B=qo(D,J,c,W,et).flat(),Z=Wo(new je.Path({segments:B,insert:!1,closed:b.closed}));return Z.reduce({}),c.closed&&(c.clockwise&&W<0||!c.clockwise&&W>0)&&Yo(Z,b),c.clockwise!==b.clockwise&&Z.reverse(),Fa(Z)}function wa(b,W,J){var et=b.point.add(W.point).divide(2),z=W.point.subtract(b.point).rotate(-90,new je.Point(0,0)).normalize(J),c=et.add(z),O=new je.Path.Arc({from:b.point,to:W.point,through:c,insert:!1});return O.segments}function Zo(b,W,J,et){if(b instanceof je.CompoundPath){var z=b.children.map(function(B){return{c:B,a:Math.abs(B.area)}});z=z.sort(function(B,Z){return Z.a-B.a}),b=z[0].c}var c=b.segments.slice(),O=W.segments.slice();switch(et){case"round":var x=wa(O[O.length-1],c[0],J),D=wa(c[c.length-1],O[0],J),N=new je.Path({segments:x.concat(c,D,O),closed:!0,insert:!1});return N.reduce({}),N;default:return new je.Path({segments:c.concat(O),closed:!0,insert:!1})}}function Sa(b,W,J,et,z){W=b.clockwise?W:-W;var c=Tn(b,W,J,z),O=Tn(b,-W,J,z);if(b.closed)return c.subtract(O,{insert:!1});var x=O,D=new Array;O instanceof je.CompoundPath&&(D=O.children.filter(function(d){return d.closed}),D.forEach(function(d){return d.remove()}),x=O.children[0]),x.reverse();var N=Zo(c,x,W,et);if(D.length>0)for(var B=0,Z=D;B<Z.length;B++){var G=Z[B];N=N.subtract(G,{insert:!1})}return N}function Ba(b){return b.closed?b.unite(b,{insert:!1}):b}function Qo(b,W,J,et){var z=Ba(b),c=z;if(z instanceof je.Path)c=Tn(z,W,J,et);else{var O=z.children.map(function(D){if(D.segments.length>1){Da(D,b)||D.reverse();var N=Tn(D,W,J,et);return N=Fa(N),N.clockwise!==D.clockwise&&N.reverse(),N instanceof je.CompoundPath?(N.applyMatrix=!0,N.children):N}else return null}),x=O.flat().filter(function(D){return!!D});c=new je.CompoundPath({children:x,insert:!1})}return c.copyAttributes(z,!1),c.remove(),c}function Jo(b,W,J,et,z){var c=Ba(b),O=c;if(c instanceof je.Path)O=Sa(c,W,J,et,z);else{var x=c.children.flatMap(function(D){return Sa(D,W,J,et,z)});O=x.reduce(function(D,N){return D.unite(N,{insert:!1})})}return O.strokeWidth=0,O.fillColor=c.strokeColor,O.shadowBlur=c.shadowBlur,O.shadowColor=c.shadowColor,O.shadowOffset=c.shadowOffset,O}var us=(function(){function b(){}return b.offset=function(W,J,et){et=et||{};var z=Qo(W,J,et.join||"miter",et.limit||10);return et.insert===void 0&&(et.insert=!0),et.insert&&(W.parent||je.project.activeLayer).addChild(z),z},b.offsetStroke=function(W,J,et){et=et||{};var z=Jo(W,J,et.join||"miter",et.cap||"butt",et.limit||10);return et.insert===void 0&&(et.insert=!0),et.insert&&(W.parent||je.project.activeLayer).addChild(z),z},b})();async function $o(){const W=await(await fetch("wall.svg")).text(),z=new DOMParser().parseFromString(W,"image/svg+xml").querySelectorAll("path"),c=[],O=new Ii.Group,x=document.createElement("canvas");je.setup(x),z.forEach((N,B)=>{const Z=je.project.importSVG(N),G=us.offset(Z,22,{miterLimit:10}).pathData,d=N.getAttribute("fill")||"white",y=N.getAttribute("stroke")||"black",S=parseFloat(N.getAttribute("stroke-width")||1),R=new Ii.Path({id:`${B}`,data:G,fill:d,stroke:y,strokeWidth:S,draggable:!0}),H=R.getClientRect({skipTransform:!0}),P=H.x+H.width/2,g=H.y+H.height/2,L=P-R.x(),K=g-R.y();R.offsetX(L),R.offsetY(K),R.x(R.x()+L),R.y(R.y()+K),O.add(R),c.push(R)}),z.forEach((N,B)=>{const Z=je.project.importSVG(N),G=us.offset(Z,0,{miterLimit:10}).pathData,d=N.getAttribute("fill")||"white",y=N.getAttribute("stroke")||"black",S=parseFloat(N.getAttribute("stroke-width")||1),R=new Ii.Path({id:`${B}`,data:G,fill:d,stroke:y,strokeWidth:S,draggable:!0}),H=R.getClientRect({skipTransform:!0}),P=H.x+H.width/2,g=H.y+H.height/2,L=P-R.x(),K=g-R.y();R.offsetX(L),R.offsetY(K),R.x(R.x()+L),R.y(R.y()+K),O.add(R),c.push(R)});const D=c.map(N=>({node:N,id:N.id(),progress:0,direction:Math.random()<.5?1:-1}));return O.width(gi.wallWidth),O.height(gi.wallHeight),{holdsGroup:O,state:D}}function tu({width:b,height:W,frequency:J=200,xOffset:et=50,yOffset:z=140,color:c="white",lineWidth:O=1}){const x=new Ii.Group;x.height(W),x.width(b);const D=new Ii.Rect({x:0,y:0,width:b,height:W,stroke:"white",strokeWidth:O,opacity:1});for(let N=et;N<=b;N+=J)x.add(new Ii.Line({points:[N,0,N,W],stroke:c,strokeWidth:O}));for(let N=W-z;N>=0;N-=J)x.add(new Ii.Line({points:[0,N,b,N],stroke:c,strokeWidth:O}));return x.add(D),x}function eu(b){const W=tu({width:gi.wallWidth,height:gi.wallHeight,frequency:gi.gridFrequency,color:"white",lineWidth:3}),J=new Ii.Rect({x:0,y:0,width:gi.wallWidth,height:gi.wallHeight,fill:"red",strokeWidth:8,opacity:1}),et=new Ii.Rect({x:0,y:0,width:gi.screenWidth,height:gi.screenHeight,fill:"white",strokeWidth:4,opacity:1});return En(J,gi),En(W,gi),et.visible(!1),J.visible(!1),W.visible(!1),b.add(et),b.add(J),b.add(W),cn.subscribe(z=>{if(z.type==="display")switch(z.layer){case"background":z.color?et.fill(`#${z.color}`):et.visible(!et.visible());break;case"wallBackground":z.color?J.fill(`#${z.color}`):J.visible(!J.visible());break;case"wallGrid":W.visible(!W.visible());break}}),{wallGrid:W,wallBackground:J,background:et}}function iu(b,W){b.forEach(J=>{hn(J.node,"normal")}),cn.subscribe(J=>{J.type==="preview"&&(b.forEach(et=>{const z=J.route.data.problem.holds.find(c=>c.id===et.id);z?hn(et.node,z.type):hn(et.node,"inactive")}),W.batchDraw()),J.type==="display"&&J.layer==="holds"&&(J.visibility?b.forEach(et=>{hn(et.node,"normal")}):b.forEach(et=>{hn(et.node,"inactive")}))})}const hn=(b,W)=>{switch(W){case"start":W=Cn.start;break;case"finish":W=Cn.finish;break;case"normal":W=Cn.normal;break;default:W=Cn.inactive}Object.entries(W).forEach(([J,et])=>{b.setAttr(J,et)})},Cn={inactive:{fill:"#888888",stroke:"#555555",strokeWidth:12,opacity:.2},normal:{fill:"#ffffff77",stroke:"#fff",strokeWidth:12,opacity:1},start:{fill:"#00ff00",stroke:"#009900",strokeWidth:12,opacity:1},finish:{fill:"#e6e6f0ff",stroke:"#ffffffff",strokeWidth:12,opacity:1}};async function ru(b){const J=await(await fetch("wall_foot.svg")).text(),c=new DOMParser().parseFromString(J,"image/svg+xml").querySelectorAll("path"),O=[],x=new Ii.Group,D=document.createElement("canvas");je.setup(D),c.forEach((B,Z)=>{const G=je.project.importSVG(B),d=us.offset(G,22,{miterLimit:10}).pathData,y=B.getAttribute("stroke")||"transparent",S=parseFloat(B.getAttribute("stroke-width")||1),R=new Ii.Path({id:`${Z}`,data:d,stroke:y,strokeWidth:S,draggable:!0}),H=R.getClientRect({skipTransform:!0}),P=H.x+H.width/2,g=H.y+H.height/2,L=Math.max(H.width,H.height)/2;R.fillRadialGradientStartPoint({x:P,y:g}),R.fillRadialGradientEndPoint({x:P,y:g}),R.fillRadialGradientStartRadius(0),R.fillRadialGradientEndRadius(L),R.fillRadialGradientColorStops([.4,"white",1,"transparent"]);const K=H.x+H.width/2,f=H.y+H.height/2,wt=K-R.x(),it=f-R.y();R.offsetX(wt),R.offsetY(it),R.x(R.x()+wt),R.y(R.y()+it),x.add(R),O.push(R)});const N=O.map(B=>({node:B,id:B.id(),progress:0,direction:Math.random()<.5?1:-1}));return x.width(gi.wallWidth),x.height(gi.wallHeight),cn.subscribe(B=>{B.type==="display"&&B.layer==="footholds"&&(O.forEach(Z=>{Z.visible(!!B.visibility)}),b.batchDraw())}),{holdsFootGroup:x,state:N}}var ns={},Ca;function nu(){return Ca||(Ca=1,(function(){function b(y){var S=0;return function(){return S<y.length?{done:!1,value:y[S++]}:{done:!0}}}var W=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,S,R){return y==Array.prototype||y==Object.prototype||(y[S]=R.value),y};function J(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof _r=="object"&&_r];for(var S=0;S<y.length;++S){var R=y[S];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var et=J(this);function z(y,S){if(S)t:{var R=et;y=y.split(".");for(var H=0;H<y.length-1;H++){var P=y[H];if(!(P in R))break t;R=R[P]}y=y[y.length-1],H=R[y],S=S(H),S!=H&&S!=null&&W(R,y,{configurable:!0,writable:!0,value:S})}}function c(y){var S=typeof Symbol<"u"&&Symbol.iterator&&y[Symbol.iterator];return S?S.call(y):{next:b(y)}}var O=typeof Object.assign=="function"?Object.assign:function(y,S){for(var R=1;R<arguments.length;R++){var H=arguments[R];if(H)for(var P in H)Object.prototype.hasOwnProperty.call(H,P)&&(y[P]=H[P])}return y};z("Object.assign",function(y){return y||O}),z("Array.prototype.fill",function(y){return y||function(S,R,H){var P=this.length||0;for(0>R&&(R=Math.max(0,P+R)),(H==null||H>P)&&(H=P),H=Number(H),0>H&&(H=Math.max(0,P+H)),R=Number(R||0);R<H;R++)this[R]=S;return this}});function x(y){return y||Array.prototype.fill}z("Int8Array.prototype.fill",x),z("Uint8Array.prototype.fill",x),z("Uint8ClampedArray.prototype.fill",x),z("Int16Array.prototype.fill",x),z("Uint16Array.prototype.fill",x),z("Int32Array.prototype.fill",x),z("Uint32Array.prototype.fill",x),z("Float32Array.prototype.fill",x),z("Float64Array.prototype.fill",x);var D=this||self;function N(y,S){y=y.split(".");var R=D;y[0]in R||typeof R.execScript>"u"||R.execScript("var "+y[0]);for(var H;y.length&&(H=y.shift());)y.length||S===void 0?R[H]&&R[H]!==Object.prototype[H]?R=R[H]:R=R[H]={}:R[H]=S}var B={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function Z(y){return y=y||{},Object.assign({},B,{fillColor:y.color},y)}function G(y,S){return y instanceof Function?y(S):y}function d(y,S,R){return Math.max(Math.min(S,R),Math.min(Math.max(S,R),y))}N("clamp",d),N("drawLandmarks",function(y,S,R){if(S){R=Z(R),y.save();var H=y.canvas,P=0;S=c(S);for(var g=S.next();!g.done;g=S.next())if(g=g.value,g!==void 0&&(g.visibility===void 0||g.visibility>R.visibilityMin)){y.fillStyle=G(R.fillColor,{index:P,from:g}),y.strokeStyle=G(R.color,{index:P,from:g}),y.lineWidth=G(R.lineWidth,{index:P,from:g});var L=new Path2D;L.arc(g.x*H.width,g.y*H.height,G(R.radius,{index:P,from:g}),0,2*Math.PI),y.fill(L),y.stroke(L),++P}y.restore()}}),N("drawConnectors",function(y,S,R,H){if(S&&R){H=Z(H),y.save();var P=y.canvas,g=0;R=c(R);for(var L=R.next();!L.done;L=R.next()){var K=L.value;y.beginPath(),L=S[K[0]],K=S[K[1]],L&&K&&(L.visibility===void 0||L.visibility>H.visibilityMin)&&(K.visibility===void 0||K.visibility>H.visibilityMin)&&(y.strokeStyle=G(H.color,{index:g,from:L,to:K}),y.lineWidth=G(H.lineWidth,{index:g,from:L,to:K}),y.moveTo(L.x*P.width,L.y*P.height),y.lineTo(K.x*P.width,K.y*P.height)),++g,y.stroke()}y.restore()}}),N("drawRectangle",function(y,S,R){R=Z(R),y.save();var H=y.canvas;y.beginPath(),y.lineWidth=G(R.lineWidth,{}),y.strokeStyle=G(R.color,{}),y.fillStyle=G(R.fillColor,{}),y.translate(S.xCenter*H.width,S.yCenter*H.height),y.rotate(S.rotation*Math.PI/180),y.rect(-S.width/2*H.width,-S.height/2*H.height,S.width*H.width,S.height*H.height),y.translate(-S.xCenter*H.width,-S.yCenter*H.height),y.stroke(),y.fill(),y.restore()}),N("lerp",function(y,S,R,H,P){return d(H*(1-(y-S)/(R-S))+P*(1-(R-y)/(R-S)),H,P)})}).call(ns)),ns}var Pa=nu(),ss={},ka;function su(){return ka||(ka=1,(function(){var b;function W(a){var _=0;return function(){return _<a.length?{done:!1,value:a[_++]}:{done:!0}}}var J=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,_,A){return a==Array.prototype||a==Object.prototype||(a[_]=A.value),a};function et(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof _r=="object"&&_r];for(var _=0;_<a.length;++_){var A=a[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var z=et(this);function c(a,_){if(_)t:{var A=z;a=a.split(".");for(var $=0;$<a.length-1;$++){var ft=a[$];if(!(ft in A))break t;A=A[ft]}a=a[a.length-1],$=A[a],_=_($),_!=$&&_!=null&&J(A,a,{configurable:!0,writable:!0,value:_})}}c("Symbol",function(a){function _(_t){if(this instanceof _)throw new TypeError("Symbol is not a constructor");return new A($+(_t||"")+"_"+ft++,_t)}function A(_t,lt){this.h=_t,J(this,"description",{configurable:!0,writable:!0,value:lt})}if(a)return a;A.prototype.toString=function(){return this.h};var $="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ft=0;return _}),c("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var _="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),A=0;A<_.length;A++){var $=z[_[A]];typeof $=="function"&&typeof $.prototype[a]!="function"&&J($.prototype,a,{configurable:!0,writable:!0,value:function(){return O(W(this))}})}return a});function O(a){return a={next:a},a[Symbol.iterator]=function(){return this},a}function x(a){var _=typeof Symbol<"u"&&Symbol.iterator&&a[Symbol.iterator];return _?_.call(a):{next:W(a)}}function D(a){if(!(a instanceof Array)){a=x(a);for(var _,A=[];!(_=a.next()).done;)A.push(_.value);a=A}return a}var N=typeof Object.assign=="function"?Object.assign:function(a,_){for(var A=1;A<arguments.length;A++){var $=arguments[A];if($)for(var ft in $)Object.prototype.hasOwnProperty.call($,ft)&&(a[ft]=$[ft])}return a};c("Object.assign",function(a){return a||N});var B=typeof Object.create=="function"?Object.create:function(a){function _(){}return _.prototype=a,new _},Z;if(typeof Object.setPrototypeOf=="function")Z=Object.setPrototypeOf;else{var G;t:{var d={a:!0},y={};try{y.__proto__=d,G=y.a;break t}catch{}G=!1}Z=G?function(a,_){if(a.__proto__=_,a.__proto__!==_)throw new TypeError(a+" is not extensible");return a}:null}var S=Z;function R(a,_){if(a.prototype=B(_.prototype),a.prototype.constructor=a,S)S(a,_);else for(var A in _)if(A!="prototype")if(Object.defineProperties){var $=Object.getOwnPropertyDescriptor(_,A);$&&Object.defineProperty(a,A,$)}else a[A]=_[A];a.za=_.prototype}function H(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function P(a){if(a.m)throw new TypeError("Generator is already running");a.m=!0}H.prototype.u=function(a){this.i=a};function g(a,_){a.l={ma:_,na:!0},a.h=a.s||a.v}H.prototype.return=function(a){this.l={return:a},this.h=this.v};function L(a,_,A){return a.h=A,{value:_}}function K(a){this.h=new H,this.i=a}function f(a,_){P(a.h);var A=a.h.j;return A?wt(a,"return"in A?A.return:function($){return{value:$,done:!0}},_,a.h.return):(a.h.return(_),it(a))}function wt(a,_,A,$){try{var ft=_.call(a.h.j,A);if(!(ft instanceof Object))throw new TypeError("Iterator result "+ft+" is not an object");if(!ft.done)return a.h.m=!1,ft;var _t=ft.value}catch(lt){return a.h.j=null,g(a.h,lt),it(a)}return a.h.j=null,$.call(a.h,_t),it(a)}function it(a){for(;a.h.h;)try{var _=a.i(a.h);if(_)return a.h.m=!1,{value:_.value,done:!1}}catch(A){a.h.i=void 0,g(a.h,A)}if(a.h.m=!1,a.h.l){if(_=a.h.l,a.h.l=null,_.na)throw _.ma;return{value:_.return,done:!0}}return{value:void 0,done:!0}}function rt(a){this.next=function(_){return P(a.h),a.h.j?_=wt(a,a.h.j.next,_,a.h.u):(a.h.u(_),_=it(a)),_},this.throw=function(_){return P(a.h),a.h.j?_=wt(a,a.h.j.throw,_,a.h.u):(g(a.h,_),_=it(a)),_},this.return=function(_){return f(a,_)},this[Symbol.iterator]=function(){return this}}function st(a){function _($){return a.next($)}function A($){return a.throw($)}return new Promise(function($,ft){function _t(lt){lt.done?$(lt.value):Promise.resolve(lt.value).then(_,A).then(_t,ft)}_t(a.next())})}function gt(a){return st(new rt(new K(a)))}c("Promise",function(a){function _(lt){this.i=0,this.j=void 0,this.h=[],this.u=!1;var Et=this.l();try{lt(Et.resolve,Et.reject)}catch(Bt){Et.reject(Bt)}}function A(){this.h=null}function $(lt){return lt instanceof _?lt:new _(function(Et){Et(lt)})}if(a)return a;A.prototype.i=function(lt){if(this.h==null){this.h=[];var Et=this;this.j(function(){Et.m()})}this.h.push(lt)};var ft=z.setTimeout;A.prototype.j=function(lt){ft(lt,0)},A.prototype.m=function(){for(;this.h&&this.h.length;){var lt=this.h;this.h=[];for(var Et=0;Et<lt.length;++Et){var Bt=lt[Et];lt[Et]=null;try{Bt()}catch(Jt){this.l(Jt)}}}this.h=null},A.prototype.l=function(lt){this.j(function(){throw lt})},_.prototype.l=function(){function lt(Jt){return function(te){Bt||(Bt=!0,Jt.call(Et,te))}}var Et=this,Bt=!1;return{resolve:lt(this.I),reject:lt(this.m)}},_.prototype.I=function(lt){if(lt===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(lt instanceof _)this.L(lt);else{t:switch(typeof lt){case"object":var Et=lt!=null;break t;case"function":Et=!0;break t;default:Et=!1}Et?this.F(lt):this.s(lt)}},_.prototype.F=function(lt){var Et=void 0;try{Et=lt.then}catch(Bt){this.m(Bt);return}typeof Et=="function"?this.M(Et,lt):this.s(lt)},_.prototype.m=function(lt){this.v(2,lt)},_.prototype.s=function(lt){this.v(1,lt)},_.prototype.v=function(lt,Et){if(this.i!=0)throw Error("Cannot settle("+lt+", "+Et+"): Promise already settled in state"+this.i);this.i=lt,this.j=Et,this.i===2&&this.K(),this.H()},_.prototype.K=function(){var lt=this;ft(function(){if(lt.D()){var Et=z.console;typeof Et<"u"&&Et.error(lt.j)}},1)},_.prototype.D=function(){if(this.u)return!1;var lt=z.CustomEvent,Et=z.Event,Bt=z.dispatchEvent;return typeof Bt>"u"?!0:(typeof lt=="function"?lt=new lt("unhandledrejection",{cancelable:!0}):typeof Et=="function"?lt=new Et("unhandledrejection",{cancelable:!0}):(lt=z.document.createEvent("CustomEvent"),lt.initCustomEvent("unhandledrejection",!1,!0,lt)),lt.promise=this,lt.reason=this.j,Bt(lt))},_.prototype.H=function(){if(this.h!=null){for(var lt=0;lt<this.h.length;++lt)_t.i(this.h[lt]);this.h=null}};var _t=new A;return _.prototype.L=function(lt){var Et=this.l();lt.T(Et.resolve,Et.reject)},_.prototype.M=function(lt,Et){var Bt=this.l();try{lt.call(Et,Bt.resolve,Bt.reject)}catch(Jt){Bt.reject(Jt)}},_.prototype.then=function(lt,Et){function Bt(ee,he){return typeof ee=="function"?function(le){try{Jt(ee(le))}catch(Ie){te(Ie)}}:he}var Jt,te,pe=new _(function(ee,he){Jt=ee,te=he});return this.T(Bt(lt,Jt),Bt(Et,te)),pe},_.prototype.catch=function(lt){return this.then(void 0,lt)},_.prototype.T=function(lt,Et){function Bt(){switch(Jt.i){case 1:lt(Jt.j);break;case 2:Et(Jt.j);break;default:throw Error("Unexpected state: "+Jt.i)}}var Jt=this;this.h==null?_t.i(Bt):this.h.push(Bt),this.u=!0},_.resolve=$,_.reject=function(lt){return new _(function(Et,Bt){Bt(lt)})},_.race=function(lt){return new _(function(Et,Bt){for(var Jt=x(lt),te=Jt.next();!te.done;te=Jt.next())$(te.value).T(Et,Bt)})},_.all=function(lt){var Et=x(lt),Bt=Et.next();return Bt.done?$([]):new _(function(Jt,te){function pe(le){return function(Ie){ee[le]=Ie,he--,he==0&&Jt(ee)}}var ee=[],he=0;do ee.push(void 0),he++,$(Bt.value).T(pe(ee.length-1),te),Bt=Et.next();while(!Bt.done)})},_});function St(a,_){a instanceof String&&(a+="");var A=0,$=!1,ft={next:function(){if(!$&&A<a.length){var _t=A++;return{value:_(_t,a[_t]),done:!1}}return $=!0,{done:!0,value:void 0}}};return ft[Symbol.iterator]=function(){return ft},ft}c("Array.prototype.keys",function(a){return a||function(){return St(this,function(_){return _})}}),c("Array.prototype.fill",function(a){return a||function(_,A,$){var ft=this.length||0;for(0>A&&(A=Math.max(0,ft+A)),($==null||$>ft)&&($=ft),$=Number($),0>$&&($=Math.max(0,ft+$)),A=Number(A||0);A<$;A++)this[A]=_;return this}});function It(a){return a||Array.prototype.fill}c("Int8Array.prototype.fill",It),c("Uint8Array.prototype.fill",It),c("Uint8ClampedArray.prototype.fill",It),c("Int16Array.prototype.fill",It),c("Uint16Array.prototype.fill",It),c("Int32Array.prototype.fill",It),c("Uint32Array.prototype.fill",It),c("Float32Array.prototype.fill",It),c("Float64Array.prototype.fill",It),c("Object.is",function(a){return a||function(_,A){return _===A?_!==0||1/_===1/A:_!==_&&A!==A}}),c("Array.prototype.includes",function(a){return a||function(_,A){var $=this;$ instanceof String&&($=String($));var ft=$.length;for(A=A||0,0>A&&(A=Math.max(A+ft,0));A<ft;A++){var _t=$[A];if(_t===_||Object.is(_t,_))return!0}return!1}}),c("String.prototype.includes",function(a){return a||function(_,A){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(_ instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(_,A||0)!==-1}});var Pt=this||self;function Tt(a,_){a=a.split(".");var A=Pt;a[0]in A||typeof A.execScript>"u"||A.execScript("var "+a[0]);for(var $;a.length&&($=a.shift());)a.length||_===void 0?A[$]&&A[$]!==Object.prototype[$]?A=A[$]:A=A[$]={}:A[$]=_}function Nt(a){var _;t:{if((_=Pt.navigator)&&(_=_.userAgent))break t;_=""}return _.indexOf(a)!=-1}var Q=Array.prototype.map?function(a,_){return Array.prototype.map.call(a,_,void 0)}:function(a,_){for(var A=a.length,$=Array(A),ft=typeof a=="string"?a.split(""):a,_t=0;_t<A;_t++)_t in ft&&($[_t]=_.call(void 0,ft[_t],_t,a));return $},at={},ct=null;function dt(a){var _=a.length,A=3*_/4;A%3?A=Math.floor(A):"=.".indexOf(a[_-1])!=-1&&(A="=.".indexOf(a[_-2])!=-1?A-2:A-1);var $=new Uint8Array(A),ft=0;return Ct(a,function(_t){$[ft++]=_t}),ft!==A?$.subarray(0,ft):$}function Ct(a,_){function A(Bt){for(;$<a.length;){var Jt=a.charAt($++),te=ct[Jt];if(te!=null)return te;if(!/^[\s\xa0]*$/.test(Jt))throw Error("Unknown base64 encoding at char: "+Jt)}return Bt}Ut();for(var $=0;;){var ft=A(-1),_t=A(0),lt=A(64),Et=A(64);if(Et===64&&ft===-1)break;_(ft<<2|_t>>4),lt!=64&&(_(_t<<4&240|lt>>2),Et!=64&&_(lt<<6&192|Et))}}function Ut(){if(!ct){ct={};for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),_=["+/=","+/","-_=","-_.","-_"],A=0;5>A;A++){var $=a.concat(_[A].split(""));at[A]=$;for(var ft=0;ft<$.length;ft++){var _t=$[ft];ct[_t]===void 0&&(ct[_t]=ft)}}}}var Ot=typeof Uint8Array<"u",Kt=!(Nt("Trident")||Nt("MSIE"))&&typeof Pt.btoa=="function";function Xt(a){if(!Kt){var _;_===void 0&&(_=0),Ut(),_=at[_];for(var A=Array(Math.floor(a.length/3)),$=_[64]||"",ft=0,_t=0;ft<a.length-2;ft+=3){var lt=a[ft],Et=a[ft+1],Bt=a[ft+2],Jt=_[lt>>2];lt=_[(lt&3)<<4|Et>>4],Et=_[(Et&15)<<2|Bt>>6],Bt=_[Bt&63],A[_t++]=Jt+lt+Et+Bt}switch(Jt=0,Bt=$,a.length-ft){case 2:Jt=a[ft+1],Bt=_[(Jt&15)<<2]||$;case 1:a=a[ft],A[_t]=_[a>>2]+_[(a&3)<<4|Jt>>4]+Bt+$}return A.join("")}for(_="";10240<a.length;)_+=String.fromCharCode.apply(null,a.subarray(0,10240)),a=a.subarray(10240);return _+=String.fromCharCode.apply(null,a),btoa(_)}var Vt=RegExp("[-_.]","g");function mt(a){switch(a){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Dt(a){if(!Kt)return dt(a);Vt.test(a)&&(a=a.replace(Vt,mt)),a=atob(a);for(var _=new Uint8Array(a.length),A=0;A<a.length;A++)_[A]=a.charCodeAt(A);return _}var Wt;function Qt(){return Wt||(Wt=new Uint8Array(0))}var re={},be=typeof Uint8Array.prototype.slice=="function",ce=0,we=0;function ge(a){var _=0>a;a=Math.abs(a);var A=a>>>0;a=Math.floor((a-A)/4294967296),_&&(A=x(Re(A,a)),_=A.next().value,a=A.next().value,A=_),ce=A>>>0,we=a>>>0}var Ze=typeof BigInt=="function";function Re(a,_){return _=~_,a?a=~a+1:_+=1,[a,_]}function Ue(a,_){this.i=a>>>0,this.h=_>>>0}function _i(a){if(!a)return ti||(ti=new Ue(0,0));if(!/^-?\d+$/.test(a))return null;if(16>a.length)ge(Number(a));else if(Ze)a=BigInt(a),ce=Number(a&BigInt(4294967295))>>>0,we=Number(a>>BigInt(32)&BigInt(4294967295));else{var _=+(a[0]==="-");we=ce=0;for(var A=a.length,$=_,ft=(A-_)%6+_;ft<=A;$=ft,ft+=6)$=Number(a.slice($,ft)),we*=1e6,ce=1e6*ce+$,4294967296<=ce&&(we+=ce/4294967296|0,ce%=4294967296);_&&(_=x(Re(ce,we)),a=_.next().value,_=_.next().value,ce=a,we=_)}return new Ue(ce,we)}var ti;function Ve(a,_){return Error("Invalid wire type: "+a+" (at position "+_+")")}function Le(){return Error("Failed to read varint, encoding is invalid.")}function Ae(a,_){return Error("Tried to read past the end of the data "+_+" > "+a)}function Qe(){throw Error("Invalid UTF8")}function _e(a,_){return _=String.fromCharCode.apply(null,_),a==null?_:a+_}var t=void 0,e,r=typeof TextDecoder<"u",n,s=typeof TextEncoder<"u",u;function h(a){if(a!==re)throw Error("illegal external caller")}function l(a,_){if(h(_),this.V=a,a!=null&&a.length===0)throw Error("ByteString should be constructed with non-empty values")}function p(){return u||(u=new l(null,re))}function v(a){h(re);var _=a.V;return _=_==null||Ot&&_!=null&&_ instanceof Uint8Array?_:typeof _=="string"?Dt(_):null,_==null?_:a.V=_}function T(a){if(typeof a=="string")return{buffer:Dt(a),C:!1};if(Array.isArray(a))return{buffer:new Uint8Array(a),C:!1};if(a.constructor===Uint8Array)return{buffer:a,C:!1};if(a.constructor===ArrayBuffer)return{buffer:new Uint8Array(a),C:!1};if(a.constructor===l)return{buffer:v(a)||Qt(),C:!0};if(a instanceof Uint8Array)return{buffer:new Uint8Array(a.buffer,a.byteOffset,a.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function I(a,_){this.i=null,this.m=!1,this.h=this.j=this.l=0,C(this,a,_)}function C(a,_,A){A=A===void 0?{}:A,a.S=A.S===void 0?!1:A.S,_&&(_=T(_),a.i=_.buffer,a.m=_.C,a.l=0,a.j=a.i.length,a.h=a.l)}I.prototype.reset=function(){this.h=this.l};function w(a,_){if(a.h=_,_>a.j)throw Ae(a.j,_)}function Y(a){var _=a.i,A=a.h,$=_[A++],ft=$&127;if($&128&&($=_[A++],ft|=($&127)<<7,$&128&&($=_[A++],ft|=($&127)<<14,$&128&&($=_[A++],ft|=($&127)<<21,$&128&&($=_[A++],ft|=$<<28,$&128&&_[A++]&128&&_[A++]&128&&_[A++]&128&&_[A++]&128&&_[A++]&128)))))throw Le();return w(a,A),ft}function M(a,_){if(0>_)throw Error("Tried to read a negative byte length: "+_);var A=a.h,$=A+_;if($>a.j)throw Ae(_,a.j-A);return a.h=$,A}var j=[];function k(){this.h=[]}k.prototype.length=function(){return this.h.length},k.prototype.end=function(){var a=this.h;return this.h=[],a};function V(a,_,A){for(;0<A||127<_;)a.h.push(_&127|128),_=(_>>>7|A<<25)>>>0,A>>>=7;a.h.push(_)}function m(a,_){for(;127<_;)a.h.push(_&127|128),_>>>=7;a.h.push(_)}function F(a,_){if(j.length){var A=j.pop();C(A,a,_),a=A}else a=new I(a,_);this.h=a,this.j=this.h.h,this.i=this.l=-1,this.setOptions(_)}F.prototype.setOptions=function(a){a=a===void 0?{}:a,this.ca=a.ca===void 0?!1:a.ca},F.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function X(a){var _=a.h;if(_.h==_.j)return!1;a.j=a.h.h;var A=Y(a.h)>>>0;if(_=A>>>3,A&=7,!(0<=A&&5>=A))throw Ve(A,a.j);if(1>_)throw Error("Invalid field number: "+_+" (at position "+a.j+")");return a.l=_,a.i=A,!0}function tt(a){switch(a.i){case 0:if(a.i!=0)tt(a);else t:{a=a.h;for(var _=a.h,A=_+10,$=a.i;_<A;)if(($[_++]&128)===0){w(a,_);break t}throw Le()}break;case 1:a=a.h,w(a,a.h+8);break;case 2:a.i!=2?tt(a):(_=Y(a.h)>>>0,a=a.h,w(a,a.h+_));break;case 5:a=a.h,w(a,a.h+4);break;case 3:_=a.l;do{if(!X(a))throw Error("Unmatched start-group tag: stream EOF");if(a.i==4){if(a.l!=_)throw Error("Unmatched end-group tag");break}tt(a)}while(!0);break;default:throw Ve(a.i,a.j)}}var U=[];function nt(){this.j=[],this.i=0,this.h=new k}function ut(a,_){_.length!==0&&(a.j.push(_),a.i+=_.length)}function pt(a,_){if(_=_.R){ut(a,a.h.end());for(var A=0;A<_.length;A++)ut(a,v(_[A])||Qt())}}var bt=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function ot(a,_){return bt?a[bt]|=_:a.A!==void 0?a.A|=_:(Object.defineProperties(a,{A:{value:_,configurable:!0,writable:!0,enumerable:!1}}),_)}function xt(a,_){bt?a[bt]&&(a[bt]&=~_):a.A!==void 0&&(a.A&=~_)}function yt(a){var _;return bt?_=a[bt]:_=a.A,_??0}function At(a,_){bt?a[bt]=_:a.A!==void 0?a.A=_:Object.defineProperties(a,{A:{value:_,configurable:!0,writable:!0,enumerable:!1}})}function Rt(a){return ot(a,1),a}function Mt(a,_){At(_,(a|0)&-51)}function jt(a,_){At(_,(a|18)&-41)}var $t={};function ie(a){return a!==null&&typeof a=="object"&&!Array.isArray(a)&&a.constructor===Object}var oe,zt=[];At(zt,23),oe=Object.freeze(zt);function Ht(a){if(yt(a.o)&2)throw Error("Cannot mutate an immutable Message")}function ne(a){var _=a.length;(_=_?a[_-1]:void 0)&&ie(_)?_.g=1:(_={},a.push((_.g=1,_)))}function ue(a){var _=a.i+a.G;return a.B||(a.B=a.o[_]={})}function se(a,_){return _===-1?null:_>=a.i?a.B?a.B[_]:void 0:a.o[_+a.G]}function fe(a,_,A,$){Ht(a),de(a,_,A,$)}function de(a,_,A,$){a.j&&(a.j=void 0),_>=a.i||$?ue(a)[_]=A:(a.o[_+a.G]=A,(a=a.B)&&_ in a&&delete a[_])}function ye(a,_,A,$){var ft=se(a,_);Array.isArray(ft)||(ft=oe);var _t=yt(ft);if(_t&1||Rt(ft),$)_t&2||ot(ft,2),A&1||Object.freeze(ft);else{$=!(A&2);var lt=_t&2;A&1||!lt?$&&_t&16&&!lt&&xt(ft,16):(ft=Rt(Array.prototype.slice.call(ft)),de(a,_,ft))}return ft}function Ce(a,_){var A=se(a,_),$=A==null?A:typeof A=="number"||A==="NaN"||A==="Infinity"||A==="-Infinity"?Number(A):void 0;return $!=null&&$!==A&&de(a,_,$),$}function ve(a,_,A,$,ft){a.h||(a.h={});var _t=a.h[A],lt=ye(a,A,3,ft);if(!_t){var Et=lt;_t=[];var Bt=!!(yt(a.o)&16);lt=!!(yt(Et)&2);var Jt=Et;!ft&&lt&&(Et=Array.prototype.slice.call(Et));for(var te=lt,pe=0;pe<Et.length;pe++){var ee=Et[pe],he=_,le=!1;if(le=le===void 0?!1:le,ee=Array.isArray(ee)?new he(ee):le?new he:void 0,ee!==void 0){he=ee.o;var Ie=le=yt(he);lt&&(Ie|=2),Bt&&(Ie|=16),Ie!=le&&At(he,Ie),he=Ie,te=te||!!(2&he),_t.push(ee)}}return a.h[A]=_t,Bt=yt(Et),_=Bt|33,_=te?_&-9:_|8,Bt!=_&&(te=Et,Object.isFrozen(te)&&(te=Array.prototype.slice.call(te)),At(te,_),Et=te),Jt!==Et&&de(a,A,Et),(ft||$&&lt)&&ot(_t,2),$&&Object.freeze(_t),_t}return ft||(ft=Object.isFrozen(_t),$&&!ft?Object.freeze(_t):!$&&ft&&(_t=Array.prototype.slice.call(_t),a.h[A]=_t)),_t}function Xe(a,_,A){var $=!!(yt(a.o)&2);if(_=ve(a,_,A,$,$),a=ye(a,A,3,$),!($||yt(a)&8)){for($=0;$<_.length;$++){if(A=_[$],yt(A.o)&2){var ft=Ci(A,!1);ft.j=A}else ft=A;A!==ft&&(_[$]=ft,a[$]=ft.o)}ot(a,8)}return _}function Be(a,_,A){if(A!=null&&typeof A!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof A+": "+A);fe(a,_,A)}function $e(a,_,A,$,ft){Ht(a);var _t=ve(a,A,_,!1,!1);return A=$??new A,a=ye(a,_,2,!1),ft!=null?(_t.splice(ft,0,A),a.splice(ft,0,A.o)):(_t.push(A),a.push(A.o)),A.C()&&xt(a,8),A}function We(a,_){return a??_}function Zt(a,_,A){return A=A===void 0?0:A,We(Ce(a,_),A)}var ze;function Ke(a){switch(typeof a){case"number":return isFinite(a)?a:String(a);case"object":if(a)if(Array.isArray(a)){if((yt(a)&128)!==0)return a=Array.prototype.slice.call(a),ne(a),a}else{if(Ot&&a!=null&&a instanceof Uint8Array)return Xt(a);if(a instanceof l){var _=a.V;return _==null?"":typeof _=="string"?_:a.V=Xt(_)}}}return a}function Je(a,_,A,$){if(a!=null){if(Array.isArray(a))a=ci(a,_,A,$!==void 0);else if(ie(a)){var ft={},_t;for(_t in a)ft[_t]=Je(a[_t],_,A,$);a=ft}else a=_(a,$);return a}}function ci(a,_,A,$){var ft=yt(a);$=$?!!(ft&16):void 0,a=Array.prototype.slice.call(a);for(var _t=0;_t<a.length;_t++)a[_t]=Je(a[_t],_,A,$);return A(ft,a),a}function Ei(a){return a.ja===$t?a.toJSON():Ke(a)}function bi(a,_){a&128&&ne(_)}function vi(a,_,A){if(A=A===void 0?jt:A,a!=null){if(Ot&&a instanceof Uint8Array)return a.length?new l(new Uint8Array(a),re):p();if(Array.isArray(a)){var $=yt(a);return $&2?a:_&&!($&32)&&($&16||$===0)?(At(a,$|2),a):(a=ci(a,vi,$&4?jt:A,!0),_=yt(a),_&4&&_&2&&Object.freeze(a),a)}return a.ja===$t?fi(a):a}}function ai(a,_,A,$,ft,_t,lt){if(a=a.h&&a.h[A]){if($=yt(a),$&2?$=a:(_t=Q(a,fi),jt($,_t),Object.freeze(_t),$=_t),Ht(_),lt=$==null?oe:Rt([]),$!=null){for(_t=!!$.length,a=0;a<$.length;a++){var Et=$[a];_t=_t&&!(yt(Et.o)&2),lt[a]=Et.o}_t=(_t?8:0)|1,a=yt(lt),(a&_t)!==_t&&(Object.isFrozen(lt)&&(lt=Array.prototype.slice.call(lt)),At(lt,a|_t)),_.h||(_.h={}),_.h[A]=$}else _.h&&(_.h[A]=void 0);de(_,A,lt,ft)}else fe(_,A,vi($,_t,lt),ft)}function fi(a){return yt(a.o)&2||(a=Ci(a,!0),ot(a.o,2)),a}function Ci(a,_){var A=a.o,$=[];ot($,16);var ft=a.constructor.h;if(ft&&$.push(ft),ft=a.B,ft){$.length=A.length,$.fill(void 0,$.length,A.length);var _t={};$[$.length-1]=_t}(yt(A)&128)!==0&&ne($),_=_||a.C()?jt:Mt,_t=a.constructor,ze=$,$=new _t($),ze=void 0,a.R&&($.R=a.R.slice()),_t=!!(yt(A)&16);for(var lt=ft?A.length-1:A.length,Et=0;Et<lt;Et++)ai(a,$,Et-a.G,A[Et],!1,_t,_);if(ft)for(var Bt in ft)ai(a,$,+Bt,ft[Bt],!0,_t,_);return $}function Me(a,_,A){a==null&&(a=ze),ze=void 0;var $=this.constructor.i||0,ft=0<$,_t=this.constructor.h,lt=!1;if(a==null){a=_t?[_t]:[];var Et=48,Bt=!0;ft&&($=0,Et|=128),At(a,Et)}else{if(!Array.isArray(a)||_t&&_t!==a[0])throw Error();var Jt=Et=ot(a,0);if((Bt=(16&Jt)!==0)&&((lt=(32&Jt)!==0)||(Jt|=32)),ft){if(128&Jt)$=0;else if(0<a.length){var te=a[a.length-1];if(ie(te)&&"g"in te){$=0,Jt|=128,delete te.g;var pe=!0,ee;for(ee in te){pe=!1;break}pe&&a.pop()}}}else if(128&Jt)throw Error();Et!==Jt&&At(a,Jt)}this.G=(_t?0:-1)-$,this.h=void 0,this.o=a;t:{if(_t=this.o.length,$=_t-1,_t&&(_t=this.o[$],ie(_t))){this.B=_t,this.i=$-this.G;break t}_!==void 0&&-1<_?(this.i=Math.max(_,$+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!ft&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(A){_=Bt&&!lt&&!0,ft=this.i;var he;for(Bt=0;Bt<A.length;Bt++)lt=A[Bt],lt<ft?(lt+=this.G,($=a[lt])?oi($,_):a[lt]=oe):(he||(he=ue(this)),($=he[lt])?oi($,_):he[lt]=oe)}}Me.prototype.toJSON=function(){return ci(this.o,Ei,bi)},Me.prototype.C=function(){return!!(yt(this.o)&2)};function oi(a,_){if(Array.isArray(a)){var A=yt(a),$=1;!_||A&2||($|=16),(A&$)!==$&&At(a,A|$)}}Me.prototype.ja=$t,Me.prototype.toString=function(){return this.o.toString()};function tr(a,_,A){if(A){var $={},ft;for(ft in A){var _t=A[ft],lt=_t.ra;lt||($.J=_t.xa||_t.oa.W,_t.ia?($.aa=Oi(_t.ia),lt=(function(Et){return function(Bt,Jt,te){return Et.J(Bt,Jt,te,Et.aa)}})($)):_t.ka?($.Z=xi(_t.da.P,_t.ka),lt=(function(Et){return function(Bt,Jt,te){return Et.J(Bt,Jt,te,Et.Z)}})($)):lt=$.J,_t.ra=lt),lt(_,a,_t.da),$={J:$.J,aa:$.aa,Z:$.Z}}}pt(_,a)}var Gi=Symbol();function er(a,_,A){return a[Gi]||(a[Gi]=function($,ft){return _($,ft,A)})}function ir(a){var _=a[Gi];if(!_){var A=q(a);_=function($,ft){return ht($,ft,A)},a[Gi]=_}return _}function hr(a){var _=a.ia;if(_)return ir(_);if(_=a.wa)return er(a.da.P,_,a.ka)}function Xi(a){var _=hr(a),A=a.da,$=a.oa.U;return _?function(ft,_t){return $(ft,_t,A,_)}:function(ft,_t){return $(ft,_t,A)}}function Li(a,_){var A=a[_];return typeof A=="function"&&A.length===0&&(A=A(),a[_]=A),Array.isArray(A)&&(Fi in A||me in A||0<A.length&&typeof A[0]=="function")?A:void 0}function Ui(a,_,A,$,ft,_t){_.P=a[0];var lt=1;if(a.length>lt&&typeof a[lt]!="number"){var Et=a[lt++];A(_,Et)}for(;lt<a.length;){A=a[lt++];for(var Bt=lt+1;Bt<a.length&&typeof a[Bt]!="number";)Bt++;switch(Et=a[lt++],Bt-=lt,Bt){case 0:$(_,A,Et);break;case 1:(Bt=Li(a,lt))?(lt++,ft(_,A,Et,Bt)):$(_,A,Et,a[lt++]);break;case 2:Bt=lt++,Bt=Li(a,Bt),ft(_,A,Et,Bt,a[lt++]);break;case 3:_t(_,A,Et,a[lt++],a[lt++],a[lt++]);break;case 4:_t(_,A,Et,a[lt++],a[lt++],a[lt++],a[lt++]);break;default:throw Error("unexpected number of binary field arguments: "+Bt)}}return _}var Ri=Symbol();function Oi(a){var _=a[Ri];if(!_){var A=ji(a);_=function($,ft){return Lt($,ft,A)},a[Ri]=_}return _}function xi(a,_){var A=a[Ri];return A||(A=function($,ft){return tr($,ft,_)},a[Ri]=A),A}var me=Symbol();function wi(a,_){a.push(_)}function Pi(a,_,A){a.push(_,A.W)}function Si(a,_,A,$){var ft=Oi($),_t=ji($).P,lt=A.W;a.push(_,function(Et,Bt,Jt){return lt(Et,Bt,Jt,_t,ft)})}function Mi(a,_,A,$,ft,_t){var lt=xi($,_t),Et=A.W;a.push(_,function(Bt,Jt,te){return Et(Bt,Jt,te,$,lt)})}function ji(a){var _=a[me];return _||(_=Ui(a,a[me]=[],wi,Pi,Si,Mi),Fi in a&&me in a&&(a.length=0),_)}var Fi=Symbol();function rr(a,_){a[0]=_}function i(a,_,A,$){var ft=A.U;a[_]=$?function(_t,lt,Et){return ft(_t,lt,Et,$)}:ft}function o(a,_,A,$,ft){var _t=A.U,lt=ir($),Et=q($).P;a[_]=function(Bt,Jt,te){return _t(Bt,Jt,te,Et,lt,ft)}}function E(a,_,A,$,ft,_t,lt){var Et=A.U,Bt=er($,ft,_t);a[_]=function(Jt,te,pe){return Et(Jt,te,pe,$,Bt,lt)}}function q(a){var _=a[Fi];return _||(_=Ui(a,a[Fi]={},rr,i,o,E),Fi in a&&me in a&&(a.length=0),_)}function ht(a,_,A){for(;X(_)&&_.i!=4;){var $=_.l,ft=A[$];if(!ft){var _t=A[0];_t&&(_t=_t[$])&&(ft=A[$]=Xi(_t))}if(!ft||!ft(_,a,$)){ft=_,$=a,_t=ft.j,tt(ft);var lt=ft;if(!lt.ca){if(ft=lt.h.h-_t,lt.h.h=_t,lt=lt.h,ft==0)ft=p();else{if(_t=M(lt,ft),lt.S&&lt.m)ft=lt.i.subarray(_t,_t+ft);else{lt=lt.i;var Et=_t;ft=_t+ft,ft=Et===ft?Qt():be?lt.slice(Et,ft):new Uint8Array(lt.subarray(Et,ft))}ft=ft.length==0?p():new l(ft,re)}(_t=$.R)?_t.push(ft):$.R=[ft]}}}return a}function Lt(a,_,A){for(var $=A.length,ft=$%2==1,_t=ft?1:0;_t<$;_t+=2)(0,A[_t+1])(_,a,A[_t]);tr(a,_,ft?A[0]:void 0)}function Ft(a,_){return{U:a,W:_}}var Yt=Ft(function(a,_,A){if(a.i!==5)return!1;a=a.h;var $=a.i,ft=a.h,_t=$[ft],lt=$[ft+1],Et=$[ft+2];return $=$[ft+3],w(a,a.h+4),lt=(_t<<0|lt<<8|Et<<16|$<<24)>>>0,a=2*(lt>>31)+1,_t=lt>>>23&255,lt&=8388607,fe(_,A,_t==255?lt?NaN:1/0*a:_t==0?a*Math.pow(2,-149)*lt:a*Math.pow(2,_t-150)*(lt+Math.pow(2,23))),!0},function(a,_,A){if(_=Ce(_,A),_!=null){m(a.h,8*A+5),a=a.h;var $=+_;$===0?0<1/$?ce=we=0:(we=0,ce=2147483648):isNaN($)?(we=0,ce=2147483647):($=(A=0>$?-2147483648:0)?-$:$,34028234663852886e22<$?(we=0,ce=(A|2139095040)>>>0):11754943508222875e-54>$?($=Math.round($/Math.pow(2,-149)),we=0,ce=(A|$)>>>0):(_=Math.floor(Math.log($)/Math.LN2),$*=Math.pow(2,-_),$=Math.round(8388608*$),16777216<=$&&++_,we=0,ce=(A|_+127<<23|$&8388607)>>>0)),A=ce,a.h.push(A>>>0&255),a.h.push(A>>>8&255),a.h.push(A>>>16&255),a.h.push(A>>>24&255)}}),ae=Ft(function(a,_,A){if(a.i!==0)return!1;var $=a.h,ft=0,_t=a=0,lt=$.i,Et=$.h;do{var Bt=lt[Et++];ft|=(Bt&127)<<_t,_t+=7}while(32>_t&&Bt&128);for(32<_t&&(a|=(Bt&127)>>4),_t=3;32>_t&&Bt&128;_t+=7)Bt=lt[Et++],a|=(Bt&127)<<_t;if(w($,Et),128>Bt)$=ft>>>0,Bt=a>>>0,(a=Bt&2147483648)&&($=~$+1>>>0,Bt=~Bt>>>0,$==0&&(Bt=Bt+1>>>0)),$=4294967296*Bt+($>>>0);else throw Le();return fe(_,A,a?-$:$),!0},function(a,_,A){_=se(_,A),_!=null&&(typeof _=="string"&&_i(_),_!=null&&(m(a.h,8*A),typeof _=="number"?(a=a.h,ge(_),V(a,ce,we)):(A=_i(_),V(a.h,A.i,A.h))))}),xe=Ft(function(a,_,A){return a.i!==0?!1:(fe(_,A,Y(a.h)),!0)},function(a,_,A){if(_=se(_,A),_!=null&&_!=null)if(m(a.h,8*A),a=a.h,A=_,0<=A)m(a,A);else{for(_=0;9>_;_++)a.h.push(A&127|128),A>>=7;a.h.push(1)}}),Te=Ft(function(a,_,A){if(a.i!==2)return!1;var $=Y(a.h)>>>0;a=a.h;var ft=M(a,$);if(a=a.i,r){var _t=a,lt;(lt=e)||(lt=e=new TextDecoder("utf-8",{fatal:!0})),a=ft+$,_t=ft===0&&a===_t.length?_t:_t.subarray(ft,a);try{var Et=lt.decode(_t)}catch(pe){if(t===void 0){try{lt.decode(new Uint8Array([128]))}catch{}try{lt.decode(new Uint8Array([97])),t=!0}catch{t=!1}}throw!t&&(e=void 0),pe}}else{Et=ft,$=Et+$,ft=[];for(var Bt=null,Jt,te;Et<$;)Jt=a[Et++],128>Jt?ft.push(Jt):224>Jt?Et>=$?Qe():(te=a[Et++],194>Jt||(te&192)!==128?(Et--,Qe()):ft.push((Jt&31)<<6|te&63)):240>Jt?Et>=$-1?Qe():(te=a[Et++],(te&192)!==128||Jt===224&&160>te||Jt===237&&160<=te||((_t=a[Et++])&192)!==128?(Et--,Qe()):ft.push((Jt&15)<<12|(te&63)<<6|_t&63)):244>=Jt?Et>=$-2?Qe():(te=a[Et++],(te&192)!==128||(Jt<<28)+(te-144)>>30!==0||((_t=a[Et++])&192)!==128||((lt=a[Et++])&192)!==128?(Et--,Qe()):(Jt=(Jt&7)<<18|(te&63)<<12|(_t&63)<<6|lt&63,Jt-=65536,ft.push((Jt>>10&1023)+55296,(Jt&1023)+56320))):Qe(),8192<=ft.length&&(Bt=_e(Bt,ft),ft.length=0);Et=_e(Bt,ft)}return fe(_,A,Et),!0},function(a,_,A){if(_=se(_,A),_!=null){var $=!1;if($=$===void 0?!1:$,s){if($&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(_))throw Error("Found an unpaired surrogate");_=(n||(n=new TextEncoder)).encode(_)}else{for(var ft=0,_t=new Uint8Array(3*_.length),lt=0;lt<_.length;lt++){var Et=_.charCodeAt(lt);if(128>Et)_t[ft++]=Et;else{if(2048>Et)_t[ft++]=Et>>6|192;else{if(55296<=Et&&57343>=Et){if(56319>=Et&&lt<_.length){var Bt=_.charCodeAt(++lt);if(56320<=Bt&&57343>=Bt){Et=1024*(Et-55296)+Bt-56320+65536,_t[ft++]=Et>>18|240,_t[ft++]=Et>>12&63|128,_t[ft++]=Et>>6&63|128,_t[ft++]=Et&63|128;continue}else lt--}if($)throw Error("Found an unpaired surrogate");Et=65533}_t[ft++]=Et>>12|224,_t[ft++]=Et>>6&63|128}_t[ft++]=Et&63|128}}_=ft===_t.length?_t:_t.subarray(0,ft)}m(a.h,8*A+2),m(a.h,_.length),ut(a,a.h.end()),ut(a,_)}}),qe=Ft(function(a,_,A,$,ft){if(a.i!==2)return!1;_=$e(_,A,$),A=a.h.j,$=Y(a.h)>>>0;var _t=a.h.h+$,lt=_t-A;if(0>=lt&&(a.h.j=_t,ft(_,a,void 0,void 0,void 0),lt=_t-a.h.h),lt)throw Error("Message parsing ended unexpectedly. Expected to read "+($+" bytes, instead read "+($-lt)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return a.h.h=_t,a.h.j=A,!0},function(a,_,A,$,ft){if(_=Xe(_,$,A),_!=null)for($=0;$<_.length;$++){var _t=a;m(_t.h,8*A+2);var lt=_t.h.end();ut(_t,lt),lt.push(_t.i),_t=lt,ft(_[$],a),lt=a;var Et=_t.pop();for(Et=lt.i+lt.h.length()-Et;127<Et;)_t.push(Et&127|128),Et>>>=7,lt.i++;_t.push(Et),lt.i++}});function ei(a){return function(_,A){t:{if(U.length){var $=U.pop();$.setOptions(A),C($.h,_,A),_=$}else _=new F(_,A);try{var ft=q(a),_t=ht(new ft.P,_,ft);break t}finally{ft=_.h,ft.i=null,ft.m=!1,ft.l=0,ft.j=0,ft.h=0,ft.S=!1,_.l=-1,_.i=-1,100>U.length&&U.push(_)}_t=void 0}return _t}}function Di(a){return function(){var _=new nt;Lt(this,_,ji(a)),ut(_,_.h.end());for(var A=new Uint8Array(_.i),$=_.j,ft=$.length,_t=0,lt=0;lt<ft;lt++){var Et=$[lt];A.set(Et,_t),_t+=Et.length}return _.j=[A],A}}function mi(a){Me.call(this,a)}R(mi,Me);var Ti=[mi,1,xe,2,Yt,3,Te,4,Te];mi.prototype.l=Di(Ti);function Ni(a){Me.call(this,a,-1,zi)}R(Ni,Me),Ni.prototype.addClassification=function(a,_){return $e(this,1,mi,a,_),this};var zi=[1],fn=ei([Ni,1,qe,Ti]);function Hi(a){Me.call(this,a)}R(Hi,Me);var dn=[Hi,1,Yt,2,Yt,3,Yt,4,Yt,5,Yt];Hi.prototype.l=Di(dn);function pn(a){Me.call(this,a,-1,gn)}R(pn,Me);var gn=[1],Nn=ei([pn,1,qe,dn]);function nr(a){Me.call(this,a)}R(nr,Me);var _n=[nr,1,Yt,2,Yt,3,Yt,4,Yt,5,Yt,6,ae],lr=ei(_n);nr.prototype.l=Di(_n);function qi(a,_,A){if(A=a.createShader(A===0?a.VERTEX_SHADER:a.FRAGMENT_SHADER),a.shaderSource(A,_),a.compileShader(A),!a.getShaderParameter(A,a.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+a.getShaderInfoLog(A));return A}function cr(a){return Xe(a,mi,1).map(function(_){var A=se(_,1);return{index:A??0,qa:Zt(_,2),label:se(_,3)!=null?We(se(_,3),""):void 0,displayName:se(_,4)!=null?We(se(_,4),""):void 0}})}function vn(a){return{x:Zt(a,1),y:Zt(a,2),z:Zt(a,3),visibility:Ce(a,4)!=null?Zt(a,4):void 0}}function Bi(a){return Xe(Nn(a),Hi,1).map(vn)}function fr(a,_){this.i=a,this.h=_,this.m=0}function ri(a,_,A){return Ln(a,_),typeof a.h.canvas.transferToImageBitmap=="function"?Promise.resolve(a.h.canvas.transferToImageBitmap()):A?Promise.resolve(a.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(a.h.canvas):(a.j===void 0&&(a.j=document.createElement("canvas")),new Promise(function($){a.j.height=a.h.canvas.height,a.j.width=a.h.canvas.width,a.j.getContext("2d",{}).drawImage(a.h.canvas,0,0,a.h.canvas.width,a.h.canvas.height),$(a.j)}))}function Ln(a,_){var A=a.h;if(a.s===void 0){var $=qi(A,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),ft=qi(A,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),_t=A.createProgram();if(A.attachShader(_t,$),A.attachShader(_t,ft),A.linkProgram(_t),!A.getProgramParameter(_t,A.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+A.getProgramInfoLog(_t));$=a.s=_t,A.useProgram($),ft=A.getUniformLocation($,"sampler0"),a.l={O:A.getAttribLocation($,"aVertex"),N:A.getAttribLocation($,"aTex"),ya:ft},a.v=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,a.v),A.enableVertexAttribArray(a.l.O),A.vertexAttribPointer(a.l.O,2,A.FLOAT,!1,0,0),A.bufferData(A.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),a.u=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,a.u),A.enableVertexAttribArray(a.l.N),A.vertexAttribPointer(a.l.N,2,A.FLOAT,!1,0,0),A.bufferData(A.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),A.uniform1i(ft,0)}$=a.l,A.useProgram(a.s),A.canvas.width=_.width,A.canvas.height=_.height,A.viewport(0,0,_.width,_.height),A.activeTexture(A.TEXTURE0),a.i.bindTexture2d(_.glName),A.enableVertexAttribArray($.O),A.bindBuffer(A.ARRAY_BUFFER,a.v),A.vertexAttribPointer($.O,2,A.FLOAT,!1,0,0),A.enableVertexAttribArray($.N),A.bindBuffer(A.ARRAY_BUFFER,a.u),A.vertexAttribPointer($.N,2,A.FLOAT,!1,0,0),A.bindFramebuffer(A.DRAW_FRAMEBUFFER?A.DRAW_FRAMEBUFFER:A.FRAMEBUFFER,null),A.clearColor(0,0,0,0),A.clear(A.COLOR_BUFFER_BIT),A.colorMask(!0,!0,!0,!0),A.drawArrays(A.TRIANGLE_FAN,0,4),A.disableVertexAttribArray($.O),A.disableVertexAttribArray($.N),A.bindBuffer(A.ARRAY_BUFFER,null),a.i.bindTexture2d(0)}function vr(a){this.h=a}var Zi=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Mn(a,_){return _+a}function mn(a,_){window[a]=_}function Fn(a){var _=document.createElement("script");return _.setAttribute("src",a),_.setAttribute("crossorigin","anonymous"),new Promise(function(A){_.addEventListener("load",function(){A()},!1),_.addEventListener("error",function(){A()},!1),document.body.appendChild(_)})}function Dn(){return gt(function(a){switch(a.h){case 1:return a.s=2,L(a,WebAssembly.instantiate(Zi),4);case 4:a.h=3,a.s=0;break;case 2:return a.s=0,a.l=null,a.return(!1);case 3:return a.return(!0)}})}function mr(a){if(this.h=a,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=a&&a.locateFile||Mn,typeof window=="object")var _=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")_=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=_,a.options){_=x(Object.keys(a.options));for(var A=_.next();!A.done;A=_.next()){A=A.value;var $=a.options[A].default;$!==void 0&&(this.l[A]=typeof $=="function"?$():$)}}}b=mr.prototype,b.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function Bn(a){var _,A,$,ft,_t,lt,Et,Bt,Jt,te,pe;return gt(function(ee){switch(ee.h){case 1:return a.ga?(_=a.h.files===void 0?[]:typeof a.h.files=="function"?a.h.files(a.l):a.h.files,L(ee,Dn(),2)):ee.return();case 2:if(A=ee.i,typeof window=="object")return mn("createMediapipeSolutionsWasm",{locateFile:a.locateFile}),mn("createMediapipeSolutionsPackedAssets",{locateFile:a.locateFile}),lt=_.filter(function(he){return he.data!==void 0}),Et=_.filter(function(he){return he.data===void 0}),Bt=Promise.all(lt.map(function(he){var le=dr(a,he.url);if(he.path!==void 0){var Ie=he.path;le=le.then(function(Ge){return a.overrideFile(Ie,Ge),Promise.resolve(Ge)})}return le})),Jt=Promise.all(Et.map(function(he){return he.simd===void 0||he.simd&&A||!he.simd&&!A?Fn(a.locateFile(he.url,a.ha)):Promise.resolve()})).then(function(){var he,le,Ie;return gt(function(Ge){if(Ge.h==1)return he=window.createMediapipeSolutionsWasm,le=window.createMediapipeSolutionsPackedAssets,Ie=a,L(Ge,he(le),2);Ie.i=Ge.i,Ge.h=0})}),te=(function(){return gt(function(he){return a.h.graph&&a.h.graph.url?he=L(he,dr(a,a.h.graph.url),0):(he.h=0,he=void 0),he})})(),L(ee,Promise.all([Jt,Bt,te]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return $=_.filter(function(he){return he.simd===void 0||he.simd&&A||!he.simd&&!A}).map(function(he){return a.locateFile(he.url,a.ha)}),importScripts.apply(null,D($)),ft=a,L(ee,createMediapipeSolutionsWasm(Module),6);case 6:ft.i=ee.i,a.m=new OffscreenCanvas(1,1),a.i.canvas=a.m,_t=a.i.GL.createContext(a.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),a.i.GL.makeContextCurrent(_t),ee.h=4;break;case 7:if(a.m=document.createElement("canvas"),pe=a.m.getContext("webgl2",{}),!pe&&(pe=a.m.getContext("webgl",{}),!pe))return alert("Failed to create WebGL canvas context when passing video frame."),ee.return();a.K=pe,a.i.canvas=a.m,a.i.createContext(a.m,!0,!0,{});case 4:a.j=new a.i.SolutionWasm,a.ga=!1,ee.h=0}})}function Vn(a){var _,A,$,ft,_t,lt,Et,Bt;return gt(function(Jt){if(Jt.h==1){if(a.h.graph&&a.h.graph.url&&a.fa===a.h.graph.url)return Jt.return();if(a.u=!0,!a.h.graph||!a.h.graph.url){Jt.h=2;return}return a.fa=a.h.graph.url,L(Jt,dr(a,a.h.graph.url),3)}for(Jt.h!=2&&(_=Jt.i,a.j.loadGraph(_)),A=x(Object.keys(a.D)),$=A.next();!$.done;$=A.next())ft=$.value,a.j.overrideFile(ft,a.D[ft]);if(a.D={},a.h.listeners)for(_t=x(a.h.listeners),lt=_t.next();!lt.done;lt=_t.next())Et=lt.value,yn(a,Et);Bt=a.l,a.l={},a.setOptions(Bt),Jt.h=0})}b.reset=function(){var a=this;return gt(function(_){a.j&&(a.j.reset(),a.s={},a.v={}),_.h=0})},b.setOptions=function(a,_){var A=this;if(_=_||this.h.options){for(var $=[],ft=[],_t={},lt=x(Object.keys(a)),Et=lt.next();!Et.done;_t={X:_t.X,Y:_t.Y},Et=lt.next())if(Et=Et.value,!(Et in this.l&&this.l[Et]===a[Et])){this.l[Et]=a[Et];var Bt=_[Et];Bt!==void 0&&(Bt.onChange&&(_t.X=Bt.onChange,_t.Y=a[Et],$.push((function(Jt){return function(){var te;return gt(function(pe){if(pe.h==1)return L(pe,Jt.X(Jt.Y),2);te=pe.i,te===!0&&(A.u=!0),pe.h=0})}})(_t))),Bt.graphOptionXref&&(Et=Object.assign({},{calculatorName:"",calculatorIndex:0},Bt.graphOptionXref,{valueNumber:Bt.type===1?a[Et]:0,valueBoolean:Bt.type===0?a[Et]:!1,valueString:Bt.type===2?a[Et]:""}),ft.push(Et)))}($.length!==0||ft.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(ft),this.F=(this.F===void 0?[]:this.F).concat($))}};function Gn(a){var _,A,$,ft,_t,lt,Et;return gt(function(Bt){switch(Bt.h){case 1:if(!a.u)return Bt.return();if(!a.F){Bt.h=2;break}_=x(a.F),A=_.next();case 3:if(A.done){Bt.h=5;break}return $=A.value,L(Bt,$(),4);case 4:A=_.next(),Bt.h=3;break;case 5:a.F=void 0;case 2:if(a.H){for(ft=new a.i.GraphOptionChangeRequestList,_t=x(a.H),lt=_t.next();!lt.done;lt=_t.next())Et=lt.value,ft.push_back(Et);a.j.changeOptions(ft),ft.delete(),a.H=void 0}a.u=!1,Bt.h=0}})}b.initialize=function(){var a=this;return gt(function(_){return _.h==1?L(_,Bn(a),2):_.h!=3?L(_,Vn(a),3):L(_,Gn(a),0)})};function dr(a,_){var A,$;return gt(function(ft){return _ in a.L?ft.return(a.L[_]):(A=a.locateFile(_,""),$=fetch(A).then(function(_t){return _t.arrayBuffer()}),a.L[_]=$,ft.return($))})}b.overrideFile=function(a,_){this.j?this.j.overrideFile(a,_):this.D[a]=_},b.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},b.send=function(a,_){var A=this,$,ft,_t,lt,Et,Bt,Jt,te,pe;return gt(function(ee){switch(ee.h){case 1:return A.h.inputs?($=1e3*(_??performance.now()),L(ee,A.I,2)):ee.return();case 2:return L(ee,A.initialize(),3);case 3:for(ft=new A.i.PacketDataList,_t=x(Object.keys(a)),lt=_t.next();!lt.done;lt=_t.next())if(Et=lt.value,Bt=A.h.inputs[Et]){t:{var he=a[Et];switch(Bt.type){case"video":var le=A.s[Bt.stream];if(le||(le=new fr(A.i,A.K),A.s[Bt.stream]=le),le.m===0&&(le.m=le.i.createTexture()),typeof HTMLVideoElement<"u"&&he instanceof HTMLVideoElement)var Ie=he.videoWidth,Ge=he.videoHeight;else typeof HTMLImageElement<"u"&&he instanceof HTMLImageElement?(Ie=he.naturalWidth,Ge=he.naturalHeight):(Ie=he.width,Ge=he.height);Ge={glName:le.m,width:Ie,height:Ge},Ie=le.h,Ie.canvas.width=Ge.width,Ie.canvas.height=Ge.height,Ie.activeTexture(Ie.TEXTURE0),le.i.bindTexture2d(le.m),Ie.texImage2D(Ie.TEXTURE_2D,0,Ie.RGBA,Ie.RGBA,Ie.UNSIGNED_BYTE,he),le.i.bindTexture2d(0),le=Ge;break t;case"detections":for(le=A.s[Bt.stream],le||(le=new vr(A.i),A.s[Bt.stream]=le),le.data||(le.data=new le.h.DetectionListData),le.data.reset(he.length),Ge=0;Ge<he.length;++Ge){Ie=he[Ge];var ke=le.data,Ye=ke.setBoundingBox,pi=Ge,yi=Ie.la,Fe=new nr;if(Be(Fe,1,yi.sa),Be(Fe,2,yi.ta),Be(Fe,3,yi.height),Be(Fe,4,yi.width),Be(Fe,5,yi.rotation),fe(Fe,6,yi.pa),yi=Fe.l(),Ye.call(ke,pi,yi),Ie.ea)for(ke=0;ke<Ie.ea.length;++ke){Fe=Ie.ea[ke],Ye=le.data,pi=Ye.addNormalizedLandmark,yi=Ge,Fe=Object.assign({},Fe,{visibility:Fe.visibility?Fe.visibility:0});var li=new Hi;Be(li,1,Fe.x),Be(li,2,Fe.y),Be(li,3,Fe.z),Fe.visibility&&Be(li,4,Fe.visibility),Fe=li.l(),pi.call(Ye,yi,Fe)}if(Ie.ba)for(ke=0;ke<Ie.ba.length;++ke)Ye=le.data,pi=Ye.addClassification,yi=Ge,Fe=Ie.ba[ke],li=new mi,Be(li,2,Fe.qa),Fe.index&&fe(li,1,Fe.index),Fe.label&&fe(li,3,Fe.label),Fe.displayName&&fe(li,4,Fe.displayName),Fe=li.l(),pi.call(Ye,yi,Fe)}le=le.data;break t;default:le={}}}switch(Jt=le,te=Bt.stream,Bt.type){case"video":ft.pushTexture2d(Object.assign({},Jt,{stream:te,timestamp:$}));break;case"detections":pe=Jt,pe.stream=te,pe.timestamp=$,ft.pushDetectionList(pe);break;default:throw Error("Unknown input config type: '"+Bt.type+"'")}}return A.j.send(ft),L(ee,A.I,4);case 4:ft.delete(),ee.h=0}})};function Wi(a,_,A){var $,ft,_t,lt,Et,Bt,Jt,te,pe,ee,he,le,Ie,Ge;return gt(function(ke){switch(ke.h){case 1:if(!A)return ke.return(_);for($={},ft=0,_t=x(Object.keys(A)),lt=_t.next();!lt.done;lt=_t.next())Et=lt.value,Bt=A[Et],typeof Bt!="string"&&Bt.type==="texture"&&_[Bt.stream]!==void 0&&++ft;1<ft&&(a.M=!1),Jt=x(Object.keys(A)),lt=Jt.next();case 2:if(lt.done){ke.h=4;break}if(te=lt.value,pe=A[te],typeof pe=="string")return Ie=$,Ge=te,L(ke,ui(a,te,_[pe]),14);if(ee=_[pe.stream],pe.type==="detection_list"){if(ee){for(var Ye=ee.getRectList(),pi=ee.getLandmarksList(),yi=ee.getClassificationsList(),Fe=[],li=0;li<Ye.size();++li){var hi=lr(Ye.get(li)),sr=Zt(hi,1),ar=Zt(hi,2),yr=Zt(hi,3),xn=Zt(hi,4),wn=Zt(hi,5,0),ni=void 0;ni=ni===void 0?0:ni,hi={la:{sa:sr,ta:ar,height:yr,width:xn,rotation:wn,pa:We(se(hi,6),ni)},ea:Bi(pi.get(li)),ba:cr(fn(yi.get(li)))},Fe.push(hi)}Ye=Fe}else Ye=[];$[te]=Ye,ke.h=7;break}if(pe.type==="proto_list"){if(ee){for(Ye=Array(ee.size()),pi=0;pi<ee.size();pi++)Ye[pi]=ee.get(pi);ee.delete()}else Ye=[];$[te]=Ye,ke.h=7;break}if(ee===void 0){ke.h=3;break}if(pe.type==="float_list"){$[te]=ee,ke.h=7;break}if(pe.type==="proto"){$[te]=ee,ke.h=7;break}if(pe.type!=="texture")throw Error("Unknown output config type: '"+pe.type+"'");return he=a.v[te],he||(he=new fr(a.i,a.K),a.v[te]=he),L(ke,ri(he,ee,a.M),13);case 13:le=ke.i,$[te]=le;case 7:pe.transform&&$[te]&&($[te]=pe.transform($[te])),ke.h=3;break;case 14:Ie[Ge]=ke.i;case 3:lt=Jt.next(),ke.h=2;break;case 4:return ke.return($)}})}function ui(a,_,A){var $;return gt(function(ft){return typeof A=="number"||A instanceof Uint8Array||A instanceof a.i.Uint8BlobList?ft.return(A):A instanceof a.i.Texture2dDataOut?($=a.v[_],$||($=new fr(a.i,a.K),a.v[_]=$),ft.return(ri($,A,a.M))):ft.return(void 0)})}function yn(a,_){for(var A=_.name||"$",$=[].concat(D(_.wants)),ft=new a.i.StringList,_t=x(_.wants),lt=_t.next();!lt.done;lt=_t.next())ft.push_back(lt.value);_t=a.i.PacketListener.implement({onResults:function(Et){for(var Bt={},Jt=0;Jt<_.wants.length;++Jt)Bt[$[Jt]]=Et.get(Jt);var te=a.listeners[A];te&&(a.I=Wi(a,Bt,_.outs).then(function(pe){pe=te(pe);for(var ee=0;ee<_.wants.length;++ee){var he=Bt[$[ee]];typeof he=="object"&&he.hasOwnProperty&&he.hasOwnProperty("delete")&&he.delete()}pe&&(a.I=pe)}))}}),a.j.attachMultiListener(ft,_t),ft.delete()}b.onResults=function(a,_){this.listeners[_||"$"]=a},Tt("Solution",mr),Tt("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Qi(a){switch(a===void 0&&(a=0),a){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function bn(a){var _=this;a=a||{},this.h=new mr({locateFile:a.locateFile,files:function(A){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:Qi(A.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Bi},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:Bi},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(A){var $,ft,_t;return gt(function(lt){return lt.h==1?($=Qi(A),ft="third_party/mediapipe/modules/pose_landmark/"+$,L(lt,dr(_.h,$),2)):(_t=lt.i,_.h.overrideFile(ft,_t),lt.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}b=bn.prototype,b.reset=function(){this.h.reset()},b.close=function(){return this.h.close(),Promise.resolve()},b.onResults=function(a){this.h.onResults(a)},b.initialize=function(){var a=this;return gt(function(_){return L(_,a.h.initialize(),0)})},b.send=function(a,_){var A=this;return gt(function($){return L($,A.h.send(a,_),0)})},b.setOptions=function(a){this.h.setOptions(a)},Tt("Pose",bn),Tt("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),Tt("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),Tt("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),Tt("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),Tt("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),Tt("VERSION","0.5.1675469404")}).call(ss)),ss}var au=su();function ou(){const b=document.getElementById("poseCanvas");b.width=gi.wallWidth*(window.innerHeight/gi.wallHeight),b.height=window.innerHeight;const W=b.getContext("2d");cn.subscribe(J=>{console.log("Received pose data:",J),W.clearRect(0,0,b.width,b.height),J.type==="pose"&&(console.log("Drawing pose landmarks"),Pa.drawConnectors(W,J.landmarks,au.POSE_CONNECTIONS,{color:"#00FF00",lineWidth:4}),Pa.drawLandmarks(W,J.landmarks,{color:"#f2ff00ff",lineWidth:2}))})}cn.connect("wss://climber.dev.maptnh.net/ws/transformed_pose/");const An=new Ii.Stage({container:"drawingContainer",width:window.innerWidth,height:window.innerHeight}),In=new Ii.Layer;An.add(In);eu(In);async function uu(){const{holdsFootGroup:b}=await ru(An),{holdsGroup:W,state:J}=await $o();ou(),iu(J,An),En(W,gi),En(b,gi),In.add(b),In.add(W),An.batchDraw()}uu();
